---
author: "Sunshine_Lin"
title: "被 lodash 的一个方法给坑了"
date: 2024-01-11
description: "前言 大家好，我是林三心，用最通俗易懂的话讲最难的知识点是我的座右铭，基础是进阶的前提是我的初心~ 背景 我们项目中有一处业务代码，需要根据不同的条件，对某个对象进行属性的删除，大概代码如下： 接着需"
tags: ["前端中文技术社区","前端开发社区","前端技术交流","前端框架教程","JavaScript 学习资源","CSS 技巧与最佳实践","HTML5 最新动态","前端工程师职业发展","开源前端项目","前端技术趋势"]
ShowReadingTime: "阅读2分钟"
weight: 1
selfDefined:"likes:15,comments:0,collects:8,views:1962,"
---
前言
--

大家好，我是林三心，用最通俗易懂的话讲最难的知识点是我的座右铭，基础是进阶的前提是我的初心~

背景
--

我们项目中有一处业务代码，需要根据不同的条件，对某个对象进行属性的删除，大概代码如下：

![](/images/jueJin/bd7f3c87cc6e40d.png)

接着需要判断这个对象是否为空，为空的话就去执行另一个很重要的逻辑，这里判断对象为空，我们选择了`lodash`的`isEmpty`方法

![](/images/jueJin/4d14df73acf3451.png)

出问题了
----

然后就出事了，上线后发现有 BUG ，定位问题之后，发现就是明明对象不为空，然后`isEmpty`还是把这个对象判为空了，然后去执行了接下来的逻辑，导致出现 BUG

然后我就去看了一下 `isEmpty`的源码，总算是发现问题了！

![](/images/jueJin/a09a4e46431449c.png)

可以看到最后一个环节，`isEmpty` 在判断对象是否为空的时候，用了`for in + hasOwnProperty`去判断某一个属性是否存在对象中，只要有一个存在，那么这个对象就不为空！

诶！那好像也没啥问题啊？但是我突然想到，那这个`for in`能遍历出 `Symbol` 类型的属性吗？于是我试了一下，**发现 for in 并不会遍历 Symbol属性**

![](/images/jueJin/b01c315bc741441.png)

这也严重了问题出在`lodash 的 isEmpty`上，并且根本原因是 **for in 并不会遍历 Symbol属性**

解决问题
----

所以还是自己实现一个来解决这个问题吧！！！我们可以获取到对象的属性个数，判断属性个数是否为0，为0那就是为空

那可以用`Object.keys`吗？他的作用就是可以把对象的属性放到一个数组中，我们试试之后，发现`Object.keys`并不会把Symbol属性算进去

![](/images/jueJin/80f79d53d2fd4cc.png)

我们换一下`Reflect.ownKeys`试试，发现就完全可以了！！！！

![](/images/jueJin/25b53f4d3f3242b.png)

所以最终自己实现了一个 `isEmpty`

![](/images/jueJin/888841fd55714e6.png)

结语 & 加学习群 & 摸鱼群
---------------

我是林三心

*   一个待过**小型toG型外包公司、大型外包公司、小公司、潜力型创业公司、大公司**的作死型前端选手；
*   一个偏前端的全干工程师；
*   一个不正经的掘金作者；
*   一个逗比的B站up主；
*   一个不帅的小红书博主；
*   一个喜欢打铁的篮球菜鸟；
*   一个喜欢历史的乏味少年；
*   一个喜欢rap的五音不全弱鸡

如果你想一起学习前端，一起摸鱼，一起研究简历优化，一起研究面试进步，一起交流历史音乐篮球rap，可以来俺的摸鱼学习群哈哈，点这个，有7000多名前端小伙伴在等着一起学习哦 --> [摸鱼沸点](https://juejin.cn/pin/7035153948126216206 "https://juejin.cn/pin/7035153948126216206")