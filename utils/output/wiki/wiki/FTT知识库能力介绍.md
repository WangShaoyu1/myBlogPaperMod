---
author: "王宇"
title: "FTT知识库能力介绍"
date: 十一月02,2023
description: "（三）知识库"
tags: ["（三）知识库"]
ShowReadingTime: "12s"
weight: 591
---
一、知识库
-----

### 1、指令库

定义：指令旨在完成特定的任务，需要进行一些动作的执行，比如页面跳转、信息查询等。

适用场景：①需要应用层执行某一动作，如提高音量；②问题答案是动态的，需要去查询某些信息并返回，如播报烹饪剩余时间

#### （1）FTT系统功能介绍

##### **①指令的组成**

*   指令名称、指令标识、相似问、关联词槽、反馈话术，其中模型的训练数据为相似问和词槽实体

##### **②****指令识别流程**

![](/download/attachments/109730229/image2023-11-2_13-50-37.png?version=1&modificationDate=1698904237449&api=v2)

**FTT指令库的任务：**对用户的query进行意图的匹配并收集必填词槽后返回一个完整的JSON，包括指令标识和实体信息。拿到指令标识后具体需要执行什么动作，以及在不同的可用环境下执行动作有什么不同，就需要应用层去做判断。

##### **③提供的功能**

词槽

*   词槽识别上无泛化能力，需要百分百匹配；需要通过维护实体别名来满足不同说法的需求
*   可关联多个系统词槽或自定义词槽
*   支持词槽非必填，但是非必填针对的是该指令引用的所有词槽，而不支持引用多个词槽的情况下，一些词槽追问，一些词槽不追问；
*   追问次数可设置1-3次，词槽的追问话术和追问失败话术只有一句

话术

*   指令话术有一定的泛化能力；
*   支持添加多个执行成功话术和执行失败话术，随机返回一个。但是话术为纯文本，无法引用词槽实体
*   指令黑名单：添加到指令黑名单后，该话术就不会被识别成指令，黑名单具有泛化能力

![](/download/attachments/109730229/image2023-10-30_9-6-7.png?version=1&modificationDate=1698627967838&api=v2)

##### **④指令完成的三种话术返回结果**

![](/download/attachments/109730229/image2023-11-2_15-1-54.png?version=1&modificationDate=1698908514690&api=v2)

##### **⑤可拓展方向**

**词槽非必填：**用户可以选择是否提供的特定信息。如推荐食谱的指令，如果用户的话术中要包含实体，则按照实体进行推荐；如果没有实体，则随机推荐。这种方式可以缩短交互的链路，同时具备了灵活性和个性化，体验感也会更好一点。

**词槽追问：**可用于主动询问意图的场景，词槽作为选项。触发规则可以有多种，执行了某个动作后、触发了某个指令后、某个时间点等，如：执行打开烹饪方案的动作后询问是否要进入开始烹饪的意图，主动询问：是否要开始烹饪（词槽追问话术），是/否作为词槽的两个实体。

#### （2）指令设计和测试

##### ①指令设计

指令设计的关键环节在于意图的明确和词槽的确定

具体流程：明确意图及具体执行的功能→对已有的意图进行区分→确定该意图需要收集的属性值（词槽）→判断属性值的必要性，是否支持非必填→确定指令标准话术→添加相似问和词槽实体

指令话术上：指令模型的训练数据由指令相似问和词槽实体组成，数据越丰富，训练的模型也就越聪明，但同时也需要考虑训练数据的质量，包括与意图的关联性和准确度等。如果训练数据过于泛化，可能会导致指令模型不够准确从而造成指令间的误识别。

##### ②指令测试

评估指标：nlp准确率、asr准确率、终端准确率、误触率

测试流程：测试数据准备（测试问句、随机话术）→nlp测试/终端测试→记录测试结果→统计测试结果→针对性话术优化/黑名单添加

测试细节：需要对一些关键问题如可能产生误触、数字/字母asr识别等进行针对性的测试

指令黑名单确定：确定完指令阈值后，对误触指令的FAQ进行指令黑名单的添加，再重新进行一次测试，以排除黑名单对指令识别的影响，以及测试黑名单是否解决误触的问题

[指令库测试方案和评价指标定义与计算方式 - 虚拟数字人 - YZ Wiki (yingzi.com)](https://wiki.yingzi.com/pages/viewpage.action?pageId=105252181)

#### （3）局限性

##### 功能上

①当前FTT仅提供了基础的单条指令识别的能力，不支持上下轮意图和实体的继承，无法进行多轮对话

②意图回复话术上，仅支持随机返回一条纯文本话术，无法引用匹配到的实体，也无法根据不同的规则触发不同的回复话术

③无法以单个词槽为单位设置非必填，无法支持同时存在必填和非必填词槽的指令

### 2、FAQ库

定义：FAQ即问答，一问一答的形式，匹配到了会播报相应的回复话术，为用户快速提供答案

适用场景：①只需要回答问题，不需要应用层去执行具体的动作；②问题的答案是静态的，不会发生改变

#### （1）FTT系统功能介绍

##### ①FAQ的组成

一个标准问、一个标准答、相似问

##### ②提供的功能

*   一个问题对应一个答案，且答案是静态的；
*   A+编辑器添加虚拟人动画和富文本（图片、视频、音频）

![](/download/attachments/109730229/image2023-10-30_10-27-19.png?version=1&modificationDate=1698632839515&api=v2)![](/download/attachments/109730229/image2023-10-30_10-27-27.png?version=1&modificationDate=1698632847409&api=v2)

##### ③可拓展的方向

结合A+动画资源，新增一些互动类的FAQ，如转圈、飞吻、打瞌睡

#### （2）FAQ撰写和测试

##### ①FAQ撰写

FAQ撰写的关键环节在于标准问的明确和答案的描述

具体流程：确定问题类别→相应分类下问题的梳理→标准问撰写→标准答撰写→相似问撰写

##### ②FAQ测试

评估指标：nlp准确率、asr准确率、终端准确率

测试流程：测试数据准备（测试问句）→nlp测试/终端测试→记录测试结果→统计测试结果→针对性话术优化

测试细节：FAQ的语义理解能力较差，且相似问相对也比较长，需要特别注意asr的识别情况，对一些容易识别成同音词的词语进行热词的添加，并添加进FAQ相似问

[问答库评价指标定义、计算方式 - 虚拟数字人 - YZ Wiki (yingzi.com)](https://wiki.yingzi.com/pages/viewpage.action?pageId=105250839)

#### （3）局限性

##### 功能上

①每个问题仅支持一个回复，回答比较单一，缺少多样性

②仅提供一问一答的语句问答能力，只能支持静态答案的问题，对于句式相似但关键词不同的问题，均需要逐一写成FAQ的形式；对于答案是动态的问题，也需要定期进行答案修改，工作量大，维护成本高；百度和讯飞提供的表格问答、文档问答、关键词问答的功能，可以快速提供答案，具有简洁高效的优点，大大降低了维护成本

##### 准确率

①目前FTT系统FAQ的语义理解能力稍差，同一批测试数据，在各自合适的阈值水平上，AIUI平台的准确率为90%，而FTT为85%，整体置信度水平偏低，误触率较AIUI平台高出10%，需要靠大量的相似问来提高准确率，维护成本较高

[20231020FTT系统问答与指令识别能力测试报告 - 虚拟数字人 - YZ Wiki (yingzi.com)](https://wiki.yingzi.com/pages/viewpage.action?pageId=109726704)

### 3、其他系统的能力

**任务型对话**：百度提供图形化对话流程管理的功能，在前端界面通过拖拽的方式将节点和连线组合，即可形成一个完整的对话流程，提高了整体交互的体验感。

没有对话流程功能的支持但是想实现任务型对话的效果，只能通过业务逻辑将几个指令和tts播报内容串联起来，形成一个完整的对话流程，可实现但是比较麻烦，且不够灵活。

![](/download/attachments/109730229/image2023-11-2_9-50-36.png?version=1&modificationDate=1698889836738&api=v2)     ![](/download/thumbnails/109730229/image2023-10-30_9-6-26.png?version=1&modificationDate=1698627986250&api=v2)

**表格问答：**从表格数据中检索答案。通过表格维护实体和相应的属性值，将用户问题进行解析，从表格中获得数据并转化为答案。不需要去写大量的相似问

**文档问答：**从非结构化的大规模文档数据中提取答案。只需要导入文档内容，通过对文档内容的分析获取问题的答案，不需要将文档内容都总结抽提成一个个FAQ

**关键词问答：**只需要添加问题的关键词即可，不需要维护大量的相似问

**问题模板（问答）：**句式相同但关键词不同的问题，即可适用问题模板来覆盖，提高效率

二、NLP配置
-------

*   对指令、问答、闲聊、兜底等的优先级和阈值进行设置
*   阈值：每个query发送后，FTT都会返回一个置信度分数，如果分数高于设定的阈值，则能匹配到相应的意图

#### （1）系统功能介绍

##### **①提供的功能**

仅支持对不同NLP模块（指令、问答、闲聊等）的优先级和阈值进行设置，不支持对单个知识库的优先级和阈值进行排序

指令模块仅支持引用一个指令库，不支持分库

FAQ模块支持引用多个FAQ库，但不支持对每个知识库设定不同的优先级和阈值

技能分发上，FTT没有技能分发干预的规则，只能按照优先级的顺序从前往后匹配

![](/download/attachments/109730229/image2023-10-30_9-7-14.png?version=1&modificationDate=1698628034353&api=v2)

#### （2）阈值和优先级确定

优先级顺序：指令→FAQ→属性和寒暄→闲聊→兜底

阈值确定：通过测试结果，综合指令/FAQ准确率和误触率两个数据，进行阈值的确定。

#### （3）局限性

指令无法分库，只能将系统操作类和搜索推荐类的指令放在同一个库训练，可能因为训练数据的不平衡导致指令模型效果不好

没有技能分发干预，可能造成回复优先级靠后的nlp模块（闲聊、兜底）返回比较慢

三、星火大模型助手-提示词模板
---------------

1、入口：[讯飞星火认知大模型-AI大语言模型-星火大模型-科大讯飞 (xfyun.cn)](https://xinghuo.xfyun.cn/botcenter)

2、助手创建：以模板的形式编辑提示词，给定助手的名称、功能、角色设定、目标任务、需求说明等信息，即可创建定制化的助手，还可以上传相应的数据集，满足业务相关知识问答的需求

3、功能：通过星火助手，无需再输入完整的问题，只需要输入问题所需要的关键词，即可快速获得答案。

![](/download/attachments/109730229/image2023-11-2_10-17-30.png?version=1&modificationDate=1698891450806&api=v2)![](/download/attachments/109730229/image2023-11-2_10-17-41.png?version=1&modificationDate=1698891461814&api=v2)

  

[Filter table data](#)[Create a pivot table](#)[Create a chart from data series](#)

[Configure buttons visibility](/users/tfac-settings.action)