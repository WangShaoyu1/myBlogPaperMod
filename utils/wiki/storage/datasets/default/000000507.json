{
	"title": "春节活动优化记录",
	"author": "王宇",
	"publishTime": "二月06,2024",
	"readTime": "12s",
	"tags": "[\"春节活动\"]",
	"description": "春节活动",
	"article": "跟年度报告一样的优化技术，并增加一些新方案\n\n[春节活动优化记录](/pages/viewpage.action?pageId=119672831)\n\n  \n\n1.在index.html添加dns prefetch\n===========================\n\n提前解释，缩短了DNS的解析时间，项目中较多地方都有用到cdn的资源\n\n[?](#)\n\n`<``metahttp-equiv``=``\"x-dns-prefetch-control\"``content``=``\"on\"``></``metahttp-equiv``>`\n\n`<``link` `rel``=``\"dns-prefetch\"` `href``=``\"[https://static-cdn.yingzi.com/](https://static-cdn.yingzi.com/)\"``>`\n\n  \n\n资料：\n\n[https://baijiahao.baidu.com/s?id=1627766889599299125&wfr=spider&for=pc](https://baijiahao.baidu.com/s?id=1627766889599299125&wfr=spider&for=pc)\n\n  \n\n2.直接用<transition></transition>做渐变消失动画\n=====================================\n\n不用再添加额外样式、类名来实现渐变效果\n\n[?](#)\n\n`<transition name=``\"transition-container\"``>`\n\n  `<Loading @click=``\"start\"` `v-``if``=``\"isLoading\"` `/>`\n\n`</transition>`\n\n  \n\n[?](#)\n\n`.transition-container-leave-active {`\n\n  `transition: opacity` `1``s;`\n\n`}`\n\n`.transition-container-leave-to {`\n\n  `opacity:` `0``;`\n\n`}`\n\n  \n\n3.能手动实现的动画就代码实现\n===============\n\n最理想场景\n\n代码实现css→代码实现js → lottie库 → gif → 代码轮播图片\n\n[https://gitlab.yingzi.com/yingzi/vdh/yingzi-web-vdh-newyear/-/blob/feature-20240205/src/components/Blessingsign/index.vue](https://gitlab.yingzi.com/yingzi/vdh/yingzi-web-vdh-newyear/-/blob/feature-20240205/src/components/Blessingsign/index.vue)\n\n  \n\n  \n\nanimation-fill-mode里both和forwards区别：\n\n[https://blog.csdn.net/weixin\\_42989576/article/details/100551602](https://blog.csdn.net/weixin_42989576/article/details/100551602)\n\n  \n\n4.偷偷下载资源\n========\n\n在loading时下载好第一个口播A+和出场动画A+，保证播放时流程，才给开始按钮点击进入\n\n后面的口播A+资源，在进入第一阶段fetch一下，在后台异步下载\n\n[?](#)\n\n`secretlyFetchCache(keys: string[]) {`\n\n  `for` `(let i` `in` `keys) {`\n\n    ``fetch(`https:````//static-cdn.yingzi.com/vdh/newyear/cache/${keys[i]}.json`);``\n\n  `}`\n\n`}`\n\n![](/download/attachments/119672831/image2024-2-5_13-49-56.png?version=1&modificationDate=1707112196199&api=v2)\n\n5.巨坑\n====\n\n有用到html2canvas生成海报的部分，img标签不要用loading='lazy'，在ios15.6 (至少有一台)，有2个以上img(大概)就会生成不出海报\n\n![](/download/attachments/119672831/image2024-2-5_18-42-5.png?version=1&modificationDate=1707129725779&api=v2)\n\n[https://github.com/niklasvh/html2canvas/issues/2864](https://github.com/niklasvh/html2canvas/issues/2864)\n\n  \n\n[Filter table data](#)[Create a pivot table](#)[Create a chart from data series](#)\n\n[Configure buttons visibility](/users/tfac-settings.action)"
}