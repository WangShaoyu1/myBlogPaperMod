{
	"title": "1、工作指南",
	"author": "王宇",
	"publishTime": "七月03,2023",
	"readTime": "12s",
	"tags": "[\"指令库\"]",
	"description": "指令库",
	"article": "*   1[1.0  综述](#id-1、工作指南-1.0综述)\n*   2[1.1  指令的业务范围（炉端）](#id-1、工作指南-1.1指令的业务范围（炉端）)\n*   3[1.2  指令设计规范](#id-1、工作指南-1.2指令设计规范)\n*   4[1.3  词槽和追问话术的撰写规范](#id-1、工作指南-1.3词槽和追问话术的撰写规范)\n*   5[1.4  相似问的撰写规范](#id-1、工作指南-1.4相似问的撰写规范)\n*   6[1\\. 5  指令测试规范](#id-1、工作指南-1.5指令测试规范)\n*   7[1\\. 6 AI工具使用](#id-1、工作指南-1.6AI工具使用)\n\n该页面存放相关工作规范、模板文件等。\n\n  \n\n系统能力介绍详见《FTT training content》。短期内将使用虚拟人公司提供的运营后台系统进行指令库搭建，以库为单位给虚拟人配置所需知识库，支持单类知识库配置多个数量。问答库、指令库均需要以库为单位做好分类。指令库需要结合不同终端的任务能力进行分库设计。  \n该处指令库的概念，与科大讯飞中的自定义技能、百度UNIT平台中的对话技能一致，均是多条指令意图的集合；单条指令，通过标准话术进行表达，话术支持关联词槽并设置多个实体，以支持对不同实体执行同一任务指令；在识别到该指令但词槽未能填充时，支持对空缺的词槽进行追问。  \n（1）根据不同终端能力与不同任务分类，进行分库设计；  \n（2）参考生命周期的业务逻辑，进行意图抽提；  \n（3）单条指令的话术设计，关联词槽设置，追问话术设计，执行成功话术，执行失败话术；  \n（4）通过添加相似问，提高命中率；  \n（5）逐条测试；  \n（6）库内相近指令冲突测试；  \n（7）多知识库的语料冲突测试；  \n（8）指令使用场景设计（对接产品经理开发落地）；  \n（摘自内容工作概述，待持续完善更新）\n\n**1.0  综述**\n-----------\n\n**1、工作指南的内容**\n\n*   指令业务范围、指令库工作流程、指令设计规范、相似问撰写规范、指令测试规范、文件格式和模板\n\n**2、工作指南的作用**\n\n*   帮助新加入的同事快速了解工作流程\n*   确定指令工作标准，规范流程\n\n**3、****指令库工作流程（待完善）**\n\n**![](/download/attachments/97890527/image2023-4-25_11-34-36.png?version=1&modificationDate=1682393676383&api=v2)**\n\n**1.1  指令的业务范围（炉端）**\n--------------------\n\n序号\n\n分类\n\n内容范围\n\n序号\n\n分类\n\n内容范围\n\n1\n\n炉端系统操作\n\n涵盖万得厨上的所有系统设置、页面切换、虚拟人的互动以及定时预约等\n\n2\n\n炉端烹饪\n\n在实现万得厨上烹饪功能的基础上，可根据用户角色或关键词进行商品推荐\n\n3\n\n炉端食谱\n\n在实现万得厨上食谱功能的基础上，可基于用户角色或关键词进行食谱的推荐\n\n4\n\n炉端社交和交易\n\n实现通过语音发布烹饪方案和食谱，进行食谱和商品交易，以及好友互动和社区交流\n\n**1.2  指令设计规范**\n---------------\n\n流程\n\n规范\n\n流程\n\n规范\n\n指令抽提\n\n**抽提流程：**\n\n*   基于业务进行功能分类→对分类下已实现的功能进行指令抽提（复制已有触屏功能）→具体场景下指令的补充→根据业务迭代的功能进行指令更新\n\n**抽提要求：**\n\n1）根据已有的业务功能进行指令的抽提，可通过语音指令完成触屏操作能够实现的功能\n\n2）在具体的业务场景下，考虑每个环节的需求，在技术能够实现的前提下提供指令的支持\n\n3）关注业务功能的迭代，及时进行指令的补充和更新，保证指令与实际业务功能同步\n\n确定执行功能\n\n**撰写要求：**\n\n1）基于具体的业务场景和用户需求，确定每个指令具体执行的功能，如：打开食谱页面、启动烹饪程序\n\n2）在指令框架的基础上，也需要结合系统功能和技术能力，确定指令具体能做到什么程度，如切换通知提示音，只能做到打开提示音选择页面，而不是直接更换\n\n指令名称\n\n**撰写要求：**\n\n1）根据指令具体的执行功能来命名，一般为“**执行动作+目标对象**”的结构，如：提高音量\n\n2）表达需清晰明确，从名称就可以看出指令具体执行的功能\n\n3）相同执行动作但对象不同的指令，指令名称统一格式，如：执行功能为页面跳转的，指令名称为“打开xx页面”\n\n指令标识\n\n**撰写格式：**“设备\\_类型\\_任务”，例：\n\n*   设置火力 的指令标识 为 wdc\\_cooking\\_fire\n*   设置音量 的指令标识 为 wdc\\_system\\_ voice\n\n**撰写要求：**\n\n1）指令标识具有唯一性，不能重复\n\n2）指令标识不能包含中文，一般为指令的英文名称\n\n3）需清晰，可直观看出对应的指令名称\n\n确定可用环境\n\n**撰写要求：**\n\n1）某些状态下部分指令无法执行，此处描述的是指令可以使用的状态，需统一状态表述，如：”暂停烹饪“的可用环境为”烹饪进行中“\n\n2）部分指令在不同的环境下可执行不同的环境，可用环境需要写清楚该功能是在什么环境下才能执行的\n\n指令标准话术\n\n**撰写流程：**\n\n*   明确意图→列举整理语音数据（GPT)→确定语法规则→提炼标准话术\n\n**撰写要求：**\n\n1）简短具体，明确要执行的任务，避免专业术语\n\n2）规范化的表达，由明确的动词和名词组成，一般为“**执行动作+目标对象**”的结构\n\n3）带自定义词槽的指令，标准话术直接引用词槽名称，用“\\[ \\]”引用，如：打开\\[食品名称\\]烹饪方案\n\n执行成功话术\n\n**作用：**\n\n*   向用户反馈操作结果，让用户能够即时了解指令执行的情况\n\n**撰写要求：**\n\n1）明确地传达执行成功的信息，语气礼貌友好\n\n2）简洁明了，不影响实际要执行任务的响应速度\n\n3）可引导用户进行下一步的操作，如”请在屏幕上选择您想要的食谱“\n\n4）添加多条执行成功话术，随机回复，避免单调性\n\n执行失败话术\n\n**作用：**\n\n*   向用户反馈执行失败的原因，并提供解决方案，让用户能够快速纠正错误并继续操作\n\n**撰写要求：**\n\n1）明确地反馈具体的执行失败原因，一个失败原因对应一条执行失败话术\n\n2）可提供帮助，引导用户进行下一步的操作，但也要避免过度提示，如：执行终止烹饪时提醒”请先暂停烹饪“\n\n3）可提供解决方案，如“抱歉，找不到您说的食谱，已为您推荐相似的食谱”\n\n4）语气友好自然，避免过于严肃生硬的语言，减轻用户的负面情绪\n\n文件格式\n\n**1、Xmind格式（指令抽提）：**[指令抽提-模板.xmind](/download/attachments/97890527/%E6%8C%87%E4%BB%A4%E6%8A%BD%E6%8F%90-%E6%A8%A1%E6%9D%BF.xmind?version=1&modificationDate=1682558279493&api=v2)\n\n1）**命名：**指令抽提-\\[指令分类\\]-\\[更新日期\\]，如“指令抽提-系统操作-20230401”\n\n2）类型为逻辑图、彩虹分支（以绿色标注已实现的指令），同级主题对齐，其余默认\n\n**2、Excel格式（指令清单）：**[指令清单-模板.xlsx](/download/attachments/97890527/%E6%8C%87%E4%BB%A4%E6%B8%85%E5%8D%95-%E6%A8%A1%E6%9D%BF.xlsx?version=1&modificationDate=1682257740964&api=v2)\n\n1）命名：指令清单-\\[指令分类\\]-\\[更新日期\\]，如“指令清单-系统操作-20230401”\n\n2）格式：字体-宋体、 字号大小 -10、字体颜色-黑色\n\n3）列内容：从左到右依次是指令库名称、分类、指令名称、指令标识、标准话术、关联词槽1、实体1（举例）、追问话术1、追问失败话术1、关联词槽2、实体2（举例）、追问话术2、追问失败话术2、执行功能、可用环境、执行成功话术、执行失败话术（通用）\n\n4）行内容：标题（绿底、文字加粗、垂直水平居中）\n\n**3、Excel格式（指令话术设计）：**[指令话术设计-模板.xlsx](/download/attachments/97890527/%E6%8C%87%E4%BB%A4%E8%AF%9D%E6%9C%AF%E8%AE%BE%E8%AE%A1-%E6%A8%A1%E6%9D%BF.xlsx?version=1&modificationDate=1682260196137&api=v2)\n\n1）命名：指令话术设计-\\[指令分类\\]-\\[更新日期\\]，如“指令话术设计-系统操作-20230401”\n\n2）格式：字体-宋体、 字号大小 -10、字体颜色-黑\n\n3）列内容：从左到右依次是指令名称、指令标识、指令描述、关联词槽、追问话术、追问失败话术、追问次数、相似问、执行成功话术、执行失败话术\n\n4）行内容：标题（绿底、文字加粗、垂直水平居中）\n\n**4、Excel格式（指令负向反馈）：**[指令负向反馈-模板.xlsx](/download/attachments/97890527/%E6%8C%87%E4%BB%A4%E8%B4%9F%E5%90%91%E5%8F%8D%E9%A6%88-%E6%A8%A1%E6%9D%BF.xlsx?version=1&modificationDate=1682259857946&api=v2)\n\n1）命名：指令负向反馈-\\[更新日期\\]，如”指令负向反馈-20230401“\n\n2）格式：字体-宋体、 字号大小 -10、字体颜色-黑\n\n3）列内容：指令名称、指令标识、执行失败原因、执行失败话术、备注\n\n4）行内容：标题（绿底、文字加粗、垂直水平居中）\n\n**4、Exel格式（词槽）：**[词槽-模板.xlsx](/download/attachments/97890527/%E8%AF%8D%E6%A7%BD-%E6%A8%A1%E6%9D%BF.xlsx?version=1&modificationDate=1682258979935&api=v2)\n\n1）命名：词槽-\\[更新日期\\]，如”词槽-20230401“\n\n2）格式：字体-宋体、 字号大小 -10、字体颜色-黑\n\n3）列内容：从左到右依次是词槽名称、词槽描述、实体ID、实体标准名、实体别名\n\n4）行内容：标题（绿底、文字加粗、垂直水平居中）\n\n5）表格填写：两个实体别名之间用”==“连接\n\n6）一个词槽的实体数量较多时，可单独添加一个页签进行维护，页签为以词槽名称命名\n\n**1.3  词槽和追问话术的撰写规范**\n---------------------\n\n流程\n\n规范\n\n流程\n\n规范\n\n关联词槽\n\n**作用：**\n\n1）提取并解析用户输入的关键信息，以便能够更好的了解用户的意图\n\n2）可根据实际情况调整词槽的取值范围，更新词槽数据\n\n**需关联词槽的指令特征：**\n\n1）同一个指令需要涉及到多个实体，如“设置火力和时间”\n\n2）实体信息对指令执行结果有影响，如“食谱名称对搜索食谱功能的影响”\n\n3）指令中同一个实体存在多个参数，且每个参数对应不同的执行功能，如“食品词槽”\n\n**无需关联词槽的指令特征：**\n\n1）指令中没有可以变化的参数，指令只是执行一个简单的操作，不用关联词槽，例如“播放视频”\n\n2）同一个意图下的参数才可以进行词槽的设置，不处于同一个意图的需要分开成两条指令，如：“提高音量”和“提高亮度”属于两个意图，此时不能把亮度和音量放在同一个词槽\n\n词槽名称\n\n**撰写要求：**\n\n1）简明扼要，能够准确描述词槽所代表的信息\n\n2）避免出现词槽名称歧义的情况，以便词槽后续的维护和管理\n\n实体ID\n\n**撰写要求：**\n\n1）同一个词槽内的实体，实体ID的格式为阿拉伯数字，从1开始往下按序列填充\n\n**注意事项：**\n\n1）同一个词槽内的实体ID不能重复\n\n2）不同词槽内的实体ID可以重复，不会相互影响\n\n实体别名\n\n**撰写方向：**\n\n1）将ASR易识别错误的同音字添加为实体别名，如“土司、局饭”\n\n2）添加实体的简称、不同地区的不同叫法、相近表述等\n\n**注意事项：**\n\n1）避免与相近实体的别名发生重复而产生歧义\n\n是否追问\n\n**作用：**\n\n此处的是否追问对应的是整个指令的所有词槽，不追问即为词槽非必填，此时即使指令话术中不包括实体信息，也可以成功识别\n\n追问话术\n\n**作用：**\n\n*   通过与用户交互获取缺失的信息，以明确用户意图\n\n**撰写要求：**\n\n1）明确追问的槽位，引导用户提供缺失的信息，如“请告诉我您要找的食谱名称”\n\n2）简单明了，避免使用复杂的语言或者长句子\n\n追问次数\n\n追问次数统一为1次\n\n追问失败话术\n\n**作用：**\n\n*   在缺失必填词槽信息的情况下，向用户传递失败信息，让用户知道当前状态\n\n**撰写要求：**\n\n1）明确具体的失败原因，如”抱歉，不知道音量值“\n\n2）引导用户提供准确信息，如”请告诉小万具体的食品名称“\n\n**1.4  相似问的撰写规范**\n-----------------\n\n流程\n\n规范\n\n流程\n\n规范\n\n撰写目的\n\n作为训练数据供给机器学习，生成训练模型，提供越多且质量越好的训练数据，智能语音助手的语音识别能力就越强\n\n撰写要求\n\n1）保持意图的一致性，以指令标准话术为准\n\n2）清晰具体，表达出完整意图\n\n3）明确指令区别，避免产生混淆和误解\n\n4）先保证规范化表达的指令话术添加到位，再进行少量口语化表达话术的添加\n\n撰写流程\n\n1）根据话术类型进行指令撰写\n\n2）标准话术→列出各分词的同义词→替换同义词→改变语序(GPT)→添加同音字语句(ASR)→→添加语气词→通过GPT批量输出相似问，查漏补缺\n\n撰写内容\n\n1）**同义词：**对各分词进行同义词替换，对不同分词的同义词进行排列组合，\n\n2）**语序：**调整句子语序，如“音量设置为30，设置音量为30”\n\n3）**同音字：**添加ASR易识别错误的同音字的相似问，如“熄屏、西平”\n\n4）**语气词：**增加少量的语气词和特征词，如“请、帮我、我想”\n\n5）**数字大小写：**引用带数字词槽的指令，相似问中大写和小写的数字都需要添加，如“烹饪三分钟、烹饪3分钟“\n\n6）**时长格式：**引用”duration“词槽的指令，涉及到的时长格式都要在相似问中添加，如\"xx分、xx秒、xx分xx秒”\n\n7）**词槽信息：**引用词槽的指令，可同时添加不包含词槽的相似问，如：“切换\\[语音\\]、切换语言”\n\n相似问维护\n\n1）后期基于指令标准话术，再结合上线之后与用户的对话日志，提炼用户的高频使用话术，进行相似问的添加优化\n\n2）数据来源：虚拟人后台对话日志\n\n注意事项\n\n1）表达自然流畅、符合用户习惯\n\n2）不要使用意图模糊或适用于多个场景的指令，如“暂停、开始”\n\n3）目前语音识别能力不是很强，因此在考虑用户表述时，可少量增加语气词，但要避免过于口语化的表达\n\n4）撰写的指令相似问在增加疑问句之后，要注意与问答库内容进行同步，避免冲突\n\n5）引用系统词槽的指令，相似问中用实例代替词槽名称；引用自定义词槽的指令，相似问中用直接引用词槽名称\n\n**1\\. 5  指令测试规范**\n-----------------\n\n测试分类\n\n目的\n\n流程\n\n规范\n\n测试分类\n\n目的\n\n流程\n\n规范\n\n基础检查\n\n排查指令间相似问冲突的情况\n\n1）测试前对所有相似问进行查重，对重复项进行处理\n\n2）不包含词槽的指令，根据不同的话术类型抽取测试问句，每一种话术类型抽取3条进行测试；\n\n3）包含词槽的指令，每一种话术类型抽取3条进行测试，引用的词槽实体尽量不重复；对于有设置追问的指令，抽取5个实体进行追问测试\n\n（话术相近指令的排查测试，不做全量测试）\n\n针对冲突的指令进行话术优化\n\n准确率测试-自测\n\n从用户的角度测试指令的识别率\n\n1）根据指令名称和标准话术、执行功能撰写测试问句\n\n2）不带词槽的指令，每个指令撰写5个测试问句进行测试\n\n3）带词槽的指令，撰写5个测试问句（带实体，话术与实体根据标准话术及实体清单随机撰写）进行测试；撰写5句不带词槽实体的测试问句，进行词槽追问识别的测试\n\n4）进行关键问题的排查测试（包括字母、数字、指令间相似话术...）\n\n5）记录测试问句的置信度\n\n6）统计识别准确率，直到准确率高于95%（准确率=成功识别测试问句数量/测试问句总数）\n\n1、针对测试结果置信度低于0.95的话术，进行相似问的维护\n\n2、统计不同阈值下的识别准确率\n\n准确率测试-验收测试\n\n从用户的角度测试指令的识别率\n\n1）根据指令名称和标准话术、执行功能撰写测试问句\n\n2）不带词槽的指令，每个指令撰写5个测试问句进行测试\n\n3）带词槽的指令，撰写5个测试问句（带实体，话术与实体根据标准话术及实体清单随机撰写）进行测试；撰写5句不带词槽实体的测试问句，进行词槽追问识别的测试\n\n4）记录测试结果：识别结果、置信度\n\n5）统计识别准确率，直到准确率高于95%（准确率=成功识别测试问句数量/测试问句总数）\n\n针对测试结果置信度低于0.95的话术，进行相似问的维护\n\nasr测试\n\n测试语音转文字的识别情况\n\n**要求：**与炉端保持一米距离，用正常音量和语序进行测试\n\n1）对于同义词、语序、语气词、口语化、问句几个话术类型，每种句式抽取3句（已有相似问）进行测试\n\n2）对于带数字、带字母的话术类型，需全部测试\n\n3）测试结果统计，准确率统计\n\n4）错误原因分析：asr识别影响、nlp理解影响\n\n1、对asr识别错误的相似问添加同音字话术\n\n2、统计识别错误率，针对高频话术添加热词\n\n3、针对添加少量同音字话术的指令，测试对于其他没有添加同音字语句的相似问是否也可以泛化识别\n\n4、将asr识别错误的话术在系统中重新进行测试，记录置信度\n\n指令话术测试\n\n  \n\n1、批量导入设计好的词槽和指令\n\n2、撰写每一条指令的测试问句\n\n3、逐条测试并用excel表记录结果\n\n4、测试结果整理和统计分析\n\n  \n\n**1、测试问句撰写**\n\n1）站在用户的角度，结合指令名称和指令标准话术，用规范化的表述撰写测试问句\n\n2）每条指令的测试问句至少为2条\n\n3）检查错别字，准备测试\n\n4）如果是进行指令自测，指令的测试测试问句尽量不与相似问重复\n\n**2、测试结果分析**\n\n1）查看每条测试问句匹配到的指令名称是否正确，标记匹配结果\n\n2）排除过于口语化及有歧义的测试问句\n\n3）统计指令测试的准确率，整理的识别准确确率需达到95%\n\n4）对于匹配错误的测试问句（非错别字影响），以及置信度低于0.9的测试问句，在指令相似问进行添加补充\n\n5）删除有歧义的相似问\n\n6）识别准确率=识别成功的测试问句数量/有效测试问句数；有效测试问句数=测试问句总数-排除的测试问句\n\n词槽测试\n\n  \n\n1、批量导入设计好的词槽和指令\n\n2、撰写关联词槽指令的测试问句\n\n3、逐条测试并用excel表记录结果\n\n4、测试结果整理和统计分析\n\n**1、测试问句撰写**\n\n1）使用指令已经录入的相似问，对实体标准名和别名分别撰写测试问句\n\n2）测试问句需包含两种格式：句子中缺少词槽实体（需要进行追问）；句子中带词槽实体（可直接识别）\n\n3）检查错别字，准备测试\n\n**2、测试结果分析**\n\n1）先用指令标准话术和实体标准名进行测试，置信度为≥0.99（目的：确定每条指令匹配到对应的指令名称）\n\n2）测试实体别名是否匹配到对应实体标准名上，总体准确率需要达到95%\n\n3）对于匹配不正确的实体别名（非错别字影响），和对于置信度低于0.9实体别名，在词槽中进行补充\n\n4）删除有歧义的实体别名\n\nASR测试\n\n  \n\n1、撰写测试语句\n\n2、语音输入测试语句，记录识别结果\n\n3、测试结果整理\n\n4、对识别失败的文字进行标注\n\n1）测试网址：[https://demo-oversea.haihuman.com/](https://demo-oversea.haihuman.com/)\n\n2）指令ASR识别测试：语音输入指令，1人重复3次，换2人各重复1次，得出测试报告\n\n3）词槽ASR识别测试：语音输入指令，1人重复3次，换2人各重复1次，得出测试报告\n\n4）注意播报测试中数字、英语（整体大小写差异、首字大写差异）、单位符号、特殊符号的播报\n\n5）对于经常使用且识别错误的字词整理之后添加热词\n\n**1\\. 6** **AI工具使用**\n--------------------\n\nAI工具使用技巧\n\n批量增加指令相似问\n\n**使用场景：**\n\n1）用于指令相似问的批量添加，按照不同角度进行相似话术的查找，避免出现遗漏\n\n**提问语句：**\n\n*   分别从同义词替换、语序调整、添加语气词、口语化表达等角度，写出50个“调到最高音量”这一语音指令的相似表达\n\n增加指令相似问\n\n（规范化）\n\n  \n\n**使用场景：**\n\n1）指令抽提完成后，在进行指令标准话术提炼时，可利用ChatGPT进行指令相似问的收集，再结合规范格式确定标准话术\n\n2）在指令标准话术的基础上，添加规范化的指令相似问，可先通过GPT进行数据收集，再进一步筛选，查漏补缺\n\n**提问语句：**\n\n*   基于“执行动作+具体对象”的规范表达，对于提高音量这一指令，请写出20个相似表达\n*   请基于”音量设置为20“这一语音指令话术，写出其他语序不同的相似表达\n\n增加指令相似问\n\n（口语化）\n\n**使用场景：**\n\n1）指令规范化的相似问补充完后，添加少量口语化的相似表述，以提高指令的识别率，通过GPT口语从多角度考虑用户的表达习惯\n\n**提问语句：**\n\n*   对于“提高音量”这一语音指令，请写出10个符合用户表述习惯的相似表达\n\n[Filter table data](#)[Create a pivot table](#)[Create a chart from data series](#)\n\n[Configure buttons visibility](/users/tfac-settings.action)"
}