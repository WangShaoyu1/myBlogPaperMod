{
	"title": "docker容器播放音频文件错误问题排查",
	"author": "王宇",
	"publishTime": "六月20,2024",
	"readTime": "12s",
	"tags": "[\"陆元伟\"]",
	"description": "陆元伟",
	"article": "*   1[1\\. 查看Linux系统中音频设备的列表的](#docker容器播放音频文件错误问题排查-查看Linux系统中音频设备的列表的)\n*   2[2\\. aplay (Advanced Linux Sound Architecture)显示了系统上可用的音频播放硬件设备](#docker容器播放音频文件错误问题排查-aplay\\(AdvancedLinuxSoundArchitecture\\)显示了系统上可用的音频播放硬件设备)\n*   3[3\\. aplay 播报音频文件](#docker容器播放音频文件错误问题排查-aplay播报音频文件)\n*   4[4\\. 查看可播放设备](#docker容器播放音频文件错误问题排查-查看可播放设备)\n\n  \n\n1\\. 查看Linux系统中音频设备的列表的\n======================\n\n  \n\n[?](#)\n\n`cat` `/``poc``/``asound``/``cards`\n\n`0` `[HDA ]: tegra``-``hda` `-` `NVIDIA Jetson Orin NX HDA`\n\n`NVIDIA Jetson Orin NX HDA at` `0x3518000` `irq` `120`\n\n`1` `[APE ]: tegra``-``ape` `-` `NVIDIA Jetson Orin NX APE`\n\n`NVIDIA``-``NVIDIAJetsonOrinNXEngineeringReferenceDeveloperKit``-``NotSpecified``-``Jetson`\n\n  \n\n从输出来看，您的设备上有两个音频卡：\n\n1.  编号为0的音频卡（\\[HDA\\]）\n    *   名称：tegra-hda\n    *   描述：NVIDIA Jetson Orin NX HDA\n    *   物理地址：位于内存地址0x3518000，中断号为120\n2.  编号为1的音频卡（\\[APE\\]）\n    *   名称：tegra-ape\n    *   描述：NVIDIA Jetson Orin NX APE\n    *   描述中还包括了硬件平台的信息（NVIDIA-NVIDIAJetsonOrinNXEngineeringReferenceDeveloperKit-NotSpecified-Jetson）\n\n  \n\n注意：\n\n*   HDA（High Definition Audio）通常指的是支持高清音频的硬件和驱动程序。\n*   APE（Audio Processing Engine）可能是指某种特定的音频处理引擎或硬件加速器，用于处理音频信号\n\n2\\. aplay (Advanced Linux Sound Architecture)显示了系统上可用的音频播放硬件设备\n==============================================================\n\n是 ALSA (Advanced Linux Sound Architecture) 的一个命令行工具，用于播放音频文件\n\n如果提示\"not found\" 的错误消息。\n\n以下命令安装\n\n> sudo apt-get update\n> \n> sudo apt-get install alsa-utils\n\n输出显示了系统上可用的音频播放硬件设备\n\n[?](#)\n\n`aplay` `-l`\n\n`**** List of PLAYBACK Hardware Devices ****`\n\n`card 0: HDA [NVIDIA Jetson Orin NX HDA], device 3: HDMI 0 [HDMI 0]`\n\n`Subdevices: 1/1`\n\n`Subdevice` `#0: subdevice #0`\n\n`card 0: HDA [NVIDIA Jetson Orin NX HDA], device 7: HDMI 1 [HDMI 1]`\n\n`Subdevices: 1/1`\n\n`Subdevice` `#0: subdevice #0`\n\n`card 0: HDA [NVIDIA Jetson Orin NX HDA], device 8: HDMI 2 [HDMI 2]`\n\n`Subdevices: 1/1`\n\n`Subdevice` `#0: subdevice #0`\n\n`card 0: HDA [NVIDIA Jetson Orin NX HDA], device 9: HDMI 3 [HDMI 3]`\n\n`Subdevices: 1/1`\n\n`Subdevice` `#0: subdevice #0`\n\n`card 1: APE [NVIDIA Jetson Orin NX APE], device 0: tegra``-dlink``-0 XBAR-ADMAIF1-0 []`\n\n`Subdevices: 1/1`\n\n`Subdevice` `#0: subdevice #0`\n\n  \n\n  \n\n信息：\n\n1.  **List of PLAYBACK Hardware Devices**\n    \n    *   这表示列出了所有可用于音频播放的硬件设备。\n2.  **card 0: HDA \\[NVIDIA Jetson Orin NX HDA\\], device 3: HDMI 0 \\[HDMI 0\\]**\n    \n    *   `card 0`: 这是音频卡的编号，通常与 `/proc/asound/cards` 中列出的卡相对应。\n    *   `HDA`: 这表示音频卡是基于高清音频（High Definition Audio）的。\n    *   `NVIDIA Jetson Orin NX HDA`: 这是音频卡的描述，指出了它是NVIDIA Jetson Orin NX平台的HDA音频卡。\n    *   `device 3`: 这是音频卡上的设备编号，用于标识特定的音频输出或输入。\n    *   `HDMI 0 [HDMI 0]`: 这表示设备3是一个HDMI音频输出，并且编号为0（可能是系统上的第一个HDMI音频输出）。\n3.  **Subdevices: 1/1**\n    \n    *   这表示该设备有一个子设备，并且当前只有一个子设备是可用的。在大多数情况下，这意味着您只有一个输出或输入通道可以使用。\n4.  **Subdevice #0: subdevice #0**\n    \n    *   这是对子设备的具体描述。在这里，只有一个子设备（编号为0），并且没有额外的信息。\n5.  **card 1: APE \\[NVIDIA Jetson Orin NX APE\\], device 0: tegra-dlink-0 XBAR-ADMAIF1-0 \\[\\]**\n    \n    *   这与上面的描述类似，但指向了不同的音频卡和设备。\n    *   `APE`: 这可能是某种音频处理引擎或加速器的缩写。\n    *   `tegra-dlink-0 XBAR-ADMAIF1-0`: 这是该设备在音频卡上的具体标识和配置。\n    *   `[]`: 这里的空方括号可能表示没有为该设备提供额外的描述或名称。\n\n系统上有两个音频卡。第一个（card 0）是HDA音频卡，提供了四个HDMI音频输出（HDMI 0到HDMI 3）。第二个（card 1）是APE音频卡，具有一个名为`tegra-dlink-0 XBAR-ADMAIF1-0`的音频设备。每个设备都只有一个可用的子设备，这通常意味着每个设备都只有一个音频通道。\n\n3\\. aplay 播报音频文件\n================\n\n> aplay xxx.wav\n\n错误1\n\n> aplay: main:831: audio open error: No such file or directory\n\n如果确定wav文件存在，并且有权限访问，则需要通过-D 参数切换播放设备\n\n命令如下\n\n> aplay -D hw:x,y xxx.wav\n\n4\\. 查看可播放设备\n===========\n\n在/dev/snd目录下面查看设备，其中pcmC0D8p ，0,8就是hw中x,y需要填写的值\n\n  \n\n[?](#)\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n`ls`\n\n`by-path pcmC0D8p pcmC1D10p pcmC1D13c pcmC1D15p pcmC1D18c pcmC1D1p pcmC1D4c pcmC1D6p pcmC1D9c`\n\n`controlC0 pcmC0D9p pcmC1D11c pcmC1D13p pcmC1D16c pcmC1D18p pcmC1D2c pcmC1D4p pcmC1D7c pcmC1D9p`\n\n`controlC1 pcmC1D0c pcmC1D11p pcmC1D14c pcmC1D16p pcmC1D19c pcmC1D2p pcmC1D5c pcmC1D7p timer`\n\n`pcmC0D3p pcmC1D0p pcmC1D12c pcmC1D14p pcmC1D17c pcmC1D19p pcmC1D3c pcmC1D5p pcmC1D8c`\n\n`pcmC0D7p pcmC1D10c pcmC1D12p pcmC1D15c pcmC1D17p pcmC1D1c pcmC1D3p pcmC1D6c pcmC1D8p`\n\n  \n\n  \n\n可以一个一个试看哪个能正常播放。或者用aiui里面的函数查找可以用的播放设备\n\n  \n\n  \n\n>  int count = aiui\\_pcm\\_player\\_get\\_output\\_device\\_count();  \n>  LOG\\_INFO(\"device size:{}\",count);  \n>  for(int i=0;i<count;i++){  \n>     int r = aiui\\_pcm\\_player\\_init(i);  \n>     LOG\\_INFO(\"i:{},deviceName:{}\",i,string(aiui\\_pcm\\_player\\_get\\_device\\_name(i)));  \n>     if (r==0){  \n>         LOG\\_INFO(\"init success\");  \n>       break;  \n>    }  \n>  }\n\n  \n\n如果选择可用的播放设备后\n\n> aplay -D hw:1,0 xxx.wav\n\n继续报错\n\n> aplay: main:831: audio open error: Device or resource busy\n\n![(悲伤)](/s/-vky9ok/8401/008d09724398b50e93468e30a239d4f6d750af9b/_/images/icons/emoticons/sad.svg)![(悲伤)](/s/-vky9ok/8401/008d09724398b50e93468e30a239d4f6d750af9b/_/images/icons/emoticons/sad.svg)![(悲伤)](/s/-vky9ok/8401/008d09724398b50e93468e30a239d4f6d750af9b/_/images/icons/emoticons/sad.svg)\n\n表示当前设备被占用了。输入以下命令查看被谁占用了\n\n  \n\n> fuser -v /dev/snd/pcmC1D0\\*\n\n  \n\n如果提示not found。继续安装库\n\n  \n\n> apt install psmisc\n\n继续输入以上查看命令，大概会有如下命令\n\n  \n\n> fuser -v /dev/snd/pcmC1D0\\*  \n> USER PID ACCESS COMMAND  \n> /dev/snd/pcmC1D0c: root 1 F...m yingzi\\_vdh  \n> /dev/snd/pcmC1D0p: root 1 F...m yingzi\\_vdh\n\n玛尼，自己的应用给占用了。查看自己的代码哪里会使用播放设备的\n\n  \n\n比如上述AIUI的代码，初始化成功它就会占着播放设备。\n\n> aiui\\_pcm\\_player\\_init\n\n  \n\n如果不是自己应用。是其他不相干的应用，那就无情的给kill它，-9表示强制终止\n\n  \n\n> kill -9 pid\n\n  \n\n  \n\nOK。继续调用播放文件命令\n\n  \n\n> aplay -D hw:1,0 xxx.wav\n\n如果出现以下信息。恭喜你。播放成功啦![(吐舌头)](/s/-vky9ok/8401/008d09724398b50e93468e30a239d4f6d750af9b/_/images/icons/emoticons/tongue.svg)。\n\nPlaying WAVE 'AIUI/audio/test.wav' : Signed 16 bit Little Endian, Rate 48000 Hz, Stereo\n\n如果不是以上信息。或者还是报错不是以上的出现的错误。![(悲伤)](/s/-vky9ok/8401/008d09724398b50e93468e30a239d4f6d750af9b/_/images/icons/emoticons/sad.svg)那就继续解决。并且更新此文档\n\n  \n\n[Filter table data](#)[Create a pivot table](#)[Create a chart from data series](#)\n\n[Configure buttons visibility](/users/tfac-settings.action)"
}