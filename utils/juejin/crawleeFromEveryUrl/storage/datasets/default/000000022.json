{
	"title": "在Linux阿里云服务器上部署Nextjs项目",
	"author": "Gaby",
	"publishTime": "2021-08-06",
	"readTime": "阅读2分钟",
	"tags": "[\"前端\",\"Linux中文技术社区\",\"前端开发社区\",\"前端技术交流\",\"前端框架教程\",\"JavaScript 学习资源\",\"CSS 技巧与最佳实践\",\"HTML5 最新动态\",\"前端工程师职业发展\",\"开源前端项目\",\"前端技术趋势\"]",
	"description": "部署Next.js项目到阿里云Linux服务器，但是网上大部分文章描述的并不清晰，而且大部分为 Copy 转载，对新手并不友好，因此针对服务器部署进行了整理，方便有需求的朋友使用",
	"article": "### 概述\n\n最近在做一个Nextjs项目,[官网教程](https://link.juejin.cn?target=https%3A%2F%2Fwww.nextjs.cn%2Fdocs%2Fdeployment \"https://www.nextjs.cn/docs/deployment\")最后一步是部署Next.js项目，但是网上大部分文章描述的并不清晰，而且大部分为 Copy 转载，对新手并不友好，因此自己针对服务器部署进行了整理，方便有自己部署需求的朋友👬🏻\n\n### 需要准备\n\n*   按照Nextjs官网的教程准备一个简单的Next.js APP\n*   服务器安装 Node Nginx PM2，配置环境\n*   运行程序，保证服务器能正常访问\n\n### 服务器安装 node\n\n此处不表，网上教程较多，本文以部署 Nextjs 为主要目标\n\n### 安装PM2\n\n安装PM2进行线程管理,[PM2官网文档](https://link.juejin.cn?target=https%3A%2F%2Fpm2.keymetrics.io%2Fdocs%2Fusage%2Fquick-start%2F \"https://pm2.keymetrics.io/docs/usage/quick-start/\")\n\n```js\n//全局安装PM2\nnpm install pm2 -g\n\n//创建软连接 node 路径\nln -s /root/node-v10.14.2-linux-x64/bin/pm2 /usr/local/bin/\n\n// 查看进程\npm2 list\n\n//启动 引号内是线程名\npm2 start npm --name \"nextjs\" -- run start\n\n//结束线程\npm2 delete nextjs\n\n```\n\n### 部署项目\n\n按照Nextjs官网的教程准备一个简单的Next.js APP\n\n网址：[Nextjs官网](https://link.juejin.cn?target=https%3A%2F%2Fwww.nextjs.cn%2Fdocs%2Fgetting-started \"https://www.nextjs.cn/docs/getting-started\")\n\n做到打开localhost:3000能访问到页面就行。\n\n然后使用 FTP 软件，将项目上传到服务器中 /var/www/nextjs/ 修改 package.json\n\n```js\n    \"scripts\": {\n    \"dev\": \"next dev\",\n    \"build\": \"next build && PORT=3000 npm start\",\n    \"start\": \"next start -p $PORT\",\n    \"lint\": \"next lint\"\n    },\n    \n``````js\n// 执行并安装相关包\nnpm install\n//或者\nyarn install\n```\n\n### 解析域名\n\n到域名服务商控制台将域名解析指向到项目部署的服务器\n\n![image.png](/images/jueJin/e7c706b7a15d41b.png)\n\n### 配置 Nginx 配置文件\n\n在nginx目录下的conf.d文件夹下 添加文件wxlvip.conf 该配置文件因每个服务器安装的服务不同，位置也可能会有所不同，按照个人路径进行修改即可\n\n```js\n    server {\n    listen       80;\n    server_name  www.wxlvip.com;\n    \n        location / {\n        #root项目文件的绝对路径\n        root /var/www/nextjs;\n        proxy_pass http://127.0.0.1:3000/;#改成自己的host 及 端口\n        proxy_http_version 1.1;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection 'upgrade';\n        proxy_set_header Host $host;\n        proxy_cache_bypass $http_upgrade;\n    }\n}\n```\n\n记得修改完成后，重启服务器。\n\n### 运行项目并访问\n\n进入/var/www/nextjs/目录执行以下命令，并访问 域名 给nextjs 目录及打包生成的目录.nexjs文件夹可写权限\n\n```js\n// 执行\npm2 start npm --name \"nextjs\" -- run build && pm2 save\n```\n\n🕯️： 项目已经在运行了。  \n接下来打开绑定的域名，正常访问项目。  \n看看我的[www.wxlvip.com/](https://link.juejin.cn?target=http%3A%2F%2Fwww.wxlvip.com%2F \"http://www.wxlvip.com/\")\n\n![image.png](/images/jueJin/7a804297e08d4b9.png)\n\n**文中如有错误，欢迎在评论区指正，如果这篇文章帮到了你，欢迎点赞👍收藏加关注😊，希望点赞多多多多...**",
	"selfDefined": "likes:22,comments:3,collects:27,likes:4565"
}