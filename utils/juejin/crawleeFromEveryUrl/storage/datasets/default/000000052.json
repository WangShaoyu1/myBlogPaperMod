{
	"title": "二次封装Storage的第一要素是什么？很多人其实都不知道~",
	"author": "Sunshine_Lin",
	"publishTime": "2024-01-23",
	"readTime": "阅读3分钟",
	"tags": "[\"前端中文技术社区\",\"前端开发社区\",\"前端技术交流\",\"前端框架教程\",\"JavaScript 学习资源\",\"CSS 技巧与最佳实践\",\"HTML5 最新动态\",\"前端工程师职业发展\",\"开源前端项目\",\"前端技术趋势\"]",
	"description": "前言 大家好，我是林三心，用最通俗易懂的话讲最难的知识点是我的座右铭，基础是进阶的前提是我的初心~ 二次封装 Storage？ 关于 Storage 的封装问题，其实都是老生常谈了，很多人都会在项目中",
	"article": "前言\n--\n\n大家好，我是林三心，用最通俗易懂的话讲最难的知识点是我的座右铭，基础是进阶的前提是我的初心~\n\n二次封装 Storage？\n-------------\n\n关于 Storage 的封装问题，其实都是老生常谈了，很多人都会在项目中去二次封装 Storage，为了让开发者能更加方便地去使用 localStore、sessionStorage\n\n就比如下方，应该是很多人封装的案例，就是封装简单的 读取、写入，或者有 删除、清空\n\n![](/images/jueJin/b15f5fab2f0a4c1.png)\n\n我们为什么封装？\n--------\n\n要不我们回过头来想一下，我们为什么要封装？其实封装无非就是为了两个目的：\n\n*   **更好地统一维护**\n*   **使用者更方便、更无脑地使用**\n\n但是我觉得在一个大项目中以及紧急的开发进度中，**使用者更方便、更无脑地使用**才是封装的第一目的\n\n所以想想刚刚的 LocalStorage 的封装，真的能让**使用者更方便、更无脑地使用**吗？\n\n我就举个例子吧，我想存进去一个对象，我这么去存，可以吗？\n\n![](/images/jueJin/479a033fd84e4da.png)\n\n显然是不行的，存进去的对象会被转成字符串 \\[object Object\\]\n\n![](/images/jueJin/d04be9feba4e4af.png)\n\n所以我必须这么去存和取值，利用 JSON.parse、JSON.stringify 去转\n\n![](/images/jueJin/dcf8298845ce469.png)\n\n只有这么去做才能达到我的目的\n\n![](/images/jueJin/17b8dddaeacd4b4.png)\n\n但是这样不觉得很麻烦吗？**使用者更方便、更无脑地使用**是封装的第一目的，显然这样只会让使用者徒增烦恼！！！\n\n有的人就说了，可以把 JSON.parse、JSON.stringify 写在 useLocalStorage 中，但是这个方案只是针对 Object 而已，但是数据类型其实有多种：number、string、object、set、map、date 等等，你直接写在里面，不太合理，你得兼顾所有的数据类型才行！！\n\n类型猜测逻辑\n------\n\n所以呢，你如果想要让**使用者更方便、更无脑地使用**，我们可以封装一套类型猜测逻辑\n\n首先我们必须准备一个函数，这个函数用来判断数据类型\n\n![](/images/jueJin/1518dfed47294af.png)\n\n但是光是判断出类型还不够啊，我们还必须给每一种类型，准备一套 读取、存入 的策略\n\n![](/images/jueJin/b2de32db233b414.png)\n\n最后只需要：\n\n*   **判断类型**\n*   **获取类型对应的存取策略**\n*   **在存取的时候执行对应策略**\n\n![](/images/jueJin/ba312633e06948b.png)\n\n我们现在可以来试试能不能达到目的\n\n![](/images/jueJin/ff7654057050421.png)\n\n显然已经达到我们想要的效果\n\n![](/images/jueJin/9281f87ef50a41d.png)\n\n结语 & 加学习群 & 摸鱼群\n---------------\n\n我是林三心\n\n*   一个待过**小型toG型外包公司、大型外包公司、小公司、潜力型创业公司、大公司**的作死型前端选手；\n*   一个偏前端的全干工程师；\n*   一个不正经的掘金作者；\n*   一个逗比的B站up主；\n*   一个不帅的小红书博主；\n*   一个喜欢打铁的篮球菜鸟；\n*   一个喜欢历史的乏味少年；\n*   一个喜欢rap的五音不全弱鸡\n\n如果你想一起学习前端，一起摸鱼，一起研究简历优化，一起研究面试进步，一起交流历史音乐篮球rap，可以来俺的摸鱼学习群哈哈，点这个，有7000多名前端小伙伴在等着一起学习哦 --> [摸鱼沸点](https://juejin.cn/pin/7035153948126216206 \"https://juejin.cn/pin/7035153948126216206\")",
	"selfDefined": "likes:11,comments:0,collects:14,likes:1066"
}