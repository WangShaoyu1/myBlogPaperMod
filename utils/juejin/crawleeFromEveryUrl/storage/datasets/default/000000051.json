{
	"title": "v-for和v-if为啥不共存？回去等消息吧！答成这鬼样！",
	"author": "Sunshine_Lin",
	"publishTime": "2024-01-25",
	"readTime": "阅读4分钟",
	"tags": "[\"Vue.js中文技术社区\",\"前端开发社区\",\"前端技术交流\",\"前端框架教程\",\"JavaScript 学习资源\",\"CSS 技巧与最佳实践\",\"HTML5 最新动态\",\"前端工程师职业发展\",\"开源前端项目\",\"前端技术趋势\"]",
	"description": "前言 大家好，我是林三心，用最通俗易懂的话讲最难的知识点是我的座右铭，基础是进阶的前提是我的初心~ 老八股文了？ 当我们提到 Vue 的面试题时，不免总会提到一个问题：v-for 和 v-if 可以共",
	"article": "前言\n--\n\n大家好，我是林三心，用最通俗易懂的话讲最难的知识点是我的座右铭，基础是进阶的前提是我的初心~\n\n老八股文了？\n------\n\n当我们提到 Vue 的面试题时，不免总会提到一个问题：**v-for 和 v-if 可以共存吗？**\n\n提到这个问题，很多人肯定会脱口而出：\n\n*   **Vue2 中 不可以**\n*   **Vue3 中 可以**\n\n再往深问，可能少部分人会回答出：\n\n*   **Vue2 中 v-for 优先级比 v-if 高**\n*   **Vue3 中 v-if 优先级比 v-for 高**\n\n但是其实很多人都是背的，具体为啥会这样，很多人都没搞清楚，稍微再往深一问，95%的人就回答不出来了~\n\n重新认识两者优先级~\n----------\n\n我带大家来重新认识这两者的优先级吧，我会分成 Vue2 和 Vue3 的版本来讲\n\n### Vue2\n\n我就拿一个最简单的代码来说，我把 v-for 和 v-if 共存与一个标签上，Vue2 中肯定会警告我们，不建议这么做，但是为啥不建议，根本没几个人知道~\n\n![](/images/jueJin/dfd56de670a7493.png)\n\n想要获取答案，可以打开这个网站：**[v2.template-explorer.vuejs.org/](https://link.juejin.cn?target=https%3A%2F%2Fv2.template-explorer.vuejs.org%2F \"https://v2.template-explorer.vuejs.org/\")**\n\n这是一个解析 Vue2 代码的网站，能把 Vue 代码解析成最终的产物代码\n\n![](/images/jueJin/a58a92e75e0b4db.png)\n\n其实重要的部分在这里\n\n![](/images/jueJin/22ab59476167438.png)\n\n可以看到在 Vue2 中，会先循环，然后在循环中去判断，判断为真则正常渲染，判断为假则执行 `_e` 函数，`_e`函数就是注释的意思，就是把判断为假的节点注释掉，也就是：\n\n*   1、先走 v-for 循环 3 次\n*   2、在循环体中走 v-if 判断\n*   3、判断 item !== 2 则正常渲染，item === 2 则把这个节点注释掉\n\n所以最终选出出来 1、3 两个节点\n\n大家能理解为什么 Vue2 会警告你了吗？因为其实我们只需要渲染2个节点，但是最终还是循环了3次，造成了性能浪费，也就是 v-for 优先级高于 v-if，共存时会造成性能浪费\n\n### Vue3\n\n但是在 Vue3 中，v-for 和 v-if 却是可以共存的，为什么呢？我们还是拿最简单的代码来分析\n\n![](/images/jueJin/026903881585436.png)\n\n我们可以到这个网站：\\*\\*[play.vuejs.org/\\*\\*，看到解析后的产物](https://link.juejin.cn?target=https%3A%2F%2Fplay.vuejs.org%2F**%25EF%25BC%258C%25E7%259C%258B%25E5%2588%25B0%25E8%25A7%25A3%25E6%259E%2590%25E5%2590%258E%25E7%259A%2584%25E4%25BA%25A7%25E7%2589%25A9 \"https://play.vuejs.org/**%EF%BC%8C%E7%9C%8B%E5%88%B0%E8%A7%A3%E6%9E%90%E5%90%8E%E7%9A%84%E4%BA%A7%E7%89%A9\")\n\n![](/images/jueJin/b5224c38ea4b4bd.png)\n\n重要部分在这里\n\n![](/images/jueJin/7fb5ef41baf0448.png)\n\n可以看到，跟 Vue2 不同的是，Vue3 中是先走判断，然后再走循环的，也就是：\n\n*   1、先走 v-if 判断\n*   2、如果 item !== 2，就去走循环也就是 v-for\n*   3、如果 item == 2，就执行 createCommandVNode，创建一个注释节点\n\n也就是在 Vue3 中，v-if 优先级是高于 v-for 的，真正循环的只有1、3这两个节点，这提高了性能\n\n但是我们会看到，代码会报错：\\*\\* item 找不到\\*\\*？\n\n![](/images/jueJin/8fc8cf21604c4f9.png)\n\n这是因为在 v-for 和 v-if 共存的时候，Vue3 会在底层帮我们转换成\n\n![](/images/jueJin/2a1a94df9ea743d.png)\n\n不信我们可以看看转换后的产物，跟刚刚是一模一样的！！！\n\n![](/images/jueJin/c2dbfd836b5e45d.png)\n\nitem是在外层的，所以报错说item 找不到，大家都知道为啥了吧？在外层怎么能获取到 item 呢？\n\n总结\n--\n\n总结就是不要让 v-if 和 v-for 共存在同一个标签中，遇到这种情况需要使用 computed 去计算，然后再去渲染\n\n![](/images/jueJin/4e605e463ba3463.png)\n\n结语 & 加学习群 & 摸鱼群\n---------------\n\n我是林三心\n\n*   一个待过**小型toG型外包公司、大型外包公司、小公司、潜力型创业公司、大公司**的作死型前端选手；\n*   一个偏前端的全干工程师；\n*   一个不正经的掘金作者；\n*   一个逗比的B站up主；\n*   一个不帅的小红书博主；\n*   一个喜欢打铁的篮球菜鸟；\n*   一个喜欢历史的乏味少年；\n*   一个喜欢rap的五音不全弱鸡\n\n如果你想一起学习前端，一起摸鱼，一起研究简历优化，一起研究面试进步，一起交流历史音乐篮球rap，可以来俺的摸鱼学习群哈哈，点这个，有7000多名前端小伙伴在等着一起学习哦 --> [摸鱼沸点](https://juejin.cn/pin/7035153948126216206 \"https://juejin.cn/pin/7035153948126216206\")",
	"selfDefined": "likes:18,comments:9,collects:22,likes:1397"
}