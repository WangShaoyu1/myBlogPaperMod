{
	"title": "为什么有些 Vue3 项目已经开始弃用 Pinia 了？",
	"author": "Sunshine_Lin",
	"publishTime": "2024-08-02",
	"readTime": "阅读2分钟",
	"tags": "[\"前端\",\"Vue.js中文技术社区\",\"前端开发社区\",\"前端技术交流\",\"前端框架教程\",\"JavaScript 学习资源\",\"CSS 技巧与最佳实践\",\"HTML5 最新动态\",\"前端工程师职业发展\",\"开源前端项目\",\"前端技术趋势\"]",
	"description": "前言 大家好，我是林三心，用最通俗易懂的话讲最难的知识点是我的座右铭，基础是进阶的前提是我的初心~ 真的需要 Pinia 吗？ 最近在想一个问题：在 Vue3 项目中，进行状态管理的时候，我们真的需要",
	"article": "前言\n--\n\n大家好，我是林三心，用最通俗易懂的话讲最难的知识点是我的座右铭，基础是进阶的前提是我的初心~\n\n真的需要 Pinia 吗？\n-------------\n\n最近在想一个问题：在 Vue3 项目中，进行状态管理的时候，我们真的需要 **Pinia** 吗？\n\n其实我们可以反过来想一个问题：没有 **Pinia**，我们能做状态管理吗？\n\n答案是：可以！！！\n\nref、reactive\n------------\n\nVue3 的一些 API 对比 React 的好处就是，这些 API 并不一定需要在组件中去声明\n\n就比如你想要做局部状态管理的时候，可以直接使用 `reactive、ref` 这类 API 来完成\n\n![image.png](/images/jueJin/7fd7d5825c1b488.png)\n\n![image-1.png](/images/jueJin/6e091281135140c.png)\n\n![image-2.png](/images/jueJin/35b69e9e063b4a4.png)\n\n这样能达到局部状态管理，多组件共用同一个状态的效果，请看下图\n\n![state-1-1.gif](/images/jueJin/6f0db3e4e7a843b.png)\n\neffectScope\n-----------\n\nVue3 有一个超级冷门的 API 叫 **effectScope** ，这个 API 非常强大，但是很多人都不知道它\n\n当然，既然很少人知道它，那自然就很少人知道，Pinia 的底层原理就是依赖了 **effectScope**\n\n![image-4.png](/images/jueJin/11ac50b9f3e4450.png)\n\n既然 Pinia 是通过`effectScope`来实现的，那么，我们自然也可以直接使用这个 API 来做状态管理~\n\n其实已经有人做过这件事了，就比如 `vueuse` 中的\n\n![image-6.png](/images/jueJin/f4215918ac5d40b.png)\n\n我们可以直接用这个 Hooks 来进行状态管理，如果是使用 `effectScope` 来进行管理的话，状态就不需要写在 Hooks 外部了，**因为 effectScope 内部逻辑只会执行一次，无论你调用多少次**\n\n![image-7.png](/images/jueJin/5af33e9e4796495.png)\n\n![image-8.png](/images/jueJin/239fb9f9625a48e.png)\n\n![image-9.png](/images/jueJin/fb07dfea844d4c1.png)\n\n利用 `effectScope` 也能达到组件之间共享状态~\n\n![state-2.gif](/images/jueJin/8682d1d1edbe490.png)\n\n那还需要 Pinia 吗？\n-------------\n\n### 结构分明\n\n我觉得 Pinia 还是有他的好处的，好处就是：**让我们少写一些代码，并且代码更加分明**\n\n比如下面这个例子\n\n*   **state：** 定义状态\n*   **getter：** 定义计算变量\n*   **action：** 定义修改方法\n\n结构很分明\n\n![image-10.png](/images/jueJin/0d23cab38fb74ec.png)\n\n### 监听 state\n\nPinia 还提供了 `$subscribe` 来监听整个状态，我们也可以利用这个方法来做**持久化存储**\n\n![image-11.png](/images/jueJin/1176553dcd1140f.png)\n\n### 插件机制\n\nPinia 提供了插件机制，可以让你去拓展 Pinia 的功能，以下是你可以扩展的内容：\n\n*   为 store 添加新的属性\n*   定义 store 时增加新的选项\n*   为 store 增加新的方法\n*   包装现有的方法\n*   改变甚至取消 action\n*   实现副作用，如本地存储\n*   仅应用插件于特定 store\n\n比如举个小例子，给所有状态管理都加一个属性变量\n\n![image-12.png](/images/jueJin/3e61cdbcb51e4fa.png)\n\nPinia 著名的持久化插件`pinia-plugin-persistedstate`就是利用了 Pinia 的插件机制\n\n![image-13.png](/images/jueJin/e6ec2efe360e469.png)\n\n他的核心代码其实很少，就是利用插件机制，使用`$subscribe`去监听每一个状态管理的变化，然后进行持久化存储~\n\n![image-14.png](/images/jueJin/5c0d0563f65b4ec.png)\n\n结语 & 加学习群 & 摸鱼群\n---------------\n\n我是林三心\n\n*   一个待过**小型toG型外包公司、大型外包公司、小公司、潜力型创业公司、大公司**的作死型前端选手；\n*   一个偏前端的全干工程师；\n*   一个不正经的掘金作者；\n*   一个逗比的B站up主；\n*   一个不帅的小红书博主；\n*   一个喜欢打铁的篮球菜鸟；\n*   一个喜欢历史的乏味少年；\n*   一个喜欢rap的五音不全弱鸡\n\n如果你想一起学习前端，一起摸鱼，一起研究简历优化，一起研究面试进步，一起交流历史音乐篮球rap，可以来俺的摸鱼学习群哈哈，点这个，有10000多名前端小伙伴在等着一起学习哦 --> [摸鱼沸点](https://juejin.cn/pin/7035153948126216206 \"https://juejin.cn/pin/7035153948126216206\")",
	"selfDefined": "likes:8,comments:3,collects:5,likes:797"
}