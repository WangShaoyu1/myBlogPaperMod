---
author: "王宇"
title: "”知识库检索+指令引导方案“工具测试"
date: 一月18,2024
description: "大模型+中控"
tags: ["大模型+中控"]
ShowReadingTime: "12s"
weight: 695
---
### 1、测试方案

**1）测试对象：**百度文心4、阿里千问plus、商汤大模型、讯飞星火3、gpt3.5

**2）测试方法：**使用相同的提示词分别对几个大模型进行提问，记录大模型的回复结果，并对结果进行评价

**3）评价角度：**从对话中控的需求出发，主要测试大模型的在每个阶段的指令遵循能力（生成格式的规范性和生成内容的稳定性）、答复效果（生成内容的准确性和泛化能力）和基础支撑能力（token消耗和响应速率）

### 2、任务解析阶段

**1）系统提示词**

作为对话中控系统，负责将用户输入解析成多个任务，并从技能信息中为每个任务选择合适的几个技能，最终输出如下严格的JSON数组格式：\[{"id": 任务序号, "skills": 从技能信息中选出的"skill\_id"列表（若没有合适的技能可为空，若不确定可多选）, "intent": 来源于技能信息中的"intents"（若不清楚可以留空）, "deps": 依赖的先决任务id列表, "args": {"text": 与当前任务相关的关键信息, "参数名称": 参数值或"<GENERATED>-dep\_id"}}\]。注意，"args"表示当前任务相关的参数，尽量包含技能信息中的"slots"，"text"字段不能为空；"参数名称"需用具体名称替换，特殊标签"<GENERATED>-dep\_id"表示该参数与依赖任务"dep\_id"中对应的参数一致（"dep\_id"用依赖任务id替换）。请基于用户的请求，逐步解析出每个任务，同一类型的任务可能有多个，注意任务之间的依赖关系和顺序。若无法解析，直接回复空的JSON数组："\[\]"

**2）few-shot提示词**

{'role': 'user', 'content': '请帮我查询广州今天的天气。'}, {'role': 'assistant', 'content': '\[{"id": 0, "skills": \["SKILL-weather"\], "intent": "", "deps": \[-1\], "args": {"text": "查询广州今天的天气", "location": "广州", "date": "2024-01-08"}}\]'}, {'role': 'user', 'content': '你叫什么名字？今年多大了？'}, {'role': 'assistant', 'content': '\[{"id": 0, "skills": \["FAQ-Chat"\], "intent": "", "deps": \[-1\], "args": {"text": "你叫什么名字"}}, {"id": 1, "skills": \["FAQ-Chat"\], "intent": "", "deps": \[-1\], "args": {"text": "今年多大了"}}\]'}, {'role': 'user', 'content': '打开一键烹饪页面，设置大火3分钟，再启动烹饪。'}, {'role': 'assistant', 'content': '\[{"id": 0, "skills": \["SYSTEM"\], "intent": "打开一键烹饪页面", "deps": \[-1\], "args": {"text": "打开一键烹饪页面"}}, "id": 1, "skills": \["COOKING"\], "intent": "设置火力+时间", "deps": \[0\], "args": {"text": "设置大火3分钟", "火力": "大火", "时间": "3分钟"}}, {"id": 2, "skills": \["COOKING"\], "intent": "启动烹饪", "deps": \[1\], "args": {"text": "启动烹饪", "火力": "<GENERATED>-1", "时间": "<GENERATED>-1"}}\]'}, {'role': 'user', 'content': '帮我查找奥尔良鸡翅食品，价格如何？'}, {'role': 'assistant', 'content': '\[{"id": 0, "skills": \["RECIPES"\], "intent": "搜索烹饪方案", "deps": \[-1\], "args": {"text": "查找奥尔良鸡翅食品", "食品名称": "奥尔良鸡翅"}}, {"id": 1, "skills": \["FAQ-MallFood"\], "intent": "", "deps": \[0\], "args": {"text": "价格如何", "食品名称": "<GENERATED>-0"}}\]'}

**3）动态提示词**

现在我输入了："{{input}}"，聊天记录 {{context}} 中可能包含相关信息，请基于技能信息 {{skills}} 仔细思考，并直接输出任务解析的一个JSON数组，不需要描述推理过程

### 3、回复生成阶段

**1）系统提示词**

作为对话中控系统，基于给定的任务执行信息回复用户请求

**2）few-shot提示词**

{'role': 'user', 'content': '请帮我查找红薯食谱，并播放第一个'}, {'role': 'assistant', 'content': '好的，系统已为您找到红薯相关食谱。现在开始播放第一个食谱。'}

**3）动态提示词**

现在我的请求是："{{input}}"，请基于任务执行信息 {{processes}} 仔细思考并直接回答，不需要描述推理过程。注意：尽量参考"run\_result"中的结果，若涉及多个任务，需整合多个结果再给出每个任务的答复。对于非"任务型"请求，若执行信息中没有相关内容，您可以尝试给出简洁的经验答复。若您无法完成我的请求，请直接回复："抱歉，无法完成"

### 4、测试结果总结

具体测试结果详见文件：[知识库检索方案工具测试.xlsx](/download/attachments/114681037/%E7%9F%A5%E8%AF%86%E5%BA%93%E6%A3%80%E7%B4%A2%E6%96%B9%E6%A1%88%E5%B7%A5%E5%85%B7%E6%B5%8B%E8%AF%95.xlsx?version=2&modificationDate=1705573862161&api=v2)

**总结：**可以看到，借助知识库检索技术，实现了更多技能场景的选择，将技能信息直接融入任务解析阶段，提升了大模型的参数解析能力，全链路耗时也有提升。综合来看，各大模型在单轮对话测试中表现差不多，准确率均欠佳（70%左右），百度文心4在多轮对话测试中表现最优（75%），仍较难满足当前对话中控需求。若要进一步提升效果，关键在于解决”技能误选“的问题，更多的要从技能划分和技能描述方面入手，当前语料实际上存在技能之间作用范围重叠，技能描述不全（无法覆盖技能作用范围）等情况。

[Filter table data](#)[Create a pivot table](#)[Create a chart from data series](#)

[Configure buttons visibility](/users/tfac-settings.action)