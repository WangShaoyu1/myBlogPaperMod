---
author: "王宇"
title: "屏端数字员工"
date: 十二月15,2023
description: "十七、前端管理"
tags: ["十七、前端管理"]
ShowReadingTime: "12s"
weight: 548
---
资料
==

状态相关（[prd](https://pdca.yingzi.com/#/documentMgtView_1694764045893?type=design&prdVersionModuleId=1962&prdVersionId=1326&designModuleId=1479&id=312&iframeParam=)）
------------------------------------------------------------------------------------------------------------------------------------------------------------------

\-正常的交互流程：

1、休眠状态有多种情况：

   （1）主页，在休眠状态下，对话框中显示的是默认欢迎语；

   （2）主页，在对实际环境的噪音情况还没有具体把握之前，用户与虚拟人都是单轮对话，即正常上一轮交互的TTS播报结束之后，虚拟人即进入休眠状态，此时对话框中的文字依旧保持上一轮的TTS播报文本；若用户接着再次唤醒，对话框显示唤醒回复“我在，您说”；若倒计时30s后用户没有再唤醒，对话框回到默认欢迎语（不播报）；

   （3）功能页，从主页进入功能页是通过输入了某个指令，因此刚进入功能页的时候对话框中是上一轮的TTS播报，此时虚拟人进入休眠状态，对话框中一直保持上一轮的TTS文本；

   （4）从功能页返回到主页，虚拟人TTS播报“好的”并进入休眠，回到主页后此时对话框直接显示默认欢迎语；

2、唤醒状态：用户通过输入唤醒词“小万小万”唤醒虚拟人——通过在H5 SDK外再套一层Android SDK的方式来实现；唤醒后小万会回复“我在，您说”，然后打开拾音；

3、聆听状态：识别用户输入内容，右上角显示“正在聆听”状态，对话框中一开始为省略号，流式识别转文字后显示ASR识别的文字，最多展示三行，超过则截断不显示后面的内容；

4、NLP处理状态：进行NLP处理，右上角显示“正在思考”状态；

5、TTS播报状态：虚拟人对话框中显示播报的文本；功能页，根据定义的语音交互区的最大高度，对话框中最多显示三行文字（即②）；当想要展示文本内容很多时，可以将部分内容放到①中，尽量保持②的精简；

  

\-异常的交互流程：

6、【判断是否输入内容逻辑】：唤醒后，若超过5s没有拾取到用户输入的内容，这时虚拟人发起二次询问：“小万没听清，请您再说一次”（对话框中同样显示该文本），然后继续打开拾音；若超过10s仍没有拾取到内容，便自动退出语音交互，对话框中的文字恢复到本次唤醒前显示的内容；

7、【主动询问引导任务流程逻辑】：当用户通过指令从主页进入了功能页，因为需要引导用户持续走完任务流程，若用户超过30s没有继续唤醒，虚拟人便主动发起询问：“请问您还想了解什么？可以参考下方问题提示对我说”，之后便打开拾音；后续与第6点一致；当此次主动询问用户仍然没有输入内容，则继续倒计时30s，若第二次超过30s没有任何唤醒交互，则自动退出当前流程，返回主页；

8、用户直接点击屏幕上的内容，相当于直接发送对应的指令给虚拟人， 这时虚拟人会有TTS回复，但并不代表虚拟人是处于可语音交互的状态（因为并没有使用唤醒词唤醒进而聆听）；  
9、【唤醒后又触屏逻辑】：若唤醒后，用户没有输入，而是触屏点击了屏幕上的内容，则虚拟人在接收到触屏发送的指令后，退出语音交互，并对触屏发送的指令进行处理和给出回复；

  

\-其他规则：

10、当用户与虚拟人的交互涉及到界面功能区的切换（即跳转页面），只要不在主页，左上角都会有一个“返回主页”的按钮；

11、快捷提问里的内容会根据用户最近一次交互的问题进行更换，更换的内容通过关联表的方式来维护；

12、H5页面标题为当前门店的名称，通过网址域名后缀的id来区分。

  

疑点
--

  
1.唤醒后“我在，您说”在安卓还是h5发出

答：h5  
2.任何阶段都能唤醒吗

答：识别阶段不能

  

状态设计
====

核心：监听安卓端调用函数

  

1.休眠
----

  

2.唤醒
----

3.聆听
----

4.NLP
-----

5.TTS
-----

[Filter table data](#)[Create a pivot table](#)[Create a chart from data series](#)

[Configure buttons visibility](/users/tfac-settings.action)