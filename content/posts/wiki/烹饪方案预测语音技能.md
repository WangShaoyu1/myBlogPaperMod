---
author: "王宇"
title: "烹饪方案预测语音技能"
date: 十月18,2023
description: "（五）算法"
tags: ["（五）算法"]
ShowReadingTime: "12s"
weight: 732
---
*   1[1\. 用户语音交互时序图](#id-烹饪方案预测语音技能-用户语音交互时序图)
*   2[2\. 升温阶段计算原理](#id-烹饪方案预测语音技能-升温阶段计算原理)
*   3[3\. 前提条件](#id-烹饪方案预测语音技能-前提条件)
*   4[4\. 数据需求](#id-烹饪方案预测语音技能-数据需求)
    *   4.1[4.1. 食谱和商品数据需求](#id-烹饪方案预测语音技能-食谱和商品数据需求)
        *   4.1.1[4.1.1. PGC食谱数据训练](#id-烹饪方案预测语音技能-PGC食谱数据训练)
        *   4.1.2[4.1.2. UGC食谱数据验算](#id-烹饪方案预测语音技能-UGC食谱数据验算)
        *   4.1.3[4.1.3. 已验证UGC食谱数据训练](#id-烹饪方案预测语音技能-已验证UGC食谱数据训练)
    *   4.2[4.2. 比热容和营养成分数据需求](#id-烹饪方案预测语音技能-比热容和营养成分数据需求)
    *   4.3[4.3. 常见食材非常规重量换算](#id-烹饪方案预测语音技能-常见食材非常规重量换算)
*   5[5\. 计算思路](#id-烹饪方案预测语音技能-计算思路)
    *   5.1[5.1. 基础参数计算](#id-烹饪方案预测语音技能-基础参数计算)
    *   5.2[5.2. 解析食材重量](#id-烹饪方案预测语音技能-解析食材重量)
    *   5.3[5.3. 食材比热容计算](#id-烹饪方案预测语音技能-食材比热容计算)
    *   5.4[5.4. 解析烹饪方案（训练过程）](#id-烹饪方案预测语音技能-解析烹饪方案（训练过程）)
    *   5.5[5.5. 食材所需热量估算](#id-烹饪方案预测语音技能-食材所需热量估算)
    *   5.6[5.6. 烹饪功率选择](#id-烹饪方案预测语音技能-烹饪功率选择)
        *   5.6.1[5.6.1. 升温阶段功率选择](#id-烹饪方案预测语音技能-升温阶段功率选择)
        *   5.6.2[5.6.2. 熟化阶段功率选择](#id-烹饪方案预测语音技能-熟化阶段功率选择)
    *   5.7[5.7. 烹饪时长计算](#id-烹饪方案预测语音技能-烹饪时长计算)
*   6[6\. 测试记录](#id-烹饪方案预测语音技能-测试记录)
    *   6.1[6.1. 总热量预测算法调优记录（初版）](#id-烹饪方案预测语音技能-总热量预测算法调优记录（初版）)
    *   6.2[6.2. 熟化热量预测算法调优记录（第二版）](#id-烹饪方案预测语音技能-熟化热量预测算法调优记录（第二版）)
    *   6.3[6.3. 前两版模型泛化能力对比](#id-烹饪方案预测语音技能-前两版模型泛化能力对比)
        *   6.3.1[6.3.1. 重量泛化能力测试记录（单一食材）](#id-烹饪方案预测语音技能-重量泛化能力测试记录（单一食材）)
        *   6.3.2[6.3.2. 重量泛化能力测试记录（两种食材）](#id-烹饪方案预测语音技能-重量泛化能力测试记录（两种食材）)
        *   6.3.3[6.3.3. 烹饪方式泛化能力测试记录](#id-烹饪方案预测语音技能-烹饪方式泛化能力测试记录)
        *   6.3.4[6.3.4. 食材泛化能力测试记录](#id-烹饪方案预测语音技能-食材泛化能力测试记录)
    *   6.4[6.4. 熟化热量预测算法调优记录（第三版）](#id-烹饪方案预测语音技能-熟化热量预测算法调优记录（第三版）)
    *   6.5[6.5. 模型泛化能力对比](#id-烹饪方案预测语音技能-模型泛化能力对比)
        *   6.5.1[6.5.1. 重量泛化能力测试记录（单一食材）](#id-烹饪方案预测语音技能-重量泛化能力测试记录（单一食材）.1)
        *   6.5.2[6.5.2. 重量泛化能力测试记录（两种食材）](#id-烹饪方案预测语音技能-重量泛化能力测试记录（两种食材）.1)
        *   6.5.3[6.5.3. 重量泛化能力测试记录（汤类）](#id-烹饪方案预测语音技能-重量泛化能力测试记录（汤类）)
        *   6.5.4[6.5.4. 烹饪方式泛化能力测试记录](#id-烹饪方案预测语音技能-烹饪方式泛化能力测试记录.1)
        *   6.5.5[6.5.5. 食材泛化能力测试记录](#id-烹饪方案预测语音技能-食材泛化能力测试记录.1)
*   7[7\. 风险和提示](#id-烹饪方案预测语音技能-风险和提示)
    *   7.1[7.1. 风险](#id-烹饪方案预测语音技能-风险)
    *   7.2[7.2. 提示](#id-烹饪方案预测语音技能-提示)

1\. 用户语音交互时序图
=============

![](/download/attachments/105264707/image2023-8-24_10-43-3.png?version=1&modificationDate=1692844983557&api=v2)

2\. 升温阶段计算原理
============

Q（理论输出热量） = P\*t  
Q（升温所需热量） = C\*M\*(T1-T0)   
热转化率 η = （Q（升温所需热量）+ Q（熟化所需热量））/ Q（理论输出热量）

**解释：**

*   Q——热量，J或W\*s
*   P——功率，W
*   t——时长，s
*   C——比热容，KJ /（千克 × ℃）或 J/(g × ℃)
*   M——食材总质量，g
*   T——温度，℃

3\. 前提条件
========

1.  **升温范围：**20—100 ℃
2.  **功率范围：**1.5版本万得厨：\[200，900 \] W，以50为增量
3.  **时长范围：**1.5版本万得厨：\[10，1550\] s，以10为增量（发现个别食谱时长超出范围，例如：排骨莲藕汤-2400 s，算法按实际计算值返回）
4.  **重量范围**：1.5版本万得厨：\[50，3000\] g，考虑热效率和模型泛化能力
5.  **主料重量占比：**不少于烹饪总重量的70%

4\. 数据需求
========

4.1. [食谱和商品数据需求](https://alidocs.dingtalk.com/i/nodes/NZQYprEoWoe7dXL3IgZX6w22J1waOeDk?iframeQuery=sheet_range%3Dst-68e0af25-98263_0_0_1_2)
-------------------------------------------------------------------------------------------------------------------------------------------

### 4.1.1. PGC食谱数据训练

采用生产环境pgc食谱数据训练模型，数据筛选过程如下：

*   数据库初步筛选出667条：原始数据（705条食谱），去除已删除的（29条，deleted is true），再去除未关联烹饪方案的（scheme\_code is null）和完全未关联食材的食谱。
*   代码初步筛选出615条：去除烹饪过程异常的（52条）。
*   代码最终筛选出593条：去除主料估算比热容所用重量占比小于0.7的（6条，辅料太多或主料中缺少比热容数据），再去除熟化阶段热量计算值为负数的（总共有16条，其中负值占比小于2%的可按0估算处理）。

### 4.1.2. UGC食谱数据验算

采用训练好的算法模型验算生产环境ugc食谱数据，数据筛选过程如下：

*   数据库初步筛选出3442条：原始数据（5051条食谱），去除已删除的和未审核通过的（1477条，deleted is true and review\_status != 1），再去除未关联烹饪方案的（scheme\_code is null）和完全未关联食材的食谱。
*   代码初步筛选出2861条：替换部分非纯数值型食材含量的值后，去除主料食材含量为非数值型的食谱（64条）。进行食材常规重量（'斤', '公斤', '两', '千克', 'kg', 'l', '升'）换算，基于表4.3的数据完成食材非常规重量换算（以下15条食谱对应主料的食材单位异常，无法按照正常逻辑换算，暂且按照'g'处理）后，去除主料食材单位不在换算范围内的食谱（517条）。

![](/download/attachments/105264707/image2023-8-23_10-17-0.png?version=1&modificationDate=1692757020608&api=v2)

*   代码再次筛选出2842条：去除非1.5版本烹饪方案的食谱（3条），再去除完全没有比热容（6条）和总重量小于50或大于3000 g的食谱（12条）。
*   代码最终筛选出2191条：去除主料估算比热容所用重量占比小于0.7的（649条，食材中缺少比热容数据）。

用当前最佳rf模型预测这2191条ugc食谱的热量，基于热量误差范围的统计结果如下：

![](/download/attachments/105264707/image2023-8-23_17-54-5.png?version=1&modificationDate=1692784445858&api=v2)

其中热量误差最高的（比算法预测所需热量少137.62%）是处于不熟等级2的一道菜（如下图所示）。

![](/download/attachments/105264707/image2023-8-23_18-0-21.png?version=1&modificationDate=1692784821782&api=v2)

用模型预测183条ugc已验证食谱的热量，基于热量误差范围的统计结果如下：

![](/download/attachments/105264707/image2023-8-23_19-20-37.png?version=1&modificationDate=1692789637998&api=v2)

其中不熟等级2的食谱数据如下：

![](/download/attachments/105264707/image2023-8-23_19-24-29.png?version=1&modificationDate=1692789869730&api=v2)

存在用户文本描述方案与实际绑定方案不匹配的情况，希望拿到pgc优化后的方案。

### 4.1.3. 已验证UGC食谱数据训练

引入人工已验证的ugc食谱数据训练模型，数据筛选过程如下：

*   初步筛选出已验证的674条：程序处理得到食谱的食材内容（名称、重量、单位），关联新的烹饪方案（去除无烹饪方案的4条）。
*   代码初步筛选出662条：去除烹饪过程异常的（12条）。
*   代码最终筛选出560条：去除主料估算比热容所用重量占比小于0.7的（57条，辅料太多或主料中缺少比热容数据），再去除熟化阶段热量计算值为负数的（总共有5条，其中负值占比小于2%的可按0估算处理）。

4.2. 比热容和营养成分数据需求
-----------------

字段名称

字段类型

是否必须

字段含义

数据来源

备注

字段名称

字段类型

是否必须

字段含义

数据来源

备注

material\_standard\_name

string

是

食物标准名，食材惟一名称

  

  

material\_alias

string

是

食物别名，食材其他名称

  

  

big\_category

string

否

大类，，包含：蛋类及制品

  

  

small\_category

string

否

小类，包含：水，鸡蛋

  

  

specific\_heat\_capacity

float

是

比热容

模型预测或实验测定，两者误差不超过5%

  

water\_content

float

是

水分含量

  

  

protein\_content

float

是

蛋白质含量

  

  

fat\_content

float

是

脂肪含量

  

  

carb\_content

float

是

碳水化合物含量

  

  

4.3. 常见食材非常规重量换算
----------------

序号

食材名称

换算前规格数量

可换算单位

换算后重量（g）

备注

1

鸡蛋、鲜鸡蛋、鸡蛋液

1

个，只，颗

50

  

2

熟鸡蛋、煎蛋

1

个，只，颗

50

  

3

鸡蛋黄、蛋黄

1

个

25

  

4

咸蛋黄

1

个

30

  

5

鸭蛋、皮蛋、咸鸭蛋、咸海鸭蛋

1

个

60

  

6

鹌鹑蛋

1

个，颗

9

  

7

鹌鹑

1

只

100

  

8

生蚝（带壳）

1

个，只

50

  

9

生蚝

1

个，只

20

通常不算壳的重量（考虑给出提示）

10

鲍鱼

1

个，只

50

  

11

十八头鲍鱼

1

个，只

28

  

12

冬菇、香菇

1

个，朵

15

湿

13

干荷叶

1

张，个

20

  

14

披萨饼皮

6英寸

个，片，块，张

200

默认6英寸

15

8英寸

个，片，块，张

400

  

16

9英寸

个，片，块，张

450

  

17

紫菜饼

1

个，片，张

100

  

18

手抓饼

1

个，片，张

110

  

19

面饼

1

块

80

方便面饼

20

土豆、马铃薯

1

个

150

中号

21

火龙果

1

个

350

  

22

苹果

1

个

200

  

23

枇杷

1

个

30

  

24

柠檬

1

个

80

  

25

红枣、红枣（鲜）

1

颗，粒，个

12

默认鲜

26

红枣（干）

1

颗，粒，个

8

  

27

香蕉

1

根

150

  

28

马蹄、荸荠

1

粒，个

16

  

29

贝贝南瓜

小

个

250

  

30

中

个

400

默认中

31

大

个

900

  

32

南瓜

1

个

1000

  

33

酸木瓜、木瓜

1

个

1000

  

34

茄子

1

个，根

180

  

35

鲮鱼、罗非鱼、豆豉鲮鱼

1

条

700

  

36

鳜鱼、黄花鱼、石斑鱼

1

条

500

  

37

小鸡腿

1

个

140

  

38

鸡腿肉

1

个

100

  

39

鸡中翅

1

个

60

  

40

卤鸭脚

1

个

45

  

41

汉堡面包

1

个

20

  

42

鸽子

1

只

300

  

43

大碗面

1

块

60

  

44

生菜

1

张，片

25

  

45

奶酪片

1

片，角

18

  

46

吐司

1

片

50

  

47

猪腰

1

个

200

  

48

猪脑

1

个

60

  

49

无花果

1

个，颗

60

  

50

肉肠

1

根

50

  

51

青椒

1

个，条

70

  

52

火鸡面

1

袋、包

140

  

53

方便面

1

袋、包

90

  

54

蛋挞皮

1

个

20

  

5\. 计算思路
========

5.1. 基础参数计算
-----------

*   1.5版本万得厨热转化率：η = 0.99（因为算法预测的是功率和时长，即理论输出热量，故此参数无需考虑。）
*   辅料（除酒水饮料类）重量范围：0-70 g，默认重量低于烹饪总重30%的食材为辅料。训练时将重量大于等于70 g（参数可调）或用户认为是主料的食材作为主料。
*   比热容取值范围：0.5-4.5 J/(g × ℃)，根据现有食材统计。

5.2. 解析食材重量
-----------

计算出每道菜的总重量（M）和主料重量（m\_main）。

记录每道菜的主料中蛋类重量占比egg\_ratio和水的重量占比water\_ratio，可用于功率选择。

5.3. 食材比热容计算
------------

利用食材比热容c，计算每道菜的平均比热容：

*   **精准计算方案：**C = SUM(c\*m)/M（m为所有食材重量）
*   **主料估算方案：**C\_main = 主料比热容 = SUM(c\*m)/m\_main（m为所有主料重量），估算误差 C\_main\_error = |1-C\_main /C|（C为精准计算比热容）

记录每道菜的精准计算所用重量占比C\_m\_ratio（存在无比热容数据的食材）、主料估算所用重量占比C\_main\_ratio（可用于数据筛选）、有效主料数n\_c\_main和主料估算比热容误差C\_main\_error。

5.4. 解析烹饪方案（训练过程）
-----------------

1.  计算出每道菜理论输出热量：Q（理论输出热量）= SUM(P\*t)；
2.  记录每道菜的阶段数n\_stage、最大功率W\_max和最小功率W\_min（后续功率选择分析用）。

5.5. 食材所需热量估算
-------------

根据现有食谱的Q（理论输出热量），利用食谱中的主料质量、水分含量、蛋白质含量、脂肪含量、碳水化合物含量，进行特征处理，得到食谱整体成分特征和主料估算比热容，建模分析相关规律，估算所需熟化热量，从而能够合理的预测其他不同食材所需的热量。

*   **估算升温阶段所需热量：**Q（升温热量）= （T1-T0）\*C\_main\*m\_main J
*   **估算所需总热量：**Q（估算总热量）= Q（预测熟化热量）+ Q（升温热量）

5.6. 烹饪功率选择
-----------

### 5.6.1. 升温阶段功率选择

根据现有pgc食谱中升温功率的分布情况，升温功率可按照以下三档调节：

*   较低功率（400—550W），中值500 W
*   较高功率（550—700W），中值650 W
*   高功率（700—900W），中值800 W

**注意：大部分食材的升温功率均取高功率（800 W）**，但对于以蛋类（鸡蛋、鸭蛋等）为主料的小炒（如：秋葵鸡蛋、青椒鸡蛋、土豆鸡蛋、苦瓜鸡蛋、韭黄鸡蛋、蒜苗鸡蛋、虾仁蒸蛋、西兰花蒸蛋等），最好降低功率特殊处理。目前根据主料中水的占比来判断是否为小炒，并结合主料中蛋类的占比来调节功率：

*   水的占比小于0.3且蛋类占比大于等于0.7：较低功率（500 W）
*   水的占比小于0.4且蛋类占比大于等于0.2：较高功率（650 W）

对于其他食材或烹饪方式，均按高功率（800 W）计算。

### 5.6.2. 熟化阶段功率选择

根据现有pgc食谱中熟化功率的分布情况，熟化功率在满足不大于升温功率的前提下，可按照以下四档调节：

*   低功率（200—350W），中值300 W
*   较低功率（400—500W），中值450 W
*   较高功率（550—650W），中值600 W
*   高功率（700—900W），中值800 W

**注意：大部分食材的熟化功率均取高功率（800 W）**，但对于以蛋类（鸡蛋、鸭蛋等）为主料的小炒、粥类和汤类，最好降低功率特殊处理。目前根据主料中水的占比来判断是否为小炒、汤类或粥类，再结合主料中蛋类的占比来调节功率：

*   水的占比大于等于0.7或水的占比小于0.3且蛋类占比大于等于0.7：低功率（300 W）
*   水的占比大于等于0.5或水的占比小于0.4且蛋类占比大于等于0.2：较低功率（450 W）
*   水的占比小于0.5且大于等于0.3：较高功率（600 W）

对于其他食材或烹饪方式，均按高功率（800 W）计算。

5.7. 烹饪时长计算
-----------

一般情况下，升温时长 = Q（升温热量）/ W（升温功率），熟化时长 = Q（熟化热量）/ W（熟化功率），但需考虑以下特殊情况：

*   **计算的升温热量不大于20000：**删除升温阶段，同时将升温时长并入熟化时长。
*   **升温阶段与熟化阶段功率一致**：删除熟化阶段，同时将熟化时长并入升温时长。
*   **估算的熟化热量不大于****20000：**删除熟化阶段，同时将熟化时长并入升温时长。

**注意：**基于当前1.5版本万得厨的时长设置限制，计算出来的时长，需要四舍五入，取10的整数值。

6\. 测试记录
========

6.1. 总热量预测算法调优记录（初版）
--------------------

*   所用模型：rf-随机森林、xgb-xgboost。
*   所用特征：归一化处理。主料重量m\_main、主料比热容C\_main\*m\_main、主料水分含量water\_main\*m\_main、蛋白质含量protein\_main\*m\_main、脂肪含量fat\_main\*m\_main、碳水化合物含量carb\_main\*m\_main。
*   数据筛选：烹饪方式为'焖', '烤', '煎', '炒', '蒸'，熟化热量不为负数，主料比热容（完全匹配、近似匹配）不缺失，主料（不少于70 g)重量占比70%以上。

  
模型

  

数据筛选

所用特征

测试结果

  

备注

主料重量

水分含量

蛋白质含量

脂肪含量

碳水化合物含量

主料比热容

平均绝对误差(MAE)

均方根误差(RMSE)

R2值

总热量误差20%内

500 W 时长偏差2 min 内

rf

总数267，比热容完全匹配，主料占比至少50%

√

√

√

√

√

√

0.031

0.046

0.906

72%

80%

  

总数193，比热容完全匹配，主料占比至少70%

√

√

√

√

√

×

0.030

0.041

0.926

76%

85%

  

总数236，比热容近似匹配，主料占比至少70%

√

√

√

√

√

√

0.034

0.057

0.887

82.63%

88.14%

  

xgb  
  

总数267，比热容完全匹配，主料占比至少50%

√

√

√

√

√

√

0.022

0.032

0.953

75%

85%

  

总数193，比热容完全匹配，主料占比至少70%

√

√

√

√

√

√

0.008

0.017

0.99

84.46%

88.08%

  

总数236，比热容近似匹配，主料占比至少70%

√

√

√

√

√

√

0.019

0.032

0.963

91.53%

95.76%

best，最大时长误差5 min左右，热量误差133%。

总数193，比热容完全匹配，主料占比至少70%

√

√

√

√

√

×

0.023

0.034

0.942

75%

83%

  

6.2. 熟化热量预测算法调优记录（第二版）
----------------------

*   所用模型：rf-随机森林、xgb-xgboost。
*   所用特征：未归一化处理。主料重量m\_main、主料比热容C\_main、主料水分含量water\_main\*m\_main、蛋白质含量protein\_main\*m\_main、脂肪含量fat\_main\*m\_main、碳水化合物含量carb\_main\*m\_main、升温热量C\_main\*m\_main\*（T1-T0）、烹饪方式。
*   数据筛选（562条）：烹饪方式为'焖', '烤', '煎', '炒', '蒸','粥', '汤', '炖', '煮'，熟化热量负值占比小于2%，比热容完全匹配+近似匹配，主料（不少于70 g或用户自定义）有效重量（比热容不缺失）占比70%以上。

  

模型

所用特征

测试结果

  

备注

主料重量

水分含量

蛋白质含量

脂肪含量

碳水化合物含量

主料比热容

升温热量

烹饪方式

R2值

总热量误差20%内

500 W 时长偏差2 min 内

rf  
  

√

√

√

√

√

√

×

×

0.912

79.18%

81.14%

  

√

√

√

√

√

×

√

×

 0.916

86.12%

84.16%

best，最大热量误差79%，时长误差8 min左右。

√

√

√

√

√

×

√

√

0.903

84.52%

83.27%

  

xgb  
  

√

√

√

√

√

√

×

×

0.896

73.84%

75.09%

  

√

√

√

√

√

×

√

×

0.889

82.74%

81.67%

  

√

√

√

√

√

×

√

√

0.897

87.01%

83.10%

  

6.3. 前两版模型泛化能力对比
----------------

### 6.3.1. 重量泛化能力测试记录（单一食材）

食材

重量(g)

食材总重量(g)

预测功率(w)

总热量预测模型计算时长(s)

熟化热量预测模型计算时长(s)

备注

鸡翅  
  
  
  
  
  
  
  
  

3000

3000

800  
  
  
  
  
  
  
  
  

890

2040

  

2500

2500

880

1880

  

2000

2000

880

1740

  

1500

1500

890

1460

  

1000

1000

840

950

  

500

500

440

610

  

200

200

190

250

  

100

100

200

150

  

50

50

140

120

  

10

10

300

130

  

### 6.3.2. 重量泛化能力测试记录（两种食材）

食材1

重量1(g)

食材2

重量2(g)

食材总重量(g)

预测功率(w)

总热量预测模型计算时长(s)

熟化热量预测模型计算时长(s)

备注

豆角  
  
  
  
  
  
  
  
  

1500

猪肉（瘦）  
  
  
  
  
  
  
  
  
  

1500

3000

800  
  
  
  
  
  
  
  
  
  

850

2150

  

1000

1500

2500

850

1940

  

1500

1000

2500

810

1800

  

1000

1000

2000

810

1600

  

500

1000

1500

810

1420

  

800

500

1300

480

1110

  

500

500

1000

480

770

  

200

200

400

330

320

  

100

100

200

160

170

  

50

50

100

140

150

  

25

25

50

150

120

  

10

10

20

210

130

  

5

5

10

310

220

  

由此可见：第一版模型对于总重1000 g以上的食材，预测值变化不大；第二版模型则变化较为明显，对较大重量的泛化能力有较大提升。但两者对于总重量50 g以下的食材均不能很好的处理，考虑限制总重量下限值。

### 6.3.3. 烹饪方式泛化能力测试记录

食材1

重量1(g)

食材2

重量2(g)

食材总重量(g)

烹饪方式

总热量预测模型计算结果

熟化热量预测模型计算结果

新旧模型热量偏差

备注

稻米（代表值）

100

水

600

700

粥

阶段1：800 W，270 s

阶段2：600 W，220 s

阶段1：800 W，270 s

阶段2：450 W，820 s

237082.52883

属于人为验证不熟的粥，当时补充了800 W，480 s，建议复验新模型（复验合格）。

绿豆

100

水

600

700

汤

阶段1：800 W，270 s

阶段2：600 W，180 s

阶段1：800 W，270 s

阶段2：450 W，710 s

211981.64478

属于人为验证不熟的绿豆汤（泡发后熟而不化），当时补充了800 W，480 s，上一版本的训练食材中无绿豆，新版本有，建议复验新模型（复验合格，算法预测值接近训练数据）。

由此可见：第二版模型引入'粥', '汤', '炖', '煮'烹饪方式后，对于粥类、汤类的泛化能力有较大提升。

### 6.3.4. 食材泛化能力测试记录

食材1

重量1(g)

食材2

重量2(g)

食材总重量(g)

总热量预测模型计算结果

熟化热量预测模型计算结果

备注

玉米（鲜）

483

  

  

483

阶段1：800 W，300 s

  

阶段1：800 W，410 s

  

属于人为验证熟的烹玉米，新模型烹饪更久一些。

猪肉（代表值，fat30g）

76

马铃薯

200

276

阶段1：800 W，310 s

  

阶段1：800 W，240 s

  

属于人为验证熟的土豆丝炒瘦肉，新模型烹饪更短一些。

豆腐（代表值）

245

  

  

245

阶段1：800 W，200 s

  

阶段1：800 W，190 s

  

属于人为验证熟的煎豆腐，前后差别不大。

千张

260

  

  

260

阶段1：800 W，390 s

  

阶段1：800 W，400 s

  

属于人为验证过熟的素炒千张，前后差别不大。训练食材中无千张。

猪肉（代表值，fat30g）

80

胡萝卜

144

224

阶段1：800 W，190 s

  

阶段1：800 W，240 s

  

属于人为验证熟的胡萝卜肉丝（胡萝卜脆），新模型烹饪更久一些，胡萝卜能变软一些。

猪肉（奶脯）

206

  

  

206

阶段1：800 W，450 s

  

阶段1：800 W，290 s

  

属于人为验证烤焦的烤五花肉，新模型烹饪时长短很多，预计不会焦，建议复验（复验合格）。

鸡肫

280

  

  

280

阶段1：800 W，330 s

  

阶段1：800 W，280 s

  

属于人为验证熟的小炒鸡肾，前后差别不大。训练食材中无鸡肾（鸡肫）。

鲈鱼

760

  

  

760

阶段1：800 W，460 s

  

阶段1：800 W，620 s

预测比热容更正后：

阶段1：800 W，580 s

  

属于人为验证过熟（爆炸）的清蒸鲈鱼，新模型烹饪时长久很多，有烧焦风险，建议复验（可能是盖盖子烹饪导致的爆炸，此次不盖盖复验合格）。

经核查：训练数据中有”清蒸鲈鱼“这道菜（800 W 480 s + 700 W 60 s），其预测热量误差仅为7.9%（800 W 570 s），而当前预测值则异常偏高。因其他特征值一样，大概是训练（3.4447）和预测（3.6725）所用的鲈鱼比热容不一样导致，考虑更正预测所用比热容。

河蟹

295

  

  

295

阶段1：800 W，370 s

  

阶段1：800 W，280 s

  

属于人为验证熟的清蒸河蟹，新模型烹饪时长短很多，训练食材中无河蟹。有不熟风险，建议复验（复验合格）。

章鱼

250

  

  

250

阶段1：800 W，170 s

  

阶段1：800 W，240 s

  

属于人为验证不熟的八爪鱼，当时补充了800 W，100 s，新模型烹饪时长久很多，训练食材中无八爪鱼（章鱼），仍有不熟风险，建议复验（复验合格）。

猪肉（肋条肉）

300

  

  

300

阶段1：800 W，490 s

  

阶段1：800 W，440 s

  

属于人为验证过熟的豉汁排骨，新模型烹饪时长短一些，预计不会过熟。

莴笋（鲜）

250

  

  

250

阶段1：800 W，130 s

  

阶段1：800 W，140 s

  

属于人为验证熟的清烹莴笋（脆），新模型烹饪时长久一些，莴笋能变软一些。

鸡蛋（代表值）

135

苦瓜（鲜）

80

215

阶段1：650 W，100 s

阶段2：450 W，180 s

阶段1：650 W，100 s

阶段2：450 W，170 s

属于人为验证过熟的苦瓜鸡蛋，新模型烹饪时长短一些，差别不大。

鸡蛋（代表值）

180

大葱

50

230

阶段1：500 W，140 s

阶段2：300 W，560 s

阶段1：500 W，140 s

阶段2：300 W，360 s

属于人为验证过熟的酱卧鸡蛋，新模型烹饪时长短很多，预计不会过熟。

由此可见：第二版模型对不同食材的泛化能力更好。

6.4. 熟化热量预测算法调优记录（第三版）
----------------------

*   所用模型：rf-随机森林。
*   所用特征：未归一化处理。主料（不包含水类）重量m\_main、主料水分含量water\_main（\*m\_main）、蛋白质含量protein\_main（\*m\_main）、脂肪含量fat\_main（\*m\_main）、碳水化合物含量carb\_main（\*m\_main）、升温热量（包含或不包含水类）、水类平均重量water\_weight\_mean、水的总含量（主料水分含量+水类平均重量）。
*   数据筛选（PGC+UGC）：烹饪方式为'粥', '汤', '焖炖', '煮', '粥，淖水', '汤，淖水', '焖炖，淖水', '煮，淖水', '粥，煮', '汤，煮'，熟化热量负值占比小于2%，比热容完全匹配+近似匹配，主料（不少于最大辅料重量或用户自定义）有效重量（比热容不缺失）占比70%以上。

  

数据筛选

所用特征

测试结果

  

备注

主料重量

水分含量

蛋白质含量

脂肪含量

碳水化合物含量

升温热量

水类平均重量

R2值

总热量误差20%内

500 W 时长偏差2 min 内

总热量误差\[-30%，50%\]

总数1153，最大辅料重量10 g

√

绝对含量

绝对含量

绝对含量

绝对含量

×

√

 0.899

80.05%

76.84%

97.40%

  

总数1145，最大辅料重量20 g

√

绝对含量

绝对含量

绝对含量

绝对含量

除水

√

0.909

80.0%

75.12%

97.03%

模型4，最大热量误差157.6%，时长误差19 min左右。

总数1145，最大辅料重量20 g

√

绝对含量

绝对含量

绝对含量

绝对含量

√

√

0.910

80.0%

76.07%

97.38%

模型5，最大热量误差100.4%，时长误差15.5 min左右。

总数1145，最大辅料重量20 g

含水

绝对含量

绝对含量

绝对含量

绝对含量

除水

×

  

  

  

  

  

总数1145，最大辅料重量20 g

√

总含量

绝对含量

绝对含量

绝对含量

√

总含量

0.902

79.12%

75.98%

97.47%

模型6，最大热量误差90.2%，时长误差20.5 min左右。

总数1145，最大辅料重量20 g

√

总含量

绝对含量

绝对含量

绝对含量

除水

总含量

0.909

79.65%

76.06%

97.47%

模型1，最大热量误差127.6%，时长误差17 min左右。

总数1153，最大辅料重量10 g

√

百分含量

百分含量

百分含量

百分含量

×

√

0.898

79.01%

76.14%

97.48%

  

总数1145，最大辅料重量20 g

√

百分含量

百分含量

百分含量

百分含量

×

√

0.912

81.66%

78.61%

97.82%

最大热量误差115%，时长误差17 min左右。

总数1145，最大辅料重量20 g

√

百分含量

百分含量

百分含量

百分含量

√

√

0.890

78.08%

74.59%

96.59%

  

总数1145，最大辅料重量20 g

含水

百分含量

百分含量

百分含量

百分含量

除水

×

  

  

  

  

  

总数1145，最大辅料重量20 g

√

总含量

百分含量

百分含量

百分含量

√

总含量

0.904

80.96%

 76.33%

97.38%

模型2，最大热量误差87.8%，时长误差16 min左右。

总数1145，最大辅料重量20 g

√

总含量

百分含量

百分含量

百分含量

除水

总含量

0.907

80.09%

76.94%

97.38%

模型3，最大热量误差106.2%，时长误差18.5 min左右。

总数1107，最大辅料重量20 g，主料有效重量占比80%以上。

√

百分含量

百分含量

百分含量

百分含量

×

√

0.910

80.67%

78.86%

97.56%

  

总数1134，最大辅料重量50 g

√

百分含量

百分含量

百分含量

百分含量

×

√

0.910

80.49%

77.14%

97.79%

  

总数1129，最大辅料重量60 g

√

百分含量

百分含量

百分含量

百分含量

×

√

0.911

80.34%

77.24%

97.34%

  

6.5. 模型泛化能力对比
-------------

### 6.5.1. 重量泛化能力测试记录（单一食材）

食材

重量(g)

食材总重量(g)

预测功率(w)

总热量预测模型计算时长(s)

熟化热量预测模型计算时长(s)

熟化热量预测模型1计算时长(s)

熟化热量预测模型2计算时长(s)

熟化热量预测模型3计算时长(s)

熟化热量预测模型4计算时长(s)

熟化热量预测模型5计算时长(s)

熟化热量预测模型6计算时长(s)

备注

鸡翅  
  
  
  
  
  
  
  
  

3000

3000

800  
  
  
  
  
  
  
  
  

890

2040

2140

2170

2020

1860

1940

2580

  

2500

2500

880

1880

1970

2000

1860

1690

1770

2420

  

2000

2000

880

1740

1790

1430

1660

1520

1270

1800

  

1500

1500

890

1460

1600

1200

1460

1390

1070

1540

  

1000

1000

840

950

1450

840

740

990

800

1040

  

500

500

440

610

670

610

620

650

590

580

  

200

200

190

250

260

290

330

220

240

280

  

100

100

200

150

190

240

260

190

210

210

  

50

50

140

120

190

200

220

240

210

210

  

### 6.5.2. 重量泛化能力测试记录（两种食材）

食材1

重量1(g)

食材2

重量2(g)

食材总重量(g)

预测功率(w)

总热量预测模型计算时长(s)

熟化热量预测模型计算时长(s)

模型1计算时长(s)

模型2计算时长(s)

模型3计算时长(s)

模型4计算时长(s)

模型5计算时长(s)

模型6计算时长(s)

备注

豆角  
  
  
  
  
  
  
  
  

1500

猪肉（瘦）  
  
  
  
  
  
  
  
  
  

1500

3000

800  
  
  
  
  
  
  
  
  
  

850

2150

2210

2560

2420

1940

2010

2650

  

1000

1500

2500

850

1940

2200

2570

2290

1800

1830

2490

  

1500

1000

2500

810

1800

2050

2020

1800

1780

1860

2500

  

1000

1000

2000

810

1600

2090

1850

2100

1650

1470

2030

  

500

1000

1500

810

1420

1840

1490

1860

1450

1180

1610

  

800

500

1300

480

1110

1830

890

1240

1430

1150

1420

  

500

500

1000

480

770

1520

1070

1450

1320

1020

1140

  

200

200

400

330

320

390

430

430

380

390

410

  

100

100

200

160

170

180

240

240

180

190

200

  

50

50

100

140

150

180

240

210

230

200

230

  

25

25

50

150

120

220

220

220

270

230

240

  

由此可见：熟化热量预测模型对重量的泛化能力差不多，但第三版本的模型对小重量（200 g以内）的泛化能力更差。

### 6.5.3. 重量泛化能力测试记录（汤类）

食材1

重量1(g)

食材2

重量2(g)

食材总重量(g)

第二版模型预测热量

模型1预测熟化热量

模型2预测熟化热量

模型3预测熟化热量

模型4预测熟化热量

模型5预测熟化热量

模型6预测熟化热量

备注

鲈鱼  
  
  
  
  
  
  
  

1500

水  
  
  
  
  
  
  
  
  
  

1500

3000

570129.35728

935254.579758

913127.682667

864640.82083

814737.179724

997313.126667

1138398

  

1000

1500

2500

575399.22064

1023125

913127.682667

741142.055547

860904.833517

1012024

1184347

  

1500

1000

2500

749364.0

935254.579758

913127.682667

864640.82083

814737.179724

997313.126667

1138398

  

1000

1000

2000

575399.22064

1023125

700203.460923

741142.055547

860904.833517

797921.872444

915067.655489

  

500

1000

1500

579720.59264

686618.593091

637558.680821

633378.877585

644021.639172

663479.134444

700048.041191

  

800

500

1300

519324.96992

528851.865697

478077.66359

486713.573585

567807.627862

461476.269778

449802.066723

  

500

500

1000

331433.948

552117.264727

570990.104821

497652.865811

603167.746069

552492.895111

577595.569532

  

100

500

600

162682.22976

291359.229455

435953.633641

461473.241811

365375.326483

271640.344889

370863.634553

  

500

100

600

292893.176

456842.378788

364529.162667

359228.369811

478408.406621

362848.646667

407746.649035

  

100

200

300

112181.78672

198642.665939

247663.209026

256396.415094

232644.569793

265105.051333

169759.211518

  

200

100

300

144647.836114

258880.506788

270305.161436

299379.117585

440087.617517

519448.786222

316115.531574

  

100

100

200

99254.41648

186565.499273

240799.874872

253353.100377

220579.405103

245268.202222

202054.321135

  

50

50

100

92046.40144

192998.111152

130717.940923

160720.049962

183819.092028

218723.033778

218912.013844

  

25

25

50

78902.11808

159765.855879

116815.959385

147805.253736

185486.261379

211218.207156

132547.725277

  

由此可见：当重量较大时，水的影响较小，在其他食材重量不变的情况下，随着水量的减少，预测热量减小。同时，预测热量与水的占比有关，但无明显规律。后续可探索降低水的影响。

### 6.5.4. 烹饪方式泛化能力测试记录

食材1

重量1(g)

食材2

重量2(g)

食材总重量(g)

烹饪方式

熟化热量预测模型计算结果（模型3）

熟化热量预测模型计算结果

新旧模型热量偏差

备注

稻米（代表值）

100

水

600

700

粥

阶段1：800 W，270 s

阶段2：300 W，1690 s

阶段1：800 W，270 s

阶段2：450 W，820 s

136410.660

属于人为复验熟的粥，模型3预测热量更多，粥能更加软烂。

绿豆

100

水

600

700

汤

阶段1：800 W，270 s

阶段2：300 W，1590 s

阶段1：800 W，270 s

阶段2：450 W，710 s

154920.422

属于复验熟（不烂）的绿豆汤，模型3预测热量更多，绿豆能更加软烂。

由此可见：模型3对于粥类、汤类的泛化能力有较大提升。

### 6.5.5. 食材泛化能力测试记录

食材1

重量1(g)

食材2

重量2(g)

食材总重量(g)

熟化热量预测模型计算结果（模型3）

熟化热量预测模型计算结果

备注

玉米（鲜）

483

  

  

483

阶段1：800 W，360 s

  

阶段1：800 W，410 s

  

属于初次验证熟的烹玉米，前后差别不大。

猪肉（代表值，fat30g）

76

马铃薯

200

276

阶段1：800 W，290 s

  

阶段1：800 W，240 s

  

属于初次验证熟的土豆丝炒瘦肉，前后差别不大。

豆腐（代表值）

245

  

  

245

阶段1：800 W，380 s

  

阶段1：800 W，190 s

  

属于初次验证熟的煎豆腐，新模型烹饪时间较长，能煎得更入味。

千张

260

  

  

260

阶段1：800 W，360 s

  

阶段1：800 W，400 s

  

属于初次验证过熟的素炒千张，前后差别不大。

猪肉（代表值，fat30g）

80

胡萝卜

144

224

阶段1：800 W，220 s

  

阶段1：800 W，240 s

  

属于初次验证熟的胡萝卜肉丝（胡萝卜脆），前后差别不大。

猪肉（奶脯）

206

  

  

206

阶段1：800 W，490 s

  

阶段1：800 W，290 s

  

属于初次验证烤焦的烤五花肉，模型3烹饪时间更久一些，预计仍会烤焦。

鸡肫

280

  

  

280

阶段1：800 W，340 s

  

阶段1：800 W，280 s

  

属于初次验证熟的小炒鸡肾，前后差别不大。

鲈鱼

760

  

  

760

阶段1：800 W，770 s

  

阶段1：800 W，580 s

  

属于初次验证熟的清蒸鲈鱼，新模型烹饪时长久一些。

河蟹

295

  

  

295

阶段1：800 W，350 s

  

阶段1：800 W，280 s

  

属于初次验证熟的清蒸河蟹，前后差别不大。

章鱼

250

  

  

250

阶段1：800 W，310 s

  

阶段1：800 W，240 s

  

属于复验合格的八爪鱼，前后差别不大。

猪肉（肋条肉）

300

  

  

300

阶段1：800 W，330 s

  

阶段1：800 W，440 s

  

属于初次验证过熟的豉汁排骨，新模型烹饪时长短一些，预计不会过熟。

莴笋（鲜）

250

  

  

250

阶段1：800 W，130 s

  

阶段1：800 W，140 s

  

属于初次验证熟的清烹莴笋（脆），新模型无变化。

鸡蛋（代表值）

135

苦瓜（鲜）

80

215

阶段1：650 W，100 s

阶段2：450 W，230 s

阶段1：650 W，100 s

阶段2：450 W，170 s

属于人为验证过熟的苦瓜鸡蛋，新模型烹饪时长久一些，预计仍然会过熟。

鸡蛋（代表值）

180

大葱

50

230

阶段1：500 W，140 s

阶段2：300 W，240 s

阶段1：500 W，140 s

阶段2：300 W，360 s

属于人为验证过熟的酱卧鸡蛋，新模型烹饪时长短很多，预计不会过熟。

鸡蛋（代表值）

50

  

  

50

阶段1：300 W，600 s

  

阶段1：500 W，30 s

阶段2：300 W，230 s

属于复验焦的荷包蛋，模型3烹饪所需热量更多，预计仍会焦。

红薯叶

80

  

  

80

阶段1：800 W，230 s

  

阶段1：800 W，130 s

  

属于复验过熟的清烹红薯叶，模型3烹饪所需热量更多，预计仍会过熟。

面条

85

水

858

943

阶段1：800 W，380 s

阶段2：300 W，2140 s

阶段1：800 W，380 s

阶段2：450 W，1090 s

属于人为验证焦的煮面条，新模型烹饪时长久很多，预计仍会焦。

板栗

325

  

  

325

阶段1：800 W，280 s

  

阶段1：800 W，380 s

  

属于人为验证不熟的烤板栗，新模型烹饪时长短一些，预计仍会不熟。

鸡爪

400

水

100

500

阶段1：800 W，630 s

  

阶段1：800 W，670 s

  

属于人为验证过熟的红烧鸡爪，新模型烹饪时长短一点，预计不会过熟。

鸡毛菜

200

  

  

200

阶段1：800 W，240 s

  

阶段1：800 W，190 s

  

属于人为验证过熟的蒜蓉鸡毛菜，新模型烹饪时长久一些，预计仍会过熟。

火腿肠

250

  

  

250

阶段1：800 W，290 s

  

阶段1：800 W，310 s

  

属于人为验证过熟的烤火腿肠，新模型烹饪时长短一点，预计仍不会过熟。

由此可见：模型3的食材泛化能力与上个版本的模型差不多，对于面类、板栗、五花肉、荷包蛋等食材的烹饪仍然无法有效处理。

7\. 风险和提示
=========

7.1. 风险
-------

1.  **比热容数据不准确：**用户较难准确告知食材名称；用户所用食材与平台记录的食材不一致；平台收集的比热容数据来源不一致；比热容受温度影响较大；比热容无法直接获取。
2.  用户无法准确告知主要食材和重量：用户很难准确告知食材重量；用户告知的主料占总食材比重少于70%；当水的占比很大时理应作为主料输入，但用户容易遗漏；迫于当前虚拟人对话系统的能力，用户只能输入1-2个主料食材。
3.  **食材所需热量估算不准确：**当前建模特征较少（缺少食材总重、烹饪方式、食材大小、口感等关键特征）；食材烹饪所需热量具有主观性，无法精准衡量；烹饪过程中食材加入的先后顺序不确定，且部分食材可能单独加热处理或不加热。
4.  虚拟人话术设计较困难：指令不支持出现多个同类词槽；食材重量单位无法灵活设置；很多关键提示类的信息容易遗漏；结合万得厨界面设计较麻烦。
5.  其他：食材初始温度不准确；此方案基于常温下常规由生到熟的烹饪方式（粥、汤、炖、烤、炒、焖、煎、蒸等）提出，暂时不适用于冷冻、熟食、面粉类、凉拌和加热等场景（考虑给出提示）。

7.2. 提示
-------

1.  **计算误差提示：**烹饪的主料重量占比需70%以上（包括水），否则计算误差可能较大。
2.  **技能使用场景提示：**常温到沸腾且由生到全熟；暂时不适用于冷冻、熟食和普通加热等场景。
3.  **通用提示：**食物的烹饪时长受到多个因素的影响，包括食物的总重、大小、烹饪方法等，请结合经验适当调节烹饪功率和时长。烹饪过程可多次搅拌，以防受热不均。
4.  **针对特殊食材的提示：**建议维护食材提示清单。（生蚝（带壳50 g，含20 g生蚝肉）：按照生蚝肉的重量算；鲈鱼：非汤类鲈鱼不要盖盖子烹饪，以防爆炸；鸡蛋：烹饪前请在蛋黄和蛋白上扎几个洞，以防爆炸；绿豆：需要提前泡发再烹饪。）

食材名称

提示内容

备注

食材名称

提示内容

备注

生蚝

按照生蚝肉的重量算

带壳50 g，含20 g生蚝肉

鲈鱼

非汤类鲈鱼不要盖盖子烹饪，以防爆炸

鱼类

鸡蛋

烹饪前请在蛋黄和蛋白上扎几个洞，以防爆炸

  

绿豆、香菇、茶树菇、鹿茸菇、猴头菇、虫草花、羊肚菌、粉条、海带、菜干、发菜、粉丝、干米粉、霸王花、虾干、笋干、干莲子、干百合、干海星、海参、红薯粉、黄花菜、木耳、银耳、干云耳、雪燕、茯苓、葛根、薏米、紫米、赤小豆、鹰嘴豆、干鱿鱼、三牙鱼、干贝

需要提前泡发再烹饪

  

瑶柱、干腐竹、黄豆、石斛、蚝豉、花生、眉豆、面藕、灵芝、海蜇皮

需提前泡水

  

  

  

  

[Filter table data](#)[Create a pivot table](#)[Create a chart from data series](#)

[Configure buttons visibility](/users/tfac-settings.action)