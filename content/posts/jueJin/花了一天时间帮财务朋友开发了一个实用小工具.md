---
author: "ç¨‹åºå‘˜æ™“å‡¡"
title: "èŠ±äº†ä¸€å¤©æ—¶é—´å¸®è´¢åŠ¡æœ‹å‹å¼€å‘äº†ä¸€ä¸ªå®ç”¨å°å·¥å…·"
date: 2024-08-19
description: "ä¸çŸ¥é“å¤§å®¶æœ‰æ²¡æœ‰åšè´¢åŠ¡çš„æœ‹å‹ï¼Œæˆ‘å°±æœ‰è¿™ä¹ˆä¸€ä½æœ‹å‹å°±ç»å¸¸è·Ÿæˆ‘æŠ±æ€¨ã€‚ä¸€åˆ°æœˆåº•ç®€ç›´å°±æ˜¯å™©æ¢¦ï¼Œæ€»æœ‰åŠ ä¸å®Œçš„ç­ï¼Œç†¬ä¸å®Œçš„å¤œï¼Œåšä¸å®Œçš„æŠ¥è¡¨ã€‚"
tags: ["åç«¯"]
ShowReadingTime: "é˜…è¯»4åˆ†é’Ÿ"
weight: 919
---
å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯**æ™“å‡¡ã€‚**

### å†™åœ¨å‰é¢

ä¸çŸ¥é“å¤§å®¶æœ‰æ²¡æœ‰åšè´¢åŠ¡çš„æœ‹å‹ï¼Œæˆ‘å°±æœ‰è¿™ä¹ˆä¸€ä½æœ‹å‹å°±ç»å¸¸è·Ÿæˆ‘æŠ±æ€¨ã€‚ä¸€åˆ°æœˆåº•ç®€ç›´å°±æ˜¯å™©æ¢¦ï¼Œæ€»æœ‰åŠ ä¸å®Œçš„ç­ï¼Œç†¬ä¸å®Œçš„å¤œï¼Œåšä¸å®Œçš„æŠ¥è¡¨ã€‚

![æ¥è‡ªæœ‹å‹çš„æŠ±æ€¨](https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/24c3f35a5a9f44f79944a04add69de70~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5pmT5Yeh:q75.awebp?rk3s=f64ab15b&x-expires=1727659713&x-signature=AuT1I8MYHoQ2674x5RkatTx8J4U%3D)

ä¸€å¬åˆ°è¿™å„¿ï¼Œè¿™ä¸å°±ä¸€æ´»ç”Ÿç”Ÿçš„ä¸€ä¸ªâ€œå¤§è¡¨å“¥â€ä¹ˆï¼Œè¿™åŠ ç­è·Ÿæˆ‘ä»¬ç¨‹åºå‘˜æœ‰å¾—ä¸€æ‹¼äº†ï¼Œå¿ä¸ä½é‚ªæ¶ä¸€ç¬‘ï¼Œå¿ƒé‡Œå¹³è¡¡äº†å¾ˆå¤šã€‚

![](https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7015168e01ef404bb3cace1623847953~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5pmT5Yeh:q75.awebp?rk3s=f64ab15b&x-expires=1727659713&x-signature=Z3WY3WVRBBhp6pltXCrF7j3f6LM%3D)

èº«ä¸ºç‰›é©¬ï¼Œå¤§å®¶éƒ½ä¸å®¹æ˜“å•Šã€‚æˆ‘ä¸ç¾¡æ…•ä½ æ•°é’±æ•°åˆ°æ‰‹æŠ½ç­‹ï¼Œä½ ä¹Ÿåˆ«ç¾¡æ…•æˆ‘æ•´å¤©å†™CRUD å†™åˆ°æ‰‹èµ·è€èŒ§ğŸ¤£

åæ§½å½’åæ§½ï¼Œé¥­è¿˜å¾—åƒï¼Œå·¥ä½œè¿˜å¾—ç»§ç»­å¹²ã€‚äºæ˜¯ä¹ï¼ŒçœŸå¥½èµ¶ä¸Šå‘¨æœ«ï¼ŒèŠ±äº†ä¸€å¤©çš„æ—¶é—´ï¼Œå¸®æœ‹å‹å†™äº†ä¸ªå°å·¥å…·

### ä¸€ã€åŠŸèƒ½éœ€æ±‚

è·Ÿæœ‹å‹å¹äº†åŠå¤©ç‰›ï¼Œç»ˆäºæŠŠéœ€æ±‚ç¡®å®šä¸‹æ¥äº†ã€‚å°±ä¸€ä¸ªå¾ˆç®€å•çš„åŠŸèƒ½ï¼Œé€šè¿‡åå­—ï¼Œå°†è¡¨ä¸€å’Œè¡¨äºŒä¸­ç›¸åŒåå­—çš„é‡‘é¢åˆè®¡ã€‚

å…·ä½“æ•°æ®æ•´åˆå¦‚ä¸‹å›¾æ‰€ç¤º

![æ•°æ®æ•´åˆ](https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/892e6685e0474fe1a16ee776fbb0ccfc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5pmT5Yeh:q75.awebp?rk3s=f64ab15b&x-expires=1727659713&x-signature=twMLkLpMF92jmmDlyKCiYNlERag%3D)

è™½ç„¶ä¸€ä¸ªéå¸¸ç®€å•çš„åŠŸèƒ½ï¼Œä½†å¦‚æœä¸å€ŸåŠ©å·¥å…·ï¼Œæ•°æ®å¤ªå¤šï¼Œäººå·¥æ¥æ ¸å¯¹ï¼Œæ•´åˆæ•°æ®ï¼Œè¿˜æ˜¯éœ€è¦éå¸¸æ¶ˆè€—æ—¶é—´å’Œä½“åŠ›çš„ã€‚

æ€ªä¸å¾—ï¼Œè¿™æœ‹å‹åˆ°æœˆåº•å°±æ¶ˆå¤±äº†ï¼ŒåŸæ¥æ—¶é—´éƒ½è€—åœ¨è¿™ä¸Šé¢äº†ã€‚

### äºŒã€æŠ€æœ¯é€‰å‹

ç”±äºéœ€æ±‚æ¯”è¾ƒç®€å•ï¼Œåªæœ‰excelå¯¼å…¥å¯¼å‡ºï¼Œæ•°æ®æ•´åˆåŠŸèƒ½ã€‚ä¸æ¶‰åŠæ•°æ®åº“ç›¸å…³æ“ä½œã€‚

ç»¼åˆè€ƒè™‘ä¹‹åé€‰æ‹©äº†

*   `PowerBuilder`
*   `Pbidea.dll`

ä½¿ç”¨`PowerBuilder`å¼€å‘æ¡Œé¢åº”ç”¨ï¼Œè™½ç„¶ç•Œé¢ä¸‘ä¸€ç‚¹ï¼Œä½†æ˜¯å¼€å‘æ•ˆç‡æŒºé«˜ï¼Œç®€å•æ‹–æ‹–æ‹½æ‹½å°±èƒ½å®Œæˆç•Œé¢ï¼ˆå¯¹äºå‰ç«¯æŠ€æœ¯ä¸ç†Ÿçš„å°ä¼™ä¼´å¾ˆå‹å¥½ï¼‰

å…¶æ¬¡ï¼Œç”±äºä¸éœ€è¦æ•°æ®åº“ï¼Œæ”¾å¼ƒwebå¼€å‘åº”ç”¨ï¼Œåˆçœå»äº†äº‘æœåŠ¡å™¨è´¹ç”¨ã€‚æœ€ç»ˆåªéœ€è¦æ‰“åŒ…æˆ`exe`æ–‡ä»¶å³å¯è·‘èµ·æ¥

`Pbidea.dll` ç®—æ˜¯`Powerbuilder`æœ€å¼ºè¾…åŠ©å¼€å‘ï¼Œæ²¡æœ‰ä¹‹ä¸€ã€‚ç®—æ˜¯PBerä»¬çš„ç¦éŸ³å§

### ä¸‰ã€ç®€å•ç•Œé¢å¸ƒå±€

![ç•Œé¢å¸ƒå±€1](https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bc5a7af14e71402692db47e0cb59f9e2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5pmT5Yeh:q75.awebp?rk3s=f64ab15b&x-expires=1727659713&x-signature=zKxREH2UCrwfChnoMKwolR0XUeQ%3D)

![ç•Œé¢å¸ƒå±€2](https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9eddb3ed28664784823a1c21e3a758c8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5pmT5Yeh:q75.awebp?rk3s=f64ab15b&x-expires=1727659713&x-signature=EdnRkxym3m08fm9Gu4SZPxOE9C4%3D)

![ç•Œé¢å¸ƒå±€3](https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ee661626c0e947ceb6496b9b547ae703~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5pmT5Yeh:q75.awebp?rk3s=f64ab15b&x-expires=1727659713&x-signature=pgqvHqDVbUzSK6paKiAcKNrBaR8%3D)

### å››ã€æ ¸å¿ƒä»£ç 

â‘  å¯¼å…¥excel

c

 ä»£ç è§£è¯»

å¤åˆ¶ä»£ç 

`â€‹ string ls_pathName,ls_FileName //è·¯å¾„+æ–‡ä»¶åï¼Œæ–‡ä»¶å long ll_Net long rows dw_1.reset() uo_datawindowex dw dw = create uo_datawindowex dw_1.setredraw(false) ll_Net = GetFileSaveName("è¯·é€‰æ‹©æ–‡ä»¶",ls_pathName,ls_FileName,"xlsx","Excelæ–‡(*.xlsx),*.xlsx") â€‹ rows = dw.ImportExcelSheet(dw_1,ls_pathName,1,0,0) destroy dw dw_1.setredraw(true) MessageBox("æç¤ºä¿¡æ¯","å¯¼å…¥æˆåŠŸ " + string(rows) + "è¡Œæ•°æ®") â€‹`

â‘¡ æ•°æ®æ•´åˆ

scss

 ä»£ç è§£è¯»

å¤åˆ¶ä»£ç 

`long ll_row,ll_sum1,ll_sum2 long ll_i,ll_j long ll_yes â€‹ string ls_err â€‹ //é‡ç½®è¡¨ä¸‰æ•°æ® â€‹ dw_3.reset() â€‹ //å¤„ç†è¡¨ä¸€æ•°æ® ll_sum1 = dw_1.rowcount( ) â€‹ if ll_sum1<=0 then     ls_err = "è¡¨1 æœªå¯¼å…¥æ•°æ®ï¼Œè¯·å…ˆå¯¼å…¥æ•°æ®"     goto err end if â€‹ for ll_i=1 to ll_sum1     ll_row = dw_3.insertrow(0)     dw_3.object.num[ll_row] =ll_row Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â //åºå·     dw_3.object.name[ll_row]=dw_1.object.name[ll_i] Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  //å§“å     dw_3.object.salary[ll_row]=dw_1.object.salary[ll_i] Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â //å·¥èµ„     dw_3.object.endowment[ll_row]=dw_1.object.endowment[ll_i] Â  Â  Â  Â  Â  Â  Â  //å…»è€     dw_3.object.medical[ll_row]=dw_1.object.medical[ll_i] Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â //åŒ»ç–—     dw_3.object.injury[ll_row]=dw_1.object.injury[ll_i] Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â //å·¥ä¼¤     dw_3.object.unemployment[ll_row]=dw_1.object.unemployment[ll_i] Â  Â  Â //å¤±ä¸š     dw_3.object.publicacc[ll_row]=dw_1.object.publicacc[ll_i] Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â //å…¬ç§¯é‡‘     dw_3.object.annuity[ll_row]=dw_1.object.annuity[ll_i] Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  //å¹´é‡‘      next â€‹ //å¤„ç†è¡¨äºŒæ•°æ® â€‹ ll_sum2 = dw_2.rowcount( ) â€‹ if ll_sum2<=0 then     ls_err = "è¡¨2æœªå¯¼å…¥æ•°æ®ï¼Œè¯·å…ˆå¯¼å…¥æ•°æ®"     goto err end if â€‹ for ll_j =1 to ll_sum2     string ls_name      ls_name = dw_2.object.name[ll_j]          ll_yes = dw_3.Find("name = '"+ ls_name +"'  ",1,dw_3.rowcount())          if ll_yes<0 then         ls_err = "æŸ¥æ‰¾å¤±è´¥!"+SQLCA.SQLErrText         goto err     end if                  if ll_yes = 0 then Â //æ²¡æœ‰æ‰¾åˆ°             ll_row = dw_3.InsertRow (0)             dw_3.ScrollToRow(ll_row)             dw_3.object.num[ll_row] Â  Â  Â  Â  Â  Â  Â  Â  Â  = ll_row Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â //åºå·             dw_3.object.name[ll_row] Â  Â  Â  Â  Â  Â  Â  Â  = dw_1.object.name[ll_j] Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  //å§“å             dw_3.object.salary[ll_row] Â  Â  Â  Â  Â  Â  Â  Â  = dw_1.object.salary[ll_j] Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â //å·¥èµ„             dw_3.object.endowment[ll_row] Â  Â  Â  Â  = dw_1.object.endowment[ll_j] Â  Â  Â  Â  Â  Â  Â  //å…»è€             dw_3.object.medical[ll_row] Â  Â  Â  Â  Â  Â  Â = dw_1.object.medical[ll_j] Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â //åŒ»ç–—             dw_3.object.injury[ll_row] Â  Â  Â  Â  Â  Â  Â  Â  = dw_1.object.injury[ll_j] Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â //å·¥ä¼¤             dw_3.object.unemployment[ll_row] Â  Â = dw_1.object.unemployment[ll_j] Â  Â  Â //å¤±ä¸š             dw_3.object.publicacc[ll_row] Â  Â  Â  Â  Â  Â = dw_1.object.publicacc[ll_j] Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â //å…¬ç§¯é‡‘             dw_3.object.annuity[ll_row] Â  Â  Â  Â  Â  Â  Â  = dw_1.object.annuity[ll_j] Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  //å¹´é‡‘     end if          if ll_yes >0 then Â //æ‰¾åˆ° Â  Â  Â  Â              dec{2} ld_salary,ld_endowment,ld_medical,ld_injury,ld_unemployment,ld_publicacc,ld_annuity             ld_salary = dw_3.object.salary[ll_yes] + dw_2.object.salary[ll_j]             ld_endowment = Â dw_3.object.endowment[ll_yes] + dw_2.object.endowment[ll_j]             ld_medical = dw_3.object.medical[ll_yes] + dw_2.object.medical[ll_j]             ld_injury = dw_3.object.injury[ll_yes] + dw_2.object.injury[ll_j]             ld_unemployment = dw_3.object.unemployment[ll_yes] + dw_2.object.unemployment[ll_j]             ld_publicacc = dw_3.object.publicacc[ll_yes] + dw_2.object.publicacc[ll_j]             ld_annuity = dw_3.object.annuity[ll_yes] + dw_2.object.annuity[ll_j]                          dw_3.object.salary[ll_yes]= Â ld_salary Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  //å·¥èµ„             dw_3.object.endowment[ll_yes]=ld_endowment Â  Â  Â  Â  Â  Â  Â  //å…»è€             dw_3.object.medical[ll_yes]=ld_medical Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â //åŒ»ç–—             dw_3.object.injury[ll_yes]=ld_injury Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  //å·¥ä¼¤             dw_3.object.unemployment[ll_yes]=ld_unemployment Â  //å¤±ä¸š             dw_3.object.publicacc[ll_yes]=ld_publicacc Â  Â  Â  Â  Â  Â  Â  Â  Â  Â //å…¬ç§¯é‡‘             dw_3.object.annuity[ll_yes]=ld_publicacc Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â //å¹´é‡‘              end if      next â€‹ return 0 â€‹ err: messagebox('é”™è¯¯ä¿¡æ¯',ls_err)`

â‘¢ excelå¯¼å‡º

vbnet

 ä»£ç è§£è¯»

å¤åˆ¶ä»£ç 

`string ls_err string ls_pathName,ls_FileName //è·¯å¾„+æ–‡ä»¶åï¼Œæ–‡ä»¶å long ll_Net â€‹ if dw_3.rowcount() = 0 then      ls_err = "æ•´åˆæ•°æ®ä¸ºç©ºï¼Œä¸èƒ½å¯¼å‡º"     goto err end if â€‹ uo_wait_box luo_waitbox luo_waitbox = create uo_wait_box luo_waitBox.OpenWait(64,RGB(220,220,220),RGB(20,20,20),TRUE,"æ­£åœ¨å¯¼å‡º ", 8,rand(6) - 1) â€‹ long rows CreateDirectory("tmp") uo_datawindowex dw dw = create uo_datawindowex â€‹ ll_Net = GetFileSaveName("é€‰æ‹©è·¯å¾„",ls_pathName,ls_FileName,"xlsx","Excelæ–‡(*.xlsx),*.xlsx") â€‹ rows = dw.ExportExcelSheet(dw_3,ls_pathName,true,true) destroy dw destroy luo_waitbox MessageBox("æç¤ºä¿¡æ¯","æˆåŠŸå¯¼å‡º " + string(rows) + " è¡Œæ•°æ®") â€‹ return 0 â€‹ err: messagebox('é”™è¯¯ä¿¡æ¯',ls_err)`

### äº”ã€æœ€ç»ˆæ•ˆæœ

![è´¢åŠ¡è¾…åŠ©ç³»ç»Ÿ](https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3020993ef6fc4de8b8c95618340ce2c8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5pmT5Yeh:q75.awebp?rk3s=f64ab15b&x-expires=1727659713&x-signature=hsWo4odk1qSaTemjn9KD5nQFtac%3D)

è¿™æ¬¡åˆ†äº«å°±åˆ°è¿™å§ï¼Œ_â˜…,Â°_:.â˜†(ï¿£â–½ï¿£)/$: _.Â°â˜…_ ã€‚å¸Œæœ›å¯¹æ‚¨æœ‰æ‰€å¸®åŠ©ï¼Œä¹Ÿå¸Œæœ›å¤šæ¥å‡ ä¸ªè¿™æ ·çš„æœ‹å‹ï¼Œä¸å¤šè¯´äº†ï¼Œ è¹­é¥­å»äº†

æˆ‘ä»¬ä¸‹æœŸå†è§ãƒ¾(â€¢Ï‰â€¢\`)o (â—'â—¡'â—)