---
author: "小红帽的大灰狼"
title: "我是DB搬运工，我哪会排查问题。。。"
date: 2024-05-30
description: "今天说说如何排查线上问题，首先声明如果想看什么cpu优化。jvm优化的，我这不适合，我这属于广大底层人士的，纯纯的CRUD，没那么多的性能优化；开干报错信息的问题首先说一个报错信息的问题：对于线"
tags: ["后端"]
ShowReadingTime: "阅读5分钟"
weight: 64
---
今天说说如何排查线上问题，首先声明如果想看什么cpu优化。jvm优化的，我这不适合，我这`属于广大底层人士`的，纯纯的CRUD，没那么多的性能优化；

开干

报错信息的问题
-------

首先说一个报错信息的问题：对于线上显而易见的界面提示错误，我们要完全避免不要将后台的报错打到前台界面上来，不要将后台的报错打到前台界面上来，不要将后台的报错打到前台界面上来，重要的说三遍，我看到很多线上生产系统报出java报错信息和php报错信息了；外人来看可能看不懂，觉得炫酷，内行人看简直了，垮diao；类似于我找的这个网图

![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/cd3dcd6cd01c4faea5b1a193db6fc3d5~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=562&h=334&s=27877&e=png&b=fefefe)

如何排查问题
------

再说下我们开发人员前后端都写的情况下如何排查问题，对于前后端都开发的人员其实避免了很多扯皮的事情，也少了很多沟通的问题，如果我们环境点击报错，我们可以

1.  打开浏览器的f12查看该请求的地址
2.  按该地址找到后台对应的接口地址，启动本地，打上断点
3.  如果没有走进后台断点处那么存在三个问题，一个是`contentType或者请求方式两者没有保持一致`，这个一般开发自测的时候就可以测出来，另一个就是你的`地址可能中间环节有路由`，路由有问题一般对于大部分功能都有影响，不会是小范围的，还有一种就是我们的`后台有拦截器`但是我们不熟悉这块，一般大家接手项目的时候估计只会扫一眼这块，恰好这块对于某些业务权限卡的很的项目来说会经常发生这种事，而你恰好不熟悉所以你排查半天也不会有头绪；
4.  进入断点以后，我们按流程往下执行就能找到报错的地方了
5.  如果你日志打的详细而且也可以轻松获取生产的日志，那就在日志中就可以找到我们报错的信息；
6.  如果你是传回前台后报错，那么我们需要在浏览器上打断点，然后去定位是不是咱们传的参数和前台解析的参数属性不一致还是一些其他的问题，以上就形成了闭环；

如果我们是只写后端，分离项目的那种，那咱们就是加强沟通，和气生财，一切问题出在我后端，前端都是完美的，来问题了你先排查起来，确定没问题了，再去告诉项目大哥，让前端兄弟排查一下，有些新手可能会问为什么不让前端先排查，`这个其实不该问`，只要是前后端分离的，业务层其实都是摆在后端的，而问题大部分是出在业务上的，所以后端干就完了；

![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/07bac8e470714fabbc2285d0e3447aff~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=962&h=726&s=398816&e=png&b=92d7f0) 如果我们使用了一些中间件，要没事带关注这些玩意，有时候大家共用的Redis，你不知道别人怎么操作，然后Redis崩了，你能怎么办，如果你是业务前置部门，虽然与你无瓜，但客户的感知就是你报错了，别人躲在后面到不了那一步，所以你得去各方联系重启机器；

![ABUIABACGAAg9b-EhwYo0omnkwUwkAM4kAM.jpg](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/746b3c2d8dd24cc5a344639fefdddd30~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=400&h=400&s=15733&e=jpg&b=fbfbfb)

项目执行过程真的报oom了呢，那你必须去生产环境捞日志，找到位置，看看机器配置，看看项目执行占用资源情况，纯小白方式直接top命令查看，资源的确给的少了，那么我们启动的时候调整下jvm参数，把它调大，如果是代码执行循环导致的，那么我们就得优化代码，如果是执行任务之类的，比如给个无界队列，那么队列也会把数据撑爆，这时候我们也需要调整业务逻辑，（`**记住，队列撑爆内存千万别直接把队列弄成有界的，一定要去沟通怎么优化，得到认可才能干，我们开发对于业务场景是没有产品经理清晰的**`）这种挤爆jvm的不是那么多见，但的确很长见识的；

部署打包
----

排查完、修改完我们就要打包了，其实我特别不建议本地打包那种方式（应该禁止），万一哪个卧龙本地打包后认为活结束了然后忘了提交，然后他离职了然后电脑重置然后over；不管有意无意，环节得控制好我在第一篇就说了，避免后期维护压力，要控制好每一个环节，其实很简单，代码上传git或者svn，用jenkins来打，Jenkins还会记录每一次的打包时间，然后下载发给生产，我觉得比本地打包优秀多了；

![jenkins.jpg](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b8575b82cccd405e84ebf85b7caf4a78~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=1701&h=975&s=153228&e=jpg&b=fdf7f7)

还有就是我们上生产的配置文件尽量读取服务器上的配置，不要和打包一起，你的项目可能部署在很多地方用，单独的配置避免了频繁的找文件，如果需要直接生产copy一份然后修改再上传，

`ok！完成`

四、总结
====

> 我也曾是个快乐的童鞋，也有过崇高的理想，直到我面前堆了一座座山，脚下多了一道道坑，我。。。。。。！