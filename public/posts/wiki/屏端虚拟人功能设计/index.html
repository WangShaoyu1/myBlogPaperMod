<!DOCTYPE html>
<html lang="zh" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>屏端虚拟人功能设计 | PaperMod</title>
<meta name="keywords" content="屏端数字员工">
<meta name="description" content="屏端数字员工">
<meta name="author" content="王宇">
<link rel="canonical" href="http://localhost:1313/posts/wiki/%E5%B1%8F%E7%AB%AF%E8%99%9A%E6%8B%9F%E4%BA%BA%E5%8A%9F%E8%83%BD%E8%AE%BE%E8%AE%A1/">
<meta name="google-site-verification" content="XYZabc">
<link crossorigin="anonymous" href="/assets/css/stylesheet.7b92bf4867c997b58ec50f63451b83777173d5bd5593376852abd85746d09d71.css" integrity="sha256-e5K/SGfJl7WOxQ9jRRuDd3Fz1b1VkzdoUqvYV0bQnXE=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/%3Clink%20/%20abs%20url%3E">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/%3Clink%20/%20abs%20url%3E">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/%3Clink%20/%20abs%20url%3E">
<link rel="apple-touch-icon" href="http://localhost:1313/%3Clink%20/%20abs%20url%3E">
<link rel="mask-icon" href="http://localhost:1313/%3Clink%20/%20abs%20url%3E">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="zh" href="http://localhost:1313/posts/wiki/%E5%B1%8F%E7%AB%AF%E8%99%9A%E6%8B%9F%E4%BA%BA%E5%8A%9F%E8%83%BD%E8%AE%BE%E8%AE%A1/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript><meta property="og:title" content="屏端虚拟人功能设计" />
<meta property="og:description" content="屏端数字员工" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://localhost:1313/posts/wiki/%E5%B1%8F%E7%AB%AF%E8%99%9A%E6%8B%9F%E4%BA%BA%E5%8A%9F%E8%83%BD%E8%AE%BE%E8%AE%A1/" />
<meta property="og:image" content="http://localhost:1313/images/papermod-cover.png" />
<meta property="article:section" content="posts" />




<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="http://localhost:1313/images/papermod-cover.png" />
<meta name="twitter:title" content="屏端虚拟人功能设计"/>
<meta name="twitter:description" content="屏端数字员工"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "http://localhost:1313/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "屏端虚拟人功能设计",
      "item": "http://localhost:1313/posts/wiki/%E5%B1%8F%E7%AB%AF%E8%99%9A%E6%8B%9F%E4%BA%BA%E5%8A%9F%E8%83%BD%E8%AE%BE%E8%AE%A1/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "屏端虚拟人功能设计",
  "name": "屏端虚拟人功能设计",
  "description": "屏端数字员工",
  "keywords": [
    "屏端数字员工"
  ],
  "articleBody": " 11. 22. 引言 2.12.1. 背景 2.22.2. 目标 2.32.3. 相关资料 2.3.12.3.1. 接口文档 33. 总体设计 3.13.1. 运行环境 3.23.2. 技术栈选型 44. 功能设计 4.14.1. 虚拟人引入 4.1.14.1.1. 引入第三方sdk 4.1.24.1.2. 资源文件 4.1.34.1.3. 初始化虚拟人实例 4.1.44.1.4. 其他初始化 4.1.4.14.1.4.1. FTT虚拟人切换， 4.24.2. 语音识别交互 4.2.14.2.1. 辅助工具 55. 本地调试 5.15.1. 跨域 5.25.2. 调试录音接口 66. 业务功能 6.16.1. 唤醒逻辑 6.1.16.1.1. 代码流程 6.1.1.16.1.1.1. 入口定义 6.1.1.26.1.1.2. .唤醒后逻辑 6.1.1.36.1.1.3. 拾音流程，兼容外壳唤醒 6.1.26.1.2. 唤醒失效 6.1.36.1.3. 唤醒打断 6.26.2. 快捷提问 6.2.16.2.1. 1.展示形式 6.2.1.16.2.1.1. 使用技术 6.2.26.2.2. 2.交互能力 6.36.3. 功能页 6.3.16.3.1. 特殊处理 6.3.26.3.2. 商品查询 6.3.36.3.3. 消费流程 6.3.46.3.4. 品牌宣传 6.46.4. 虚拟人交互 ============================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================\n2. 引言 2.1. 背景 在食品互联网产品能力与万得厨硬件能力结合打造的软硬件一体化的产品发展比较健全成熟的情况下，为了更好的打造产品的核心竞争力，给用户更完整全面的使用体验，同时也为了放大产业的价值，所以需要借助AI产品的能力，于是就提出了虚拟数字人与万得厨深入结合走整合社会化资源的影子虚拟数字人的产业建设逻辑，并结合“敬老、爱幼、助残”的整体产品、运营战略思想，产品定位为是运行在万得厨设备和万得厨APP上的智能专享厨师，让人人都有专享厨师，赋能集团整个C盘，实现\"人人为我，我为人人“的核心理念。\n在大数据、云计算、算法等核心技术都发展的比较成熟的环境下，各行各业对于虚拟数字人的投入也越来越大，未来已来，AI互联网的气息已经无处不在，也已经演化成了基础层、平台层、应用层的生态环境，所以有足够多的能力支持我们做虚拟数字人这件事情，当然我们的定位也很清晰，我们专注在厨房领域，用虚拟人赋能万得厨打造智能厨房，实现智能烹饪、精准推荐、营养搭配等核心能力。\n站在全局视角和长远规划来看，我们要做的是能力交易平台，人人都可以发布能力上去，人人都可以订阅其他人的能力，所以我们需要打造平台管理运营后台、服务商运营管理后台等去更好的连接生产端、消费端加入到生态中来，一起支撑虚拟人平台的建设。\n2.2. 目标 自助食堂数字员工的身份主要是：导购员+服务员，除了拥有助手身份的所有功能之外，还拥有以下一些与场景相关的特殊功能：\n1、门店消费流程介绍\n2、门店商品位置查询\n3、门店近期特价优惠\n4、门店设备闲忙情况\n2.3. 相关资料 名称\n链\n名称\n链\n2.3.1. 接口文档 https://yingzi-appservice-osc.dev.yingzi.com/api/appservice/osc/swagger-ui.html#/OC%E8%BF%90%E8%90%A5-%E7%BD%91%E7%82%B9%E5%95%86%E5%93%81Api/listOfflineStoreCommodityForOcUsingGET\n3. 总体设计 3.1. 运行环境 平台\n大屏端app\n访问地址\n开发环境（https://vdh-screen.dev.yingzi.com/）\n测试环境（https://vdh-screen.test.yingzi.com/）\n访问方式\napp嵌套浏览器\n账号体系\n3.2. 技术栈选型 整体框架\nvite生成vue技术栈\n视图层\nvue3\n包管理工具\nyarn\n接口规范\nrestful api\n核心sdk\n第三方虚拟人公司提供的sdk\n重要工具库\nvueuse、rxjs、swiper\n4. 功能设计 4.1. 虚拟人引入 4.1.1. 引入第三方sdk import { Avatar } from ‘./haihuman’\n4.1.2. 资源文件 放置项目根目录\nwasm\nhaicore_sdk.wasm\njson\nsk.json, behav.json\n4.1.3. 初始化虚拟人实例 实例化逻辑\ninit\n?\n1\n2\n3\n4\n5\n6\n7\nconst a = new Avatar(your_avatar_id, 'v1.0'``, avatarModel, containerId, ''``, {\nlocale: 'cn'``,\n})\na.init({\n// onProgress, onReady, onRender, onChat...具体看文档或源码\n})\nyour_avatar_id：在FTT我的应用里点击相应虚拟人的查看按钮，即可查看avatarId\navatarModel: 虚拟人模型文件名，在FTT【资源母版 \u003e 虚拟人母版】，记得加上\".glb\"后缀\ncontainerId: 容纳虚拟人的html标签的id\n4.1.4. 其他初始化 4.1.4.1. FTT虚拟人切换， 分测试环境和生产环境，区别是api和虚拟人id不同，在代码执行比较早的阶段定义好一个全局变量，决定取的是哪个环境的虚拟人\n通过拦截fetch改变url\n?\nwindow.fetch = (...args) =\u003e {\nif (window.fttEnv === 'test'``) {\nif (``typeof args[0] === 'string'``) {\nargs[0] = args[0].replace(``'[https://vdh-api.yingzi.com](https://vdh-api.yingzi.com)'``, '[https://vdh-api.test.yingzi.com](https://vdh-api.test.yingzi.com)'``)\n}\n}\nreturn Promise.resolve(oldfetch(...args));\n};\n4.2. 语音识别交互 浏览器环境：引用影子封装的基础能力@yingzi/STT-Core 屏端环境：安卓容器唤醒和识别发送通知 4.2.1. 辅助工具 影子内部集成讯飞语音识别的库\n5. 本地调试 5.1. 跨域 有第三方的资源由sdk调用获取，需要host文件添加下面一行\n自己的ip local-test.yingzi.com\n然后用local-test.yingzi.com来调试\n5.2. 调试录音接口 因为是用navigator.mediaDevices,而这个api有安全策略，只能在以下情况下使用，不然undefined\nhttps llocalhost/127.0.0.1 file///url 由于上面已经用了local-test.yingzi.com调试，而且默认vite启动是http，所以需要配置启用https\n6. 业务功能 6.1. 唤醒逻辑 由于浏览器不具备唤醒功能，这部分只能依赖app，主要由宿主app收到唤醒指令后调用浏览器的自定义方法，步骤主要是以下\n6.1.1. 代码流程 6.1.1.1. 入口定义 暴露到window，给宿主调用，调用document的自定义方法\n?\nwindow.onYzevent = (data) =\u003e {\ndocument.dispatchEvent(\nnew CustomEvent(``\"onYzevent\"``, {\ndetail: () =\u003e {\nstatus.value = \"listening\"``;\n},\n})\n);\n};\n6.1.1.2. .唤醒后逻辑 在你所需唤醒的地方加上\n?\ndocument.addEventListener(``\"onYzevent\"``, async (e) =\u003e {\ne.detail?.()\n// 业务逻辑...\n})\n6.1.1.3. 拾音流程，兼容外壳唤醒 安卓外壳\nwindow.onYzevent(obj)\nwakeUp\nspeechResult\nwindow.android?.starAsr()\n10秒还是没识别到\n识别到text\n//\u003c![CDATA[ (function() { $ = AJS.$; var graphContainer = document.getElementById(‘drawio-macro-content-02867ae0-60e8-4f92-b4d5-dcd409ffc447’); DrawioProperties = { contextPath : AJS.contextPath(), buildNumber : 8401 }; var readerOpts = {}; readerOpts.loadUrl = ’’ + ‘/rest/drawio/1.0/diagram/crud/%6F%6E%59%7A%65%76%65%6E%74/109731880?revision=1’; readerOpts.imageUrl = ’’ + ‘/download/attachments/109731880/onYzevent.png’ + ‘?version=1\u0026api=v2’; readerOpts.editUrl = ’’ + ‘/plugins/drawio/addDiagram.action?ceoId=109731880\u0026owningPageId=109731880\u0026diagramName=%6F%6E%59%7A%65%76%65%6E%74\u0026revision=1’; readerOpts.editable = true; readerOpts.canComment = true; readerOpts.stylePath = STYLE_PATH; readerOpts.stencilPath = STENCIL_PATH; readerOpts.imagePath = IMAGE_PATH + ‘/reader’; readerOpts.border = true; readerOpts.width = ‘400’; readerOpts.simpleViewer = false; readerOpts.tbstyle = ’top’; readerOpts.links = ‘auto’; readerOpts.lightbox = true; readerOpts.resourcePath = ATLAS_RESOURCE_BASE + ‘/resources/viewer’; readerOpts.disableButtons = false; readerOpts.zoomToFit = true; readerOpts.language = ‘zh’; readerOpts.licenseStatus = ‘OK’; readerOpts.contextPath = AJS.contextPath(); readerOpts.diagramName = decodeURIComponent(’%6F%6E%59%7A%65%76%65%6E%74’); readerOpts.diagramDisplayName = ‘’; readerOpts.aspect = ‘’; readerOpts.ceoName = ‘屏端虚拟人功能设计’; readerOpts.attVer = ‘1’; readerOpts.attId = ‘114666883’; readerOpts.lastModifierName = ‘吴家杰’; readerOpts.lastModified = ‘2023-12-01 11:21:32.634’; readerOpts.creatorName = ‘吴家杰’; //Embed macro specific info readerOpts.extSrvIntegType = ‘$extSrvIntegType’; readerOpts.gClientId = ‘$gClientId’; readerOpts.oClientId = ‘$oClientId’; readerOpts.service = ‘$service’; readerOpts.sFileId = ‘$sFileId’; readerOpts.odriveId = ‘$odriveId’; readerOpts.diagramUrl = ‘$diagramUrl’; readerOpts.csvFileUrl = ‘$csvFileUrl’; readerOpts.pageId = ‘$pageId’ || Confluence.getContentId(); readerOpts.aspectHash = ‘$aspectHash’; readerOpts.useExternalImageService = ‘$useExternalImageService’ == ’true’; readerOpts.isTemplate = ‘$isTemplate’ == ’true’; if (readerOpts.width == ‘’) { readerOpts.width = null; } // LATER: Check if delayed loading of resources can be used for image placeholder mode var viewerPromise = createViewer(graphContainer, readerOpts); if(readerOpts.editable) { $(graphContainer).data(‘viewerConfig’, readerOpts); $(graphContainer).on(‘drawioViewerUpdate’, updateDrawioViewer); } viewerPromise.done(function(viewer) { updateCachedDiagram(graphContainer, readerOpts, viewer); }); })(); //]]\u003e\n暴露接口如下👇\n屏端android和web交互接口\n6.1.2. 唤醒失效 语音识别的内容一直为空，在12s左右，基于websocket的识别过程将被服务端主动断开，产品希望时间延长，所以第一次断开后客户端这边主动重连一次，虚拟人播报“小万没听清，请您再说一次”，第二次断开后展示恢复欢迎语\n6.1.3. 唤醒打断 语音识别中不能唤醒，客户端拦截唤醒后的操作 待机中、思考中、朗读中都可以唤醒，重新进入语音识别阶段 6.2. 快捷提问 6.2.1. 1.展示形式 barrage: 弹幕模式\ngrid: 方格模式\n6.2.1.1. 使用技术 主页利用vueuse的useAnimate做弹幕横向移动的效果，同时是循环播放\n将内容分行 将每行内容复制一次添加到尾端 keyframes = [\n{ transform: “translateX(0)” },\n{ transform: “translateX(-50%)” },\n] 功能页使用\n定时器转换，6个6个定时转换，不足的尾部拼接头部\n6.2.2. 2.交互能力 除在思考中(nlp)过程中其他任何情况都能点击，直接调用给虚拟人做nlp\n6.3. 功能页 因为主页和其他功能页之间切换需要耗时，这里功能页封装成一个大的组件，根据条件判断在主页来显示，做到一个应用一个虚拟人\n6.3.1. 特殊处理 在所有功能页，nlp提交文本都默认带上上下文，提高当前场景下的指令命中率，假如命中失败，不播报失败话术，直接去掉上下文再一次nlp提交 6.3.2. 商品查询 前端一次拉取所有商品，方便做搜索和排序 根据条件排序时重新拉一次接口 根据指令返回话术，判断是否追问，播放追问话术，继续追问后，负反馈后前端播放失败话术，正反馈后前端播放成功话术，然后前端定位到商品那一页 6.3.3. 消费流程 几个流程步骤的内容从字典拉取\n自动从头开始播报时，需要播报当前内容时Swiper的页面滑到当前页面，改造以前的talk方法，将talk返回promise格式，回调后触发resolve\n使用效果\n?\n/**\n*\n* @param {() =\u003e void} callback 完整读完回调\n* @param {() =\u003e void} unitCallback 每步准备开始读的回调\n*/\ntalkAll: async (callback, unitCallback) =\u003e {\nconst talk = async (text, c) =\u003e {\nreturn await avatar.talk(text, \"read\"``, false``, callback, void 0``, () =\u003e {\nconsole.log(``\"du\"``, text);\nunitCallback();\nc?.();\n});\n};\nasync function run() {\nlet i = 0\nfor (let item of data.value) {\nawait talk(item.value, () =\u003e goPage(i));\ni++\n}\n}\nrun()\n// goPage(0);\n// await talk(data.value[0].value);\n// await talk(data.value[1].value, () =\u003e goPage(1));\n// await talk(data.value[2].value, () =\u003e goPage(2));\n// await talk(data.value[3].value, () =\u003e goPage(3));\n// await talk(data.value[4].value, () =\u003e goPage(4));\n// await talk(data.value[5].value, () =\u003e goPage(5));\n// await talk(data.value[6].value, () =\u003e goPage(6));\n// await talk(data.value[7].value, () =\u003e goPage(7));\n}\n6.3.4. 品牌宣传 任何点击交互都先通过nlp返回，再做响应操作，如nlp还未返回，需提示操作频繁\n6.4. 虚拟人交互 跟公众号h5版本的比较，屏端实现的触屏事件、复位能力、动画，都使用rxjs实现，解决比较复杂的异步场景\nrxjs优化异步状态\nFilter table dataCreate a pivot tableCreate a chart from data series\nConfigure buttons visibility\n",
  "wordCount" : "704",
  "inLanguage": "zh",
  "image": "http://localhost:1313/images/papermod-cover.png","datePublished": "0001-01-01T00:00:00Z",
  "dateModified": "0001-01-01T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "王宇"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://localhost:1313/posts/wiki/%E5%B1%8F%E7%AB%AF%E8%99%9A%E6%8B%9F%E4%BA%BA%E5%8A%9F%E8%83%BD%E8%AE%BE%E8%AE%A1/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "PaperMod",
    "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:1313/%3Clink%20/%20abs%20url%3E"
    }
  }
}
</script>
</head>

<body class=" dark" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="Home (Alt + H)">
                        
                    <img src="http://localhost:1313/images/msg_hu15231257772499651944.png" alt="" aria-label="logo"
                        height="20">Home</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/archives" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://github.com/adityatelange/hugo-PaperMod/wiki/" title="WiKi">
                    <span>WiKi</span>&nbsp;
                    <svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round"
                        stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12">
                        <path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"></path>
                        <path d="M15 3h6v6"></path>
                        <path d="M10 14L21 3"></path>
                    </svg>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://localhost:1313/">主页</a>&nbsp;»&nbsp;<a href="http://localhost:1313/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      屏端虚拟人功能设计
    </h1>
    <div class="post-description">
      屏端数字员工
    </div>
    <div class="post-meta">4 分钟&nbsp;·&nbsp;王宇&nbsp;|&nbsp;<a href="https://github.com/WangShaoyu1/myBlogPaperMod/tree/master/content/posts/wiki/%e5%b1%8f%e7%ab%af%e8%99%9a%e6%8b%9f%e4%ba%ba%e5%8a%9f%e8%83%bd%e8%ae%be%e8%ae%a1.md" rel="noopener noreferrer" target="_blank">Suggest Changes</a>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">目录</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#2-%e5%bc%95%e8%a8%80" aria-label="2. 引言">2. 引言</a><ul>
                        
                <li>
                    <a href="#21-%e8%83%8c%e6%99%af" aria-label="2.1. 背景">2.1. 背景</a></li>
                <li>
                    <a href="#22-%e7%9b%ae%e6%a0%87" aria-label="2.2. 目标">2.2. 目标</a></li>
                <li>
                    <a href="#23-%e7%9b%b8%e5%85%b3%e8%b5%84%e6%96%99" aria-label="2.3. 相关资料">2.3. 相关资料</a><ul>
                        
                <li>
                    <a href="#231-%e6%8e%a5%e5%8f%a3%e6%96%87%e6%a1%a3" aria-label="2.3.1. 接口文档">2.3.1. 接口文档</a></li></ul>
                </li></ul>
                </li>
                <li>
                    <a href="#3-%e6%80%bb%e4%bd%93%e8%ae%be%e8%ae%a1" aria-label="3. 总体设计">3. 总体设计</a><ul>
                        
                <li>
                    <a href="#31-%e8%bf%90%e8%a1%8c%e7%8e%af%e5%a2%83" aria-label="3.1. 运行环境">3.1. 运行环境</a></li>
                <li>
                    <a href="#32-%e6%8a%80%e6%9c%af%e6%a0%88%e9%80%89%e5%9e%8b" aria-label="3.2. 技术栈选型">3.2. 技术栈选型</a></li></ul>
                </li>
                <li>
                    <a href="#4-%e5%8a%9f%e8%83%bd%e8%ae%be%e8%ae%a1" aria-label="4. 功能设计">4. 功能设计</a><ul>
                        
                <li>
                    <a href="#41-%e8%99%9a%e6%8b%9f%e4%ba%ba%e5%bc%95%e5%85%a5" aria-label="4.1. 虚拟人引入">4.1. 虚拟人引入</a><ul>
                        
                <li>
                    <a href="#411-%e5%bc%95%e5%85%a5%e7%ac%ac%e4%b8%89%e6%96%b9sdk" aria-label="4.1.1. 引入第三方sdk">4.1.1. 引入第三方sdk</a></li>
                <li>
                    <a href="#412-%e8%b5%84%e6%ba%90%e6%96%87%e4%bb%b6" aria-label="4.1.2. 资源文件">4.1.2. 资源文件</a></li>
                <li>
                    <a href="#413-%e5%88%9d%e5%a7%8b%e5%8c%96%e8%99%9a%e6%8b%9f%e4%ba%ba%e5%ae%9e%e4%be%8b" aria-label="4.1.3. 初始化虚拟人实例">4.1.3. 初始化虚拟人实例</a></li>
                <li>
                    <a href="#414-%e5%85%b6%e4%bb%96%e5%88%9d%e5%a7%8b%e5%8c%96" aria-label="4.1.4.  其他初始化">4.1.4.  其他初始化</a><ul>
                        
                <li>
                    <a href="#4141-ftt%e8%99%9a%e6%8b%9f%e4%ba%ba%e5%88%87%e6%8d%a2" aria-label="4.1.4.1. FTT虚拟人切换，">4.1.4.1. FTT虚拟人切换，</a></li></ul>
                </li></ul>
                </li>
                <li>
                    <a href="#42-%e8%af%ad%e9%9f%b3%e8%af%86%e5%88%ab%e4%ba%a4%e4%ba%92" aria-label="4.2. 语音识别交互">4.2. 语音识别交互</a><ul>
                        
                <li>
                    <a href="#421-%e8%be%85%e5%8a%a9%e5%b7%a5%e5%85%b7" aria-label="4.2.1.  辅助工具">4.2.1.  辅助工具</a></li></ul>
                </li></ul>
                </li>
                <li>
                    <a href="#5-%e6%9c%ac%e5%9c%b0%e8%b0%83%e8%af%95" aria-label="5. 本地调试">5. 本地调试</a><ul>
                        
                <li>
                    <a href="#51-%e8%b7%a8%e5%9f%9f" aria-label="5.1. 跨域">5.1. 跨域</a></li>
                <li>
                    <a href="#52-%e8%b0%83%e8%af%95%e5%bd%95%e9%9f%b3%e6%8e%a5%e5%8f%a3" aria-label="5.2. 调试录音接口">5.2. 调试录音接口</a></li></ul>
                </li>
                <li>
                    <a href="#6-%e4%b8%9a%e5%8a%a1%e5%8a%9f%e8%83%bd" aria-label="6. 业务功能">6. 业务功能</a><ul>
                        
                <li>
                    <a href="#61-%e5%94%a4%e9%86%92%e9%80%bb%e8%be%91" aria-label="6.1. 唤醒逻辑">6.1. 唤醒逻辑</a><ul>
                        
                <li>
                    <a href="#611-%e4%bb%a3%e7%a0%81%e6%b5%81%e7%a8%8b" aria-label="6.1.1. 代码流程">6.1.1. 代码流程</a><ul>
                        
                <li>
                    <a href="#6111-%e5%85%a5%e5%8f%a3%e5%ae%9a%e4%b9%89" aria-label="6.1.1.1. 入口定义">6.1.1.1. 入口定义</a></li>
                <li>
                    <a href="#6112-%e5%94%a4%e9%86%92%e5%90%8e%e9%80%bb%e8%be%91" aria-label="6.1.1.2. .唤醒后逻辑">6.1.1.2. .唤醒后逻辑</a></li>
                <li>
                    <a href="#6113-%e6%8b%be%e9%9f%b3%e6%b5%81%e7%a8%8b%e5%85%bc%e5%ae%b9%e5%a4%96%e5%a3%b3%e5%94%a4%e9%86%92" aria-label="6.1.1.3. 拾音流程，兼容外壳唤醒">6.1.1.3. 拾音流程，兼容外壳唤醒</a></li></ul>
                </li>
                <li>
                    <a href="#612-%e5%94%a4%e9%86%92%e5%a4%b1%e6%95%88" aria-label="6.1.2. 唤醒失效">6.1.2. 唤醒失效</a></li>
                <li>
                    <a href="#613-%e5%94%a4%e9%86%92%e6%89%93%e6%96%ad" aria-label="6.1.3. 唤醒打断">6.1.3. 唤醒打断</a></li></ul>
                </li>
                <li>
                    <a href="#62-%e5%bf%ab%e6%8d%b7%e6%8f%90%e9%97%ae" aria-label="6.2. 快捷提问">6.2. 快捷提问</a><ul>
                        
                <li>
                    <a href="#621-1%e5%b1%95%e7%a4%ba%e5%bd%a2%e5%bc%8f" aria-label="6.2.1. 1.展示形式">6.2.1. 1.展示形式</a><ul>
                        
                <li>
                    <a href="#6211-%e4%bd%bf%e7%94%a8%e6%8a%80%e6%9c%af" aria-label="6.2.1.1. 使用技术">6.2.1.1. 使用技术</a></li></ul>
                </li>
                <li>
                    <a href="#622-2%e4%ba%a4%e4%ba%92%e8%83%bd%e5%8a%9b" aria-label="6.2.2. 2.交互能力">6.2.2. 2.交互能力</a></li></ul>
                </li>
                <li>
                    <a href="#63-%e5%8a%9f%e8%83%bd%e9%a1%b5" aria-label="6.3. 功能页">6.3. 功能页</a><ul>
                        
                <li>
                    <a href="#631-%e7%89%b9%e6%ae%8a%e5%a4%84%e7%90%86" aria-label="6.3.1. 特殊处理">6.3.1. 特殊处理</a></li>
                <li>
                    <a href="#632-%e5%95%86%e5%93%81%e6%9f%a5%e8%af%a2" aria-label="6.3.2. 商品查询">6.3.2. 商品查询</a></li>
                <li>
                    <a href="#633-%e6%b6%88%e8%b4%b9%e6%b5%81%e7%a8%8b" aria-label="6.3.3. 消费流程">6.3.3. 消费流程</a></li>
                <li>
                    <a href="#634-%e5%93%81%e7%89%8c%e5%ae%a3%e4%bc%a0" aria-label="6.3.4. 品牌宣传">6.3.4. 品牌宣传</a></li></ul>
                </li>
                <li>
                    <a href="#64-%e8%99%9a%e6%8b%9f%e4%ba%ba%e4%ba%a4%e4%ba%92" aria-label="6.4. 虚拟人交互">6.4. 虚拟人交互</a>
                </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><ol>
<li></li>
</ol>
<ul>
<li>1<a href="/posts/wiki/%E5%B1%8F%E7%AB%AF%E8%99%9A%E6%8B%9F%E4%BA%BA%E5%8A%9F%E8%83%BD%E8%AE%BE%E8%AE%A1/#id-屏端虚拟人功能设计-">1.</a></li>
<li>2<a href="/posts/wiki/%E5%B1%8F%E7%AB%AF%E8%99%9A%E6%8B%9F%E4%BA%BA%E5%8A%9F%E8%83%BD%E8%AE%BE%E8%AE%A1/#id-屏端虚拟人功能设计-引言">2. 引言</a>
<ul>
<li>2.1<a href="/posts/wiki/%E5%B1%8F%E7%AB%AF%E8%99%9A%E6%8B%9F%E4%BA%BA%E5%8A%9F%E8%83%BD%E8%AE%BE%E8%AE%A1/#id-屏端虚拟人功能设计-背景">2.1. 背景</a></li>
<li>2.2<a href="/posts/wiki/%E5%B1%8F%E7%AB%AF%E8%99%9A%E6%8B%9F%E4%BA%BA%E5%8A%9F%E8%83%BD%E8%AE%BE%E8%AE%A1/#id-屏端虚拟人功能设计-目标">2.2. 目标</a></li>
<li>2.3<a href="/posts/wiki/%E5%B1%8F%E7%AB%AF%E8%99%9A%E6%8B%9F%E4%BA%BA%E5%8A%9F%E8%83%BD%E8%AE%BE%E8%AE%A1/#id-屏端虚拟人功能设计-相关资料">2.3. 相关资料</a>
<ul>
<li>2.3.1<a href="/posts/wiki/%E5%B1%8F%E7%AB%AF%E8%99%9A%E6%8B%9F%E4%BA%BA%E5%8A%9F%E8%83%BD%E8%AE%BE%E8%AE%A1/#id-屏端虚拟人功能设计-接口文档">2.3.1. 接口文档</a></li>
</ul>
</li>
</ul>
</li>
<li>3<a href="/posts/wiki/%E5%B1%8F%E7%AB%AF%E8%99%9A%E6%8B%9F%E4%BA%BA%E5%8A%9F%E8%83%BD%E8%AE%BE%E8%AE%A1/#id-屏端虚拟人功能设计-总体设计">3. 总体设计</a>
<ul>
<li>3.1<a href="/posts/wiki/%E5%B1%8F%E7%AB%AF%E8%99%9A%E6%8B%9F%E4%BA%BA%E5%8A%9F%E8%83%BD%E8%AE%BE%E8%AE%A1/#id-屏端虚拟人功能设计-运行环境">3.1. 运行环境</a></li>
<li>3.2<a href="/posts/wiki/%E5%B1%8F%E7%AB%AF%E8%99%9A%E6%8B%9F%E4%BA%BA%E5%8A%9F%E8%83%BD%E8%AE%BE%E8%AE%A1/#id-屏端虚拟人功能设计-技术栈选型">3.2. 技术栈选型</a></li>
</ul>
</li>
<li>4<a href="/posts/wiki/%E5%B1%8F%E7%AB%AF%E8%99%9A%E6%8B%9F%E4%BA%BA%E5%8A%9F%E8%83%BD%E8%AE%BE%E8%AE%A1/#id-屏端虚拟人功能设计-功能设计">4. 功能设计</a>
<ul>
<li>4.1<a href="/posts/wiki/%E5%B1%8F%E7%AB%AF%E8%99%9A%E6%8B%9F%E4%BA%BA%E5%8A%9F%E8%83%BD%E8%AE%BE%E8%AE%A1/#id-屏端虚拟人功能设计-虚拟人引入">4.1. 虚拟人引入</a>
<ul>
<li>4.1.1<a href="/posts/wiki/%E5%B1%8F%E7%AB%AF%E8%99%9A%E6%8B%9F%E4%BA%BA%E5%8A%9F%E8%83%BD%E8%AE%BE%E8%AE%A1/#id-屏端虚拟人功能设计-引入第三方sdk">4.1.1. 引入第三方sdk</a></li>
<li>4.1.2<a href="/posts/wiki/%E5%B1%8F%E7%AB%AF%E8%99%9A%E6%8B%9F%E4%BA%BA%E5%8A%9F%E8%83%BD%E8%AE%BE%E8%AE%A1/#id-屏端虚拟人功能设计-资源文件">4.1.2. 资源文件</a></li>
<li>4.1.3<a href="/posts/wiki/%E5%B1%8F%E7%AB%AF%E8%99%9A%E6%8B%9F%E4%BA%BA%E5%8A%9F%E8%83%BD%E8%AE%BE%E8%AE%A1/#id-屏端虚拟人功能设计-初始化虚拟人实例">4.1.3. 初始化虚拟人实例</a></li>
<li>4.1.4<a href="/posts/wiki/%E5%B1%8F%E7%AB%AF%E8%99%9A%E6%8B%9F%E4%BA%BA%E5%8A%9F%E8%83%BD%E8%AE%BE%E8%AE%A1/#id-屏端虚拟人功能设计-其他初始化">4.1.4.  其他初始化</a>
<ul>
<li>4.1.4.1<a href="/posts/wiki/%E5%B1%8F%E7%AB%AF%E8%99%9A%E6%8B%9F%E4%BA%BA%E5%8A%9F%E8%83%BD%E8%AE%BE%E8%AE%A1/#id-屏端虚拟人功能设计-FTT虚拟人切换，">4.1.4.1. FTT虚拟人切换，</a></li>
</ul>
</li>
</ul>
</li>
<li>4.2<a href="/posts/wiki/%E5%B1%8F%E7%AB%AF%E8%99%9A%E6%8B%9F%E4%BA%BA%E5%8A%9F%E8%83%BD%E8%AE%BE%E8%AE%A1/#id-屏端虚拟人功能设计-语音识别交互">4.2. 语音识别交互</a>
<ul>
<li>4.2.1<a href="/posts/wiki/%E5%B1%8F%E7%AB%AF%E8%99%9A%E6%8B%9F%E4%BA%BA%E5%8A%9F%E8%83%BD%E8%AE%BE%E8%AE%A1/#id-屏端虚拟人功能设计-辅助工具">4.2.1.  辅助工具</a></li>
</ul>
</li>
</ul>
</li>
<li>5<a href="/posts/wiki/%E5%B1%8F%E7%AB%AF%E8%99%9A%E6%8B%9F%E4%BA%BA%E5%8A%9F%E8%83%BD%E8%AE%BE%E8%AE%A1/#id-屏端虚拟人功能设计-本地调试">5. 本地调试</a>
<ul>
<li>5.1<a href="/posts/wiki/%E5%B1%8F%E7%AB%AF%E8%99%9A%E6%8B%9F%E4%BA%BA%E5%8A%9F%E8%83%BD%E8%AE%BE%E8%AE%A1/#id-屏端虚拟人功能设计-跨域">5.1. 跨域</a></li>
<li>5.2<a href="/posts/wiki/%E5%B1%8F%E7%AB%AF%E8%99%9A%E6%8B%9F%E4%BA%BA%E5%8A%9F%E8%83%BD%E8%AE%BE%E8%AE%A1/#id-屏端虚拟人功能设计-调试录音接口">5.2. 调试录音接口</a></li>
</ul>
</li>
<li>6<a href="/posts/wiki/%E5%B1%8F%E7%AB%AF%E8%99%9A%E6%8B%9F%E4%BA%BA%E5%8A%9F%E8%83%BD%E8%AE%BE%E8%AE%A1/#id-屏端虚拟人功能设计-业务功能">6. 业务功能</a>
<ul>
<li>6.1<a href="/posts/wiki/%E5%B1%8F%E7%AB%AF%E8%99%9A%E6%8B%9F%E4%BA%BA%E5%8A%9F%E8%83%BD%E8%AE%BE%E8%AE%A1/#id-屏端虚拟人功能设计-唤醒逻辑">6.1. 唤醒逻辑</a>
<ul>
<li>6.1.1<a href="/posts/wiki/%E5%B1%8F%E7%AB%AF%E8%99%9A%E6%8B%9F%E4%BA%BA%E5%8A%9F%E8%83%BD%E8%AE%BE%E8%AE%A1/#id-屏端虚拟人功能设计-代码流程">6.1.1. 代码流程</a>
<ul>
<li>6.1.1.1<a href="/posts/wiki/%E5%B1%8F%E7%AB%AF%E8%99%9A%E6%8B%9F%E4%BA%BA%E5%8A%9F%E8%83%BD%E8%AE%BE%E8%AE%A1/#id-屏端虚拟人功能设计-入口定义">6.1.1.1. 入口定义</a></li>
<li>6.1.1.2<a href="/posts/wiki/%E5%B1%8F%E7%AB%AF%E8%99%9A%E6%8B%9F%E4%BA%BA%E5%8A%9F%E8%83%BD%E8%AE%BE%E8%AE%A1/#id-屏端虚拟人功能设计-.唤醒后逻辑">6.1.1.2. .唤醒后逻辑</a></li>
<li>6.1.1.3<a href="/posts/wiki/%E5%B1%8F%E7%AB%AF%E8%99%9A%E6%8B%9F%E4%BA%BA%E5%8A%9F%E8%83%BD%E8%AE%BE%E8%AE%A1/#id-屏端虚拟人功能设计-拾音流程，兼容外壳唤醒">6.1.1.3. 拾音流程，兼容外壳唤醒</a></li>
</ul>
</li>
<li>6.1.2<a href="/posts/wiki/%E5%B1%8F%E7%AB%AF%E8%99%9A%E6%8B%9F%E4%BA%BA%E5%8A%9F%E8%83%BD%E8%AE%BE%E8%AE%A1/#id-屏端虚拟人功能设计-唤醒失效">6.1.2. 唤醒失效</a></li>
<li>6.1.3<a href="/posts/wiki/%E5%B1%8F%E7%AB%AF%E8%99%9A%E6%8B%9F%E4%BA%BA%E5%8A%9F%E8%83%BD%E8%AE%BE%E8%AE%A1/#id-屏端虚拟人功能设计-唤醒打断">6.1.3. 唤醒打断</a></li>
</ul>
</li>
<li>6.2<a href="/posts/wiki/%E5%B1%8F%E7%AB%AF%E8%99%9A%E6%8B%9F%E4%BA%BA%E5%8A%9F%E8%83%BD%E8%AE%BE%E8%AE%A1/#id-屏端虚拟人功能设计-快捷提问">6.2. 快捷提问</a>
<ul>
<li>6.2.1<a href="/posts/wiki/%E5%B1%8F%E7%AB%AF%E8%99%9A%E6%8B%9F%E4%BA%BA%E5%8A%9F%E8%83%BD%E8%AE%BE%E8%AE%A1/#id-屏端虚拟人功能设计-1.展示形式">6.2.1. 1.展示形式</a>
<ul>
<li>6.2.1.1<a href="/posts/wiki/%E5%B1%8F%E7%AB%AF%E8%99%9A%E6%8B%9F%E4%BA%BA%E5%8A%9F%E8%83%BD%E8%AE%BE%E8%AE%A1/#id-屏端虚拟人功能设计-使用技术">6.2.1.1. 使用技术</a></li>
</ul>
</li>
<li>6.2.2<a href="/posts/wiki/%E5%B1%8F%E7%AB%AF%E8%99%9A%E6%8B%9F%E4%BA%BA%E5%8A%9F%E8%83%BD%E8%AE%BE%E8%AE%A1/#id-屏端虚拟人功能设计-2.交互能力">6.2.2. 2.交互能力</a></li>
</ul>
</li>
<li>6.3<a href="/posts/wiki/%E5%B1%8F%E7%AB%AF%E8%99%9A%E6%8B%9F%E4%BA%BA%E5%8A%9F%E8%83%BD%E8%AE%BE%E8%AE%A1/#id-屏端虚拟人功能设计-功能页">6.3. 功能页</a>
<ul>
<li>6.3.1<a href="/posts/wiki/%E5%B1%8F%E7%AB%AF%E8%99%9A%E6%8B%9F%E4%BA%BA%E5%8A%9F%E8%83%BD%E8%AE%BE%E8%AE%A1/#id-屏端虚拟人功能设计-特殊处理">6.3.1. 特殊处理</a></li>
<li>6.3.2<a href="/posts/wiki/%E5%B1%8F%E7%AB%AF%E8%99%9A%E6%8B%9F%E4%BA%BA%E5%8A%9F%E8%83%BD%E8%AE%BE%E8%AE%A1/#id-屏端虚拟人功能设计-商品查询">6.3.2. 商品查询</a></li>
<li>6.3.3<a href="/posts/wiki/%E5%B1%8F%E7%AB%AF%E8%99%9A%E6%8B%9F%E4%BA%BA%E5%8A%9F%E8%83%BD%E8%AE%BE%E8%AE%A1/#id-屏端虚拟人功能设计-消费流程">6.3.3. 消费流程</a></li>
<li>6.3.4<a href="/posts/wiki/%E5%B1%8F%E7%AB%AF%E8%99%9A%E6%8B%9F%E4%BA%BA%E5%8A%9F%E8%83%BD%E8%AE%BE%E8%AE%A1/#id-屏端虚拟人功能设计-品牌宣传">6.3.4. 品牌宣传</a></li>
</ul>
</li>
<li>6.4<a href="/posts/wiki/%E5%B1%8F%E7%AB%AF%E8%99%9A%E6%8B%9F%E4%BA%BA%E5%8A%9F%E8%83%BD%E8%AE%BE%E8%AE%A1/#id-屏端虚拟人功能设计-虚拟人交互">6.4. 虚拟人交互</a></li>
</ul>
</li>
</ul>
<p>============================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================</p>
<h1 id="2-引言">2. 引言<a hidden class="anchor" aria-hidden="true" href="#2-引言">#</a></h1>
<h2 id="21-背景">2.1. 背景<a hidden class="anchor" aria-hidden="true" href="#21-背景">#</a></h2>
<p>        在食品互联网产品能力与万得厨硬件能力结合打造的软硬件一体化的产品发展比较健全成熟的情况下，为了更好的打造产品的核心竞争力，给用户更完整全面的使用体验，同时也为了放大产业的价值，所以需要借助AI产品的能力，于是就提出了虚拟数字人与万得厨深入结合走整合社会化资源的影子虚拟数字人的产业建设逻辑，并结合“敬老、爱幼、助残”的整体产品、运营战略思想，产品定位为是运行在万得厨设备和万得厨APP上的智能专享厨师，让人人都有专享厨师，赋能集团整个C盘，实现&quot;人人为我，我为人人“的核心理念。</p>
<p>       在大数据、云计算、算法等核心技术都发展的比较成熟的环境下，各行各业对于虚拟数字人的投入也越来越大，未来已来，AI互联网的气息已经无处不在，也已经演化成了基础层、平台层、应用层的生态环境，所以有足够多的能力支持我们做虚拟数字人这件事情，当然我们的定位也很清晰，我们专注在厨房领域，用虚拟人赋能万得厨打造智能厨房，实现智能烹饪、精准推荐、营养搭配等核心能力。</p>
<p>       站在全局视角和长远规划来看，我们要做的是能力交易平台，人人都可以发布能力上去，人人都可以订阅其他人的能力，所以我们需要打造平台管理运营后台、服务商运营管理后台等去更好的连接生产端、消费端加入到生态中来，一起支撑虚拟人平台的建设。</p>
<h2 id="22-目标">2.2. 目标<a hidden class="anchor" aria-hidden="true" href="#22-目标">#</a></h2>
<p>自助食堂数字员工的身份主要是：导购员+服务员，除了拥有助手身份的所有功能之外，还拥有以下一些与场景相关的特殊功能：</p>
<p>1、门店消费流程介绍</p>
<p>2、门店商品位置查询</p>
<p>3、门店近期特价优惠</p>
<p>4、门店设备闲忙情况</p>
<h2 id="23-相关资料">2.3. 相关资料<a hidden class="anchor" aria-hidden="true" href="#23-相关资料">#</a></h2>
<p>名称</p>
<p>链</p>
<p>名称</p>
<p>链</p>
<h3 id="231-接口文档">2.3.1. 接口文档<a hidden class="anchor" aria-hidden="true" href="#231-接口文档">#</a></h3>
<p><a href="https://yingzi-appservice-osc.dev.yingzi.com/api/appservice/osc/swagger-ui.html#/OC%E8%BF%90%E8%90%A5-%E7%BD%91%E7%82%B9%E5%95%86%E5%93%81Api/listOfflineStoreCommodityForOcUsingGET">https://yingzi-appservice-osc.dev.yingzi.com/api/appservice/osc/swagger-ui.html#/OC%E8%BF%90%E8%90%A5-%E7%BD%91%E7%82%B9%E5%95%86%E5%93%81Api/listOfflineStoreCommodityForOcUsingGET</a></p>
<h1 id="3-总体设计">3. 总体设计<a hidden class="anchor" aria-hidden="true" href="#3-总体设计">#</a></h1>
<h2 id="31-运行环境">3.1. 运行环境<a hidden class="anchor" aria-hidden="true" href="#31-运行环境">#</a></h2>
<p>平台</p>
<p>大屏端app</p>
<p>访问地址</p>
<p>开发环境（<a href="https://vdh-screen.dev.yingzi.com/">https://vdh-screen.dev.yingzi.com/</a>）</p>
<p>测试环境（<a href="https://vdh-screen.dev.yingzi.com/">https://vdh-screen.test.yingzi.com/</a>）</p>
<p>访问方式</p>
<p>app嵌套浏览器</p>
<p>账号体系</p>
<h2 id="32-技术栈选型">3.2. 技术栈选型<a hidden class="anchor" aria-hidden="true" href="#32-技术栈选型">#</a></h2>
<p>整体框架</p>
<p>vite生成vue技术栈</p>
<p>视图层</p>
<p>vue3</p>
<p>包管理工具</p>
<p>yarn</p>
<p>接口规范</p>
<p>restful api</p>
<p>核心sdk</p>
<p>第三方虚拟人公司提供的sdk</p>
<p>重要工具库</p>
<p>vueuse、rxjs、swiper</p>
<h1 id="4-功能设计">4. 功能设计<a hidden class="anchor" aria-hidden="true" href="#4-功能设计">#</a></h1>
<h2 id="41-虚拟人引入">4.1. 虚拟人引入<a hidden class="anchor" aria-hidden="true" href="#41-虚拟人引入">#</a></h2>
<h3 id="411-引入第三方sdk">4.1.1. 引入第三方sdk<a hidden class="anchor" aria-hidden="true" href="#411-引入第三方sdk">#</a></h3>
<p>import { Avatar } from &lsquo;./haihuman&rsquo;</p>
<h3 id="412-资源文件">4.1.2. 资源文件<a hidden class="anchor" aria-hidden="true" href="#412-资源文件">#</a></h3>
<p>放置项目根目录</p>
<p>wasm</p>
<p>haicore_sdk.wasm</p>
<p>json</p>
<p>sk.json, behav.json</p>
<h3 id="413-初始化虚拟人实例">4.1.3. 初始化虚拟人实例<a hidden class="anchor" aria-hidden="true" href="#413-初始化虚拟人实例">#</a></h3>
<p>实例化逻辑</p>
<p><strong>init</strong></p>
<p><a href="/">?</a></p>
<p>1</p>
<p>2</p>
<p>3</p>
<p>4</p>
<p>5</p>
<p>6</p>
<p>7</p>
<p><code>const a =</code> <code>new</code> <code>Avatar(your_avatar_id,</code> <code>'v1.0'``, avatarModel, containerId,</code> <code>''``, {</code></p>
<p>  <code>locale:</code> <code>'cn'``,</code></p>
<p><code>})</code></p>
<p><code>a.init({</code></p>
<p>    <code>// onProgress, onReady, onRender, onChat...具体看文档或源码</code></p>
<p><code>})</code></p>
<p>your_avatar_id：在<a href="https://vdh-open.yingzi.com/userSpace/application/appList">FTT我的应用</a>里点击相应虚拟人的查看按钮，即可查看avatarId</p>
<p>avatarModel: 虚拟人模型文件名，在<a href="https://vdh-open.yingzi.com/userSpace/virtual/resource_management">FTT【资源母版 &gt; 虚拟人母版】</a>，记得加上&quot;.glb&quot;后缀</p>
<p><img loading="lazy" src="/download/attachments/109731880/image2023-6-30_14-38-10.png?version=1&amp;modificationDate=1698909241976&amp;api=v2" alt=""  />
</p>
<p>containerId: 容纳虚拟人的html标签的id</p>
<h3 id="414-其他初始化">4.1.4.  其他初始化<a hidden class="anchor" aria-hidden="true" href="#414-其他初始化">#</a></h3>
<h4 id="4141-ftt虚拟人切换">4.1.4.1. FTT虚拟人切换，<a hidden class="anchor" aria-hidden="true" href="#4141-ftt虚拟人切换">#</a></h4>
<p>分<strong>测试环境</strong>和<strong>生产环境</strong>，区别是api和虚拟人id不同，在代码执行比较早的阶段定义好一个全局变量，决定取的是哪个环境的虚拟人</p>
<p><img loading="lazy" src="/download/attachments/109731880/image2023-12-1_14-42-2.png?version=1&amp;modificationDate=1701412923050&amp;api=v2" alt=""  />
</p>
<p>通过拦截fetch改变url</p>
<p><a href="/">?</a></p>
<p><code>window.fetch = (...args) =&gt; {</code></p>
<p>  <code>if</code> <code>(window.fttEnv ===</code> <code>'test'``) {</code></p>
<p>    <code>if</code> <code>(``typeof</code> <code>args[0] ===</code> <code>'string'``) {</code></p>
<p>      <code>args[0] = args[0].replace(``'[https://vdh-api.yingzi.com](https://vdh-api.yingzi.com)'``,</code> <code>'[https://vdh-api.test.yingzi.com](https://vdh-api.test.yingzi.com)'``)</code></p>
<p>    <code>}</code></p>
<p>  <code>}</code></p>
<p>  <code>return</code> <code>Promise.resolve(oldfetch(...args));</code></p>
<p><code>};</code></p>
<h2 id="42-语音识别交互">4.2. 语音识别交互<a hidden class="anchor" aria-hidden="true" href="#42-语音识别交互">#</a></h2>
<ol>
<li>浏览器环境：引用影子封装的基础能力@yingzi/STT-Core</li>
<li>屏端环境：安卓容器唤醒和识别发送通知</li>
</ol>
<h3 id="421-辅助工具">4.2.1.  辅助工具<a hidden class="anchor" aria-hidden="true" href="#421-辅助工具">#</a></h3>
<p>影子内部集成讯飞语音识别的库</p>
<h1 id="5-本地调试">5. 本地调试<a hidden class="anchor" aria-hidden="true" href="#5-本地调试">#</a></h1>
<h2 id="51-跨域">5.1. 跨域<a hidden class="anchor" aria-hidden="true" href="#51-跨域">#</a></h2>
<p>有第三方的资源由sdk调用获取，需要host文件添加下面一行</p>
<p>自己的ip <a href="http://local-test.yingzi.com">local-test.yingzi.com</a></p>
<p>然后用<a href="http://local-test.yingzi.com">local-test.yingzi.com</a>来调试</p>
<h2 id="52-调试录音接口">5.2. 调试录音接口<a hidden class="anchor" aria-hidden="true" href="#52-调试录音接口">#</a></h2>
<p>因为是用<strong>navigator.mediaDevices</strong>,而这个api有安全策略，只能在以下情况下使用，不然undefined</p>
<ol>
<li>https</li>
<li>llocalhost/127.0.0.1</li>
<li>file///url</li>
</ol>
<p>由于上面已经用了<a href="http://local-test.yingzi.com">local-test.yingzi.com</a>调试，而且默认vite启动是http，所以需要配置启用https</p>
<h1 id="6-业务功能">6. 业务功能<a hidden class="anchor" aria-hidden="true" href="#6-业务功能">#</a></h1>
<h2 id="61-唤醒逻辑">6.1. 唤醒逻辑<a hidden class="anchor" aria-hidden="true" href="#61-唤醒逻辑">#</a></h2>
<p>由于浏览器不具备唤醒功能，这部分只能依赖app，主要由宿主app收到唤醒指令后调用浏览器的自定义方法，步骤主要是以下</p>
<h3 id="611-代码流程">6.1.1. 代码流程<a hidden class="anchor" aria-hidden="true" href="#611-代码流程">#</a></h3>
<h4 id="6111-入口定义">6.1.1.1. 入口定义<a hidden class="anchor" aria-hidden="true" href="#6111-入口定义">#</a></h4>
<p>暴露到window，给宿主调用，调用document的自定义方法</p>
<p><a href="/">?</a></p>
<p><code>window.onYzevent = (data) =&gt; {</code></p>
<p>  <code>document.dispatchEvent(</code></p>
<p>    <code>new</code> <code>CustomEvent(``&quot;onYzevent&quot;``, {</code></p>
<p>      <code>detail: () =&gt; {</code></p>
<p>        <code>status.value =</code> <code>&quot;listening&quot;``;</code></p>
<p>      <code>},</code></p>
<p>    <code>})</code></p>
<p>  <code>);</code></p>
<p><code>};</code></p>
<h4 id="6112-唤醒后逻辑">6.1.1.2. .唤醒后逻辑<a hidden class="anchor" aria-hidden="true" href="#6112-唤醒后逻辑">#</a></h4>
<p>在你所需唤醒的地方加上</p>
<p><a href="/">?</a></p>
<p><code>document.addEventListener(``&quot;onYzevent&quot;``, async (e) =&gt; {</code></p>
<p>    <code>e.detail?.()</code></p>
<p>    <code>// 业务逻辑...</code></p>
<p><code>})</code></p>
<h4 id="6113-拾音流程兼容外壳唤醒">6.1.1.3. 拾音流程，兼容外壳唤醒<a hidden class="anchor" aria-hidden="true" href="#6113-拾音流程兼容外壳唤醒">#</a></h4>
<p>安卓外壳</p>
<p>window.onYzevent(obj)</p>
<p>wakeUp</p>
<p>speechResult</p>
<p>window.android?.starAsr()</p>
<p>10秒还是没识别到</p>
<p>识别到text</p>
<p><img loading="lazy" src="data:image/svg&#43;xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0Ij48cGF0aCBkPSJNMjEuOTkgNGMwLTEuMS0uODktMi0xLjk5LTJINGMtMS4xIDAtMiAuOS0yIDJ2MTJjMCAxLjEuOSAyIDIgMmgxNGw0IDQtLjAxLTE4ek0xOCAxNEg2di0yaDEydjJ6bTAtM0g2VjloMTJ2MnptMC0zSDZWNmgxMnYyeiIvPjxwYXRoIGQ9Ik0wIDBoMjR2MjRIMHoiIGZpbGw9Im5vbmUiLz48L3N2Zz4=" alt=""  title="显示评论"  />
</p>
<p>//&lt;![CDATA[ (function() { $ = AJS.$; var graphContainer = document.getElementById(&lsquo;drawio-macro-content-02867ae0-60e8-4f92-b4d5-dcd409ffc447&rsquo;); DrawioProperties = { contextPath : AJS.contextPath(), buildNumber : 8401 }; var readerOpts = {}; readerOpts.loadUrl = &rsquo;&rsquo; + &lsquo;/rest/drawio/1.0/diagram/crud/%6F%6E%59%7A%65%76%65%6E%74/109731880?revision=1&rsquo;; readerOpts.imageUrl = &rsquo;&rsquo; + &lsquo;/download/attachments/109731880/onYzevent.png&rsquo; + &lsquo;?version=1&amp;api=v2&rsquo;; readerOpts.editUrl = &rsquo;&rsquo; + &lsquo;/plugins/drawio/addDiagram.action?ceoId=109731880&amp;owningPageId=109731880&amp;diagramName=%6F%6E%59%7A%65%76%65%6E%74&amp;revision=1&rsquo;; readerOpts.editable = true; readerOpts.canComment = true; readerOpts.stylePath = STYLE_PATH; readerOpts.stencilPath = STENCIL_PATH; readerOpts.imagePath = IMAGE_PATH + &lsquo;/reader&rsquo;; readerOpts.border = true; readerOpts.width = &lsquo;400&rsquo;; readerOpts.simpleViewer = false; readerOpts.tbstyle = &rsquo;top&rsquo;; readerOpts.links = &lsquo;auto&rsquo;; readerOpts.lightbox = true; readerOpts.resourcePath = ATLAS_RESOURCE_BASE + &lsquo;/resources/viewer&rsquo;; readerOpts.disableButtons = false; readerOpts.zoomToFit = true; readerOpts.language = &lsquo;zh&rsquo;; readerOpts.licenseStatus = &lsquo;OK&rsquo;; readerOpts.contextPath = AJS.contextPath(); readerOpts.diagramName = decodeURIComponent(&rsquo;%6F%6E%59%7A%65%76%65%6E%74&rsquo;); readerOpts.diagramDisplayName = &lsquo;&rsquo;; readerOpts.aspect = &lsquo;&rsquo;; readerOpts.ceoName = &lsquo;屏端虚拟人功能设计&rsquo;; readerOpts.attVer = &lsquo;1&rsquo;; readerOpts.attId = &lsquo;114666883&rsquo;; readerOpts.lastModifierName = &lsquo;吴家杰&rsquo;; readerOpts.lastModified = &lsquo;2023-12-01 11:21:32.634&rsquo;; readerOpts.creatorName = &lsquo;吴家杰&rsquo;; //Embed macro specific info readerOpts.extSrvIntegType = &lsquo;$extSrvIntegType&rsquo;; readerOpts.gClientId = &lsquo;$gClientId&rsquo;; readerOpts.oClientId = &lsquo;$oClientId&rsquo;; readerOpts.service = &lsquo;$service&rsquo;; readerOpts.sFileId = &lsquo;$sFileId&rsquo;; readerOpts.odriveId = &lsquo;$odriveId&rsquo;; readerOpts.diagramUrl = &lsquo;$diagramUrl&rsquo;; readerOpts.csvFileUrl = &lsquo;$csvFileUrl&rsquo;; readerOpts.pageId = &lsquo;$pageId&rsquo; || Confluence.getContentId(); readerOpts.aspectHash = &lsquo;$aspectHash&rsquo;; readerOpts.useExternalImageService = &lsquo;$useExternalImageService&rsquo; == &rsquo;true&rsquo;; readerOpts.isTemplate = &lsquo;$isTemplate&rsquo; == &rsquo;true&rsquo;; if (readerOpts.width == &lsquo;&rsquo;) { readerOpts.width = null; } // LATER: Check if delayed loading of resources can be used for image placeholder mode var viewerPromise = createViewer(graphContainer, readerOpts); if(readerOpts.editable) { $(graphContainer).data(&lsquo;viewerConfig&rsquo;, readerOpts); $(graphContainer).on(&lsquo;drawioViewerUpdate&rsquo;, updateDrawioViewer); } viewerPromise.done(function(viewer) { updateCachedDiagram(graphContainer, readerOpts, viewer); }); })(); //]]&gt;</p>
<p>暴露接口如下👇</p>
<p><a href="/pages/viewpage.action?pageId=114659651">屏端android和web交互接口</a></p>
<h3 id="612-唤醒失效">6.1.2. 唤醒失效<a hidden class="anchor" aria-hidden="true" href="#612-唤醒失效">#</a></h3>
<p>语音识别的内容一直为空，在12s左右，基于websocket的识别过程将被服务端主动断开，产品希望时间延长，所以第一次断开后客户端这边主动重连一次，虚拟人播报“小万没听清，请您再说一次”，第二次断开后展示恢复欢迎语</p>
<h3 id="613-唤醒打断">6.1.3. 唤醒打断<a hidden class="anchor" aria-hidden="true" href="#613-唤醒打断">#</a></h3>
<ul>
<li>语音识别中不能唤醒，客户端拦截唤醒后的操作</li>
<li>待机中、思考中、朗读中都可以唤醒，重新进入语音识别阶段</li>
</ul>
<h2 id="62-快捷提问">6.2. 快捷提问<a hidden class="anchor" aria-hidden="true" href="#62-快捷提问">#</a></h2>
<h3 id="621-1展示形式">6.2.1. 1.展示形式<a hidden class="anchor" aria-hidden="true" href="#621-1展示形式">#</a></h3>
<p>barrage: 弹幕模式</p>
<p>grid: 方格模式</p>
<h4 id="6211-使用技术">6.2.1.1. 使用技术<a hidden class="anchor" aria-hidden="true" href="#6211-使用技术">#</a></h4>
<p><strong>主页利用vueuse的useAnimate做弹幕横向移动的效果，同时是循环播放</strong></p>
<ul>
<li>将内容分行</li>
<li>将每行内容复制一次添加到尾端</li>
<li>keyframes = [<br>
{ transform: &ldquo;translateX(0)&rdquo; },<br>
{ transform: &ldquo;translateX(-50%)&rdquo; },<br>
]</li>
</ul>
<p><strong>功能页使用</strong></p>
<p>定时器转换，6个6个定时转换，不足的尾部拼接头部</p>
<h3 id="622-2交互能力">6.2.2. 2.交互能力<a hidden class="anchor" aria-hidden="true" href="#622-2交互能力">#</a></h3>
<p>除在思考中(nlp)过程中其他任何情况都能点击，直接调用给虚拟人做nlp</p>
<h2 id="63-功能页">6.3. 功能页<a hidden class="anchor" aria-hidden="true" href="#63-功能页">#</a></h2>
<p>因为主页和其他功能页之间切换需要耗时，这里功能页封装成一个大的组件，根据条件判断在主页来显示，做到一个应用一个虚拟人</p>
<h3 id="631-特殊处理">6.3.1. 特殊处理<a hidden class="anchor" aria-hidden="true" href="#631-特殊处理">#</a></h3>
<ul>
<li>在所有功能页，nlp提交文本都默认带上上下文，提高当前场景下的指令命中率，假如命中失败，不播报失败话术，直接去掉上下文再一次nlp提交</li>
</ul>
<h3 id="632-商品查询">6.3.2. 商品查询<a hidden class="anchor" aria-hidden="true" href="#632-商品查询">#</a></h3>
<ul>
<li>前端一次拉取所有商品，方便做搜索和排序</li>
<li>根据条件排序时重新拉一次接口</li>
<li>根据指令返回话术，判断是否追问，播放追问话术，继续追问后，负反馈后前端播放失败话术，正反馈后前端播放成功话术，然后前端定位到商品那一页</li>
</ul>
<h3 id="633-消费流程">6.3.3. 消费流程<a hidden class="anchor" aria-hidden="true" href="#633-消费流程">#</a></h3>
<ol>
<li>
<p>几个流程步骤的内容从字典拉取</p>
</li>
<li>
<p>自动从头开始播报时，需要播报当前内容时Swiper的页面滑到当前页面，改造以前的talk方法，将talk返回promise格式，回调后触发resolve</p>
<p>使用效果</p>
<p><a href="/">?</a></p>
<p><code>/**</code></p>
<p> <code>*</code></p>
<p> <code>* @param {() =&gt; void} callback 完整读完回调</code></p>
<p> <code>* @param {() =&gt; void} unitCallback 每步准备开始读的回调</code></p>
<p> <code>*/</code></p>
<p><code>talkAll: async (callback, unitCallback) =&gt; {</code></p>
<p>  <code>const</code> <code>talk = async (text, c) =&gt; {</code></p>
<p>    <code>return</code> <code>await avatar.talk(text,</code> <code>&quot;read&quot;``,</code> <code>false``, callback,</code> <code>void</code> <code>0``, () =&gt; {</code></p>
<p>      <code>console.log(``&quot;du&quot;``, text);</code></p>
<p>      <code>unitCallback();</code></p>
<p>      <code>c?.();</code></p>
<p>    <code>});</code></p>
<p>  <code>};</code></p>
<p>  <code>async function run() {</code></p>
<p>    <code>let i =</code> <code>0</code></p>
<p>    <code>for</code> <code>(let item of data.value) {</code></p>
<p>      <code>await talk(item.value, () =&gt; goPage(i));</code></p>
<p>      <code>i++</code></p>
<p>    <code>}</code></p>
<p>  <code>}</code></p>
<p>  <code>run()</code></p>
<p>  <code>// goPage(0);</code></p>
<p>  <code>// await talk(data.value[0].value);</code></p>
<p>  <code>// await talk(data.value[1].value, () =&gt; goPage(1));</code></p>
<p>  <code>// await talk(data.value[2].value, () =&gt; goPage(2));</code></p>
<p>  <code>// await talk(data.value[3].value, () =&gt; goPage(3));</code></p>
<p>  <code>// await talk(data.value[4].value, () =&gt; goPage(4));</code></p>
<p>  <code>// await talk(data.value[5].value, () =&gt; goPage(5));</code></p>
<p>  <code>// await talk(data.value[6].value, () =&gt; goPage(6));</code></p>
<p>  <code>// await talk(data.value[7].value, () =&gt; goPage(7));</code></p>
<p><code>}</code></p>
</li>
</ol>
<h3 id="634-品牌宣传">6.3.4. 品牌宣传<a hidden class="anchor" aria-hidden="true" href="#634-品牌宣传">#</a></h3>
<p><img loading="lazy" src="/download/thumbnails/109731880/image2023-12-1_14-37-46.png?version=1&amp;modificationDate=1701412666319&amp;api=v2" alt=""  />
</p>
<p>任何点击交互都先通过nlp返回，再做响应操作，如nlp还未返回，需提示操作频繁</p>
<h2 id="64-虚拟人交互">6.4. 虚拟人交互<a hidden class="anchor" aria-hidden="true" href="#64-虚拟人交互">#</a></h2>
<p>跟公众号h5版本的比较，屏端实现的触屏事件、复位能力、动画，都使用rxjs实现，解决比较复杂的异步场景</p>
<p><a href="/pages/viewpage.action?pageId=109722532">rxjs优化异步状态</a></p>
<p><a href="/">Filter table data</a><a href="/">Create a pivot table</a><a href="/">Create a chart from data series</a></p>
<p><a href="/users/tfac-settings.action">Configure buttons visibility</a></p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/tags/%E5%B1%8F%E7%AB%AF%E6%95%B0%E5%AD%97%E5%91%98%E5%B7%A5/">屏端数字员工</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="http://localhost:1313/posts/wiki/%E6%95%B0%E5%AD%97%E5%91%98%E5%B7%A5h5/">
    <span class="title">« 上一页</span>
    <br>
    <span>数字员工（H5）</span>
  </a>
  <a class="next" href="http://localhost:1313/posts/wiki/postcss/">
    <span class="title">下一页 »</span>
    <br>
    <span>postcss</span>
  </a>
</nav>


<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 屏端虚拟人功能设计 on x"
            href="https://x.com/intent/tweet/?text=%e5%b1%8f%e7%ab%af%e8%99%9a%e6%8b%9f%e4%ba%ba%e5%8a%9f%e8%83%bd%e8%ae%be%e8%ae%a1&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fwiki%2f%25E5%25B1%258F%25E7%25AB%25AF%25E8%2599%259A%25E6%258B%259F%25E4%25BA%25BA%25E5%258A%259F%25E8%2583%25BD%25E8%25AE%25BE%25E8%25AE%25A1%2f&amp;hashtags=%e5%b1%8f%e7%ab%af%e6%95%b0%e5%ad%97%e5%91%98%e5%b7%a5">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 屏端虚拟人功能设计 on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fwiki%2f%25E5%25B1%258F%25E7%25AB%25AF%25E8%2599%259A%25E6%258B%259F%25E4%25BA%25BA%25E5%258A%259F%25E8%2583%25BD%25E8%25AE%25BE%25E8%25AE%25A1%2f&amp;title=%e5%b1%8f%e7%ab%af%e8%99%9a%e6%8b%9f%e4%ba%ba%e5%8a%9f%e8%83%bd%e8%ae%be%e8%ae%a1&amp;summary=%e5%b1%8f%e7%ab%af%e8%99%9a%e6%8b%9f%e4%ba%ba%e5%8a%9f%e8%83%bd%e8%ae%be%e8%ae%a1&amp;source=http%3a%2f%2flocalhost%3a1313%2fposts%2fwiki%2f%25E5%25B1%258F%25E7%25AB%25AF%25E8%2599%259A%25E6%258B%259F%25E4%25BA%25BA%25E5%258A%259F%25E8%2583%25BD%25E8%25AE%25BE%25E8%25AE%25A1%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 屏端虚拟人功能设计 on reddit"
            href="https://reddit.com/submit?url=http%3a%2f%2flocalhost%3a1313%2fposts%2fwiki%2f%25E5%25B1%258F%25E7%25AB%25AF%25E8%2599%259A%25E6%258B%259F%25E4%25BA%25BA%25E5%258A%259F%25E8%2583%25BD%25E8%25AE%25BE%25E8%25AE%25A1%2f&title=%e5%b1%8f%e7%ab%af%e8%99%9a%e6%8b%9f%e4%ba%ba%e5%8a%9f%e8%83%bd%e8%ae%be%e8%ae%a1">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 屏端虚拟人功能设计 on facebook"
            href="https://facebook.com/sharer/sharer.php?u=http%3a%2f%2flocalhost%3a1313%2fposts%2fwiki%2f%25E5%25B1%258F%25E7%25AB%25AF%25E8%2599%259A%25E6%258B%259F%25E4%25BA%25BA%25E5%258A%259F%25E8%2583%25BD%25E8%25AE%25BE%25E8%25AE%25A1%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 屏端虚拟人功能设计 on whatsapp"
            href="https://api.whatsapp.com/send?text=%e5%b1%8f%e7%ab%af%e8%99%9a%e6%8b%9f%e4%ba%ba%e5%8a%9f%e8%83%bd%e8%ae%be%e8%ae%a1%20-%20http%3a%2f%2flocalhost%3a1313%2fposts%2fwiki%2f%25E5%25B1%258F%25E7%25AB%25AF%25E8%2599%259A%25E6%258B%259F%25E4%25BA%25BA%25E5%258A%259F%25E8%2583%25BD%25E8%25AE%25BE%25E8%25AE%25A1%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 屏端虚拟人功能设计 on telegram"
            href="https://telegram.me/share/url?text=%e5%b1%8f%e7%ab%af%e8%99%9a%e6%8b%9f%e4%ba%ba%e5%8a%9f%e8%83%bd%e8%ae%be%e8%ae%a1&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fwiki%2f%25E5%25B1%258F%25E7%25AB%25AF%25E8%2599%259A%25E6%258B%259F%25E4%25BA%25BA%25E5%258A%259F%25E8%2583%25BD%25E8%25AE%25BE%25E8%25AE%25A1%2f">
            <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
                <path
                    d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 屏端虚拟人功能设计 on ycombinator"
            href="https://news.ycombinator.com/submitlink?t=%e5%b1%8f%e7%ab%af%e8%99%9a%e6%8b%9f%e4%ba%ba%e5%8a%9f%e8%83%bd%e8%ae%be%e8%ae%a1&u=http%3a%2f%2flocalhost%3a1313%2fposts%2fwiki%2f%25E5%25B1%258F%25E7%25AB%25AF%25E8%2599%259A%25E6%258B%259F%25E4%25BA%25BA%25E5%258A%259F%25E8%2583%25BD%25E8%25AE%25BE%25E8%25AE%25A1%2f">
            <svg version="1.1" xml:space="preserve" width="30px" height="30px" viewBox="0 0 512 512" fill="currentColor"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape">
                <path
                    d="M449.446 0C483.971 0 512 28.03 512 62.554L512 449.446C512 483.97 483.97 512 449.446 512L62.554 512C28.03 512 0 483.97 0 449.446L0 62.554C0 28.03 28.029 0 62.554 0L449.446 0ZM183.8767 87.9921H121.8427L230.6673 292.4508V424.0079H281.3328V292.4508L390.1575 87.9921H328.1233L256 238.2489z" />
            </svg>
        </a>
    </li>
</ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span><a href="https://beian.miit.gov.cn/">粤ICP备2023039897号-1</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = '复制';

        function copyingDone() {
            copybutton.innerHTML = '已复制！';
            setTimeout(() => {
                copybutton.innerHTML = '复制';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
