<!DOCTYPE html>
<html lang="zh" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>RAG技术实践及应用中的探索与思考 | PaperMod</title>
<meta name="keywords" content="知识插件">
<meta name="description" content="知识插件">
<meta name="author" content="王宇">
<link rel="canonical" href="http://localhost:1313/posts/wiki/rag%E6%8A%80%E6%9C%AF%E5%AE%9E%E8%B7%B5%E5%8F%8A%E5%BA%94%E7%94%A8%E4%B8%AD%E7%9A%84%E6%8E%A2%E7%B4%A2%E4%B8%8E%E6%80%9D%E8%80%83/">
<meta name="google-site-verification" content="XYZabc">
<link crossorigin="anonymous" href="/assets/css/stylesheet.7b92bf4867c997b58ec50f63451b83777173d5bd5593376852abd85746d09d71.css" integrity="sha256-e5K/SGfJl7WOxQ9jRRuDd3Fz1b1VkzdoUqvYV0bQnXE=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/%3Clink%20/%20abs%20url%3E">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/%3Clink%20/%20abs%20url%3E">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/%3Clink%20/%20abs%20url%3E">
<link rel="apple-touch-icon" href="http://localhost:1313/%3Clink%20/%20abs%20url%3E">
<link rel="mask-icon" href="http://localhost:1313/%3Clink%20/%20abs%20url%3E">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="zh" href="http://localhost:1313/posts/wiki/rag%E6%8A%80%E6%9C%AF%E5%AE%9E%E8%B7%B5%E5%8F%8A%E5%BA%94%E7%94%A8%E4%B8%AD%E7%9A%84%E6%8E%A2%E7%B4%A2%E4%B8%8E%E6%80%9D%E8%80%83/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript><meta property="og:title" content="RAG技术实践及应用中的探索与思考" />
<meta property="og:description" content="知识插件" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://localhost:1313/posts/wiki/rag%E6%8A%80%E6%9C%AF%E5%AE%9E%E8%B7%B5%E5%8F%8A%E5%BA%94%E7%94%A8%E4%B8%AD%E7%9A%84%E6%8E%A2%E7%B4%A2%E4%B8%8E%E6%80%9D%E8%80%83/" />
<meta property="og:image" content="http://localhost:1313/images/papermod-cover.png" />
<meta property="article:section" content="posts" />




<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="http://localhost:1313/images/papermod-cover.png" />
<meta name="twitter:title" content="RAG技术实践及应用中的探索与思考"/>
<meta name="twitter:description" content="知识插件"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "http://localhost:1313/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "RAG技术实践及应用中的探索与思考",
      "item": "http://localhost:1313/posts/wiki/rag%E6%8A%80%E6%9C%AF%E5%AE%9E%E8%B7%B5%E5%8F%8A%E5%BA%94%E7%94%A8%E4%B8%AD%E7%9A%84%E6%8E%A2%E7%B4%A2%E4%B8%8E%E6%80%9D%E8%80%83/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "RAG技术实践及应用中的探索与思考",
  "name": "RAG技术实践及应用中的探索与思考",
  "description": "知识插件",
  "keywords": [
    "知识插件"
  ],
  "articleBody": " 1 前言 2一、RAG 技术介绍 2.11. 概述 2.22. 知识库的构建 2.2.12.1 文档拆分与处理 2.2.22.2 知识向量化入库 2.33. 检索召回 2.3.13.1 关键词检索 2.3.23.2 向量检索 2.3.33.3 召回重排序 2.44. 第三方平台能力概要 3二、RAG 技术实践 3.11. 短文本类问答实践 3.1.11.1 知识库的构建 3.1.21.2 检索应用 3.1.31.3 思考总结 3.22. 长文档类问答实践 3.2.12.1 知识库的构建 3.2.22.2 探索总结 3.33. 表格类问答实践 3.3.13.1 知识库的构建 3.3.23.2 探索总结 4三、思考与总结 前言 传统自然语言处理（NLP）算法和大规模语言模型（Large Language Models, LLMs）是自然语言处理领域的两大技术分支，各有其特点和适用场景。下面是两者优缺点的对比：\n对比项\n传统自然语言算法\n大语言模型\n对比项\n传统自然语言算法\n大语言模型\n优势\n**可解释性强：**传统 NLP 算法往往基于明确的规则或特征工程，其工作原理直观且可解释性强。\n资源需求较低**：**相比大型语言模型，传统算法在训练和部署时对计算资源的需求较低，更适合资源受限的环境。\n针对性强**：**针对特定任务设计的算法往往在该任务上表现良好，如命名实体识别、关键词提取等，具有高度定制化的解决方案。\n稳定性较好**：**因为依赖于明确的规则，传统算法的输出相对稳定，对于输入变化的敏感性较低。\n自适应性强**：**通过自监督从大量文本中学习，无需人工设计特征，能自动捕捉语言的复杂结构和语境。\n泛化能力好**：**LLMs 在训练过程中接触到广泛的语言现象，能较好地泛化到未见过的任务和数据上，表现出较强的生成和理解能力。\n上下文理解强**：**具备长序列建模能力，能更好地理解文本的前后文关系，生成连贯、有逻辑的文本。\n多功能性好**：**通过微调，同一个基础模型可以在多种 NLP 任务上达到优秀水平，减少模型开发的成本。\n劣势\n泛化能力差**：**面对未见过的文本或语言变化，传统算法可能无法很好地处理，需要不断调整和优化。\n特征工程耗时**：**手工设计特征和规则耗时费力，难以覆盖语言的复杂性和多样性。\n缺乏上下文理解**：**除了一些复杂的模型，传统算法往往缺乏对长距离依赖和上下文的理解能力。\n**局限性明显：**在处理文本生成、上下文理解、复杂推理等高级语言任务时，传统算法往往力不从心。\n资源消耗巨大**：**训练大型语言模型需要大量的计算资源和数据，成本高昂。\n不透明性**：**模型内部决策过程复杂，难以解释。\n数据偏见和伦理问题******：**模型可能受到训练数据中偏见和错误的影响，产生不恰当或有害的输出，带来伦理和法律风险。\n稳定性问题**：**对于某些输入，LLMs 可能产生不稳定或不一致的结果，特别是在边缘案例或对抗性攻击下。\n一、RAG 技术介绍 1. 概述 所谓 RAG（Retrieval Augmented Generation, 检索增强生成）技术，指的是**大模型（LLM）+ 知识召回（Knowledge Retrieval）**的问答实现路线。其基本思路是把私域知识文档进行切片，然后向量化导入知识库，再通过检索召回与用户问题相关的知识片段，最终作为上下文输入给大语言模型进行归纳总结。这种在提示词中引入领域知识的方式较好地利用了大模型的指令遵循和推理能力，能整合相关信息直接给出答案，而不是单纯的给出相关知识或链接。RAG 方法使得开发者不必为每一个特定的任务重新训练整个大模型，只需要外挂上不同的知识库，即可为模型提供额外的信息输入，提高其回答的准确性和专业性。\n在 LLM 已经具备了较强能力的基础上，仍然需要 RAG ，主要有以下几点原因：\n**幻觉问题：**LLM 文本生成的底层原理是基于概率的，因此会不可避免地产生“一本正经的胡说八道”的情况。通过 RAG 技术，大模型在回答问题时可以参考相关知识片段进行推断和回答，减少产生幻觉的可能性。 **时效性问题：**LLM 的规模越大，大模型训练的成本越高，周期也就越长。那么具有时效性的数据也就无法参与训练，所以也就无法直接回答时效性相关的问题，例如“帮我推荐几部热映的电影？”。通过 RAG 技术，可以快速补充这些知识，从而确保回答的准确性和时效性。 **数据安全问题：**通用的 LLM 没有企业内部数据和用户数据，那么企业想要在保证安全的前提下使用 LLM，最好的方式就是把数据全部放在本地，企业数据的业务计算全部在本地完成，而在线的大模型仅仅完成一个归纳总结的功能。 2. 知识库的构建 2.1 文档拆分与处理 知识向量化的前置步骤是进行知识的拆分，语义完整性的保持是最重要的考量。由于拆分的片段后续需要通过向量化模型进行推理，所以必须考虑向量化模型的最大长度限制，超出这个限制会出现截断，导致语义不完整。\n目前使用较多的基础方式是采用 Langchain 中的 RecursiveCharacterTextSplitter，属于是 Langchain 的默认拆分器。它采用多级分隔字符列表 [“\\n\\n”， “\\n”， ” “， “”] 来进行拆分，默认先按照段落做拆分，如果拆分结果的 chunk_size （文档块大小，其字符数受限于向量化模型）超出，再继续利用下一级分隔字符继续拆分，直到满足 chunk_size 的要求。\n但这种做法相对来说还是比较粗糙，可能会造成一些关键内容被拆开。对于一些特定的文档格式可以有一些更细致的做法。\n2.2 知识向量化入库 切分后的文档知识需要向量化后再导入知识库，这对于后续的知识检索召回起关键作用。知识的向量化需要借助深度模型的语义化能力，不仅仅需要基于场景数据来评估选用合适的向量模型，确定向量维度，还存在向量模型微调、部署\u0026推理等额外步骤。\n真实的业务场景中，文档的规模在百到百万这个数量级之间。按照冗余的多级召回方式，对应的知识条目最高可能达到亿的规模。由于整个离线计算的规模很大，所以必须并发进行，否则无法满足知识新增和向量检索效果迭代的要求。\n3. 检索召回 知识召回在基于大语言模型的知识问答中是非常关键的步骤，它决定了大语言模型的输入，对后续回答的可靠性以及回复质量影响非常大。目前基于语义向量召回是用的比较多的方式，但在实际的生产实践中，关键词召回方式也非常实用，它具备精确匹配、索引效率和可解释的优势。\n3.1 关键词检索 这种召回策略在很多场景下非常有效，特别是一些对领域专词非常敏感的场景。但它的缺点在于对语义信息的捕捉能力较弱，用户的输入更多表现为完整的句子而不是搜索关键词，所以一般把它作为向量召回的一种必要补充。同时，现实中多词一义是非常普遍的，除了向量检索能改善这个问题以外，也可以通过构建同义词表去匹配用户输入的关键词。\n3.2 向量检索 对称召回：一般是指通过两个同类句子的相似性来召回，比如输入的 query 匹配相似的另一个 question(query-\u003equestion)，也可以是输入的陈述句匹配相似的另一个陈述句。 非对称召回：一般是检索数据， 通常是一个相对短的问句和一个相对长的答案（一般为一个文本段落）, 一些 Question Answering 类的任务都是基于这种数据集。 一般来说，对称召回任务比非对称召回任务要简单，特别在很多垂直领域，向量模型对领域知识的理解有限，对称召回很多时候理解了字面意思就能满足要求。\n在一些专业领域，通用的向量模型可能无法很好的理解一些专有词汇，导致检索性能不足, 且正例和负例相似度的值域有比较多的重叠，无法通过阈值判断该召回内容是否属于相关信息。过多的无关信息可能会在下游误导大语言模型，所以需要使用领域数据对向量模型进行微调，微调的主要目标一方面是为了提高 topk 召回的准确率，另外一方面是想要拉开正例和负例的相似度分值分布，从而得到更好的分隔阈值。\n3.3 召回重排序 在知识混合检索场景中，如何结合关键词和向量召回的结果是一个问题，因为两者不在一个评分体系下。\n在基于大语言模型的知识问答场景下， 可以简单采用关键词召回和向量召回各取 topk 然后去重取并集的方式。 可以借鉴 ElasticSearch 混合检索（KNN+BM25）分值（Score）的计算方式：knn_score * boost **+ bm25_score *** （1-boost）。 另外一个思路是再训练一个排序模型的来打分，这种方式可以更好的结合关键词和向量召回的结果。 4. 第三方平台能力概要 当前大模型厂商（百度、讯飞等）其实也都提供了对应的 RAG 服务构建流程，包括文件上传、文档检索和问答一整套流程，但他们提供的能力比较通用且局限性较高（比如：文档分块方式固定、向量化模型和检索策略固定，检出率也不方便优化，通常与自有大模型绑定提供服务），无法满足企业个性化定制的需求。\n二、RAG 技术实践 1. 短文本类问答实践 1.1 知识库的构建 之前做的“春节活动”和“扬翔企业知识”问答服务，都是把人工处理好的短文本（最长723个字符）作为基础数据，其处理方式相对比较简单。向量化模型采用开源预训练的模型就能达到较好的效果。\n1.2 检索应用 使用120条用例测试发现，纯向量检索的模型问答效果不太好，具体测试结果如下：\n通过引入关键词召回，并调整相关权重和阈值，再次使用“春节活动”测试用例测试后，模型问答效果有较大提升：\n由此可见，检索方案的确定并非一蹴而就的，需要基于具体的场景数据来测评。首先要初选向量化模型，敲定检索方式后，还需要多次测试来确定具体的权重和阈值。\n1.3 思考总结 实践中采用的是多次测试调整后的提示词和讯飞星火认知大模型完成的知识问答，从测试结果来看，回答错误的用例中，有部分检索到了对应的知识，但大模型回答错误，可能与检索知识的顺序和无关内容的影响有关，由此可见检索效果对问答结果影响较大，但大模型本身的能力也很重要。所以后续大模型的选择、提示词的确认都需要基于具体的场景需求和数据来测评抉择。\n2. 长文档类问答实践 2.1 知识库的构建 目前在做的“养猪专家”和“营养健康助手”问答服务，都使用了大量的教材类长文档数据（达千万级字数），数据的获取和处理非常的复杂耗时。\n**文档拆分：**需要分多级（段落、各章节）进行拆分。 **数据增强：**文本拆分后可能会失去一部分关键的上下文信息，需要使用标题做增强。 文本摘要：按段落和章节的拆分方式，会出现文本长度超出限制的情况，需要使用大模型做摘要处理。大模型摘要受到上下文长度和通用能力的限制，其效果较难保证。对于长度较短的文本，可直接做摘要；但是长文本则有很多做摘要的技巧，比如先重叠拆分，对每一块都做摘要后再汇总（map_reduce）做出最终的摘要；或按顺序依次对每一块做摘要，并把前一次摘要的结果并入下一次做摘要的内容中，把最后一次摘要作为长文本的最终摘要（refine）。其实，因为摘要输出长度限制，长文本摘要会失去很多关键信息，导致摘要效果不佳，故后面探索出了新的路子，让大模型做分知识点摘要，最终将生成的每个知识点拆分后再入库，可达到较好的效果。因为引入了标题增强，所以存在许多章节文本既有父标题，又有子标题，做摘要的同时还需要提取标题之间的关系，这个难度相对较高。 **数据去重：**多级拆分带来知识冗余，需要进行去重处理（simhash、minhash等）。 2.2 探索总结 对于长文本知识库的构建，尝试了许多方法优化文本拆分和摘要的效果。对于文本拆分，直接按长度重叠拆分是最简单的实现方法，但拆分最重要的考虑是语义完整性，所以最开始尝试了 NLTK, Spacy、bert 系列（语义拆分或下一句判断），效果都不好。还不如按段落拆分，但对文本质量要求较高，且也会存在语义相关的内容被拆分的情况，所以需要多级冗余拆分，才能达到一个相对较好的效果。而摘要主要考虑的是分块长度限制，也试过传统的 nlp 算法（比如 bert、bart、mt5、pegasus、textrank），更适用于关键词/句提取，标题生成，但摘要效果远不如大模型。\n当然大模型摘要也存在许多问题，并不是一蹴而就或一个模型就能解决所有问题的，只能是在现有能力的情况下选择最优方案而已。具体测评情况总结如下：\n3. 表格类问答实践 3.1 知识库的构建 表格知识库构建的目的是将结构化的表格内容转化为文本描述，方便检索对应的知识供大模型参考。其对格式要求是最高的，光是提取表的标题、备注、表头和数据都需要耗费大量的人力。\n**表格拆分：**需要根据字符数限制按行、列拆分为多个子表。 **内容增强：**表格数据一般应用于查表问答或提供计算参数，但是单独的表格数据缺少相关描述信息，导致检索难度非常大，需要使用大模型生成一些拓展信息。 **基础数据统计：**由于最终知识库中展示的每一块内容都是子表的信息，缺少全局全表的信息，有时候会误导大模型，故需要提供全表的一个基础数据统计（比如：最大/小值、均值、高频数等），这样也能应对一部分全表数据问答的情况。 3.2 探索总结 最开始是想要在文档中结合上下文知识将表格内容一起给大模型做摘要，但这个表格上下文的提取难度很高，而且不适用于表格内容较多的情况，故最后直接将表格数据单独摘了出来处理。目前的处理方式其实还存在许多问题，比如表格数据的排版并非自然语言描述，故向量检索不太适用，更多的是依靠关键词检索。若想要提升向量检索的效果，则需要将表格中的每一条数据都转化为自然语言描述，但这个没有万能的模板，用大模型做的效果也并不好，还是需要人工去针对具体的表格确定转化模板，才能达到较好的效果。\n三、思考与总结 RAG 大模型问答应用构建的过程不只是数据的获取和处理耗时耗力，还有检索、提示词和模型参数的调整，这涉及检出率的统计和问答效果评估分析等一系列繁琐的工作。\n从目前做的工作来看，RAG 技术能在一定程度上提升通用大模型问答的正确率和质量（相关性、完整度），当然也面临通用大模型能力不断迭代升级的影响，要想构建出领域较优的问答服务，还有许多更细致深入的工作要做。\nFilter table dataCreate a pivot tableCreate a chart from data series\nConfigure buttons visibility\n",
  "wordCount" : "244",
  "inLanguage": "zh",
  "image": "http://localhost:1313/images/papermod-cover.png","datePublished": "0001-01-01T00:00:00Z",
  "dateModified": "0001-01-01T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "王宇"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://localhost:1313/posts/wiki/rag%E6%8A%80%E6%9C%AF%E5%AE%9E%E8%B7%B5%E5%8F%8A%E5%BA%94%E7%94%A8%E4%B8%AD%E7%9A%84%E6%8E%A2%E7%B4%A2%E4%B8%8E%E6%80%9D%E8%80%83/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "PaperMod",
    "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:1313/%3Clink%20/%20abs%20url%3E"
    }
  }
}
</script>
</head>

<body class=" dark" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="Home (Alt + H)">
                        
                    <img src="http://localhost:1313/images/msg_hu15231257772499651944.png" alt="" aria-label="logo"
                        height="20">Home</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/archives" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://github.com/adityatelange/hugo-PaperMod/wiki/" title="WiKi">
                    <span>WiKi</span>&nbsp;
                    <svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round"
                        stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12">
                        <path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"></path>
                        <path d="M15 3h6v6"></path>
                        <path d="M10 14L21 3"></path>
                    </svg>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://localhost:1313/">主页</a>&nbsp;»&nbsp;<a href="http://localhost:1313/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      RAG技术实践及应用中的探索与思考
    </h1>
    <div class="post-description">
      知识插件
    </div>
    <div class="post-meta">2 分钟&nbsp;·&nbsp;王宇&nbsp;|&nbsp;<a href="https://github.com/WangShaoyu1/myBlogPaperMod/tree/master/content/posts/wiki/RAG%e6%8a%80%e6%9c%af%e5%ae%9e%e8%b7%b5%e5%8f%8a%e5%ba%94%e7%94%a8%e4%b8%ad%e7%9a%84%e6%8e%a2%e7%b4%a2%e4%b8%8e%e6%80%9d%e8%80%83.md" rel="noopener noreferrer" target="_blank">Suggest Changes</a>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">目录</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#%e5%89%8d%e8%a8%80" aria-label="前言">前言</a></li>
                <li>
                    <a href="#%e4%b8%80rag-%e6%8a%80%e6%9c%af%e4%bb%8b%e7%bb%8d" aria-label="一、RAG 技术介绍">一、RAG 技术介绍</a><ul>
                        
                <li>
                    <a href="#1%e6%a6%82%e8%bf%b0" aria-label="1. 概述">1. 概述</a></li>
                <li>
                    <a href="#2-%e7%9f%a5%e8%af%86%e5%ba%93%e7%9a%84%e6%9e%84%e5%bb%ba" aria-label="2. 知识库的构建">2. 知识库的构建</a><ul>
                        
                <li>
                    <a href="#21-%e6%96%87%e6%a1%a3%e6%8b%86%e5%88%86%e4%b8%8e%e5%a4%84%e7%90%86" aria-label="2.1 文档拆分与处理">2.1 文档拆分与处理</a></li>
                <li>
                    <a href="#22-%e7%9f%a5%e8%af%86%e5%90%91%e9%87%8f%e5%8c%96%e5%85%a5%e5%ba%93" aria-label="2.2 知识向量化入库">2.2 知识向量化入库</a></li></ul>
                </li>
                <li>
                    <a href="#3-%e6%a3%80%e7%b4%a2%e5%8f%ac%e5%9b%9e" aria-label="3. 检索召回">3. 检索召回</a><ul>
                        
                <li>
                    <a href="#31-%e5%85%b3%e9%94%ae%e8%af%8d%e6%a3%80%e7%b4%a2" aria-label="3.1 关键词检索">3.1 关键词检索</a></li>
                <li>
                    <a href="#32-%e5%90%91%e9%87%8f%e6%a3%80%e7%b4%a2" aria-label="3.2 向量检索">3.2 向量检索</a></li>
                <li>
                    <a href="#33-%e5%8f%ac%e5%9b%9e%e9%87%8d%e6%8e%92%e5%ba%8f" aria-label="3.3 召回重排序">3.3 召回重排序</a></li></ul>
                </li>
                <li>
                    <a href="#4-%e7%ac%ac%e4%b8%89%e6%96%b9%e5%b9%b3%e5%8f%b0%e8%83%bd%e5%8a%9b%e6%a6%82%e8%a6%81" aria-label="4. 第三方平台能力概要">4. 第三方平台能力概要</a></li></ul>
                </li>
                <li>
                    <a href="#%e4%ba%8crag-%e6%8a%80%e6%9c%af%e5%ae%9e%e8%b7%b5" aria-label="二、RAG 技术实践">二、RAG 技术实践</a><ul>
                        
                <li>
                    <a href="#1%e7%9f%ad%e6%96%87%e6%9c%ac%e7%b1%bb%e9%97%ae%e7%ad%94%e5%ae%9e%e8%b7%b5" aria-label="1. 短文本类问答实践">1. 短文本类问答实践</a><ul>
                        
                <li>
                    <a href="#11-%e7%9f%a5%e8%af%86%e5%ba%93%e7%9a%84%e6%9e%84%e5%bb%ba" aria-label="1.1 知识库的构建">1.1 知识库的构建</a></li>
                <li>
                    <a href="#12-%e6%a3%80%e7%b4%a2%e5%ba%94%e7%94%a8" aria-label="1.2 检索应用">1.2 检索应用</a></li>
                <li>
                    <a href="#13-%e6%80%9d%e8%80%83%e6%80%bb%e7%bb%93" aria-label="1.3 思考总结">1.3 思考总结</a></li></ul>
                </li>
                <li>
                    <a href="#2-%e9%95%bf%e6%96%87%e6%a1%a3%e7%b1%bb%e9%97%ae%e7%ad%94%e5%ae%9e%e8%b7%b5" aria-label="2. 长文档类问答实践">2. 长文档类问答实践</a><ul>
                        
                <li>
                    <a href="#21-%e7%9f%a5%e8%af%86%e5%ba%93%e7%9a%84%e6%9e%84%e5%bb%ba" aria-label="2.1 知识库的构建">2.1 知识库的构建</a></li>
                <li>
                    <a href="#22-%e6%8e%a2%e7%b4%a2%e6%80%bb%e7%bb%93" aria-label="2.2 探索总结">2.2 探索总结</a></li></ul>
                </li>
                <li>
                    <a href="#3-%e8%a1%a8%e6%a0%bc%e7%b1%bb%e9%97%ae%e7%ad%94%e5%ae%9e%e8%b7%b5" aria-label="3. 表格类问答实践">3. 表格类问答实践</a><ul>
                        
                <li>
                    <a href="#31-%e7%9f%a5%e8%af%86%e5%ba%93%e7%9a%84%e6%9e%84%e5%bb%ba" aria-label="3.1 知识库的构建">3.1 知识库的构建</a></li>
                <li>
                    <a href="#32%e6%8e%a2%e7%b4%a2%e6%80%bb%e7%bb%93" aria-label="3.2 探索总结">3.2 探索总结</a></li></ul>
                </li></ul>
                </li>
                <li>
                    <a href="#%e4%b8%89%e6%80%9d%e8%80%83%e4%b8%8e%e6%80%bb%e7%bb%93" aria-label="三、思考与总结">三、思考与总结</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><ul>
<li>1 <a href="/posts/wiki/rag%E6%8A%80%E6%9C%AF%E5%AE%9E%E8%B7%B5%E5%8F%8A%E5%BA%94%E7%94%A8%E4%B8%AD%E7%9A%84%E6%8E%A2%E7%B4%A2%E4%B8%8E%E6%80%9D%E8%80%83/#RAG技术实践及应用中的探索与思考-前言">前言</a></li>
<li>2<a href="/posts/wiki/rag%E6%8A%80%E6%9C%AF%E5%AE%9E%E8%B7%B5%E5%8F%8A%E5%BA%94%E7%94%A8%E4%B8%AD%E7%9A%84%E6%8E%A2%E7%B4%A2%E4%B8%8E%E6%80%9D%E8%80%83/#RAG技术实践及应用中的探索与思考-一、RAG技术介绍">一、RAG 技术介绍</a>
<ul>
<li>2.1<a href="/posts/wiki/rag%E6%8A%80%E6%9C%AF%E5%AE%9E%E8%B7%B5%E5%8F%8A%E5%BA%94%E7%94%A8%E4%B8%AD%E7%9A%84%E6%8E%A2%E7%B4%A2%E4%B8%8E%E6%80%9D%E8%80%83/#RAG技术实践及应用中的探索与思考-1.概述">1. 概述</a></li>
<li>2.2<a href="/posts/wiki/rag%E6%8A%80%E6%9C%AF%E5%AE%9E%E8%B7%B5%E5%8F%8A%E5%BA%94%E7%94%A8%E4%B8%AD%E7%9A%84%E6%8E%A2%E7%B4%A2%E4%B8%8E%E6%80%9D%E8%80%83/#RAG技术实践及应用中的探索与思考-2.知识库的构建">2. 知识库的构建</a>
<ul>
<li>2.2.1<a href="/posts/wiki/rag%E6%8A%80%E6%9C%AF%E5%AE%9E%E8%B7%B5%E5%8F%8A%E5%BA%94%E7%94%A8%E4%B8%AD%E7%9A%84%E6%8E%A2%E7%B4%A2%E4%B8%8E%E6%80%9D%E8%80%83/#RAG技术实践及应用中的探索与思考-2.1文档拆分与处理">2.1 文档拆分与处理</a></li>
<li>2.2.2<a href="/posts/wiki/rag%E6%8A%80%E6%9C%AF%E5%AE%9E%E8%B7%B5%E5%8F%8A%E5%BA%94%E7%94%A8%E4%B8%AD%E7%9A%84%E6%8E%A2%E7%B4%A2%E4%B8%8E%E6%80%9D%E8%80%83/#RAG技术实践及应用中的探索与思考-2.2知识向量化入库">2.2 知识向量化入库</a></li>
</ul>
</li>
<li>2.3<a href="/posts/wiki/rag%E6%8A%80%E6%9C%AF%E5%AE%9E%E8%B7%B5%E5%8F%8A%E5%BA%94%E7%94%A8%E4%B8%AD%E7%9A%84%E6%8E%A2%E7%B4%A2%E4%B8%8E%E6%80%9D%E8%80%83/#RAG技术实践及应用中的探索与思考-3.检索召回">3. 检索召回</a>
<ul>
<li>2.3.1<a href="/posts/wiki/rag%E6%8A%80%E6%9C%AF%E5%AE%9E%E8%B7%B5%E5%8F%8A%E5%BA%94%E7%94%A8%E4%B8%AD%E7%9A%84%E6%8E%A2%E7%B4%A2%E4%B8%8E%E6%80%9D%E8%80%83/#RAG技术实践及应用中的探索与思考-3.1关键词检索">3.1 关键词检索</a></li>
<li>2.3.2<a href="/posts/wiki/rag%E6%8A%80%E6%9C%AF%E5%AE%9E%E8%B7%B5%E5%8F%8A%E5%BA%94%E7%94%A8%E4%B8%AD%E7%9A%84%E6%8E%A2%E7%B4%A2%E4%B8%8E%E6%80%9D%E8%80%83/#RAG技术实践及应用中的探索与思考-3.2向量检索">3.2 向量检索</a></li>
<li>2.3.3<a href="/posts/wiki/rag%E6%8A%80%E6%9C%AF%E5%AE%9E%E8%B7%B5%E5%8F%8A%E5%BA%94%E7%94%A8%E4%B8%AD%E7%9A%84%E6%8E%A2%E7%B4%A2%E4%B8%8E%E6%80%9D%E8%80%83/#RAG技术实践及应用中的探索与思考-3.3召回重排序">3.3 召回重排序</a></li>
</ul>
</li>
<li>2.4<a href="/posts/wiki/rag%E6%8A%80%E6%9C%AF%E5%AE%9E%E8%B7%B5%E5%8F%8A%E5%BA%94%E7%94%A8%E4%B8%AD%E7%9A%84%E6%8E%A2%E7%B4%A2%E4%B8%8E%E6%80%9D%E8%80%83/#RAG技术实践及应用中的探索与思考-4.第三方平台能力概要">4. 第三方平台能力概要</a></li>
</ul>
</li>
<li>3<a href="/posts/wiki/rag%E6%8A%80%E6%9C%AF%E5%AE%9E%E8%B7%B5%E5%8F%8A%E5%BA%94%E7%94%A8%E4%B8%AD%E7%9A%84%E6%8E%A2%E7%B4%A2%E4%B8%8E%E6%80%9D%E8%80%83/#RAG技术实践及应用中的探索与思考-二、RAG技术实践">二、RAG 技术实践</a>
<ul>
<li>3.1<a href="/posts/wiki/rag%E6%8A%80%E6%9C%AF%E5%AE%9E%E8%B7%B5%E5%8F%8A%E5%BA%94%E7%94%A8%E4%B8%AD%E7%9A%84%E6%8E%A2%E7%B4%A2%E4%B8%8E%E6%80%9D%E8%80%83/#RAG技术实践及应用中的探索与思考-1.短文本类问答实践">1. 短文本类问答实践</a>
<ul>
<li>3.1.1<a href="/posts/wiki/rag%E6%8A%80%E6%9C%AF%E5%AE%9E%E8%B7%B5%E5%8F%8A%E5%BA%94%E7%94%A8%E4%B8%AD%E7%9A%84%E6%8E%A2%E7%B4%A2%E4%B8%8E%E6%80%9D%E8%80%83/#RAG技术实践及应用中的探索与思考-1.1知识库的构建">1.1 知识库的构建</a></li>
<li>3.1.2<a href="/posts/wiki/rag%E6%8A%80%E6%9C%AF%E5%AE%9E%E8%B7%B5%E5%8F%8A%E5%BA%94%E7%94%A8%E4%B8%AD%E7%9A%84%E6%8E%A2%E7%B4%A2%E4%B8%8E%E6%80%9D%E8%80%83/#RAG技术实践及应用中的探索与思考-1.2检索应用">1.2 检索应用</a></li>
<li>3.1.3<a href="/posts/wiki/rag%E6%8A%80%E6%9C%AF%E5%AE%9E%E8%B7%B5%E5%8F%8A%E5%BA%94%E7%94%A8%E4%B8%AD%E7%9A%84%E6%8E%A2%E7%B4%A2%E4%B8%8E%E6%80%9D%E8%80%83/#RAG技术实践及应用中的探索与思考-1.3思考总结">1.3 思考总结</a></li>
</ul>
</li>
<li>3.2<a href="/posts/wiki/rag%E6%8A%80%E6%9C%AF%E5%AE%9E%E8%B7%B5%E5%8F%8A%E5%BA%94%E7%94%A8%E4%B8%AD%E7%9A%84%E6%8E%A2%E7%B4%A2%E4%B8%8E%E6%80%9D%E8%80%83/#RAG技术实践及应用中的探索与思考-2.长文档类问答实践">2. 长文档类问答实践</a>
<ul>
<li>3.2.1<a href="/posts/wiki/rag%E6%8A%80%E6%9C%AF%E5%AE%9E%E8%B7%B5%E5%8F%8A%E5%BA%94%E7%94%A8%E4%B8%AD%E7%9A%84%E6%8E%A2%E7%B4%A2%E4%B8%8E%E6%80%9D%E8%80%83/#RAG技术实践及应用中的探索与思考-2.1知识库的构建">2.1 知识库的构建</a></li>
<li>3.2.2<a href="/posts/wiki/rag%E6%8A%80%E6%9C%AF%E5%AE%9E%E8%B7%B5%E5%8F%8A%E5%BA%94%E7%94%A8%E4%B8%AD%E7%9A%84%E6%8E%A2%E7%B4%A2%E4%B8%8E%E6%80%9D%E8%80%83/#RAG技术实践及应用中的探索与思考-2.2探索总结">2.2 探索总结</a></li>
</ul>
</li>
<li>3.3<a href="/posts/wiki/rag%E6%8A%80%E6%9C%AF%E5%AE%9E%E8%B7%B5%E5%8F%8A%E5%BA%94%E7%94%A8%E4%B8%AD%E7%9A%84%E6%8E%A2%E7%B4%A2%E4%B8%8E%E6%80%9D%E8%80%83/#RAG技术实践及应用中的探索与思考-3.表格类问答实践">3. 表格类问答实践</a>
<ul>
<li>3.3.1<a href="/posts/wiki/rag%E6%8A%80%E6%9C%AF%E5%AE%9E%E8%B7%B5%E5%8F%8A%E5%BA%94%E7%94%A8%E4%B8%AD%E7%9A%84%E6%8E%A2%E7%B4%A2%E4%B8%8E%E6%80%9D%E8%80%83/#RAG技术实践及应用中的探索与思考-3.1知识库的构建">3.1 知识库的构建</a></li>
<li>3.3.2<a href="/posts/wiki/rag%E6%8A%80%E6%9C%AF%E5%AE%9E%E8%B7%B5%E5%8F%8A%E5%BA%94%E7%94%A8%E4%B8%AD%E7%9A%84%E6%8E%A2%E7%B4%A2%E4%B8%8E%E6%80%9D%E8%80%83/#RAG技术实践及应用中的探索与思考-3.2探索总结">3.2 探索总结</a></li>
</ul>
</li>
</ul>
</li>
<li>4<a href="/posts/wiki/rag%E6%8A%80%E6%9C%AF%E5%AE%9E%E8%B7%B5%E5%8F%8A%E5%BA%94%E7%94%A8%E4%B8%AD%E7%9A%84%E6%8E%A2%E7%B4%A2%E4%B8%8E%E6%80%9D%E8%80%83/#RAG技术实践及应用中的探索与思考-三、思考与总结">三、思考与总结</a></li>
</ul>
<h1 id="前言">前言<a hidden class="anchor" aria-hidden="true" href="#前言">#</a></h1>
<p>传统自然语言处理（NLP）算法和大规模语言模型（Large Language Models, LLMs）是自然语言处理领域的两大技术分支，各有其特点和适用场景。下面是两者优缺点的对比：</p>
<p>对比项</p>
<p>传统自然语言算法</p>
<p>大语言模型</p>
<p>对比项</p>
<p>传统自然语言算法</p>
<p>大语言模型</p>
<p><strong>优势</strong></p>
<ul>
<li>
<p>**可解释性强：**传统 NLP 算法往往基于明确的规则或特征工程，其工作原理直观且可解释性强。</p>
</li>
<li>
<p><strong>资源需求较低</strong>**：**相比大型语言模型，传统算法在训练和部署时对计算资源的需求较低，更适合资源受限的环境。</p>
</li>
<li>
<p><strong>针对性强</strong>**：**针对特定任务设计的算法往往在该任务上表现良好，如命名实体识别、关键词提取等，具有高度定制化的解决方案。</p>
</li>
<li>
<p><strong>稳定性较好</strong>**：**因为依赖于明确的规则，传统算法的输出相对稳定，对于输入变化的敏感性较低。</p>
</li>
<li>
<p><strong>自适应性强</strong>**：**通过自监督从大量文本中学习，无需人工设计特征，能自动捕捉语言的复杂结构和语境。</p>
</li>
<li>
<p><strong>泛化能力好</strong>**：**LLMs 在训练过程中接触到广泛的语言现象，能较好地泛化到未见过的任务和数据上，表现出较强的生成和理解能力。</p>
</li>
<li>
<p><strong>上下文理解强</strong>**：**具备长序列建模能力，能更好地理解文本的前后文关系，生成连贯、有逻辑的文本。</p>
</li>
<li>
<p><strong>多功能性好</strong>**：**通过微调，同一个基础模型可以在多种 NLP 任务上达到优秀水平，减少模型开发的成本。</p>
</li>
</ul>
<p><strong>劣势</strong></p>
<ul>
<li>
<p><strong>泛化能力差</strong>**：**面对未见过的文本或语言变化，传统算法可能无法很好地处理，需要不断调整和优化。</p>
</li>
<li>
<p><strong>特征工程耗时</strong>**：**手工设计特征和规则耗时费力，难以覆盖语言的复杂性和多样性。</p>
</li>
<li>
<p><strong>缺乏上下文理解</strong>**：**除了一些复杂的模型，传统算法往往缺乏对长距离依赖和上下文的理解能力。</p>
</li>
<li>
<p>**<strong>局限性明显</strong>：**在处理文本生成、上下文理解、复杂推理等高级语言任务时，传统算法往往力不从心。</p>
</li>
<li>
<p><strong>资源消耗巨大</strong>**：**训练大型语言模型需要大量的计算资源和数据，成本高昂。</p>
</li>
<li>
<p><strong>不透明性</strong>**：**模型内部决策过程复杂，难以解释。</p>
</li>
<li>
<p><strong>数据偏见</strong>和伦理问题******：**模型可能受到训练数据中偏见和错误的影响，产生不恰当或有害的输出，带来伦理和法律风险。</p>
</li>
<li>
<p><strong>稳定性问题</strong>**：**对于某些输入，LLMs 可能产生不稳定或不一致的结果，特别是在边缘案例或对抗性攻击下。</p>
</li>
</ul>
<h1 id="一rag-技术介绍">一、RAG 技术介绍<a hidden class="anchor" aria-hidden="true" href="#一rag-技术介绍">#</a></h1>
<h2 id="1概述">1. 概述<a hidden class="anchor" aria-hidden="true" href="#1概述">#</a></h2>
<p>所谓 RAG（Retrieval Augmented Generation, 检索增强生成）技术，指的是**大模型（LLM）+ 知识召回（Knowledge Retrieval）**的问答实现路线。其基本思路是把私域知识文档进行切片，然后向量化导入知识库，再通过检索召回与用户问题相关的知识片段，最终作为上下文输入给大语言模型进行归纳总结。这种在提示词中引入领域知识的方式较好地利用了大模型的指令遵循和推理能力，能整合相关信息直接给出答案，而不是单纯的给出相关知识或链接。RAG 方法使得开发者不必为每一个特定的任务重新训练整个大模型，只需要外挂上不同的知识库，即可为模型提供额外的信息输入，提高其回答的准确性和专业性。</p>
<p><img loading="lazy" src="/download/attachments/129174321/image2024-6-25_10-47-34.png?version=1&amp;modificationDate=1719283654580&amp;api=v2" alt=""  />
</p>
<p>在 LLM 已经具备了较强能力的基础上，仍然需要 RAG ，主要有以下几点原因：</p>
<ul>
<li>**幻觉问题：**LLM 文本生成的底层原理是基于概率的，因此会不可避免地产生“一本正经的胡说八道”的情况。通过 RAG 技术，大模型在回答问题时可以参考相关知识片段进行推断和回答，减少产生幻觉的可能性。</li>
<li>**时效性问题：**LLM 的规模越大，大模型训练的成本越高，周期也就越长。那么具有时效性的数据也就无法参与训练，所以也就无法直接回答时效性相关的问题，例如“帮我推荐几部热映的电影？”。通过 RAG 技术，可以快速补充这些知识，从而确保回答的准确性和时效性。 </li>
<li>**数据安全问题：**通用的 LLM 没有企业内部数据和用户数据，那么企业想要在保证安全的前提下使用 LLM，最好的方式就是把数据全部放在本地，企业数据的业务计算全部在本地完成，而在线的大模型仅仅完成一个归纳总结的功能。</li>
</ul>
<h2 id="2-知识库的构建">2. 知识库的构建<a hidden class="anchor" aria-hidden="true" href="#2-知识库的构建">#</a></h2>
<h3 id="21-文档拆分与处理">2.1 文档拆分与处理<a hidden class="anchor" aria-hidden="true" href="#21-文档拆分与处理">#</a></h3>
<p>知识向量化的前置步骤是进行知识的拆分，<strong>语义完整性的保持是最重要的考量。由于拆分的片段后续需要通过向量化模型进行推理，所以必须考虑向量化模型的最大长度限制，超出这个限制会出现截断，导致语义不完整。</strong></p>
<p>目前使用较多的基础方式是采用 Langchain 中的 RecursiveCharacterTextSplitter，属于是 Langchain 的默认拆分器。它采用多级分隔字符列表 [“\n\n”， “\n”， ” “， “”] 来进行拆分，默认先按照段落做拆分，如果拆分结果的 chunk_size （文档块大小，其字符数受限于向量化模型）超出，再继续利用下一级分隔字符继续拆分，直到满足 chunk_size 的要求。</p>
<p>但这种做法相对来说还是比较粗糙，可能会造成一些关键内容被拆开。对于一些特定的文档格式可以有一些更细致的做法。</p>
<h3 id="22-知识向量化入库">2.2 知识向量化入库<a hidden class="anchor" aria-hidden="true" href="#22-知识向量化入库">#</a></h3>
<p>切分后的文档知识需要向量化后再导入知识库，这对于后续的知识检索召回起关键作用。知识的向量化需要借助深度模型的语义化能力，不仅仅需要基于场景数据来评估选用合适的向量模型，确定向量维度，还存在向量模型微调、部署&amp;推理等额外步骤。</p>
<p>真实的业务场景中，文档的规模在百到百万这个数量级之间。按照冗余的多级召回方式，对应的知识条目最高可能达到亿的规模。由于整个离线计算的规模很大，所以必须并发进行，否则无法满足知识新增和向量检索效果迭代的要求。</p>
<h2 id="3-检索召回">3. 检索召回<a hidden class="anchor" aria-hidden="true" href="#3-检索召回">#</a></h2>
<p>知识召回在基于大语言模型的知识问答中是非常关键的步骤，它决定了大语言模型的输入，对后续回答的可靠性以及回复质量影响非常大。目前基于语义向量召回是用的比较多的方式，但在实际的生产实践中，关键词召回方式也非常实用，它具备精确匹配、索引效率和可解释的优势。</p>
<h3 id="31-关键词检索">3.1 关键词检索<a hidden class="anchor" aria-hidden="true" href="#31-关键词检索">#</a></h3>
<p>这种召回策略在很多场景下非常有效，特别是一些对领域专词非常敏感的场景。但它的缺点在于对语义信息的捕捉能力较弱，用户的输入更多表现为完整的句子而不是搜索关键词，所以一般把它作为向量召回的一种必要补充。同时，现实中多词一义是非常普遍的，除了向量检索能改善这个问题以外，也可以通过构建同义词表去匹配用户输入的关键词。</p>
<h3 id="32-向量检索">3.2 向量检索<a hidden class="anchor" aria-hidden="true" href="#32-向量检索">#</a></h3>
<ul>
<li><strong>对称召回：<strong>一般是指通过两个</strong>同类句子</strong>的相似性来召回，比如输入的 query 匹配相似的另一个 question(query-&gt;question)，也可以是输入的陈述句匹配相似的另一个陈述句。</li>
<li><strong>非对称召回：<strong>一般是检索数据， 通常是一个</strong>相对短的问句和一个相对长的答案</strong>（一般为一个文本段落）, 一些 Question Answering 类的任务都是基于这种数据集。</li>
</ul>
<p>一般来说，对称召回任务比非对称召回任务要简单，特别在很多垂直领域，向量模型对领域知识的理解有限，对称召回很多时候理解了字面意思就能满足要求。</p>
<p>在一些专业领域，通用的向量模型可能无法很好的理解一些专有词汇，导致检索性能不足,  且正例和负例相似度的值域有比较多的重叠，无法通过阈值判断该召回内容是否属于相关信息。过多的无关信息可能会在下游误导大语言模型，所以需要使用领域数据对向量模型进行微调，微调的主要目标一方面是为了提高 topk 召回的准确率，另外一方面是想要拉开正例和负例的相似度分值分布，从而得到更好的分隔阈值。</p>
<h3 id="33-召回重排序">3.3 召回重排序<a hidden class="anchor" aria-hidden="true" href="#33-召回重排序">#</a></h3>
<p>在知识混合检索场景中，如何结合关键词和向量召回的结果是一个问题，因为两者不在一个评分体系下。</p>
<ul>
<li>在基于大语言模型的知识问答场景下， 可以简单采用关键词召回和向量召回各取 topk 然后<strong>去重取并集</strong>的方式。</li>
<li>可以借鉴 ElasticSearch 混合检索（KNN+BM25）分值（Score）的计算方式：<strong>knn_score</strong> <strong>*</strong> <strong>boost</strong> **+ bm25_score *** （1-boost）<strong><strong>。</strong></strong></li>
<li>另外一个思路是再训练一个<strong>排序模型</strong>的来打分，这种方式可以更好的结合关键词和向量召回的结果。</li>
</ul>
<h2 id="4-第三方平台能力概要">4. 第三方平台能力概要<a hidden class="anchor" aria-hidden="true" href="#4-第三方平台能力概要">#</a></h2>
<p>当前大模型厂商（百度、讯飞等）其实也都提供了对应的 RAG 服务构建流程，包括文件上传、文档检索和问答一整套流程，但他们提供的能力比较通用且局限性较高（比如：文档分块方式固定、向量化模型和检索策略固定，检出率也不方便优化，通常与自有大模型绑定提供服务），无法满足企业个性化定制的需求。</p>
<h1 id="二rag-技术实践">二、RAG 技术实践<a hidden class="anchor" aria-hidden="true" href="#二rag-技术实践">#</a></h1>
<h2 id="1短文本类问答实践">1. 短文本类问答实践<a hidden class="anchor" aria-hidden="true" href="#1短文本类问答实践">#</a></h2>
<h3 id="11-知识库的构建">1.1 知识库的构建<a hidden class="anchor" aria-hidden="true" href="#11-知识库的构建">#</a></h3>
<p>之前做的“春节活动”和“扬翔企业知识”问答服务，都是把人工处理好的短文本（最长723个字符）作为基础数据，其处理方式相对比较简单。向量化模型采用开源预训练的模型就能达到较好的效果。</p>
<p><img loading="lazy" src="/download/attachments/129174321/image2024-6-27_9-42-17.png?version=1&amp;modificationDate=1719452537773&amp;api=v2" alt=""  />
</p>
<h3 id="12-检索应用">1.2 检索应用<a hidden class="anchor" aria-hidden="true" href="#12-检索应用">#</a></h3>
<p>使用120条用例测试发现，纯向量检索的模型问答效果不太好，具体测试结果如下：</p>
<p><img loading="lazy" src="/download/attachments/129174321/image2024-2-18_18-46-35.png?version=1&amp;modificationDate=1719400202762&amp;api=v2" alt=""  />
</p>
<p>通过引入关键词召回，并调整相关权重和阈值，再次使用“春节活动”测试用例测试后，模型问答效果有较大提升：</p>
<p><img loading="lazy" src="/download/attachments/129174321/image2024-2-18_18-59-10.png?version=1&amp;modificationDate=1719400202817&amp;api=v2" alt=""  />
</p>
<p>由此可见，检索方案的确定并非一蹴而就的，需要基于具体的场景数据来测评。首先要初选向量化模型，敲定检索方式后，还需要多次测试来确定具体的权重和阈值。</p>
<h3 id="13-思考总结">1.3 思考总结<a hidden class="anchor" aria-hidden="true" href="#13-思考总结">#</a></h3>
<p>实践中采用的是多次测试调整后的提示词和讯飞星火认知大模型完成的知识问答，从测试结果来看，回答错误的用例中，有部分检索到了对应的知识，但大模型回答错误，可能与检索知识的顺序和无关内容的影响有关，由此可见检索效果对问答结果影响较大，但大模型本身的能力也很重要。所以后续大模型的选择、提示词的确认都需要基于具体的场景需求和数据来测评抉择。</p>
<h2 id="2-长文档类问答实践">2. 长文档类问答实践<a hidden class="anchor" aria-hidden="true" href="#2-长文档类问答实践">#</a></h2>
<h3 id="21-知识库的构建">2.1 知识库的构建<a hidden class="anchor" aria-hidden="true" href="#21-知识库的构建">#</a></h3>
<p>目前在做的“养猪专家”和“营养健康助手”问答服务，都使用了大量的教材类长文档数据（达千万级字数），数据的获取和处理非常的复杂耗时。</p>
<ul>
<li>**文档拆分：**需要分多级（段落、各章节）进行拆分。</li>
<li>**数据增强：**文本拆分后可能会失去一部分关键的上下文信息，需要使用标题做增强。</li>
<li><strong>文本摘要：<strong>按段落和章节的拆分方式，会出现文本长度超出限制的情况，需要使用大模型做摘要处理。大模型摘要受到上下文长度和通用能力的限制，其效果较难保证。对于长度较短的文本，可直接做摘要；但是长文本则有很多做摘要的技巧，比如先重叠拆分，对每一块都做摘要后再汇总（map_reduce）做出最终的摘要；或按顺序依次对每一块做摘要，并把前一次摘要的结果并入下一次做摘要的内容中，把最后一次摘要作为长文本的最终摘要（refine）。其实，因为摘要输出长度限制，长文本摘要会失去很多关键信息，导致摘要效果不佳，故后面探索出了新的路子，让大模型做</strong>分知识点摘要</strong>，最终将生成的每个知识点拆分后再入库，可达到较好的效果。因为引入了标题增强，所以存在许多章节文本既有父标题，又有子标题，做摘要的同时还需要提取标题之间的关系，这个难度相对较高。</li>
<li>**数据去重：**多级拆分带来知识冗余，需要进行去重处理（simhash、minhash等）。</li>
</ul>
<h3 id="22-探索总结">2.2 探索总结<a hidden class="anchor" aria-hidden="true" href="#22-探索总结">#</a></h3>
<p>对于长文本知识库的构建，尝试了许多方法优化文本拆分和摘要的效果。对于文本拆分，直接按长度重叠拆分是最简单的实现方法，但拆分最重要的考虑是<strong>语义完整性</strong>，所以最开始尝试了 NLTK, Spacy、bert 系列（语义拆分或下一句判断），效果都不好。还不如按段落拆分，但对文本质量要求较高，且也会存在语义相关的内容被拆分的情况，所以需要多级冗余拆分，才能达到一个相对较好的效果。而摘要主要考虑的是分块长度限制，也试过传统的 nlp 算法（比如 bert、bart、mt5、pegasus、textrank），更适用于关键词/句提取，标题生成，但摘要效果远不如大模型。</p>
<p><img loading="lazy" src="/download/attachments/129174321/image2024-6-27_15-28-22.png?version=1&amp;modificationDate=1719473302701&amp;api=v2" alt=""  />
</p>
<p>当然大模型摘要也存在许多问题，并不是一蹴而就或一个模型就能解决所有问题的，只能是在现有能力的情况下选择最优方案而已。具体测评情况总结如下：</p>
<p><img loading="lazy" src="/download/attachments/129174321/image2024-6-27_15-5-38.png?version=1&amp;modificationDate=1719471938079&amp;api=v2" alt=""  />
</p>
<h2 id="3-表格类问答实践">3. 表格类问答实践<a hidden class="anchor" aria-hidden="true" href="#3-表格类问答实践">#</a></h2>
<h3 id="31-知识库的构建">3.1 知识库的构建<a hidden class="anchor" aria-hidden="true" href="#31-知识库的构建">#</a></h3>
<p>表格知识库构建的目的是将结构化的表格内容转化为文本描述，方便检索对应的知识供大模型参考。其对格式要求是最高的，光是提取表的标题、备注、表头和数据都需要耗费大量的人力。</p>
<p><img loading="lazy" src="/download/attachments/129174321/image2024-6-27_11-38-2.png?version=1&amp;modificationDate=1719459482297&amp;api=v2" alt=""  />
</p>
<ul>
<li>**表格拆分：**需要根据字符数限制按行、列拆分为多个子表。</li>
<li>**内容增强：**表格数据一般应用于查表问答或提供计算参数，但是单独的表格数据缺少相关描述信息，导致检索难度非常大，需要使用大模型生成一些拓展信息。</li>
<li>**基础数据统计：**由于最终知识库中展示的每一块内容都是子表的信息，缺少全局全表的信息，有时候会误导大模型，故需要提供全表的一个基础数据统计（比如：最大/小值、均值、高频数等），这样也能应对一部分全表数据问答的情况。</li>
</ul>
<h3 id="32探索总结">3.2 探索总结<a hidden class="anchor" aria-hidden="true" href="#32探索总结">#</a></h3>
<p>最开始是想要在文档中结合上下文知识将表格内容一起给大模型做摘要，但这个表格上下文的提取难度很高，而且不适用于表格内容较多的情况，故最后直接将表格数据单独摘了出来处理。目前的处理方式其实还存在许多问题，比如表格数据的排版并非自然语言描述，故向量检索不太适用，更多的是依靠关键词检索。若想要提升向量检索的效果，则需要将表格中的每一条数据都转化为自然语言描述，但这个没有万能的模板，用大模型做的效果也并不好，还是需要人工去针对具体的表格确定转化模板，才能达到较好的效果。</p>
<h1 id="三思考与总结">三、思考与总结<a hidden class="anchor" aria-hidden="true" href="#三思考与总结">#</a></h1>
<p>RAG 大模型问答应用构建的过程不只是数据的获取和处理耗时耗力，还有检索、提示词和模型参数的调整，这涉及检出率的统计和问答效果评估分析等一系列繁琐的工作。</p>
<p><img loading="lazy" src="/download/thumbnails/129174321/image2024-6-27_14-16-30.png?version=1&amp;modificationDate=1719468990735&amp;api=v2" alt=""  />
</p>
<p>从目前做的工作来看，RAG 技术能在一定程度上提升通用大模型问答的正确率和质量（相关性、完整度），当然也面临通用大模型能力不断迭代升级的影响，要想构建出领域较优的问答服务，还有许多更细致深入的工作要做。</p>
<p><img loading="lazy" src="/download/attachments/129174321/image2024-6-27_14-48-46.png?version=1&amp;modificationDate=1719470926948&amp;api=v2" alt=""  />
</p>
<p><a href="/">Filter table data</a><a href="/">Create a pivot table</a><a href="/">Create a chart from data series</a></p>
<p><a href="/users/tfac-settings.action">Configure buttons visibility</a></p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/tags/%E7%9F%A5%E8%AF%86%E6%8F%92%E4%BB%B6/">知识插件</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="http://localhost:1313/posts/wiki/%E5%90%91%E9%87%8F%E6%A8%A1%E5%9E%8Bgpu%E6%94%AF%E6%8C%81%E9%95%9C%E5%83%8F%E5%88%B6%E4%BD%9C/">
    <span class="title">« 上一页</span>
    <br>
    <span>向量模型GPU支持镜像制作</span>
  </a>
  <a class="next" href="http://localhost:1313/posts/wiki/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E7%9F%A5%E8%AF%86%E9%97%AE%E7%AD%94%E6%8A%80%E6%9C%AF%E5%AE%9E%E8%B7%B5%E6%96%B9%E6%A1%88%E6%80%BB%E7%BB%93/">
    <span class="title">下一页 »</span>
    <br>
    <span>大模型知识问答技术实践方案总结</span>
  </a>
</nav>


<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share RAG技术实践及应用中的探索与思考 on x"
            href="https://x.com/intent/tweet/?text=RAG%e6%8a%80%e6%9c%af%e5%ae%9e%e8%b7%b5%e5%8f%8a%e5%ba%94%e7%94%a8%e4%b8%ad%e7%9a%84%e6%8e%a2%e7%b4%a2%e4%b8%8e%e6%80%9d%e8%80%83&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fwiki%2frag%25E6%258A%2580%25E6%259C%25AF%25E5%25AE%259E%25E8%25B7%25B5%25E5%258F%258A%25E5%25BA%2594%25E7%2594%25A8%25E4%25B8%25AD%25E7%259A%2584%25E6%258E%25A2%25E7%25B4%25A2%25E4%25B8%258E%25E6%2580%259D%25E8%2580%2583%2f&amp;hashtags=%e7%9f%a5%e8%af%86%e6%8f%92%e4%bb%b6">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share RAG技术实践及应用中的探索与思考 on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fwiki%2frag%25E6%258A%2580%25E6%259C%25AF%25E5%25AE%259E%25E8%25B7%25B5%25E5%258F%258A%25E5%25BA%2594%25E7%2594%25A8%25E4%25B8%25AD%25E7%259A%2584%25E6%258E%25A2%25E7%25B4%25A2%25E4%25B8%258E%25E6%2580%259D%25E8%2580%2583%2f&amp;title=RAG%e6%8a%80%e6%9c%af%e5%ae%9e%e8%b7%b5%e5%8f%8a%e5%ba%94%e7%94%a8%e4%b8%ad%e7%9a%84%e6%8e%a2%e7%b4%a2%e4%b8%8e%e6%80%9d%e8%80%83&amp;summary=RAG%e6%8a%80%e6%9c%af%e5%ae%9e%e8%b7%b5%e5%8f%8a%e5%ba%94%e7%94%a8%e4%b8%ad%e7%9a%84%e6%8e%a2%e7%b4%a2%e4%b8%8e%e6%80%9d%e8%80%83&amp;source=http%3a%2f%2flocalhost%3a1313%2fposts%2fwiki%2frag%25E6%258A%2580%25E6%259C%25AF%25E5%25AE%259E%25E8%25B7%25B5%25E5%258F%258A%25E5%25BA%2594%25E7%2594%25A8%25E4%25B8%25AD%25E7%259A%2584%25E6%258E%25A2%25E7%25B4%25A2%25E4%25B8%258E%25E6%2580%259D%25E8%2580%2583%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share RAG技术实践及应用中的探索与思考 on reddit"
            href="https://reddit.com/submit?url=http%3a%2f%2flocalhost%3a1313%2fposts%2fwiki%2frag%25E6%258A%2580%25E6%259C%25AF%25E5%25AE%259E%25E8%25B7%25B5%25E5%258F%258A%25E5%25BA%2594%25E7%2594%25A8%25E4%25B8%25AD%25E7%259A%2584%25E6%258E%25A2%25E7%25B4%25A2%25E4%25B8%258E%25E6%2580%259D%25E8%2580%2583%2f&title=RAG%e6%8a%80%e6%9c%af%e5%ae%9e%e8%b7%b5%e5%8f%8a%e5%ba%94%e7%94%a8%e4%b8%ad%e7%9a%84%e6%8e%a2%e7%b4%a2%e4%b8%8e%e6%80%9d%e8%80%83">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share RAG技术实践及应用中的探索与思考 on facebook"
            href="https://facebook.com/sharer/sharer.php?u=http%3a%2f%2flocalhost%3a1313%2fposts%2fwiki%2frag%25E6%258A%2580%25E6%259C%25AF%25E5%25AE%259E%25E8%25B7%25B5%25E5%258F%258A%25E5%25BA%2594%25E7%2594%25A8%25E4%25B8%25AD%25E7%259A%2584%25E6%258E%25A2%25E7%25B4%25A2%25E4%25B8%258E%25E6%2580%259D%25E8%2580%2583%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share RAG技术实践及应用中的探索与思考 on whatsapp"
            href="https://api.whatsapp.com/send?text=RAG%e6%8a%80%e6%9c%af%e5%ae%9e%e8%b7%b5%e5%8f%8a%e5%ba%94%e7%94%a8%e4%b8%ad%e7%9a%84%e6%8e%a2%e7%b4%a2%e4%b8%8e%e6%80%9d%e8%80%83%20-%20http%3a%2f%2flocalhost%3a1313%2fposts%2fwiki%2frag%25E6%258A%2580%25E6%259C%25AF%25E5%25AE%259E%25E8%25B7%25B5%25E5%258F%258A%25E5%25BA%2594%25E7%2594%25A8%25E4%25B8%25AD%25E7%259A%2584%25E6%258E%25A2%25E7%25B4%25A2%25E4%25B8%258E%25E6%2580%259D%25E8%2580%2583%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share RAG技术实践及应用中的探索与思考 on telegram"
            href="https://telegram.me/share/url?text=RAG%e6%8a%80%e6%9c%af%e5%ae%9e%e8%b7%b5%e5%8f%8a%e5%ba%94%e7%94%a8%e4%b8%ad%e7%9a%84%e6%8e%a2%e7%b4%a2%e4%b8%8e%e6%80%9d%e8%80%83&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fwiki%2frag%25E6%258A%2580%25E6%259C%25AF%25E5%25AE%259E%25E8%25B7%25B5%25E5%258F%258A%25E5%25BA%2594%25E7%2594%25A8%25E4%25B8%25AD%25E7%259A%2584%25E6%258E%25A2%25E7%25B4%25A2%25E4%25B8%258E%25E6%2580%259D%25E8%2580%2583%2f">
            <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
                <path
                    d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share RAG技术实践及应用中的探索与思考 on ycombinator"
            href="https://news.ycombinator.com/submitlink?t=RAG%e6%8a%80%e6%9c%af%e5%ae%9e%e8%b7%b5%e5%8f%8a%e5%ba%94%e7%94%a8%e4%b8%ad%e7%9a%84%e6%8e%a2%e7%b4%a2%e4%b8%8e%e6%80%9d%e8%80%83&u=http%3a%2f%2flocalhost%3a1313%2fposts%2fwiki%2frag%25E6%258A%2580%25E6%259C%25AF%25E5%25AE%259E%25E8%25B7%25B5%25E5%258F%258A%25E5%25BA%2594%25E7%2594%25A8%25E4%25B8%25AD%25E7%259A%2584%25E6%258E%25A2%25E7%25B4%25A2%25E4%25B8%258E%25E6%2580%259D%25E8%2580%2583%2f">
            <svg version="1.1" xml:space="preserve" width="30px" height="30px" viewBox="0 0 512 512" fill="currentColor"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape">
                <path
                    d="M449.446 0C483.971 0 512 28.03 512 62.554L512 449.446C512 483.97 483.97 512 449.446 512L62.554 512C28.03 512 0 483.97 0 449.446L0 62.554C0 28.03 28.029 0 62.554 0L449.446 0ZM183.8767 87.9921H121.8427L230.6673 292.4508V424.0079H281.3328V292.4508L390.1575 87.9921H328.1233L256 238.2489z" />
            </svg>
        </a>
    </li>
</ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span><a href="https://beian.miit.gov.cn/">粤ICP备2023039897号-1</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = '复制';

        function copyingDone() {
            copybutton.innerHTML = '已复制！';
            setTimeout(() => {
                copybutton.innerHTML = '复制';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
