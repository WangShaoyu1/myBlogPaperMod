<!DOCTYPE html>
<html lang="zh" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>2.2、意图设计&amp;对话设计 | PaperMod</title>
<meta name="keywords" content="2、语音交互设计知识">
<meta name="description" content="2、语音交互设计知识">
<meta name="author" content="王宇">
<link rel="canonical" href="http://localhost:1313/posts/wiki/2.2%E6%84%8F%E5%9B%BE%E8%AE%BE%E8%AE%A1%E5%AF%B9%E8%AF%9D%E8%AE%BE%E8%AE%A1/">
<meta name="google-site-verification" content="XYZabc">
<link crossorigin="anonymous" href="/assets/css/stylesheet.7b92bf4867c997b58ec50f63451b83777173d5bd5593376852abd85746d09d71.css" integrity="sha256-e5K/SGfJl7WOxQ9jRRuDd3Fz1b1VkzdoUqvYV0bQnXE=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/%3Clink%20/%20abs%20url%3E">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/%3Clink%20/%20abs%20url%3E">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/%3Clink%20/%20abs%20url%3E">
<link rel="apple-touch-icon" href="http://localhost:1313/%3Clink%20/%20abs%20url%3E">
<link rel="mask-icon" href="http://localhost:1313/%3Clink%20/%20abs%20url%3E">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="zh" href="http://localhost:1313/posts/wiki/2.2%E6%84%8F%E5%9B%BE%E8%AE%BE%E8%AE%A1%E5%AF%B9%E8%AF%9D%E8%AE%BE%E8%AE%A1/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript><meta property="og:title" content="2.2、意图设计&amp;对话设计" />
<meta property="og:description" content="2、语音交互设计知识" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://localhost:1313/posts/wiki/2.2%E6%84%8F%E5%9B%BE%E8%AE%BE%E8%AE%A1%E5%AF%B9%E8%AF%9D%E8%AE%BE%E8%AE%A1/" />
<meta property="og:image" content="http://localhost:1313/images/papermod-cover.png" />
<meta property="article:section" content="posts" />




<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="http://localhost:1313/images/papermod-cover.png" />
<meta name="twitter:title" content="2.2、意图设计&amp;对话设计"/>
<meta name="twitter:description" content="2、语音交互设计知识"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "http://localhost:1313/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "2.2、意图设计\u0026对话设计",
      "item": "http://localhost:1313/posts/wiki/2.2%E6%84%8F%E5%9B%BE%E8%AE%BE%E8%AE%A1%E5%AF%B9%E8%AF%9D%E8%AE%BE%E8%AE%A1/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "2.2、意图设计\u0026对话设计",
  "name": "2.2、意图设计\u0026对话设计",
  "description": "2、语音交互设计知识",
  "keywords": [
    "2、语音交互设计知识"
  ],
  "articleBody": " 13.4 语音交互框架、意图设计 1.1唤醒状态 1.2聆听状态 1.3网络等待状态 1.4语音播报状态 1.5长连接通信状态 1.6结束至默认状态 23.5 对话设计原则 2.1任务型对话设计原则 2.2· 设计对话脚本需要关注的点： 2.3修复对话设计原则 2.4谷歌语音交互设计走查表 3.4 语音交互框架、意图设计 · 四种语音交互模式：\n单轮交互：指智能语音助手被唤醒后只能完成一项任务，不管是否完成了任务，智能语音助手都会进入休眠状态，用户要继续使用智能重新唤醒它。绝大部分的智能语音助手和语音任务都属于单轮。 多轮交互：一些相对复杂的语音任务很难一句话说清楚，多轮对话指不用多次唤醒，双方可以通过多轮交流的方式完成一项任务，当任务完成后会自动进入休眠状态。多轮交互的缺点在于，智能语音助手在播报时麦克风处于关闭，要播报完才会打开麦克风聆听用户的声音（不能中途插话），除非再次唤醒，但再次唤醒就会将前面几轮的对话过程清空。 持续监听：指一旦唤醒后，智能语音助手就会把麦克风一直打开，用户可以一直说。持续监听依然存在问题，假设上一轮对话未结束，这时智能语音助手听到其他人说的话，会误以为时新的语音任务，就会直接结束上一轮并播报新的内容或停止播报。 全双工语音交互：拥有更强的抗噪能力和上下文理解能力，不会像持续监听一样容易被噪声打断整个对话过程。可以理解每一句话是否跟当前任务有关，并猜测当前任务的下一轮对话是什么，做到真正的“边听边说”。 · 四种“唤醒+识别”方式：在语音交互设计时应该根据它们的优劣势进行选择并综合使用。\n“唤醒+在线意图识别”：在线意图识别的好处是云端有较强的算力支持将语音转换成文字和自然语言进行理解，弊端是任何操作都要云端处理，一旦信号不好，网络延迟变长，就会影响体验。 “唤醒+离线意图识别”：离线意图识别就是为了解决信号不好导致指令无法执行的问题，一般离线意图识别主要服务于常用的简单指令。 “免唤醒”：免唤醒也用了唤醒词技术，只不过把默认唤醒词改为了指令，新的唤醒词被命中后会直接执行相关指令。但不能把所有指令设置为免唤醒。 “one-shot”：也被称为“唤醒连说”技术，意思是“唤醒词+意图识别”一体化，支持用户在说出唤醒词后不停顿，立刻说出后续需求。 · 语音交互状态设计：整个语音交互框架会围绕各种语音状态进行设计，但仅靠声音的反馈用户很难知道现在交互流程处于哪个状态，对用户来说体验不好，因此在设计语音交互框架时需要考虑更全面。\n唤醒状态 · 设计唤醒状态前需要考虑当前设备采用的是那种语音交互方式（包括前述的四种语音交互模式与四种“唤醒+识别”方式），还需要考虑该设备使用的是近场语音交互还是远场语音交互。近场语音交互：指人距离机器不超过30cm，一般近场会通过按键或唤醒词的方式唤醒智能语音助手，由于设备就在眼前，可以通过视觉反馈的方式告知用户已被唤醒。远场语音交互：指人距离机器0.3~5m，由于用户距离设备较远，可能看不清当前设备的状态，因此需要通过听觉反馈告知用户是否被唤醒。\n聆听状态 · 在唤醒状态之后，具体分为等待用户响应状态和ASR状态。前者为等待用户说话的过程，后者为将用户说的话自动转成文字的过程。\n· 等待用户响应状态需要设置一个时间上限，如果用户一直不说话，到达时间上限后会自动退出或发起二次询问，然后进入下一轮的等待状态。时间不是越长越好，如果没有很好的抗噪能力，可能会突然执行无关的指令，影响用户体验。\n· 在单轮交互和多轮交互模式下，亚马逊的智能音箱Echo设置的等待时间上限为8s，8s内如果一直没有说话Echo会二次寻味，再不说话就会自动休眠。持续监听与全双工语音交互的设计相对复杂，等待用户响应时间分为初次唤醒聆听、二次询问、持续聆听，建议初次唤醒聆听与二次询问的等待时间上限设置为8s，而持续聆听是指上一轮对话结束后的等待时间，用户随时可能发起新一轮语音任务，所以建议设置长一些（20~30s）。\n网络等待状态 · 绝大部分语音交互的识别和处理都在云端进行，返回语音结果需要一段时间，因此网络等待状态必须反馈给用户，因为用户不知道该状态何时会结束。\n语音播报状态 · 不同产品在处理语音播报状态方面有着不一样的反馈设计，比如呼吸灯效、动态表情、直接显示播报的文字内容等。还要考虑到是否会对用户产生干扰（驾驶时占用视觉通道等）。\n长连接通信状态 · 持续监听和全双工依赖长连接通信质量，即指客户端和云端保持一段时间的通信，如果长连接通信质量时好时坏，就会导致云端接收到的信息缺失和意图识别有误。如果不将长连接通信状态的通信质量突出显示，则当因为通信问题导致意图识别不准确时，用户就会认为是智能语音助手的问题。建议在设计这个状态时，可以优先考虑音效设计，比如加入微小的“滋滋滋”电流声，让用户知道当前的通话质量受到了干扰。\n结束至默认状态 · 任务结束或用户在规定的时间内没有说话，设备的麦克风停止拾音，语音交互到此结束。可以通过音箱的一系列动作（摄像头回正等）、动态表情等来表现。\n· 由于语音交互涉及的状态很多，因此设计师应该全局考虑如何通过一套设计覆盖所有的状态和场景。\n· 天猫精灵IN糖的体验设计师为了拉近用户和智能音箱的距离，用PAD（Pleasure - Arousal - Dominance，即愉悦度-唤醒度-优势度）情绪状态模型对天猫精灵IN糖进行人格化情绪引擎设计，并围绕语音交互语料、表情分组和语音技能屏显这三个要素，设计出一系列更自然、更符合用户对话语境的情绪表达。\n· 意图设计术语介绍：计算机听懂人说话得益于意图识别和实体提取的能力，在设计语音意图之前，需要了解与意图设计相关的术语。\n技能（Skill）：可以简单理解为一个应用。David J. Major发现，大多数Alexa用户无法分辨亚马逊官方和第三方厂商开发的技能之间的区别，很有可能是因为每种技能都用了同一种声音播报，用户呼喊触发词会加深用户对该品牌的记忆，因此第三方应用更需要通过触发词及其他方式提升用户对该品牌的印象。 意图（Intent）：可以简单理解为某个应用的功能或流程，主要满足用户的请求或目的。有些意图隶属于某项技能，如果用户脱离技能输入意图，则系统就无法理解并执行；有些意图可以忽略技能而直接执行，默认属于系统技能（比如查天气）。做语音交互更多的是在设计意图怎样被理解并执行相关操作。 词典（Dictionary）：可以理解为某个领域内词汇的集合。有些词语会存在于不同的词典中，不同词典的调用也会影响意图的识别。比如“刘德华”“张学友”既属于“男歌星”这个词典，又属于“电影男演员”这个词典，当用户说“我要看刘德华的电影”时，匹配到的是“电影男演员”的词典；当用户说“我要听刘德华的歌”时，匹配到的是“男歌星”的词典；如果用户说“打开刘德华”，就不知道是要匹配哪个词典了（需要人为设计相关策略来匹配）。 词槽（Slot）和槽位：词槽可以理解为一句话中所包含的参数是什么。槽位是指这句话里有多少个参数，它们直接决定系统能否匹配到正确的技能和意图。词槽和词典时强相关的。在设计前，需要了解清楚语音智能平台是否支持词槽状态选择（可选、必选）、是否具备泛化能力、槽位是否支持通配符。 泛化（Generalize）：指同一个意图有不同的表达方式，泛化能力会直接影响系统能否听懂用户在说什么以及设计师的工作量，同时也反映出该平台的人工智能水平如何。当前大部分平台的泛化能力较弱，需要设计师源源不断地将不同的表达方式写入系统，不同的表达方式可以通过“无意义词”这个词槽来实现（类似百度AI平台上的“特征词”词槽）。词槽和槽位的设计也会影响泛化能力。 通配符（Wildcard Character）：主要用来进行模糊搜索和匹配。在意图设计中，当缺少数据导致某些词典数据不全时，通配符能够直接简化制作词典的工作量。比如，“XXX”是一个通配符，在“视频播放”这个意图增加“我想看XXX电影”这个表达后，无论XXX是什么，都能打开视频应用搜索XXX电影。通配符使用一定要合理，用得越多，越会影响词槽和槽位的设计，导致系统识别意图时不知道如何对众多匹配到的意图进行排序。 实体（Entity）：获取意图中的关键信息是通过实体提取实现的。实体提取是信息抽取、信息检索、机器翻译、问答系统等多种自然语言处理必不可少的组成部分。前述的词典、泛化和通配符都是为了让系统更好地提取出实体。 Bot：可以简单理解为意图识别的执行方，是一个功能合集，包含了很多技能。 · 决定你的产品能否听懂用户说的大部分内容，主要由智能语音平台决定，在做产品设计前，需要了解智能语音平台的以下7个方面：\n了解智能语音平台的NLU能力如何，是否具备较好的泛化能力。NLU是每个智能语音平台的核心。一般来说计算机会通过文本分析和文本匹配两种方法实现意图识别。 了解系统的意图匹配规则是完全匹配还是模糊匹配。只支持词槽完全匹配的智能语音平台几乎没有任何泛化能力，这需要设计师考虑通过构建词典、词槽和槽位的方式实现意图泛化。如果智能语音平台支持词槽模糊匹配，说明系统采用了识别关键词的方式，对“请帮我把声音调高一点”的指令，能识别出“声音调高一点”分别属于操作对象、调整、状态三个词槽，而其他文字“请帮我把”将被忽略。 了解智能语音平台对语言的支持程度如何。不同的语言都不同的语法和特点，会影响到NLU。 了解智能语音平台的系统词典数量是否足够多、每个词典拥有的词汇量是否齐全。词典收集不完整的结果是系统很有可能不知道用户说的内容是什么意思。 了解智能语音平台是否支持客户端和服务端自定义参数的传输，类似5W1H这类场景化的参数如果不支持传输，那在设计时就只能考虑多轮对话的上下文，而不能结合当前的位置和时间等参数进行设计。尤其是带屏幕的语音设备，因为用户有可能说完一句话就直接操作屏幕，然后又继续语音对话，如果语音设备不知道用户在屏幕上进行什么操作，那智能语音平台就不知道用户整个使用流程是怎样的。 了解智能语音平台是否支持意图的自定义排序。意图匹配很可能匹配到多个意图，只是每个意图都有不同的匹配概率，最终系统只召回概率最大的意图，而意图应该根据当前的场景进行匹配，而不只是根据词槽。意图自定义排序很重要，因为它能根据特定参数匹配某些低概率的意图，实现场景化的理解。 了解智能语音平台是否支持声纹识别。一台设备多人使用，声纹识别可以区分当前使用者十四黑，有助于针对不同用户提供个性化回答。 · 以“给带屏设备设计一款智能语音系统”为例，使用的智能语音平台不具备泛化能力，但可以自定义参数传输和意图自定义排序。设计内容分为系统全局设计和意图设计：\n系统全局设计：\n以多种形式告知用户系统暂时无法理解用户的语义，比如“抱歉，目前还不能理解你的意思”。这种兜底策略成本最低，但出现频率过高，会让用户觉得产品没什么用，很不智能。\n将听不懂的语句传给第三方搜索功能。提取用户输入的关键词到搜索网站上找答案，但是答案过多，导致用户操作成本有点高。\n将听不懂的语句传给第三方闲聊机器人。闲聊机器人需要第三方API支持，成本最高，但效果也是最好的，让产品看起来更人性化。\n将听不懂的语句传给Q\u0026A。根据目标人群和使用场景建立一套问答系统，比如驾驶场景可能问的更多的是关于如何驾驶的，家里的智能音箱问的最多的是小朋友的十万个为什么。可以通过“为什么”“怎么”等关键词识别并匹配相应的Q\u0026A。\n词汇的覆盖面决定了词典质量，词汇量越多越好。\n是否考虑动态更新，比如名人、视频、音乐等都需要支持动态更新。\n该词汇是否有同义词，考虑其他常用叫法。\n该词汇是否是多音字，是否会有常见的错误叫法。\n保持互动语言简短，避免重复的短语。\n写出人们是如何交谈的，而不是如何阅读和写作的。\n当需要用户提供信息时，给出相应的指示。\n不要假设用户知道该做什么。\n问问题时一次只问一个问题。\n在让用户做选择时，一次提供不超过三个选项。\n学会使用话轮转换（Turn-taking），指会话中说话人和听话人角色的不断相互变换。若缺少有效的轮回，就有可能出现对话的双方同事说话或对话内容不同步并且难以被理解的情况。\n对话中的所有元素应该可以被绑定在一起，成为简单的一句话，这些元素是意图设计中最重要的参数。\n赋予产品一个固定的人物形象。首先明确我们的用户群体，再根据用户群体的画像设计一个虚拟角色，对角色进行描述，包括采用的音色。\n考虑设计产品的目的是什么、将为用户提供哪些技能（应用）、这些技能的目的是什么、用户为什么要使用它、用户通过这些技能能做什么和不能做什么、用户可以用哪些方式调用该技能，以及产品将会应用在哪个垂直领域。对自己提供的技能进行先后排序。\n建立合理的兜底方案，即当语音完全匹配不上意图时提供的最后解决方案。兜底方案有以下四种，它们之间是互斥的，可以通过语法识别、关键词匹配等方式建立置信度，从而选择合适的兜底方案——匹配上关键词后，可以交由Q\u0026A模块或第三方搜索功能来解决；如果没匹配上关键词且语法分析没太大问题，则可以交由闲聊模块解决；如果问题很大，则告知用户“抱歉没理解”（大部分语句中语法有严重问题都是噪声导致的）。\n查看智能语音平台是否提供了与技能相关的垂直领域官方词典，如果没有，考虑手动建立自己的词典。需要注意以下几点：\n在场景的帮助下，可以更好地理解用户的意图。由于大部分设备都使用了开源的安卓系统，而且语音应用和其他应用相互独立，信息几乎不能传输，所以可以通过安卓官方的API获取栈顶应用信息，了解用户当前处于哪个应用中。如果用户当前使用的应用是由自己设计开发的，那么可以将用户的一系列操作流程及相关参数传输给服务器进行分析，这样有助于更好地判断用户的想法是什么，并前置最相关的意图。\n可以使用脚本来帮助确认可能没考虑到的情况，撰写脚本需要考虑以下几点（可参看3.5节）：\n将脚本转化为决策树，类似信息架构，通过决策树可以发现整个技能是否设计得不严谨，从而知道如何优化；还能帮助我们考虑任务的跳出机制问题，如果不允许用户跳出任务，则应该友好地告诉用户当前的情况或询问是否退出任务并进行新的任务。\n意图设计：\n意图设计并不是槽位越多越好，要根据实际情况而定，设计者在设计词槽和槽位时，可以结合当前语言的语法和词性一起考虑，比如每句话需要考虑主、谓、宾结构，还有各种名词、动词、副词、量词和形容词。\n当智能语音平台泛化能力较弱时，可以考虑手动提升整体的泛化能力：将常用的表达方式抽离出来成为独立的词典，然后让每个意图都匹配该词典。\n如果设计的是系统产品，应该考虑全局意图的设计，比如带屏智能音箱、投影仪都是由实体按键的，可以考虑通过语音命令的方式模拟按键操作，从而达到全局操作的目的。（所见即所得）\n· 完成整个全局设计和意图设计后，应该邀请用户进行实践和测试，用户可能会用我们意想不到的话术进行对话，从而可以尽可能地完善意图及对话设计。\n3.5 对话设计原则 · 为用户解决问题、创建有温度的对话流程是智能交互平台设计师的愿景。\n· 设计对话前需要了解的事项：\n考虑计算机的局限：在设计前要考虑技术的优势和不足。技术的局限性引入了人与人对话中不会发生的场景，这些局限性应该提前提示用户。另外，当语音系统还达不到很聪明、随意交流的程度时，就不应该让用户误认为它可以达到。\n确定用户场景：为了实现个性化和场景化设计，可以通过技术手段获取用户定位、时间和用户身份（包括声纹、用户注册信息）等信息，在设计对话脚本前需要考虑以下几个与场景相关的问题：\nWhere：用户在哪里？所处的环境是怎样的？\nWhat：用户正在做什么？\nHow：用户使用的是什么设备？\nWhat：用户要完成什么任务？目标是什么？\nWhy：用户的期望和意图是什么？\n明确要设计的技能是什么：不同类型的技能面向不同的用户群体和用户场景。所有的技能都可以分为：\n播报型：为用户提供内容服务，例如音乐、新闻、百科、食谱、故事等；\n指令型：在用户和生活服务之间建立一座桥梁，帮助用户解放双手，通过语音就能控制家居、发送短信、叫外卖等；\n互动型：用户通过多轮对话的方式与设备交互，主要用于娱乐领域，如问答测试、情景探险、识图对话、听音唱歌等。\n明确要设计的对话类型是什么：不同的技能对应着不同的对话类型，从应用场景的覆盖面看，对话类型可以分为开放域（Open-domain）和封闭域（Closed-domain）。开放域对话类型没有太多限定的主题或明确的目标，需要大量的知识库和复杂的模型，一般用于闲聊场景；封闭域对话类型通常会限定在一定场景之下，需要一个垂直领域建立的模型和知识图谱，对对话的质量要求更高，对错误的容忍度更低，一般用于任务、问答或娱乐场景。据此，对话类型主要分为以下四种（见表格）：\n提前定义好智能助手的人物设定。\n了解对话的关键因素：谷歌的设计师通过解构那些我们习以为常的自然对话中的规则和管理挖掘出一个VUI对话的关键因素：（语音交互设计指南 Actions on Google Design）\n话轮转换（Turn-taking）：当轮到用户说话时，智能语音助手应该发出清晰的信号，例如音效提醒。用户说话时，智能语音助手也不要贸然强行打断。\n对话线索（Treading）：对话中的对话线索可以帮助我们更容易地跟上对话的节奏。\n利用语音固有的效率：人们经常使用较为简短的口头表达方式，我们基本上可以感知对话中的“言外之意”，而VUI中的隐喻则必须能够弥补人类语言中看似不合逻辑、非理性的部分。\n预测不同的用户行为：人们会用不同的词语和说话方式去描述同样的事情，这取决于他们自己的情景语境和自己的经验产生的对VUI的预期，VUI需要支持这些差异。\n遵循会话“合作原则”：美国语言哲学家格莱斯（Paul Grice）认为，在人们交际的过程中，对话双方似乎在有意无意地遵循着某个原则，以求有效地配合，从而完成交际任务。语音交互可以考虑遵循对话的“合作原则”进行设计（如下）。但实际语言交际中，人们并非总是遵循这个原则，格莱斯把这种表面上故意违反“合作原则”而产生的言外之意成为“特殊会话含义”，需要依赖特殊语境才能推导出来的含义。设计者在设计脚本时应尽量避免使用这种对话方式，避免用户理解不了。\n量的准则：所说的话应该满足且不超出交际所需的信息量。\n质的准则：不要说自知是虚假的和缺乏足够证据的话。\n关系准则：所说的话要贴切，要与交谈目的和交谈内容有关系，不说不相干的话。\n方式准则：所说的话要简洁明了，不要拐弯抹角产生歧义。\n对话不存在“出错”的概念：逻辑和准确性不是万能法则，用户的任何请求都是有目的的，即使没有明确说出来。不管用户说了什么，都不要把它当成是一个错误来处理，而是要考虑把它转变为一个机会，用新的方式来处理，从而进行更顺畅、更自然的沟通。有助于把“错误”转换成对话交互中自然的一部分的方法如下：\n不要把技术上的“出错”当作用户的错误。\n为不同类型的“出错”提供对应的、适合的处理方式。\n通过提供帮助来避免出错。\n知道在什么情况下放弃。\n使完成任务的路径更短，从而掩盖错误。\n对话类型\n含义\n特点\n目标\n对话类型\n含义\n特点\n目标\n1、任务类型\n指在特定条件下为带有明确目的的用户提供信息或服务\n设计起来比较复杂，非常依赖意图识别技术，通常使用意图识别+多轮对话+对接内容提供商的API和知识图谱\n用最短的对话轮次来完成用户的任务，把在对话中获取的信息转换成需要的参数\n2、问答类型\n问题也是一种任务，问答类型与任务类型的对话有一定的相似性\n一般用于客服机器人上，能和用户进行基本沟通并自动回复用户有关产品或服务的相关问题\n意图设计非常简单，一般抓住关键词“为什么”和“是什么”即可，然后通过FAQ+对接内容提供商的API和知识图谱回答用户的问题\n用最短的对话轮次来回答用户的问题\n3、闲聊类型\n开放域类型，没有明确目的的对话，主要根据用户对话中出现的关键词进行回复\n不精确，不可控，机器的回复都在闲聊库，通过检索给出响应的回复\n对话轮次越多越好\n4、游戏/娱乐类型\n结合了任务类型与闲聊类型的特点，还要考虑游戏类型、趣味性等因素进行设计\n脚本分支多，游戏类型还需考虑故事线，设计起来比较复杂\n让用户放轻松\n· 设计脚本的目的是让用户理解对话的内容，帮助用户快速完成任务。如果对话过程中需要多轮对话，则脚本能引导用户给出够用的、正确的信息，然后执行用户希望完成的任务。\n· 一个好的脚本应该是站在人们如何交谈的视角进行设计的，而不是通过阅读和写作视角进行刻板设计的。\n任务型对话设计原则 · 设计对话脚本需要关注的点： 提升对话内容的多样性：尝试在固定回答上加入不同的对白，比如用户调用技能的时候，可以考虑丰富多变的欢迎语，还可以考虑提供关于技能基本功能的提示，设计固定回复时可以通过同义词为答案增加变化，然后从这些答案里随机选择一个作为回复。 尊重用户的时间：尽量在短时间内将必要的回复信息表达出来。在交谈中，说得太多与说得太少一样表现得不合作，从用户角度出发，保持简短和最佳相关性有助于用户理解。 保持文案的一致性：在写脚本时保持语句中动词、名词搭配的语法一致性，以及用户、智能语音助手的称呼的一致性。（写文案技巧，能用“咱”时就不用“你”，拉近与用户的距离） 减轻用户的认知负担：在编写脚本时，尽量避免使用“科技术语”“专业词汇”“方言用语”等。通过一致的称谓来称呼同一个事物，帮助用户降低对同一事物的认知负担。 逐步向用户获取信息：用户在进行语音交互的时间里，通常无法将所有完成意图所需的关键参数说出来，此时应避免垄断对话，不要一口气提出所有问题，而要将问题分解成多个独立问题，一个一个地提问，引导出所有答案。 尽量提供少于三个的选项：如果选项过多，则为用户找出与输入预期匹配度最高的三个选项，列表中的第一项应与用户刚刚采取的操作最相关。 不要假设用户会准确地把设想的对白表达出来：虽然有“合作原则”，但是用户经常会提供比智能语音助手真正需要的更多的信息（过度回答），这时智能语音助手要能够获取这些回答，不需要再问很多问题；除此之外，还要包容多种说话风格，把用户可能会说的句子、短语和单词最大范围地呈现出来；还有一种情况是，用户在说话时突然改变主意或立刻更正，这时候用户会在正确的意图前加上“不”“要不还是算了”等短语，这种情况非常依赖语音交互系统的泛化能力，在意图和词槽设计上没有较好的解决方法。 不要假设用户知道该怎么做或会发生什么：不要猜测用户的意思，提供事实信息让用户自己做决策，当用户需要时给出提示；用户回答的顺序也可能和脚本流程设计的顺序不一致，需要考虑全部情况。 在追问过程中为用户提供指导：在设计多轮交互的追问句时，建议包含“当前情景”和“需要进行的操作或选项”，这样的追问句能为用户通过继续对话的线索，并指导用户下一步该说什么。 避免用户进行复杂或带来高歧义的输入：通过语音填写邮箱、密码和网址等，多音字、同音异义词的识别等，这些对计算机来说都是很复杂和高歧义的输入，要避免用户进行此类输入。 针对重要请求，向用户发出显式确认；针对风险较低的请求，可以采用隐式确认方式：确认是语音界面与用户沟通的一种方式，用于检查用户的问题、命令和回复是否被正确理解，可以保证对话的流畅度和准确度，让用户知道系统已经理解了自己的话。根据不同的情境和置信区间选择合适的确认方式——对于某些难以撤销的操作，采用显示确认方式较为合适，例如资金转账的最终确认和免责协议的确认，通常要与用于核实其提供的输入是否被正确地处理，或者请求用户允许操作，在得到用户确认之前不会执行后续操作；对于识别准确率为中到高，且潜在的负面影响较小时，不想过分打扰用户，采用隐式确认方式较为合适，VUI在回复中融入了用户话语中的关键信息，以表明VUI理解了用户说的话，优点是效率高，但缺点是出错时用户通常不知道如何让对话重回正轨。 尽量少用语气助词：常见的有疑问语气、祈使语气、感叹语气、肯定语气和停顿语气，目前TTS技术很难通过文字和语境将正确的预期表达出来，仍只能用平调朗读出语气助词，因此要谨慎使用。 检查对话内容是否符合人物设定：不同性格的人说的话的特征是不一样的。切勿用高人一等的口吻和用户说话。 在引起用户负面情绪的关键点上加入情感化设计：在设计对话时可以引入用户体验地图，在引起用户负面情绪的关键点上加入情感化设计或转移话题；撒娇也是一种能缓解用户情绪低落的好方法，比如在语音助手没理解用户输入的意图时，不要说“我不知道你在说什么”，而是说“换一个问题嘛，不要为难人家好不好”。 在合适的场景说合适的话：设计对话时要结合用户对话时的时间和定位信息进行考虑。 考虑多种交互的方式：除了语音，还可以结合结构化的文字和图像进行表达，复杂的内容需要播放很长时间的语音，可以采用视觉可视化的方式让用户能够快速看完。 优先撰写愉悦脚本：愉悦脚本指的是可以完成任务并且完整、简单的对话脚本，从开始到结束，中间没有任何分支。完成愉悦脚本的撰写后，在考虑其他需要语音助手引导的分支或路线。 · 设计师不能只将精力集中于所谓的“理想流程”和“预设逻辑”中，应该考虑如何解决对话过程中出现的错误，例如设计相关的对白告知用户当前的状况是什么、提供修复错误的说明引导，是整个人机对话流程基于对话流和“合作原则”重回正轨。修复对话的关键在于学会站在机器的视角来看待问题。\n· 导致对话失败的情况有：\n计算机没有获取到任何输入。可能是确实没有输入，也可能是系统没有检测到，获取信息超时。（无ASR） 虽然计算机获取到了信息，但是却不能识别或解析，这种情况可能是有背景噪音或多个用户一起说话。（有ASR但有误） 识别到了用户的输入信息，但系统不知道如何回应和处理。（NLP兜底） 错误地识别了用户输入的信息。（NLP有误） 修复对话设计原则 · 针对上述的四种对话失败情况：\n当用户超时输入或无输入时，可以再次提示一遍刚才的问题，用较为简洁的句式变体对原有问题进行二次询问。\n理解了内容跟但不能提供帮助，又具体分为四种情况：\n不支持用户要求的功能，可以说“我目前还不能帮助你做XX，不过我可以帮你XXX”，告诉用户该功能不可用。设计师需要提前计划要做的功能的意图，然后跟踪用户何时请求不支持的功能，更好地确定功能的优先级。\n用户说法不清导致意图识别信息缺失，通过询问引导用户再说一遍，完成必要槽位信息的补充。在询问时建议列举相关内容供用户参考，比如“一共找到两个XXX，请问您要打开第一个还是第二个？”\n因阈值上下限导致语音助手不能提供完整的帮助（比如音量最高100%，用户还想再提高音量），需要告诉用户当前状况并推荐相关操作。\n明确知道用户的指令是错误的，需要引导用户重回正轨或恢复默认状态。设计师应该提前想到用户的常用说法，并在意图设计和回复上体现出来，比如空调有1-4档，用户觉得4档开冷于是说“关闭4档”，但风量档位意图只有切换没有挂你的概念，这时应该回复“风量档位以为您调回1档”。\n因各种原因导致语音识别不清晰，系统不知道用户说了什么，可以对内容进行语法分析和关键字匹配，匹配上关键字就可以交由FAQ模块或第三方搜索模块来解决，如果没匹配上关键字且语法分析问题较大，则通过兜底。\n用户在多轮对话过程中没按照脚本走导致理解出问题，可以在多轮交互过程中提示用户目前支持的说法是什么，从而限制多轮交互中用户的说法；或者询问用户是否退出当前多轮并进入新一轮对话。\n谷歌语音交互设计走查表 · 包括问候语与结束语、设计自然流畅的对话、人物画像、对话修复/容错等。\nFilter table dataCreate a pivot tableCreate a chart from data series\nConfigure buttons visibility\n",
  "wordCount" : "240",
  "inLanguage": "zh",
  "image": "http://localhost:1313/images/papermod-cover.png","datePublished": "0001-01-01T00:00:00Z",
  "dateModified": "0001-01-01T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "王宇"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://localhost:1313/posts/wiki/2.2%E6%84%8F%E5%9B%BE%E8%AE%BE%E8%AE%A1%E5%AF%B9%E8%AF%9D%E8%AE%BE%E8%AE%A1/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "PaperMod",
    "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:1313/%3Clink%20/%20abs%20url%3E"
    }
  }
}
</script>
</head>

<body class=" dark" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="Home (Alt + H)">
                        
                    <img src="http://localhost:1313/images/msg_hu15231257772499651944.png" alt="" aria-label="logo"
                        height="20">Home</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/archives" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://github.com/adityatelange/hugo-PaperMod/wiki/" title="WiKi">
                    <span>WiKi</span>&nbsp;
                    <svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round"
                        stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12">
                        <path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"></path>
                        <path d="M15 3h6v6"></path>
                        <path d="M10 14L21 3"></path>
                    </svg>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://localhost:1313/">主页</a>&nbsp;»&nbsp;<a href="http://localhost:1313/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      2.2、意图设计&amp;对话设计
    </h1>
    <div class="post-description">
      2、语音交互设计知识
    </div>
    <div class="post-meta">2 分钟&nbsp;·&nbsp;王宇&nbsp;|&nbsp;<a href="https://github.com/WangShaoyu1/myBlogPaperMod/tree/master/content/posts/wiki/2.2%e3%80%81%e6%84%8f%e5%9b%be%e8%ae%be%e8%ae%a1&amp;%e5%af%b9%e8%af%9d%e8%ae%be%e8%ae%a1.md" rel="noopener noreferrer" target="_blank">Suggest Changes</a>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">目录</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#34-%e8%af%ad%e9%9f%b3%e4%ba%a4%e4%ba%92%e6%a1%86%e6%9e%b6%e6%84%8f%e5%9b%be%e8%ae%be%e8%ae%a1" aria-label="3.4 语音交互框架、意图设计">3.4 语音交互框架、意图设计</a><ul>
                        <ul>
                        
                <li>
                    <a href="#%e5%94%a4%e9%86%92%e7%8a%b6%e6%80%81" aria-label="唤醒状态">唤醒状态</a></li>
                <li>
                    <a href="#%e8%81%86%e5%90%ac%e7%8a%b6%e6%80%81" aria-label="聆听状态">聆听状态</a></li>
                <li>
                    <a href="#%e7%bd%91%e7%bb%9c%e7%ad%89%e5%be%85%e7%8a%b6%e6%80%81" aria-label="网络等待状态">网络等待状态</a></li>
                <li>
                    <a href="#%e8%af%ad%e9%9f%b3%e6%92%ad%e6%8a%a5%e7%8a%b6%e6%80%81" aria-label="语音播报状态">语音播报状态</a></li>
                <li>
                    <a href="#%e9%95%bf%e8%bf%9e%e6%8e%a5%e9%80%9a%e4%bf%a1%e7%8a%b6%e6%80%81" aria-label="长连接通信状态">长连接通信状态</a></li>
                <li>
                    <a href="#%e7%bb%93%e6%9d%9f%e8%87%b3%e9%bb%98%e8%ae%a4%e7%8a%b6%e6%80%81" aria-label="结束至默认状态">结束至默认状态</a></li></ul>
                    </ul>
                </li>
                <li>
                    <a href="#35-%e5%af%b9%e8%af%9d%e8%ae%be%e8%ae%a1%e5%8e%9f%e5%88%99" aria-label="3.5 对话设计原则">3.5 对话设计原则</a><ul>
                        <ul>
                        
                <li>
                    <a href="#%e4%bb%bb%e5%8a%a1%e5%9e%8b%e5%af%b9%e8%af%9d%e8%ae%be%e8%ae%a1%e5%8e%9f%e5%88%99" aria-label="任务型对话设计原则">任务型对话设计原则</a></li>
                <li>
                    <a href="#-%e8%ae%be%e8%ae%a1%e5%af%b9%e8%af%9d%e8%84%9a%e6%9c%ac%e9%9c%80%e8%a6%81%e5%85%b3%e6%b3%a8%e7%9a%84%e7%82%b9" aria-label="· 设计对话脚本需要关注的点：">· 设计对话脚本需要关注的点：</a></li>
                <li>
                    <a href="#%e4%bf%ae%e5%a4%8d%e5%af%b9%e8%af%9d%e8%ae%be%e8%ae%a1%e5%8e%9f%e5%88%99" aria-label="修复对话设计原则">修复对话设计原则</a></li>
                <li>
                    <a href="#%e8%b0%b7%e6%ad%8c%e8%af%ad%e9%9f%b3%e4%ba%a4%e4%ba%92%e8%ae%be%e8%ae%a1%e8%b5%b0%e6%9f%a5%e8%a1%a8" aria-label="谷歌语音交互设计走查表">谷歌语音交互设计走查表</a>
                </li>
            </ul>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><ul>
<li>1<a href="/posts/wiki/2.2%E6%84%8F%E5%9B%BE%E8%AE%BE%E8%AE%A1%E5%AF%B9%E8%AF%9D%E8%AE%BE%E8%AE%A1/#id-2.2、意图设计&对话设计-3.4语音交互框架、意图设计">3.4 语音交互框架、意图设计</a>
<ul>
<li>1.1<a href="/posts/wiki/2.2%E6%84%8F%E5%9B%BE%E8%AE%BE%E8%AE%A1%E5%AF%B9%E8%AF%9D%E8%AE%BE%E8%AE%A1/#id-2.2、意图设计&对话设计-唤醒状态">唤醒状态</a></li>
<li>1.2<a href="/posts/wiki/2.2%E6%84%8F%E5%9B%BE%E8%AE%BE%E8%AE%A1%E5%AF%B9%E8%AF%9D%E8%AE%BE%E8%AE%A1/#id-2.2、意图设计&对话设计-聆听状态">聆听状态</a></li>
<li>1.3<a href="/posts/wiki/2.2%E6%84%8F%E5%9B%BE%E8%AE%BE%E8%AE%A1%E5%AF%B9%E8%AF%9D%E8%AE%BE%E8%AE%A1/#id-2.2、意图设计&对话设计-网络等待状态">网络等待状态</a></li>
<li>1.4<a href="/posts/wiki/2.2%E6%84%8F%E5%9B%BE%E8%AE%BE%E8%AE%A1%E5%AF%B9%E8%AF%9D%E8%AE%BE%E8%AE%A1/#id-2.2、意图设计&对话设计-语音播报状态">语音播报状态</a></li>
<li>1.5<a href="/posts/wiki/2.2%E6%84%8F%E5%9B%BE%E8%AE%BE%E8%AE%A1%E5%AF%B9%E8%AF%9D%E8%AE%BE%E8%AE%A1/#id-2.2、意图设计&对话设计-长连接通信状态">长连接通信状态</a></li>
<li>1.6<a href="/posts/wiki/2.2%E6%84%8F%E5%9B%BE%E8%AE%BE%E8%AE%A1%E5%AF%B9%E8%AF%9D%E8%AE%BE%E8%AE%A1/#id-2.2、意图设计&对话设计-结束至默认状态">结束至默认状态</a></li>
</ul>
</li>
<li>2<a href="/posts/wiki/2.2%E6%84%8F%E5%9B%BE%E8%AE%BE%E8%AE%A1%E5%AF%B9%E8%AF%9D%E8%AE%BE%E8%AE%A1/#id-2.2、意图设计&对话设计-3.5对话设计原则">3.5 对话设计原则</a>
<ul>
<li>2.1<a href="/posts/wiki/2.2%E6%84%8F%E5%9B%BE%E8%AE%BE%E8%AE%A1%E5%AF%B9%E8%AF%9D%E8%AE%BE%E8%AE%A1/#id-2.2、意图设计&对话设计-任务型对话设计原则">任务型对话设计原则</a></li>
<li>2.2<a href="/posts/wiki/2.2%E6%84%8F%E5%9B%BE%E8%AE%BE%E8%AE%A1%E5%AF%B9%E8%AF%9D%E8%AE%BE%E8%AE%A1/#id-2.2、意图设计&对话设计-·设计对话脚本需要关注的点：">· 设计对话脚本需要关注的点：</a></li>
<li>2.3<a href="/posts/wiki/2.2%E6%84%8F%E5%9B%BE%E8%AE%BE%E8%AE%A1%E5%AF%B9%E8%AF%9D%E8%AE%BE%E8%AE%A1/#id-2.2、意图设计&对话设计-修复对话设计原则">修复对话设计原则</a></li>
<li>2.4<a href="/posts/wiki/2.2%E6%84%8F%E5%9B%BE%E8%AE%BE%E8%AE%A1%E5%AF%B9%E8%AF%9D%E8%AE%BE%E8%AE%A1/#id-2.2、意图设计&对话设计-谷歌语音交互设计走查表">谷歌语音交互设计走查表</a></li>
</ul>
</li>
</ul>
<h2 id="34-语音交互框架意图设计">3.4 语音交互框架、意图设计<a hidden class="anchor" aria-hidden="true" href="#34-语音交互框架意图设计">#</a></h2>
<p>· <strong>四种语音交互模式</strong>：</p>
<ol>
<li>单轮交互：指智能语音助手被唤醒后只能完成一项任务，不管是否完成了任务，智能语音助手都会进入休眠状态，用户要继续使用智能重新唤醒它。绝大部分的智能语音助手和语音任务都属于单轮。</li>
<li>多轮交互：一些相对复杂的语音任务很难一句话说清楚，多轮对话指不用多次唤醒，双方可以通过多轮交流的方式完成一项任务，当任务完成后会自动进入休眠状态。多轮交互的缺点在于，智能语音助手在播报时麦克风处于关闭，要播报完才会打开麦克风聆听用户的声音（不能中途插话），除非再次唤醒，但再次唤醒就会将前面几轮的对话过程清空。</li>
<li>持续监听：指一旦唤醒后，智能语音助手就会把麦克风一直打开，用户可以一直说。持续监听依然存在问题，假设上一轮对话未结束，这时智能语音助手听到其他人说的话，会误以为时新的语音任务，就会直接结束上一轮并播报新的内容或停止播报。</li>
<li>全双工语音交互：拥有更强的抗噪能力和上下文理解能力，不会像持续监听一样容易被噪声打断整个对话过程。可以理解每一句话是否跟当前任务有关，并猜测当前任务的下一轮对话是什么，做到真正的“边听边说”。</li>
</ol>
<p>· <strong>四种“唤醒+识别”方式</strong>：在语音交互设计时应该根据它们的优劣势进行选择并综合使用。</p>
<ol>
<li>“唤醒+在线意图识别”：在线意图识别的好处是云端有较强的算力支持将语音转换成文字和自然语言进行理解，弊端是任何操作都要云端处理，一旦信号不好，网络延迟变长，就会影响体验。</li>
<li>“唤醒+离线意图识别”：离线意图识别就是为了解决信号不好导致指令无法执行的问题，一般离线意图识别主要服务于常用的简单指令。</li>
<li>“免唤醒”：免唤醒也用了唤醒词技术，只不过把默认唤醒词改为了指令，新的唤醒词被命中后会直接执行相关指令。但不能把所有指令设置为免唤醒。</li>
<li>“one-shot”：也被称为“唤醒连说”技术，意思是“唤醒词+意图识别”一体化，支持用户在说出唤醒词后不停顿，立刻说出后续需求。</li>
</ol>
<p>· <strong>语音交互状态设计</strong>：整个语音交互框架会围绕各种语音状态进行设计，但仅靠声音的反馈用户很难知道现在交互流程处于哪个状态，对用户来说体验不好，因此在设计语音交互框架时需要考虑更全面。</p>
<h4 id="唤醒状态">唤醒状态<a hidden class="anchor" aria-hidden="true" href="#唤醒状态">#</a></h4>
<p>· 设计唤醒状态前需要考虑当前设备采用的是那种语音交互方式（包括前述的四种语音交互模式与四种“唤醒+识别”方式），还需要考虑该设备使用的是近场语音交互还是远场语音交互。近场语音交互：指人距离机器不超过30cm，一般近场会通过按键或唤醒词的方式唤醒智能语音助手，由于设备就在眼前，可以通过视觉反馈的方式告知用户已被唤醒。远场语音交互：指人距离机器0.3~5m，由于用户距离设备较远，可能看不清当前设备的状态，因此需要通过听觉反馈告知用户是否被唤醒。</p>
<h4 id="聆听状态">聆听状态<a hidden class="anchor" aria-hidden="true" href="#聆听状态">#</a></h4>
<p>· 在唤醒状态之后，具体分为等待用户响应状态和ASR状态。前者为等待用户说话的过程，后者为将用户说的话自动转成文字的过程。</p>
<p>· 等待用户响应状态需要设置一个时间上限，如果用户一直不说话，到达时间上限后会自动退出或发起二次询问，然后进入下一轮的等待状态。时间不是越长越好，如果没有很好的抗噪能力，可能会突然执行无关的指令，影响用户体验。</p>
<p>· 在单轮交互和多轮交互模式下，亚马逊的智能音箱Echo设置的等待时间上限为8s，8s内如果一直没有说话Echo会二次寻味，再不说话就会自动休眠。持续监听与全双工语音交互的设计相对复杂，等待用户响应时间分为初次唤醒聆听、二次询问、持续聆听，建议初次唤醒聆听与二次询问的等待时间上限设置为8s，而持续聆听是指上一轮对话结束后的等待时间，用户随时可能发起新一轮语音任务，所以建议设置长一些（20~30s）。</p>
<h4 id="网络等待状态">网络等待状态<a hidden class="anchor" aria-hidden="true" href="#网络等待状态">#</a></h4>
<p>· 绝大部分语音交互的识别和处理都在云端进行，返回语音结果需要一段时间，因此网络等待状态必须反馈给用户，因为用户不知道该状态何时会结束。</p>
<h4 id="语音播报状态">语音播报状态<a hidden class="anchor" aria-hidden="true" href="#语音播报状态">#</a></h4>
<p>· 不同产品在处理语音播报状态方面有着不一样的反馈设计，比如呼吸灯效、动态表情、直接显示播报的文字内容等。还要考虑到是否会对用户产生干扰（驾驶时占用视觉通道等）。</p>
<h4 id="长连接通信状态">长连接通信状态<a hidden class="anchor" aria-hidden="true" href="#长连接通信状态">#</a></h4>
<p>· 持续监听和全双工依赖长连接通信质量，即指客户端和云端保持一段时间的通信，如果长连接通信质量时好时坏，就会导致云端接收到的信息缺失和意图识别有误。如果不将长连接通信状态的通信质量突出显示，则当因为通信问题导致意图识别不准确时，用户就会认为是智能语音助手的问题。建议在设计这个状态时，可以优先考虑音效设计，比如加入微小的“滋滋滋”电流声，让用户知道当前的通话质量受到了干扰。</p>
<h4 id="结束至默认状态">结束至默认状态<a hidden class="anchor" aria-hidden="true" href="#结束至默认状态">#</a></h4>
<p>· 任务结束或用户在规定的时间内没有说话，设备的麦克风停止拾音，语音交互到此结束。可以通过音箱的一系列动作（摄像头回正等）、动态表情等来表现。</p>
<p>· 由于语音交互涉及的状态很多，因此设计师应该全局考虑如何通过一套设计覆盖所有的状态和场景。</p>
<p>· 天猫精灵IN糖的体验设计师为了拉近用户和智能音箱的距离，用PAD（Pleasure - Arousal - Dominance，即愉悦度-唤醒度-优势度）情绪状态模型对天猫精灵IN糖进行人格化情绪引擎设计，并围绕语音交互语料、表情分组和语音技能屏显这三个要素，设计出一系列更自然、更符合用户对话语境的情绪表达。</p>
<p>· <strong>意图设计术语介绍</strong>：计算机听懂人说话得益于意图识别和实体提取的能力，在设计语音意图之前，需要了解与意图设计相关的术语。</p>
<ul>
<li><em>技能（Skill）</em>：可以简单理解为一个应用。David J. Major发现，大多数Alexa用户无法分辨亚马逊官方和第三方厂商开发的技能之间的区别，很有可能是因为每种技能都用了同一种声音播报，用户呼喊触发词会加深用户对该品牌的记忆，因此第三方应用更需要通过触发词及其他方式提升用户对该品牌的印象。</li>
<li><em>意图（Intent）</em>：可以简单理解为某个应用的功能或流程，主要满足用户的请求或目的。有些意图隶属于某项技能，如果用户脱离技能输入意图，则系统就无法理解并执行；有些意图可以忽略技能而直接执行，默认属于系统技能（比如查天气）。做语音交互更多的是在设计意图怎样被理解并执行相关操作。</li>
<li><em>词典（Dictionary）</em>：可以理解为某个领域内词汇的集合。有些词语会存在于不同的词典中，不同词典的调用也会影响意图的识别。比如“刘德华”“张学友”既属于“男歌星”这个词典，又属于“电影男演员”这个词典，当用户说“我要看刘德华的电影”时，匹配到的是“电影男演员”的词典；当用户说“我要听刘德华的歌”时，匹配到的是“男歌星”的词典；如果用户说“打开刘德华”，就不知道是要匹配哪个词典了（需要人为设计相关策略来匹配）。</li>
<li><em>词槽（Slot）和槽位</em>：词槽可以理解为一句话中所包含的参数是什么。槽位是指这句话里有多少个参数，它们直接决定系统能否匹配到正确的技能和意图。词槽和词典时强相关的。在设计前，需要了解清楚语音智能平台是否支持词槽状态选择（可选、必选）、是否具备泛化能力、槽位是否支持通配符。</li>
<li><em>泛化（Generalize）</em>：指同一个意图有不同的表达方式，泛化能力会直接影响系统能否听懂用户在说什么以及设计师的工作量，同时也反映出该平台的人工智能水平如何。当前大部分平台的泛化能力较弱，需要设计师源源不断地将不同的表达方式写入系统，不同的表达方式可以通过“无意义词”这个词槽来实现（类似百度AI平台上的“特征词”词槽）。词槽和槽位的设计也会影响泛化能力。</li>
<li><em>通配符（Wildcard Character）</em>：主要用来进行模糊搜索和匹配。在意图设计中，当缺少数据导致某些词典数据不全时，通配符能够直接简化制作词典的工作量。比如，“XXX”是一个通配符，在“视频播放”这个意图增加“我想看XXX电影”这个表达后，无论XXX是什么，都能打开视频应用搜索XXX电影。通配符使用一定要合理，用得越多，越会影响词槽和槽位的设计，导致系统识别意图时不知道如何对众多匹配到的意图进行排序。</li>
<li><em>实体（Entity）</em>：获取意图中的关键信息是通过实体提取实现的。实体提取是信息抽取、信息检索、机器翻译、问答系统等多种自然语言处理必不可少的组成部分。前述的词典、泛化和通配符都是为了让系统更好地提取出实体。</li>
<li>Bot：可以简单理解为意图识别的执行方，是一个功能合集，包含了很多技能。</li>
</ul>
<p>· 决定你的产品能否听懂用户说的大部分内容，主要由智能语音平台决定，在做产品设计前，需要了解智能语音平台的以下7个方面：</p>
<ol>
<li>了解智能语音平台的NLU能力如何，是否具备较好的泛化能力。NLU是每个智能语音平台的核心。一般来说计算机会通过文本分析和文本匹配两种方法实现意图识别。</li>
<li>了解系统的意图匹配规则是完全匹配还是模糊匹配。只支持词槽完全匹配的智能语音平台几乎没有任何泛化能力，这需要设计师考虑通过构建词典、词槽和槽位的方式实现意图泛化。如果智能语音平台支持词槽模糊匹配，说明系统采用了识别关键词的方式，对“请帮我把声音调高一点”的指令，能识别出“声音调高一点”分别属于操作对象、调整、状态三个词槽，而其他文字“请帮我把”将被忽略。</li>
<li>了解智能语音平台对语言的支持程度如何。不同的语言都不同的语法和特点，会影响到NLU。</li>
<li>了解智能语音平台的系统词典数量是否足够多、每个词典拥有的词汇量是否齐全。词典收集不完整的结果是系统很有可能不知道用户说的内容是什么意思。</li>
<li>了解智能语音平台是否支持客户端和服务端自定义参数的传输，类似5W1H这类场景化的参数如果不支持传输，那在设计时就只能考虑多轮对话的上下文，而不能结合当前的位置和时间等参数进行设计。尤其是带屏幕的语音设备，因为用户有可能说完一句话就直接操作屏幕，然后又继续语音对话，如果语音设备不知道用户在屏幕上进行什么操作，那智能语音平台就不知道用户整个使用流程是怎样的。</li>
<li>了解智能语音平台是否支持意图的自定义排序。意图匹配很可能匹配到多个意图，只是每个意图都有不同的匹配概率，最终系统只召回概率最大的意图，而意图应该根据当前的场景进行匹配，而不只是根据词槽。意图自定义排序很重要，因为它能根据特定参数匹配某些低概率的意图，实现场景化的理解。</li>
<li>了解智能语音平台是否支持声纹识别。一台设备多人使用，声纹识别可以区分当前使用者十四黑，有助于针对不同用户提供个性化回答。</li>
</ol>
<p>· 以“给带屏设备设计一款智能语音系统”为例，使用的智能语音平台不具备泛化能力，但可以自定义参数传输和意图自定义排序。设计内容分为系统全局设计和意图设计：</p>
<ol>
<li>
<p><strong>系统全局设计</strong>：</p>
<ol>
<li>
<p>以多种形式告知用户系统暂时无法理解用户的语义，比如“抱歉，目前还不能理解你的意思”。这种兜底策略成本最低，但出现频率过高，会让用户觉得产品没什么用，很不智能。</p>
</li>
<li>
<p>将听不懂的语句传给第三方搜索功能。提取用户输入的关键词到搜索网站上找答案，但是答案过多，导致用户操作成本有点高。</p>
</li>
<li>
<p>将听不懂的语句传给第三方闲聊机器人。闲聊机器人需要第三方API支持，成本最高，但效果也是最好的，让产品看起来更人性化。</p>
</li>
<li>
<p>将听不懂的语句传给Q&amp;A。根据目标人群和使用场景建立一套问答系统，比如驾驶场景可能问的更多的是关于如何驾驶的，家里的智能音箱问的最多的是小朋友的十万个为什么。可以通过“为什么”“怎么”等关键词识别并匹配相应的Q&amp;A。</p>
</li>
<li>
<p>词汇的覆盖面决定了词典质量，词汇量越多越好。</p>
</li>
<li>
<p>是否考虑动态更新，比如名人、视频、音乐等都需要支持动态更新。</p>
</li>
<li>
<p>该词汇是否有同义词，考虑其他常用叫法。</p>
</li>
<li>
<p>该词汇是否是多音字，是否会有常见的错误叫法。</p>
</li>
<li>
<p>保持互动语言简短，避免重复的短语。</p>
</li>
<li>
<p>写出人们是如何交谈的，而不是如何阅读和写作的。</p>
</li>
<li>
<p>当需要用户提供信息时，给出相应的指示。</p>
</li>
<li>
<p>不要假设用户知道该做什么。</p>
</li>
<li>
<p>问问题时一次只问一个问题。</p>
</li>
<li>
<p>在让用户做选择时，一次提供不超过三个选项。</p>
</li>
<li>
<p>学会使用话轮转换（Turn-taking），指会话中说话人和听话人角色的不断相互变换。若缺少有效的轮回，就有可能出现对话的双方同事说话或对话内容不同步并且难以被理解的情况。</p>
</li>
<li>
<p>对话中的所有元素应该可以被绑定在一起，成为简单的一句话，这些元素是意图设计中最重要的参数。</p>
</li>
</ol>
</li>
<li>
<p>赋予产品一个固定的人物形象。首先明确我们的用户群体，再根据用户群体的画像设计一个虚拟角色，对角色进行描述，包括采用的音色。</p>
</li>
<li>
<p>考虑设计产品的目的是什么、将为用户提供哪些技能（应用）、这些技能的目的是什么、用户为什么要使用它、用户通过这些技能能做什么和不能做什么、用户可以用哪些方式调用该技能，以及产品将会应用在哪个垂直领域。对自己提供的技能进行先后排序。</p>
</li>
<li>
<p>建立合理的兜底方案，即当语音完全匹配不上意图时提供的最后解决方案。兜底方案有以下四种，它们之间是互斥的，可以通过语法识别、关键词匹配等方式建立置信度，从而选择合适的兜底方案——匹配上关键词后，可以交由Q&amp;A模块或第三方搜索功能来解决；如果没匹配上关键词且语法分析没太大问题，则可以交由闲聊模块解决；如果问题很大，则告知用户“抱歉没理解”（大部分语句中语法有严重问题都是噪声导致的）。</p>
</li>
<li>
<p>查看智能语音平台是否提供了与技能相关的垂直领域官方词典，如果没有，考虑手动建立自己的词典。需要注意以下几点：</p>
</li>
<li>
<p>在场景的帮助下，可以更好地理解用户的意图。由于大部分设备都使用了开源的安卓系统，而且语音应用和其他应用相互独立，信息几乎不能传输，所以可以通过安卓官方的API获取栈顶应用信息，了解用户当前处于哪个应用中。如果用户当前使用的应用是由自己设计开发的，那么可以将用户的一系列操作流程及相关参数传输给服务器进行分析，这样有助于更好地判断用户的想法是什么，并前置最相关的意图。</p>
</li>
<li>
<p>可以使用脚本来帮助确认可能没考虑到的情况，撰写脚本需要考虑以下几点（可参看3.5节）：</p>
</li>
<li>
<p>将脚本转化为决策树，类似信息架构，通过决策树可以发现整个技能是否设计得不严谨，从而知道如何优化；还能帮助我们考虑任务的跳出机制问题，如果不允许用户跳出任务，则应该友好地告诉用户当前的情况或询问是否退出任务并进行新的任务。</p>
</li>
<li>
<p><strong>意图设计</strong>：</p>
</li>
<li>
<p>意图设计并不是槽位越多越好，要根据实际情况而定，设计者在设计词槽和槽位时，可以结合当前语言的语法和词性一起考虑，比如每句话需要考虑主、谓、宾结构，还有各种名词、动词、副词、量词和形容词。</p>
</li>
<li>
<p>当智能语音平台泛化能力较弱时，可以考虑手动提升整体的泛化能力：将常用的表达方式抽离出来成为独立的词典，然后让每个意图都匹配该词典。</p>
</li>
<li>
<p>如果设计的是系统产品，应该考虑全局意图的设计，比如带屏智能音箱、投影仪都是由实体按键的，可以考虑通过语音命令的方式模拟按键操作，从而达到全局操作的目的。（所见即所得）</p>
</li>
</ol>
<p>· 完成整个全局设计和意图设计后，应该邀请用户进行实践和测试，用户可能会用我们意想不到的话术进行对话，从而可以尽可能地完善意图及对话设计。</p>
<h2 id="35-对话设计原则">3.5 对话设计原则<a hidden class="anchor" aria-hidden="true" href="#35-对话设计原则">#</a></h2>
<p>· 为用户解决问题、创建有温度的对话流程是智能交互平台设计师的愿景。</p>
<p>· 设计对话前需要了解的事项：</p>
<ol>
<li>
<p>考虑计算机的局限：在设计前要考虑技术的优势和不足。技术的局限性引入了人与人对话中不会发生的场景，这些局限性应该提前提示用户。另外，当语音系统还达不到很聪明、随意交流的程度时，就不应该让用户误认为它可以达到。</p>
</li>
<li>
<p>确定用户场景：为了实现个性化和场景化设计，可以通过技术手段获取用户定位、时间和用户身份（包括声纹、用户注册信息）等信息，在设计对话脚本前需要考虑以下几个与场景相关的问题：</p>
</li>
<li>
<p>Where：用户在哪里？所处的环境是怎样的？</p>
</li>
<li>
<p>What：用户正在做什么？</p>
</li>
<li>
<p>How：用户使用的是什么设备？</p>
</li>
<li>
<p>What：用户要完成什么任务？目标是什么？</p>
</li>
<li>
<p>Why：用户的期望和意图是什么？</p>
</li>
<li>
<p>明确要设计的技能是什么：不同类型的技能面向不同的用户群体和用户场景。所有的技能都可以分为：</p>
</li>
<li>
<p>播报型：为用户提供内容服务，例如音乐、新闻、百科、食谱、故事等；</p>
</li>
<li>
<p>指令型：在用户和生活服务之间建立一座桥梁，帮助用户解放双手，通过语音就能控制家居、发送短信、叫外卖等；</p>
</li>
<li>
<p>互动型：用户通过多轮对话的方式与设备交互，主要用于娱乐领域，如问答测试、情景探险、识图对话、听音唱歌等。</p>
</li>
<li>
<p>明确要设计的对话类型是什么：不同的技能对应着不同的对话类型，从应用场景的覆盖面看，对话类型可以分为开放域（Open-domain）和封闭域（Closed-domain）。开放域对话类型没有太多限定的主题或明确的目标，需要大量的知识库和复杂的模型，一般用于闲聊场景；封闭域对话类型通常会限定在一定场景之下，需要一个垂直领域建立的模型和知识图谱，对对话的质量要求更高，对错误的容忍度更低，一般用于任务、问答或娱乐场景。据此，对话类型主要分为以下四种（见表格）：</p>
</li>
<li>
<p>提前定义好智能助手的人物设定。</p>
</li>
<li>
<p>了解对话的关键因素：谷歌的设计师通过解构那些我们习以为常的自然对话中的规则和管理挖掘出一个VUI对话的关键因素：（语音交互设计指南 Actions on Google Design）</p>
</li>
<li>
<p>话轮转换（Turn-taking）：当轮到用户说话时，智能语音助手应该发出清晰的信号，例如音效提醒。用户说话时，智能语音助手也不要贸然强行打断。</p>
</li>
<li>
<p>对话线索（Treading）：对话中的对话线索可以帮助我们更容易地跟上对话的节奏。</p>
</li>
<li>
<p>利用语音固有的效率：人们经常使用较为简短的口头表达方式，我们基本上可以感知对话中的“言外之意”，而VUI中的隐喻则必须能够弥补人类语言中看似不合逻辑、非理性的部分。</p>
</li>
<li>
<p>预测不同的用户行为：人们会用不同的词语和说话方式去描述同样的事情，这取决于他们自己的情景语境和自己的经验产生的对VUI的预期，VUI需要支持这些差异。</p>
</li>
<li>
<p>遵循会话“合作原则”：美国语言哲学家格莱斯（Paul Grice）认为，在人们交际的过程中，对话双方似乎在有意无意地遵循着某个原则，以求有效地配合，从而完成交际任务。语音交互可以考虑遵循对话的“合作原则”进行设计（如下）。但实际语言交际中，人们并非总是遵循这个原则，格莱斯把这种表面上故意违反“合作原则”而产生的言外之意成为“特殊会话含义”，需要依赖特殊语境才能推导出来的含义。设计者在设计脚本时应尽量避免使用这种对话方式，避免用户理解不了。</p>
</li>
<li>
<p>量的准则：所说的话应该满足且不超出交际所需的信息量。</p>
</li>
<li>
<p>质的准则：不要说自知是虚假的和缺乏足够证据的话。</p>
</li>
<li>
<p>关系准则：所说的话要贴切，要与交谈目的和交谈内容有关系，不说不相干的话。</p>
</li>
<li>
<p>方式准则：所说的话要简洁明了，不要拐弯抹角产生歧义。</p>
</li>
<li>
<p>对话不存在“出错”的概念：逻辑和准确性不是万能法则，用户的任何请求都是有目的的，即使没有明确说出来。不管用户说了什么，都不要把它当成是一个错误来处理，而是要考虑把它转变为一个机会，用新的方式来处理，从而进行更顺畅、更自然的沟通。有助于把“错误”转换成对话交互中自然的一部分的方法如下：</p>
</li>
<li>
<p>不要把技术上的“出错”当作用户的错误。</p>
</li>
<li>
<p>为不同类型的“出错”提供对应的、适合的处理方式。</p>
</li>
<li>
<p>通过提供帮助来避免出错。</p>
</li>
<li>
<p>知道在什么情况下放弃。</p>
</li>
<li>
<p>使完成任务的路径更短，从而掩盖错误。</p>
</li>
</ol>
<p>对话类型</p>
<p>含义</p>
<p>特点</p>
<p>目标</p>
<p>对话类型</p>
<p>含义</p>
<p>特点</p>
<p>目标</p>
<p>1、任务类型</p>
<p>指在特定条件下为带有明确目的的用户提供信息或服务</p>
<p>设计起来比较复杂，非常依赖意图识别技术，通常使用意图识别+多轮对话+对接内容提供商的API和知识图谱</p>
<p>用最短的对话轮次来完成用户的任务，把在对话中获取的信息转换成需要的参数</p>
<p>2、问答类型</p>
<p>问题也是一种任务，问答类型与任务类型的对话有一定的相似性<br>
一般用于客服机器人上，能和用户进行基本沟通并自动回复用户有关产品或服务的相关问题</p>
<p>意图设计非常简单，一般抓住关键词“为什么”和“是什么”即可，然后通过FAQ+对接内容提供商的API和知识图谱回答用户的问题</p>
<p>用最短的对话轮次来回答用户的问题</p>
<p>3、闲聊类型</p>
<p>开放域类型，没有明确目的的对话，主要根据用户对话中出现的关键词进行回复</p>
<p>不精确，不可控，机器的回复都在闲聊库，通过检索给出响应的回复</p>
<p>对话轮次越多越好</p>
<p>4、游戏/娱乐类型</p>
<p>结合了任务类型与闲聊类型的特点，还要考虑游戏类型、趣味性等因素进行设计</p>
<p>脚本分支多，游戏类型还需考虑故事线，设计起来比较复杂</p>
<p>让用户放轻松</p>
<p>· 设计脚本的目的是让用户理解对话的内容，帮助用户快速完成任务。如果对话过程中需要多轮对话，则脚本能引导用户给出够用的、正确的信息，然后执行用户希望完成的任务。</p>
<p>· 一个好的脚本应该是站在人们如何交谈的视角进行设计的，而不是通过阅读和写作视角进行刻板设计的。</p>
<h4 id="任务型对话设计原则">任务型对话设计原则<a hidden class="anchor" aria-hidden="true" href="#任务型对话设计原则">#</a></h4>
<h4 id="-设计对话脚本需要关注的点">· 设计对话脚本需要关注的点：<a hidden class="anchor" aria-hidden="true" href="#-设计对话脚本需要关注的点">#</a></h4>
<ol>
<li><strong>提升对话内容的多样性</strong>：尝试在固定回答上加入不同的对白，比如用户调用技能的时候，可以考虑丰富多变的欢迎语，还可以考虑提供关于技能基本功能的提示，设计固定回复时可以通过同义词为答案增加变化，然后从这些答案里随机选择一个作为回复。</li>
<li><strong>尊重用户的时间</strong>：尽量在短时间内将必要的回复信息表达出来。在交谈中，说得太多与说得太少一样表现得不合作，从用户角度出发，保持简短和最佳相关性有助于用户理解。</li>
<li><strong>保持文案的一致性</strong>：在写脚本时保持语句中动词、名词搭配的语法一致性，以及用户、智能语音助手的称呼的一致性。（写文案技巧，能用“咱”时就不用“你”，拉近与用户的距离）</li>
<li><strong>减轻用户的认知负担</strong>：在编写脚本时，尽量避免使用“科技术语”“专业词汇”“方言用语”等。通过一致的称谓来称呼同一个事物，帮助用户降低对同一事物的认知负担。</li>
<li><strong>逐步向用户获取信息</strong>：用户在进行语音交互的时间里，通常无法将所有完成意图所需的关键参数说出来，此时应避免垄断对话，不要一口气提出所有问题，而要将问题分解成多个独立问题，一个一个地提问，引导出所有答案。</li>
<li><strong>尽量提供少于三个的选项</strong>：如果选项过多，则为用户找出与输入预期匹配度最高的三个选项，列表中的第一项应与用户刚刚采取的操作最相关。</li>
<li><strong>不要假设用户会准确地把设想的对白表达出来</strong>：虽然有“合作原则”，但是用户经常会提供比智能语音助手真正需要的更多的信息（过度回答），这时智能语音助手要能够获取这些回答，不需要再问很多问题；除此之外，还要包容多种说话风格，把用户可能会说的句子、短语和单词最大范围地呈现出来；还有一种情况是，用户在说话时突然改变主意或立刻更正，这时候用户会在正确的意图前加上“不”“要不还是算了”等短语，这种情况非常依赖语音交互系统的泛化能力，在意图和词槽设计上没有较好的解决方法。</li>
<li><strong>不要假设用户知道该怎么做或会发生什么</strong>：不要猜测用户的意思，提供事实信息让用户自己做决策，当用户需要时给出提示；用户回答的顺序也可能和脚本流程设计的顺序不一致，需要考虑全部情况。</li>
<li><strong>在追问过程中为用户提供指导</strong>：在设计多轮交互的追问句时，建议包含“当前情景”和“需要进行的操作或选项”，这样的追问句能为用户通过继续对话的线索，并指导用户下一步该说什么。</li>
<li><strong>避免用户进行复杂或带来高歧义的输入</strong>：通过语音填写邮箱、密码和网址等，多音字、同音异义词的识别等，这些对计算机来说都是很复杂和高歧义的输入，要避免用户进行此类输入。</li>
<li><strong>针对重要请求，向用户发出显式确认；针对风险较低的请求，可以采用隐式确认方式</strong>：确认是语音界面与用户沟通的一种方式，用于检查用户的问题、命令和回复是否被正确理解，可以保证对话的流畅度和准确度，让用户知道系统已经理解了自己的话。根据不同的情境和置信区间选择合适的确认方式——对于某些难以撤销的操作，采用<strong>显示确认方式</strong>较为合适，例如资金转账的最终确认和免责协议的确认，通常要与用于核实其提供的输入是否被正确地处理，或者请求用户允许操作，在得到用户确认之前不会执行后续操作；对于识别准确率为中到高，且潜在的负面影响较小时，不想过分打扰用户，采用<strong>隐式确认方式</strong>较为合适，VUI在回复中融入了用户话语中的关键信息，以表明VUI理解了用户说的话，优点是效率高，但缺点是出错时用户通常不知道如何让对话重回正轨。</li>
<li><strong>尽量少用语气助词</strong>：常见的有疑问语气、祈使语气、感叹语气、肯定语气和停顿语气，目前TTS技术很难通过文字和语境将正确的预期表达出来，仍只能用平调朗读出语气助词，因此要谨慎使用。</li>
<li><strong>检查对话内容是否符合人物设定</strong>：不同性格的人说的话的特征是不一样的。切勿用高人一等的口吻和用户说话。</li>
<li><strong>在引起用户负面情绪的关键点上加入情感化设计</strong>：在设计对话时可以引入用户体验地图，在引起用户负面情绪的关键点上加入情感化设计或转移话题；撒娇也是一种能缓解用户情绪低落的好方法，比如在语音助手没理解用户输入的意图时，不要说“我不知道你在说什么”，而是说“换一个问题嘛，不要为难人家好不好”。</li>
<li><strong>在合适的场景说合适的话</strong>：设计对话时要结合用户对话时的时间和定位信息进行考虑。</li>
<li><strong>考虑多种交互的方式</strong>：除了语音，还可以结合结构化的文字和图像进行表达，复杂的内容需要播放很长时间的语音，可以采用视觉可视化的方式让用户能够快速看完。</li>
<li>优<strong>先撰写愉悦脚本</strong>：愉悦脚本指的是可以完成任务并且完整、简单的对话脚本，从开始到结束，中间没有任何分支。完成愉悦脚本的撰写后，在考虑其他需要语音助手引导的分支或路线。</li>
</ol>
<p>· 设计师不能只将精力集中于所谓的“理想流程”和“预设逻辑”中，应该考虑如何解决对话过程中出现的错误，例如设计相关的对白告知用户当前的状况是什么、提供修复错误的说明引导，是整个人机对话流程基于对话流和“合作原则”重回正轨。修复对话的关键在于学会站在机器的视角来看待问题。</p>
<p>· 导致对话失败的情况有：</p>
<ol>
<li>计算机没有获取到任何输入。可能是确实没有输入，也可能是系统没有检测到，获取信息超时。（无ASR）</li>
<li>虽然计算机获取到了信息，但是却不能识别或解析，这种情况可能是有背景噪音或多个用户一起说话。（有ASR但有误）</li>
<li>识别到了用户的输入信息，但系统不知道如何回应和处理。（NLP兜底）</li>
<li>错误地识别了用户输入的信息。（NLP有误）</li>
</ol>
<h4 id="修复对话设计原则">修复对话设计原则<a hidden class="anchor" aria-hidden="true" href="#修复对话设计原则">#</a></h4>
<p>· 针对上述的四种对话失败情况：</p>
<ol>
<li>
<p>当用户超时输入或无输入时，可以再次提示一遍刚才的问题，用较为简洁的句式变体对原有问题进行二次询问。</p>
</li>
<li>
<p>理解了内容跟但不能提供帮助，又具体分为四种情况：</p>
</li>
<li>
<p>不支持用户要求的功能，可以说“我目前还不能帮助你做XX，不过我可以帮你XXX”，告诉用户该功能不可用。设计师需要提前计划要做的功能的意图，然后跟踪用户何时请求不支持的功能，更好地确定功能的优先级。</p>
</li>
<li>
<p>用户说法不清导致意图识别信息缺失，通过询问引导用户再说一遍，完成必要槽位信息的补充。在询问时建议列举相关内容供用户参考，比如“一共找到两个XXX，请问您要打开第一个还是第二个？”</p>
</li>
<li>
<p>因阈值上下限导致语音助手不能提供完整的帮助（比如音量最高100%，用户还想再提高音量），需要告诉用户当前状况并推荐相关操作。</p>
</li>
<li>
<p>明确知道用户的指令是错误的，需要引导用户重回正轨或恢复默认状态。设计师应该提前想到用户的常用说法，并在意图设计和回复上体现出来，比如空调有1-4档，用户觉得4档开冷于是说“关闭4档”，但风量档位意图只有切换没有挂你的概念，这时应该回复“风量档位以为您调回1档”。</p>
</li>
<li>
<p>因各种原因导致语音识别不清晰，系统不知道用户说了什么，可以对内容进行语法分析和关键字匹配，匹配上关键字就可以交由FAQ模块或第三方搜索模块来解决，如果没匹配上关键字且语法分析问题较大，则通过兜底。</p>
</li>
<li>
<p>用户在多轮对话过程中没按照脚本走导致理解出问题，可以在多轮交互过程中提示用户目前支持的说法是什么，从而限制多轮交互中用户的说法；或者询问用户是否退出当前多轮并进入新一轮对话。</p>
</li>
</ol>
<h4 id="谷歌语音交互设计走查表">谷歌语音交互设计走查表<a hidden class="anchor" aria-hidden="true" href="#谷歌语音交互设计走查表">#</a></h4>
<p>· 包括问候语与结束语、设计自然流畅的对话、人物画像、对话修复/容错等。</p>
<p><img loading="lazy" src="/download/thumbnails/105255115/1.png?version=1&amp;modificationDate=1687657054792&amp;api=v2" alt=""  />
<img loading="lazy" src="/download/attachments/105255115/2.png?version=1&amp;modificationDate=1687657059330&amp;api=v2" alt=""  />
<img loading="lazy" src="/download/attachments/105255115/3.png?version=1&amp;modificationDate=1687657062032&amp;api=v2" alt=""  />
<img loading="lazy" src="/download/thumbnails/105255115/4.png?version=1&amp;modificationDate=1687657064288&amp;api=v2" alt=""  />
</p>
<p><a href="/">Filter table data</a><a href="/">Create a pivot table</a><a href="/">Create a chart from data series</a></p>
<p><a href="/users/tfac-settings.action">Configure buttons visibility</a></p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/tags/2%E8%AF%AD%E9%9F%B3%E4%BA%A4%E4%BA%92%E8%AE%BE%E8%AE%A1%E7%9F%A5%E8%AF%86/">2、语音交互设计知识</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="http://localhost:1313/posts/wiki/%E9%92%9F%E5%8D%8E%E8%A3%95/">
    <span class="title">« 上一页</span>
    <br>
    <span>钟华裕</span>
  </a>
  <a class="next" href="http://localhost:1313/posts/wiki/2.1%E8%AF%AD%E9%9F%B3%E4%BA%A4%E4%BA%92%E8%AE%BE%E8%AE%A1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/">
    <span class="title">下一页 »</span>
    <br>
    <span>2.1、语音交互设计基础知识</span>
  </a>
</nav>


<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 2.2、意图设计&对话设计 on x"
            href="https://x.com/intent/tweet/?text=2.2%e3%80%81%e6%84%8f%e5%9b%be%e8%ae%be%e8%ae%a1%26%e5%af%b9%e8%af%9d%e8%ae%be%e8%ae%a1&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fwiki%2f2.2%25E6%2584%258F%25E5%259B%25BE%25E8%25AE%25BE%25E8%25AE%25A1%25E5%25AF%25B9%25E8%25AF%259D%25E8%25AE%25BE%25E8%25AE%25A1%2f&amp;hashtags=2%e3%80%81%e8%af%ad%e9%9f%b3%e4%ba%a4%e4%ba%92%e8%ae%be%e8%ae%a1%e7%9f%a5%e8%af%86">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 2.2、意图设计&对话设计 on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fwiki%2f2.2%25E6%2584%258F%25E5%259B%25BE%25E8%25AE%25BE%25E8%25AE%25A1%25E5%25AF%25B9%25E8%25AF%259D%25E8%25AE%25BE%25E8%25AE%25A1%2f&amp;title=2.2%e3%80%81%e6%84%8f%e5%9b%be%e8%ae%be%e8%ae%a1%26%e5%af%b9%e8%af%9d%e8%ae%be%e8%ae%a1&amp;summary=2.2%e3%80%81%e6%84%8f%e5%9b%be%e8%ae%be%e8%ae%a1%26%e5%af%b9%e8%af%9d%e8%ae%be%e8%ae%a1&amp;source=http%3a%2f%2flocalhost%3a1313%2fposts%2fwiki%2f2.2%25E6%2584%258F%25E5%259B%25BE%25E8%25AE%25BE%25E8%25AE%25A1%25E5%25AF%25B9%25E8%25AF%259D%25E8%25AE%25BE%25E8%25AE%25A1%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 2.2、意图设计&对话设计 on reddit"
            href="https://reddit.com/submit?url=http%3a%2f%2flocalhost%3a1313%2fposts%2fwiki%2f2.2%25E6%2584%258F%25E5%259B%25BE%25E8%25AE%25BE%25E8%25AE%25A1%25E5%25AF%25B9%25E8%25AF%259D%25E8%25AE%25BE%25E8%25AE%25A1%2f&title=2.2%e3%80%81%e6%84%8f%e5%9b%be%e8%ae%be%e8%ae%a1%26%e5%af%b9%e8%af%9d%e8%ae%be%e8%ae%a1">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 2.2、意图设计&对话设计 on facebook"
            href="https://facebook.com/sharer/sharer.php?u=http%3a%2f%2flocalhost%3a1313%2fposts%2fwiki%2f2.2%25E6%2584%258F%25E5%259B%25BE%25E8%25AE%25BE%25E8%25AE%25A1%25E5%25AF%25B9%25E8%25AF%259D%25E8%25AE%25BE%25E8%25AE%25A1%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 2.2、意图设计&对话设计 on whatsapp"
            href="https://api.whatsapp.com/send?text=2.2%e3%80%81%e6%84%8f%e5%9b%be%e8%ae%be%e8%ae%a1%26%e5%af%b9%e8%af%9d%e8%ae%be%e8%ae%a1%20-%20http%3a%2f%2flocalhost%3a1313%2fposts%2fwiki%2f2.2%25E6%2584%258F%25E5%259B%25BE%25E8%25AE%25BE%25E8%25AE%25A1%25E5%25AF%25B9%25E8%25AF%259D%25E8%25AE%25BE%25E8%25AE%25A1%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 2.2、意图设计&对话设计 on telegram"
            href="https://telegram.me/share/url?text=2.2%e3%80%81%e6%84%8f%e5%9b%be%e8%ae%be%e8%ae%a1%26%e5%af%b9%e8%af%9d%e8%ae%be%e8%ae%a1&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fwiki%2f2.2%25E6%2584%258F%25E5%259B%25BE%25E8%25AE%25BE%25E8%25AE%25A1%25E5%25AF%25B9%25E8%25AF%259D%25E8%25AE%25BE%25E8%25AE%25A1%2f">
            <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
                <path
                    d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 2.2、意图设计&对话设计 on ycombinator"
            href="https://news.ycombinator.com/submitlink?t=2.2%e3%80%81%e6%84%8f%e5%9b%be%e8%ae%be%e8%ae%a1%26%e5%af%b9%e8%af%9d%e8%ae%be%e8%ae%a1&u=http%3a%2f%2flocalhost%3a1313%2fposts%2fwiki%2f2.2%25E6%2584%258F%25E5%259B%25BE%25E8%25AE%25BE%25E8%25AE%25A1%25E5%25AF%25B9%25E8%25AF%259D%25E8%25AE%25BE%25E8%25AE%25A1%2f">
            <svg version="1.1" xml:space="preserve" width="30px" height="30px" viewBox="0 0 512 512" fill="currentColor"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape">
                <path
                    d="M449.446 0C483.971 0 512 28.03 512 62.554L512 449.446C512 483.97 483.97 512 449.446 512L62.554 512C28.03 512 0 483.97 0 449.446L0 62.554C0 28.03 28.029 0 62.554 0L449.446 0ZM183.8767 87.9921H121.8427L230.6673 292.4508V424.0079H281.3328V292.4508L390.1575 87.9921H328.1233L256 238.2489z" />
            </svg>
        </a>
    </li>
</ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span><a href="https://beian.miit.gov.cn/">粤ICP备2023039897号-1</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = '复制';

        function copyingDone() {
            copybutton.innerHTML = '已复制！';
            setTimeout(() => {
                copybutton.innerHTML = '复制';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
