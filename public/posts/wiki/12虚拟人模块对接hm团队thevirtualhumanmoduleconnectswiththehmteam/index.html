<!DOCTYPE html>
<html lang="zh" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>12、虚拟人模块对接HM团队ThevirtualhumanmoduleconnectswiththeHMteam | PaperMod</title>
<meta name="keywords" content="五、系统架构设计">
<meta name="description" content="五、系统架构设计">
<meta name="author" content="王宇">
<link rel="canonical" href="http://localhost:1313/posts/wiki/12%E8%99%9A%E6%8B%9F%E4%BA%BA%E6%A8%A1%E5%9D%97%E5%AF%B9%E6%8E%A5hm%E5%9B%A2%E9%98%9Fthevirtualhumanmoduleconnectswiththehmteam/">
<meta name="google-site-verification" content="XYZabc">
<link crossorigin="anonymous" href="/assets/css/stylesheet.7b92bf4867c997b58ec50f63451b83777173d5bd5593376852abd85746d09d71.css" integrity="sha256-e5K/SGfJl7WOxQ9jRRuDd3Fz1b1VkzdoUqvYV0bQnXE=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/%3Clink%20/%20abs%20url%3E">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/%3Clink%20/%20abs%20url%3E">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/%3Clink%20/%20abs%20url%3E">
<link rel="apple-touch-icon" href="http://localhost:1313/%3Clink%20/%20abs%20url%3E">
<link rel="mask-icon" href="http://localhost:1313/%3Clink%20/%20abs%20url%3E">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="zh" href="http://localhost:1313/posts/wiki/12%E8%99%9A%E6%8B%9F%E4%BA%BA%E6%A8%A1%E5%9D%97%E5%AF%B9%E6%8E%A5hm%E5%9B%A2%E9%98%9Fthevirtualhumanmoduleconnectswiththehmteam/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript><meta property="og:title" content="12、虚拟人模块对接HM团队ThevirtualhumanmoduleconnectswiththeHMteam" />
<meta property="og:description" content="五、系统架构设计" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://localhost:1313/posts/wiki/12%E8%99%9A%E6%8B%9F%E4%BA%BA%E6%A8%A1%E5%9D%97%E5%AF%B9%E6%8E%A5hm%E5%9B%A2%E9%98%9Fthevirtualhumanmoduleconnectswiththehmteam/" />
<meta property="og:image" content="http://localhost:1313/images/papermod-cover.png" />
<meta property="article:section" content="posts" />




<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="http://localhost:1313/images/papermod-cover.png" />
<meta name="twitter:title" content="12、虚拟人模块对接HM团队ThevirtualhumanmoduleconnectswiththeHMteam"/>
<meta name="twitter:description" content="五、系统架构设计"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "http://localhost:1313/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "12、虚拟人模块对接HM团队ThevirtualhumanmoduleconnectswiththeHMteam",
      "item": "http://localhost:1313/posts/wiki/12%E8%99%9A%E6%8B%9F%E4%BA%BA%E6%A8%A1%E5%9D%97%E5%AF%B9%E6%8E%A5hm%E5%9B%A2%E9%98%9Fthevirtualhumanmoduleconnectswiththehmteam/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "12、虚拟人模块对接HM团队ThevirtualhumanmoduleconnectswiththeHMteam",
  "name": "12、虚拟人模块对接HM团队ThevirtualhumanmoduleconnectswiththeHMteam",
  "description": "五、系统架构设计",
  "keywords": [
    "五、系统架构设计"
  ],
  "articleBody": " 11. 业务流程 Business Process 22. 数据流图 Data flow diagram 33. SDK接入指导 SDK Access Guidance 3.13.1. 声学SDK Acoustic SDK access guide 3.23.2. 虚拟人SDK接入指导 Virtual Human SDK Access Guide 44. 创建虚拟人流程 Create a virtual digital human process 55. 虚拟人接入万得厨2.0（NVIDIA）集成方案v1.0 5.15.1. 设计原则 Design Principles 5.1.15.1.1. 模块拆分原则 Module splitting principle 5.1.25.1.2. 命名规范 Naming convention 5.25.2. 优势 5.35.3. 技术栈 technology stack 5.45.4. 分层架构 layered architecture 5.4.15.4.1. 架构一 Architecture 1 5.4.25.4.2. 架构二 Architecture 2 5.55.5. 通信机制 Communication mechanism 5.5.15.5.1. 语音模块voiceservic通信 Voice module voiceservic communication 5.5.25.5.2. 虚拟人APP和外部APP通信方式 Communication method between virtual person APP and external APP 5.65.6. 时序图 Sequence diagram 1. 业务流程 Business Process 将虚拟数字人安装在万得厨（之后会有其他设备载体），期望通过语音互动的交互形式，依托背后强大的产业知识数据库及知名第三方厂商的公开知识库，为用户提供设备控制、智能对话等服务\nThe virtual digital human （VDH）is installed in Wonder Kitchen (there will be other device carriers in the future), and it is expected to provide users with device control and intelligence Conversation and other services through the interactive form of voice interaction, relying on the powerful industrial knowledge database and the public knowledge base of well-known third-party manufacturers\nPool\n用户 User\n说出语音对话内容\nUser speaks voice conversation content\n设备端 device\n执行指令\nExecute instructions\nmic拾音\nmic picking up sound\n播放语音\nPlay voice\nVDH Cloud Skills NLP（natural language processing）Analyze user intent\n影子虚拟人 Yingzi VDH\n解析意图调用万得厨指令接口\nParsing the intention to call the Wonderchu command interface\n播放动作\nplay action\nAcoustic SDK\nASR语音转化为文本\nASR speech to text\nVDH SDK\n调用接口\ncalling SDK interface\n触发回调接口\nTrigger callback interface\n(IPlayChat)\nVirtual human operation system\n配置虚拟人指令、闲聊库、知识库\nConfigure virtual human instructions, chat library, and knowledge base\nVDH: virtual digtal human 虚拟数字人\nAcoustic SDK\n//\u003c![CDATA[ (function() { $ = AJS.$; var graphContainer = document.getElementById(‘drawio-macro-content-6b6525bc-a85d-4100-b25e-bf121efca794’); DrawioProperties = { contextPath : AJS.contextPath(), buildNumber : 8401 }; var readerOpts = {}; readerOpts.loadUrl = ’’ + ‘/rest/drawio/1.0/diagram/crud/%E6%9C%AA%E5%91%BD%E5%90%8D%E7%BB%98%E5%9B%BE/123651584?revision=1’; readerOpts.imageUrl = ’’ + ‘/download/attachments/123651584/未命名绘图.png’ + ‘?version=1\u0026api=v2’; readerOpts.editUrl = ’’ + ‘/plugins/drawio/addDiagram.action?ceoId=123651584\u0026owningPageId=123651584\u0026diagramName=%E6%9C%AA%E5%91%BD%E5%90%8D%E7%BB%98%E5%9B%BE\u0026revision=1’; readerOpts.editable = true; readerOpts.canComment = true; readerOpts.stylePath = STYLE_PATH; readerOpts.stencilPath = STENCIL_PATH; readerOpts.imagePath = IMAGE_PATH + ‘/reader’; readerOpts.border = true; readerOpts.width = ‘1000’; readerOpts.simpleViewer = false; readerOpts.tbstyle = ’top’; readerOpts.links = ‘auto’; readerOpts.lightbox = true; readerOpts.resourcePath = ATLAS_RESOURCE_BASE + ‘/resources/viewer’; readerOpts.disableButtons = false; readerOpts.zoomToFit = true; readerOpts.language = ‘zh’; readerOpts.licenseStatus = ‘OK’; readerOpts.contextPath = AJS.contextPath(); readerOpts.diagramName = decodeURIComponent(’%E6%9C%AA%E5%91%BD%E5%90%8D%E7%BB%98%E5%9B%BE’); readerOpts.diagramDisplayName = ‘’; readerOpts.aspect = ‘’; readerOpts.ceoName = ‘12、虚拟人模块对接HM团队 The virtual human module connects with the HM team’; readerOpts.attVer = ‘1’; readerOpts.attId = ‘123651603’; readerOpts.lastModifierName = ‘王宇’; readerOpts.lastModified = ‘2024-05-06 11:33:46.134’; readerOpts.creatorName = ‘王宇’; //Embed macro specific info readerOpts.extSrvIntegType = ‘$extSrvIntegType’; readerOpts.gClientId = ‘$gClientId’; readerOpts.oClientId = ‘$oClientId’; readerOpts.service = ‘$service’; readerOpts.sFileId = ‘$sFileId’; readerOpts.odriveId = ‘$odriveId’; readerOpts.diagramUrl = ‘$diagramUrl’; readerOpts.csvFileUrl = ‘$csvFileUrl’; readerOpts.pageId = ‘$pageId’ || Confluence.getContentId(); readerOpts.aspectHash = ‘$aspectHash’; readerOpts.useExternalImageService = ‘$useExternalImageService’ == ’true’; readerOpts.isTemplate = ‘$isTemplate’ == ’true’; if (readerOpts.width == ‘’) { readerOpts.width = null; } // LATER: Check if delayed loading of resources can be used for image placeholder mode var viewerPromise = createViewer(graphContainer, readerOpts); if(readerOpts.editable) { $(graphContainer).data(‘viewerConfig’, readerOpts); $(graphContainer).on(‘drawioViewerUpdate’, updateDrawioViewer); } viewerPromise.done(function(viewer) { updateCachedDiagram(graphContainer, readerOpts, viewer); }); })(); //]]\u003e\n说明 Description：\n**运营人员在杭州虚拟人公司的后台运营系统录入指令库和知识库\n**\nOperators enter the instruction base and knowledge base into the backend operation system of third-party Virtual Human Company\n1、用户说出语音对话内容，被麦克风拾音\nThe user speaks the voice conversation content and the sound is picked up by the microphone.\n2、调用科大讯飞sdk asr接口降语音转化为文本\nCall the IFLYTEK sdk asr interface to convert speech into text.\n3、将文本传给杭州虚拟人接口AvatarPlayCloudBehavior，接口分析语义、情绪、进行行为推理，回调影子虚拟人接口\nPass the text to the third-partyvirtual human interface AvatarPlayCloudBehavior. The interface analyzes semantics, emotions, conducts behavioral inference, and calls back the shadow virtual human interface.\n4、影子虚拟人接口收到IPlaychat的接口回调，根据意图，调用万得厨或者其他接口。\nThe Yingzi VDH interface receives the interface callback from IPlaychat, and calls Wonder Kitchen or other interfaces based on the intention\n2. 数据流图 Data flow diagram 万得厨 Device\n虚拟人应用\nVDH application\nmic\nAcoustic SDK\n(Wake ASR)\nVDH sdk\nVDH cloud service\n虚拟人后台运营应用\nVirtual human backend operation application\naudio\n技能 skill\n//\u003c![CDATA[ (function() { $ = AJS.$; var graphContainer = document.getElementById(‘drawio-macro-content-ce91b1af-b22c-4950-901e-632e6bc8a16b’); DrawioProperties = { contextPath : AJS.contextPath(), buildNumber : 8401 }; var readerOpts = {}; readerOpts.loadUrl = ’’ + ‘/rest/drawio/1.0/diagram/crud/%E6%9C%AA%E5%91%BD%E5%90%8D%E7%BB%98%E5%9B%BE%31/123651584?revision=1’; readerOpts.imageUrl = ’’ + ‘/download/attachments/123651584/未命名绘图1.png’ + ‘?version=1\u0026api=v2’; readerOpts.editUrl = ’’ + ‘/plugins/drawio/addDiagram.action?ceoId=123651584\u0026owningPageId=123651584\u0026diagramName=%E6%9C%AA%E5%91%BD%E5%90%8D%E7%BB%98%E5%9B%BE%31\u0026revision=1’; readerOpts.editable = true; readerOpts.canComment = true; readerOpts.stylePath = STYLE_PATH; readerOpts.stencilPath = STENCIL_PATH; readerOpts.imagePath = IMAGE_PATH + ‘/reader’; readerOpts.border = true; readerOpts.width = ‘600’; readerOpts.simpleViewer = false; readerOpts.tbstyle = ’top’; readerOpts.links = ‘auto’; readerOpts.lightbox = true; readerOpts.resourcePath = ATLAS_RESOURCE_BASE + ‘/resources/viewer’; readerOpts.disableButtons = false; readerOpts.zoomToFit = true; readerOpts.language = ‘zh’; readerOpts.licenseStatus = ‘OK’; readerOpts.contextPath = AJS.contextPath(); readerOpts.diagramName = decodeURIComponent(’%E6%9C%AA%E5%91%BD%E5%90%8D%E7%BB%98%E5%9B%BE%31’); readerOpts.diagramDisplayName = ‘’; readerOpts.aspect = ‘’; readerOpts.ceoName = ‘12、虚拟人模块对接HM团队 The virtual human module connects with the HM team’; readerOpts.attVer = ‘1’; readerOpts.attId = ‘123651609’; readerOpts.lastModifierName = ‘王宇’; readerOpts.lastModified = ‘2024-05-06 11:42:02.77’; readerOpts.creatorName = ‘王宇’; //Embed macro specific info readerOpts.extSrvIntegType = ‘$extSrvIntegType’; readerOpts.gClientId = ‘$gClientId’; readerOpts.oClientId = ‘$oClientId’; readerOpts.service = ‘$service’; readerOpts.sFileId = ‘$sFileId’; readerOpts.odriveId = ‘$odriveId’; readerOpts.diagramUrl = ‘$diagramUrl’; readerOpts.csvFileUrl = ‘$csvFileUrl’; readerOpts.pageId = ‘$pageId’ || Confluence.getContentId(); readerOpts.aspectHash = ‘$aspectHash’; readerOpts.useExternalImageService = ‘$useExternalImageService’ == ’true’; readerOpts.isTemplate = ‘$isTemplate’ == ’true’; if (readerOpts.width == ‘’) { readerOpts.width = null; } // LATER: Check if delayed loading of resources can be used for image placeholder mode var viewerPromise = createViewer(graphContainer, readerOpts); if(readerOpts.editable) { $(graphContainer).data(‘viewerConfig’, readerOpts); $(graphContainer).on(‘drawioViewerUpdate’, updateDrawioViewer); } viewerPromise.done(function(viewer) { updateCachedDiagram(graphContainer, readerOpts, viewer); }); })(); //]]\u003e\n3. SDK接入指导 SDK Access Guidance 3.1. 声学SDK Acoustic SDK access guide 中文版本 Chinese edition : https://aiui-doc.xf-yun.com/project-1/doc-12/ https://github.com/zrmei/DemoCode/blob/master/docs/src/index.rst https://democode.readthedocs.io/zh-cn/latest/src/index.html#sdk Demo code：\nstd_mic2\u0026aiui.zip 3.2. 虚拟人SDK接入指导 Virtual Human SDK Access Guide 中文文档 Chinese documentation\n英文文档 English document\n中文文档 Chinese documentation\n英文文档 English document\nPDF\nPDF\nDemo code：\nnvidia jetson orin.zip 4. 创建虚拟人流程 Create a virtual digital human process 序号order\n中文版本 Chinese edition\n英文版本 English edition\n序号order\n中文版本 Chinese edition\n英文版本 English edition\n1\n【必须】HaiSDK#Init，sdk初始化方法，在回调里面判断是否成功，成功后继续下一步\n【Required】 HaiSDK#Init, sdk initialization method, determine whether it is successful in the callback, and continue to the next step if successful.\n2\n【必须】通过HaiSDK.GetAuthToken()方法获取token，成功后继续下一步\n【Required】 Obtain the token through the HaiSDK.GetAuthToken() method and proceed to the next step after success.\n3\n【必须】获取通过接口虚拟人信息，url=(GPValues.BASE_URL + “/getInstListByAppId”)，添加token到头部信息，addHeader(“Cookie”,“user_token=$token”)\n【Required】 Obtain the virtual person information through the interface, url=(GPValues.BASE_URL + “/getInstListByAppId”), add token to the header information, addHeader(“Cookie”, “user_token=$token”)\n4\n【必须】检查资源包：HaiSDK.CheckServerAsset，如果不需要更新，则可跳过第5步\n【Required】 Check the resource package: HaiSDK.CheckServerAsset. If you do not need to update, you can skip step 5.\n5\n【必须】下载资源包方法：HaiSDK.DownloadCheckedServerAsset\n【Required】 How to download resource package: HaiSDK.DownloadCheckedServerAsset\n6\n【可选】如果是pta虚拟人，需要执行这个，下载PTA实例资源：HaiSDK.DownloadPTA，不是pta虚拟人直接跳过这步，进入创建。\n【Optional】 If it is a pta virtual person, you need to perform this and download the PTA instance resource: HaiSDK.DownloadPTA. If it is not a pta virtual person, skip this step and enter creation.\n7\n【可选】创建pta HaiSDK.CreatePTA 失败原因 //1 创建成功\n//-1 未检测到人脸\n//-2 不是正脸\n//-3 戴了眼镜\n//-4 五官被遮挡\n//-5 眼睛异常\n//-6 嘴部异常\n//-7 图片为空\n【Optional】 Reason for failure to create pta HaiSDK.CreatePTA //1 Successfully created\n//-1 No face detected\n//-2 is not a positive face\n//-3 Wearing glasses\n//-4 facial features are obscured\n//-5 Eye abnormalities\n//-6 Mouth abnormality\n//-7 The picture is empty\n8\n【必须】创建虚拟人：HaiSDK.CreateInstance\n【Required】Create virtual person: HaiSDK.CreateInstance\n9\n【可选】装扮接口，HaiSDK.InstanceLoadAsset 例如 HaiSDK.InstanceLoadAsset(avatarInstID, qualityType, parts.getMUplimb());穿上衣\n【Optional】 Dressing interface, HaiSDK.InstanceLoadAsset For example, HaiSDK.InstanceLoadAsset(avatarInstID, qualityType, parts.getMUplimb()); put on clothes\n5. 虚拟人接入万得厨2.0（NVIDIA）集成方案v1.0 5.1. 设计原则 Design Principles 5.1.1. 模块拆分原则 Module splitting principle 拆分原则：分层解耦、单一职责、高内聚低耦合、易于维护与扩展\nSplit principles: layered decoupling, single responsibility, high cohesion and low coupling, easy maintenance and expansion\n业务模块：承载具体业务需求，业务模块之间尽可能解耦。\nBusiness module: carries specific business needs and is decoupled as much as possible between business modules 通用模块（有的叫功能模块）：包含其他模块经常使用的代码，减少冗余，理论上通用模块不依赖任何业务侧的数据结构。\nGeneral modules (some are called functional modules): contain codes frequently used by other modules to reduce redundancy. In theory, general modules do not depend on any business-side data structures. 5.1.2. 命名规范 Naming convention 命名规范（保证语义与表达的同时，尽量做到简洁，可以使用 core、common、business 等文件夹包括各个层级） Naming convention (while ensuring semantics and expression, try to be as concise as possible, you can use core, common, business, etc. folders to include various levels)\n5.2. 优势 中文文档 Chinese documentation\n英文文档 English document\n中文文档 Chinese documentation\n英文文档 English document\n虚拟人可以快速移植到其他app。 Virtual humans can be quickly transplanted to other apps.\n开发减少构建时间。在开发阶段按需编译组件，一次调试中可能有一两个组件参与集成，这样编译时间就会大大降低，提高开发效率。 Develop to reduce build times. Components are compiled on demand during the development phase. One or two components may be integrated during a debugging process, which greatly reduces the compilation time and improves development efficiency.\n代码解耦，代码责任制，组件之间的交互如果还是直接引用的话，那么组件之间根本没有做到解耦。组件间通信解耦组织直接调用，降低沟通成本。 Code decoupling, code accountability, and if the interactions between components are still directly referenced, then there is no decoupling between components at all. Inter-component communication decoupling organizes direct calls, reducing communication costs.\n5.3. 技术栈 technology stack 开发语言programming language：c++ 界面Front-end interface framework：QT 5.4. 分层架构 layered architecture 为了加快前端集成进度，建议HM团队去按照生态应用（主应用、子应用）的架构（也就是架构1）去集成，虚拟人团队提供声学SDK、虚拟人SDK的接入技术指导。国内虚拟人团队工作重点放在打造场景化人机交互形态上。\nIn order to speed up the front-end integration progress, it is recommended that the HM team integrate according to the architecture of the ecological application (main application, sub-application) (that is, architecture 1). The domestic virtual human team provides access technical guidance for the acoustic SDK and virtual human SDK. Domestic virtual human teams focus on creating scenario-based human-computer interaction.\n5.4.1. 架构一 Architecture 1 万得厨界面应用、虚拟人应用，两者之间是独立存在的，通过交互协议双向通信。虚拟人应用作为一个生态应用接入。\nWonder Kitchen Interface Application and Virtual human application ，The two exist independently and communicate in two directions through an interactive protocol.\nThe virtual human application is accessed as an ecological application\nAPP\n服务\nservice\n加热服务\nheating service\n外部集成\nexternal integrated\nNLP\nASR\n其他服务\nother service\n万得厨\n虚拟人\nVirtual digtal human\n//\u003c![CDATA[ (function() { $ = AJS.$; var graphContainer = document.getElementById(‘drawio-macro-content-c6f8061d-24a8-4aef-ba43-9d5f25fff9fc’); DrawioProperties = { contextPath : AJS.contextPath(), buildNumber : 8401 }; var readerOpts = {}; readerOpts.loadUrl = ’’ + ‘/rest/drawio/1.0/diagram/crud/%6C%61%79%65%72%65%64%20%61%72%63%68%69%74%65%63%74%75%72%65/123651584?revision=2’; readerOpts.imageUrl = ’’ + ‘/download/attachments/123651584/layered architecture-b16d28ddda6d9de30bd12cd604bc041fe50121ab.png’ + ‘?version=2\u0026api=v2’; readerOpts.editUrl = ’’ + ‘/plugins/drawio/addDiagram.action?ceoId=123651584\u0026owningPageId=123651584\u0026diagramName=%6C%61%79%65%72%65%64%20%61%72%63%68%69%74%65%63%74%75%72%65\u0026revision=2’; readerOpts.editable = true; readerOpts.canComment = true; readerOpts.stylePath = STYLE_PATH; readerOpts.stencilPath = STENCIL_PATH; readerOpts.imagePath = IMAGE_PATH + ‘/reader’; readerOpts.border = true; readerOpts.width = ‘800’; readerOpts.simpleViewer = false; readerOpts.tbstyle = ’top’; readerOpts.links = ‘auto’; readerOpts.lightbox = true; readerOpts.resourcePath = ATLAS_RESOURCE_BASE + ‘/resources/viewer’; readerOpts.disableButtons = false; readerOpts.zoomToFit = true; readerOpts.language = ‘zh’; readerOpts.licenseStatus = ‘OK’; readerOpts.contextPath = AJS.contextPath(); readerOpts.diagramName = decodeURIComponent(’%6C%61%79%65%72%65%64%20%61%72%63%68%69%74%65%63%74%75%72%65’); readerOpts.diagramDisplayName = ‘’; readerOpts.aspect = ‘kmN2Z7sw7ftHL1OGfhmL’; readerOpts.ceoName = ‘12、虚拟人模块对接HM团队 The virtual human module connects with the HM team’; readerOpts.attVer = ‘2’; readerOpts.attId = ‘123651788’; readerOpts.lastModifierName = ‘王宇’; readerOpts.lastModified = ‘2024-05-06 18:55:48.559’; readerOpts.creatorName = ‘王宇’; //Embed macro specific info readerOpts.extSrvIntegType = ‘$extSrvIntegType’; readerOpts.gClientId = ‘$gClientId’; readerOpts.oClientId = ‘$oClientId’; readerOpts.service = ‘$service’; readerOpts.sFileId = ‘$sFileId’; readerOpts.odriveId = ‘$odriveId’; readerOpts.diagramUrl = ‘$diagramUrl’; readerOpts.csvFileUrl = ‘$csvFileUrl’; readerOpts.pageId = ‘$pageId’ || Confluence.getContentId(); readerOpts.aspectHash = ‘$aspectHash’; readerOpts.useExternalImageService = ‘$useExternalImageService’ == ’true’; readerOpts.isTemplate = ‘$isTemplate’ == ’true’; if (readerOpts.width == ‘’) { readerOpts.width = null; } // LATER: Check if delayed loading of resources can be used for image placeholder mode var viewerPromise = createViewer(graphContainer, readerOpts); if(readerOpts.editable) { $(graphContainer).data(‘viewerConfig’, readerOpts); $(graphContainer).on(‘drawioViewerUpdate’, updateDrawioViewer); } viewerPromise.done(function(viewer) { updateCachedDiagram(graphContainer, readerOpts, viewer); }); })(); //]]\u003e\n绿色代表虚拟人负责的部分。\nThe green color represents the part that the virtual person is responsible for. 黄色代表万得厨负责的部分\nThe yellow color represents the part that Wonder Kitchen is responsible for 虚拟人包含语音和形象展示。主要用来和用户交互，和万得厨进行数据传递，完成对万得厨指令的调用。\nThe virtual person includes voice and image display. It is mainly used to interact with users, transfer data with Wonder Kitchen, and complete the call of Wonder Kitchen instructions. 虚拟人模块主要包含ASR（语音转文字）、TTS（文字转语音）、NLP（自然语言理解处理）和以及动画的封装。\nThe virtual human module mainly includes ASR (speech to text), TTS (text to speech), NLP (natural language understanding processing) and animation encapsulation. 5.4.2. 架构二 Architecture 2 虚拟人应用，作为万得厨界面应用的一个模块，通过SDK的形式，整体集成进去\nVirtual human application, as a module of WINDUK interface application，Integrated as a whole through SDK\nAPP\n服务\nservice\n加热服务\nheating service\n外部集成\nexternal integrated\nNLP\nASR\n其他服务\nother service\n万得厨\n虚拟人\nVirtual digtal human\n//\u003c![CDATA[ (function() { $ = AJS.$; var graphContainer = document.getElementById(‘drawio-macro-content-b2d1d86b-3967-4242-8b6c-a7b029d9a72c’); DrawioProperties = { contextPath : AJS.contextPath(), buildNumber : 8401 }; var readerOpts = {}; readerOpts.loadUrl = ’’ + ‘/rest/drawio/1.0/diagram/crud/%6C%61%79%65%72%65%64%20%61%72%63%68%69%74%65%63%74%75%72%65/123651584?revision=2’; readerOpts.imageUrl = ’’ + ‘/download/attachments/123651584/layered architecture-b16d28ddda6d9de30bd12cd604bc041fe50121ab.png’ + ‘?version=2\u0026api=v2’; readerOpts.editUrl = ’’ + ‘/plugins/drawio/addDiagram.action?ceoId=123651584\u0026owningPageId=123651584\u0026diagramName=%6C%61%79%65%72%65%64%20%61%72%63%68%69%74%65%63%74%75%72%65\u0026revision=2’; readerOpts.editable = true; readerOpts.canComment = true; readerOpts.stylePath = STYLE_PATH; readerOpts.stencilPath = STENCIL_PATH; readerOpts.imagePath = IMAGE_PATH + ‘/reader’; readerOpts.border = true; readerOpts.width = ‘800’; readerOpts.simpleViewer = false; readerOpts.tbstyle = ’top’; readerOpts.links = ‘auto’; readerOpts.lightbox = true; readerOpts.resourcePath = ATLAS_RESOURCE_BASE + ‘/resources/viewer’; readerOpts.disableButtons = false; readerOpts.zoomToFit = true; readerOpts.language = ‘zh’; readerOpts.licenseStatus = ‘OK’; readerOpts.contextPath = AJS.contextPath(); readerOpts.diagramName = decodeURIComponent(’%6C%61%79%65%72%65%64%20%61%72%63%68%69%74%65%63%74%75%72%65’); readerOpts.diagramDisplayName = ‘’; readerOpts.aspect = ‘kmN2Z7sw7ftHL1OGfhmL’; readerOpts.ceoName = ‘12、虚拟人模块对接HM团队 The virtual human module connects with the HM team’; readerOpts.attVer = ‘2’; readerOpts.attId = ‘123651788’; readerOpts.lastModifierName = ‘王宇’; readerOpts.lastModified = ‘2024-05-06 18:55:48.559’; readerOpts.creatorName = ‘王宇’; //Embed macro specific info readerOpts.extSrvIntegType = ‘$extSrvIntegType’; readerOpts.gClientId = ‘$gClientId’; readerOpts.oClientId = ‘$oClientId’; readerOpts.service = ‘$service’; readerOpts.sFileId = ‘$sFileId’; readerOpts.odriveId = ‘$odriveId’; readerOpts.diagramUrl = ‘$diagramUrl’; readerOpts.csvFileUrl = ‘$csvFileUrl’; readerOpts.pageId = ‘$pageId’ || Confluence.getContentId(); readerOpts.aspectHash = ‘$aspectHash’; readerOpts.useExternalImageService = ‘$useExternalImageService’ == ’true’; readerOpts.isTemplate = ‘$isTemplate’ == ’true’; if (readerOpts.width == ‘’) { readerOpts.width = null; } // LATER: Check if delayed loading of resources can be used for image placeholder mode var viewerPromise = createViewer(graphContainer, readerOpts); if(readerOpts.editable) { $(graphContainer).data(‘viewerConfig’, readerOpts); $(graphContainer).on(‘drawioViewerUpdate’, updateDrawioViewer); } viewerPromise.done(function(viewer) { updateCachedDiagram(graphContainer, readerOpts, viewer); }); })(); //]]\u003e\n5.5. 通信机制 Communication mechanism 5.5.1. 语音模块voiceservic通信 Voice module voiceservic communication 语音模块voiceservice是一个单独的程序集，嵌入到虚拟人app中。语音模块会初始化讯飞sdk并启动录音，识别用户的声音，当用户唤醒或识别的时候，会把相关结果回调到调用方应用。\nThe voice module voiceservice is a separate assembly that is embedded into the virtual human app. The voice module will initialize the iFlytek SDK and start recording, and recognize the user’s voice. When the user wakes up or recognizes it, the relevant results will be called back to the calling application.\n5.5.2. 虚拟人APP和外部APP通信方式 Communication method between virtual person APP and external APP 主要业务场景 Main business scenes:：\n虚拟人–\u003e万得厨\n主要业务场景 Main business scenes:：\n虚拟人–\u003e万得厨\n万得厨→虚拟人\n指令instruction：\n虚拟人APP通过通信发送给万得厨app，万得厨app接收到指令，执行指令逻辑。\nThe virtual human app sends it to the Wonder Kitchen app via communication, and the Wonder Kitchen app receives the instructions and executes the instruction logic.\n显示虚拟人 Display virtual people\n动画（入场、退场等） Animation (admission, exit, etc.)\ntts语音播报 TTS voice broadcast\n万得厨APP通过通信发送给虚拟人APP具体操作，虚拟人APP接收到操作，执行操作逻辑。\nWonder Kitchen APP sends specific operations to the virtual human APP through communication. The virtual human APP receives the operations and executes the operation logic.\n5.6. 时序图 Sequence diagram 以开始烹饪为例：\nTake for example starting cooking\n虚拟人appVirtual human app执行指令例如开始烹饪\n显示虚拟人\ndisplay virtual\nperson\n加热服务Heating service\n用户 User\nasr语音转文字asr speech to text\n结果返回\nResult returned\n万得厨appWonder Kitchen app\n跳转页面\nJump page\n虚拟人云服务Virtual person cloud servicenlp\n显示虚拟人\ndisplay virtual\nperson\n烹饪结束\ncooking finished\n开始烹饪\nStart cooking\n通知显示虚拟人\nNotifications show virtual person\n//\u003c![CDATA[ (function() { $ = AJS.$; var graphContainer = document.getElementById(‘drawio-macro-content-a38223e4-4426-4ba6-99ac-8175f8eab0de’); DrawioProperties = { contextPath : AJS.contextPath(), buildNumber : 8401 }; var readerOpts = {}; readerOpts.loadUrl = ’’ + ‘/rest/drawio/1.0/diagram/crud/%54%69%6D%69%6E%67%20%64%69%61%67%72%61%6D/123651584?revision=1’; readerOpts.imageUrl = ’’ + ‘/download/attachments/123651584/Timing diagram.png’ + ‘?version=1\u0026api=v2’; readerOpts.editUrl = ’’ + ‘/plugins/drawio/addDiagram.action?ceoId=123651584\u0026owningPageId=123651584\u0026diagramName=%54%69%6D%69%6E%67%20%64%69%61%67%72%61%6D\u0026revision=1’; readerOpts.editable = true; readerOpts.canComment = true; readerOpts.stylePath = STYLE_PATH; readerOpts.stencilPath = STENCIL_PATH; readerOpts.imagePath = IMAGE_PATH + ‘/reader’; readerOpts.border = true; readerOpts.width = ‘1000’; readerOpts.simpleViewer = false; readerOpts.tbstyle = ’top’; readerOpts.links = ‘auto’; readerOpts.lightbox = true; readerOpts.resourcePath = ATLAS_RESOURCE_BASE + ‘/resources/viewer’; readerOpts.disableButtons = false; readerOpts.zoomToFit = true; readerOpts.language = ‘zh’; readerOpts.licenseStatus = ‘OK’; readerOpts.contextPath = AJS.contextPath(); readerOpts.diagramName = decodeURIComponent(’%54%69%6D%69%6E%67%20%64%69%61%67%72%61%6D’); readerOpts.diagramDisplayName = ‘’; readerOpts.aspect = ‘’; readerOpts.ceoName = ‘12、虚拟人模块对接HM团队 The virtual human module connects with the HM team’; readerOpts.attVer = ‘1’; readerOpts.attId = ‘123651797’; readerOpts.lastModifierName = ‘王宇’; readerOpts.lastModified = ‘2024-05-06 19:28:24.107’; readerOpts.creatorName = ‘王宇’; //Embed macro specific info readerOpts.extSrvIntegType = ‘$extSrvIntegType’; readerOpts.gClientId = ‘$gClientId’; readerOpts.oClientId = ‘$oClientId’; readerOpts.service = ‘$service’; readerOpts.sFileId = ‘$sFileId’; readerOpts.odriveId = ‘$odriveId’; readerOpts.diagramUrl = ‘$diagramUrl’; readerOpts.csvFileUrl = ‘$csvFileUrl’; readerOpts.pageId = ‘$pageId’ || Confluence.getContentId(); readerOpts.aspectHash = ‘$aspectHash’; readerOpts.useExternalImageService = ‘$useExternalImageService’ == ’true’; readerOpts.isTemplate = ‘$isTemplate’ == ’true’; if (readerOpts.width == ‘’) { readerOpts.width = null; } // LATER: Check if delayed loading of resources can be used for image placeholder mode var viewerPromise = createViewer(graphContainer, readerOpts); if(readerOpts.editable) { $(graphContainer).data(‘viewerConfig’, readerOpts); $(graphContainer).on(‘drawioViewerUpdate’, updateDrawioViewer); } viewerPromise.done(function(viewer) { updateCachedDiagram(graphContainer, readerOpts, viewer); }); })(); //]]\u003e\nFilter table dataCreate a pivot tableCreate a chart from data series\nConfigure buttons visibility\n",
  "wordCount" : "2435",
  "inLanguage": "zh",
  "image": "http://localhost:1313/images/papermod-cover.png","datePublished": "0001-01-01T00:00:00Z",
  "dateModified": "0001-01-01T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "王宇"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://localhost:1313/posts/wiki/12%E8%99%9A%E6%8B%9F%E4%BA%BA%E6%A8%A1%E5%9D%97%E5%AF%B9%E6%8E%A5hm%E5%9B%A2%E9%98%9Fthevirtualhumanmoduleconnectswiththehmteam/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "PaperMod",
    "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:1313/%3Clink%20/%20abs%20url%3E"
    }
  }
}
</script>
</head>

<body class=" dark" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="Home (Alt + H)">
                        
                    <img src="http://localhost:1313/images/msg_hu15231257772499651944.png" alt="" aria-label="logo"
                        height="20">Home</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/archives" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://github.com/adityatelange/hugo-PaperMod/wiki/" title="WiKi">
                    <span>WiKi</span>&nbsp;
                    <svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round"
                        stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12">
                        <path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"></path>
                        <path d="M15 3h6v6"></path>
                        <path d="M10 14L21 3"></path>
                    </svg>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://localhost:1313/">主页</a>&nbsp;»&nbsp;<a href="http://localhost:1313/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      12、虚拟人模块对接HM团队ThevirtualhumanmoduleconnectswiththeHMteam
    </h1>
    <div class="post-description">
      五、系统架构设计
    </div>
    <div class="post-meta">12 分钟&nbsp;·&nbsp;王宇&nbsp;|&nbsp;<a href="https://github.com/WangShaoyu1/myBlogPaperMod/tree/master/content/posts/wiki/12%e3%80%81%e8%99%9a%e6%8b%9f%e4%ba%ba%e6%a8%a1%e5%9d%97%e5%af%b9%e6%8e%a5HM%e5%9b%a2%e9%98%9fThevirtualhumanmoduleconnectswiththeHMteam.md" rel="noopener noreferrer" target="_blank">Suggest Changes</a>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">目录</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#1-%e4%b8%9a%e5%8a%a1%e6%b5%81%e7%a8%8bbusiness-process" aria-label="1. 业务流程 Business Process">1. 业务流程 Business Process</a></li>
                <li>
                    <a href="#2-%e6%95%b0%e6%8d%ae%e6%b5%81%e5%9b%be-data-flow-diagram" aria-label="2. 数据流图 Data flow diagram">2. 数据流图 Data flow diagram</a></li>
                <li>
                    <a href="#3-sdk%e6%8e%a5%e5%85%a5%e6%8c%87%e5%af%bcsdk-access-guidance" aria-label="3. SDK接入指导 SDK Access Guidance">3. SDK接入指导 SDK Access Guidance</a><ul>
                        
                <li>
                    <a href="#31-%e5%a3%b0%e5%ad%a6sdkacoustic-sdk-access-guide" aria-label="3.1. 声学SDK Acoustic SDK access guide">3.1. 声学SDK Acoustic SDK access guide</a></li>
                <li>
                    <a href="#32-%e8%99%9a%e6%8b%9f%e4%ba%basdk%e6%8e%a5%e5%85%a5%e6%8c%87%e5%af%bcvirtual-human-sdk-access-guide" aria-label="3.2. 虚拟人SDK接入指导 Virtual Human SDK Access Guide">3.2. 虚拟人SDK接入指导 Virtual Human SDK Access Guide</a></li></ul>
                </li>
                <li>
                    <a href="#4-%e5%88%9b%e5%bb%ba%e8%99%9a%e6%8b%9f%e4%ba%ba%e6%b5%81%e7%a8%8bcreate-a-virtual-digital-human-process" aria-label="4. 创建虚拟人流程 Create a virtual digital human process">4. 创建虚拟人流程 Create a virtual digital human process</a></li>
                <li>
                    <a href="#5-%e8%99%9a%e6%8b%9f%e4%ba%ba%e6%8e%a5%e5%85%a5%e4%b8%87%e5%be%97%e5%8e%a820nvidia%e9%9b%86%e6%88%90%e6%96%b9%e6%a1%88v10" aria-label="5. 虚拟人接入万得厨2.0（NVIDIA）集成方案v1.0">5. 虚拟人接入万得厨2.0（NVIDIA）集成方案v1.0</a><ul>
                        
                <li>
                    <a href="#51-%e8%ae%be%e8%ae%a1%e5%8e%9f%e5%88%99design-principles" aria-label="5.1. 设计原则 Design Principles">5.1. 设计原则 Design Principles</a><ul>
                        
                <li>
                    <a href="#511-%e6%a8%a1%e5%9d%97%e6%8b%86%e5%88%86%e5%8e%9f%e5%88%99-module-splitting-principle" aria-label="5.1.1. 模块拆分原则 Module splitting principle">5.1.1. 模块拆分原则 Module splitting principle</a></li>
                <li>
                    <a href="#512-%e5%91%bd%e5%90%8d%e8%a7%84%e8%8c%83-naming-convention" aria-label="5.1.2. 命名规范 Naming convention">5.1.2. 命名规范 Naming convention</a></li></ul>
                </li>
                <li>
                    <a href="#52-%e4%bc%98%e5%8a%bf" aria-label="5.2. 优势">5.2. 优势</a></li>
                <li>
                    <a href="#53-%e6%8a%80%e6%9c%af%e6%a0%88-technology-stack" aria-label="5.3. 技术栈 technology stack">5.3. 技术栈 technology stack</a></li>
                <li>
                    <a href="#54-%e5%88%86%e5%b1%82%e6%9e%b6%e6%9e%84-layered-architecture" aria-label="5.4. 分层架构 layered architecture">5.4. 分层架构 layered architecture</a><ul>
                        
                <li>
                    <a href="#541-%e6%9e%b6%e6%9e%84%e4%b8%80-architecture-1" aria-label="5.4.1. 架构一 Architecture 1">5.4.1. 架构一 Architecture 1</a></li>
                <li>
                    <a href="#542-%e6%9e%b6%e6%9e%84%e4%ba%8c-architecture-2" aria-label="5.4.2. 架构二 Architecture 2 ">5.4.2. 架构二 Architecture 2 </a></li></ul>
                </li>
                <li>
                    <a href="#55-%e9%80%9a%e4%bf%a1%e6%9c%ba%e5%88%b6communication-mechanism" aria-label="5.5. 通信机制 Communication mechanism">5.5. 通信机制 Communication mechanism</a><ul>
                        
                <li>
                    <a href="#551-%e8%af%ad%e9%9f%b3%e6%a8%a1%e5%9d%97voiceservic%e9%80%9a%e4%bf%a1voice-module-voiceservic-communication" aria-label="5.5.1. 语音模块voiceservic通信 Voice module voiceservic communication">5.5.1. 语音模块voiceservic通信 Voice module voiceservic communication</a></li>
                <li>
                    <a href="#552-%e8%99%9a%e6%8b%9f%e4%ba%baapp%e5%92%8c%e5%a4%96%e9%83%a8app%e9%80%9a%e4%bf%a1%e6%96%b9%e5%bc%8fcommunication-method-between-virtual-person-app-and-external-app" aria-label="5.5.2. 虚拟人APP和外部APP通信方式  Communication method between virtual person APP and external APP">5.5.2. 虚拟人APP和外部APP通信方式  Communication method between virtual person APP and external APP</a></li></ul>
                </li>
                <li>
                    <a href="#56-%e6%97%b6%e5%ba%8f%e5%9b%besequence-diagram" aria-label="5.6. 时序图  Sequence diagram">5.6. 时序图  Sequence diagram</a>
                </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><ul>
<li>1<a href="/posts/wiki/12%E8%99%9A%E6%8B%9F%E4%BA%BA%E6%A8%A1%E5%9D%97%E5%AF%B9%E6%8E%A5hm%E5%9B%A2%E9%98%9Fthevirtualhumanmoduleconnectswiththehmteam/#id-12、虚拟人模块对接HM团队ThevirtualhumanmoduleconnectswiththeHMteam-业务流程BusinessProcess">1. 业务流程 Business Process</a></li>
<li>2<a href="/posts/wiki/12%E8%99%9A%E6%8B%9F%E4%BA%BA%E6%A8%A1%E5%9D%97%E5%AF%B9%E6%8E%A5hm%E5%9B%A2%E9%98%9Fthevirtualhumanmoduleconnectswiththehmteam/#id-12、虚拟人模块对接HM团队ThevirtualhumanmoduleconnectswiththeHMteam-数据流图Dataflowdiagram">2. 数据流图 Data flow diagram</a></li>
<li>3<a href="/posts/wiki/12%E8%99%9A%E6%8B%9F%E4%BA%BA%E6%A8%A1%E5%9D%97%E5%AF%B9%E6%8E%A5hm%E5%9B%A2%E9%98%9Fthevirtualhumanmoduleconnectswiththehmteam/#id-12、虚拟人模块对接HM团队ThevirtualhumanmoduleconnectswiththeHMteam-SDK接入指导SDKAccessGuidance">3. SDK接入指导 SDK Access Guidance</a>
<ul>
<li>3.1<a href="/posts/wiki/12%E8%99%9A%E6%8B%9F%E4%BA%BA%E6%A8%A1%E5%9D%97%E5%AF%B9%E6%8E%A5hm%E5%9B%A2%E9%98%9Fthevirtualhumanmoduleconnectswiththehmteam/#id-12、虚拟人模块对接HM团队ThevirtualhumanmoduleconnectswiththeHMteam-声学SDKAcousticSDKaccessguide">3.1. 声学SDK Acoustic SDK access guide</a></li>
<li>3.2<a href="/posts/wiki/12%E8%99%9A%E6%8B%9F%E4%BA%BA%E6%A8%A1%E5%9D%97%E5%AF%B9%E6%8E%A5hm%E5%9B%A2%E9%98%9Fthevirtualhumanmoduleconnectswiththehmteam/#id-12、虚拟人模块对接HM团队ThevirtualhumanmoduleconnectswiththeHMteam-虚拟人SDK接入指导VirtualHumanSDKAccessGuide">3.2. 虚拟人SDK接入指导 Virtual Human SDK Access Guide</a></li>
</ul>
</li>
<li>4<a href="/posts/wiki/12%E8%99%9A%E6%8B%9F%E4%BA%BA%E6%A8%A1%E5%9D%97%E5%AF%B9%E6%8E%A5hm%E5%9B%A2%E9%98%9Fthevirtualhumanmoduleconnectswiththehmteam/#id-12、虚拟人模块对接HM团队ThevirtualhumanmoduleconnectswiththeHMteam-创建虚拟人流程Createavirtualdigitalhumanprocess">4. 创建虚拟人流程 Create a virtual digital human process</a></li>
<li>5<a href="/posts/wiki/12%E8%99%9A%E6%8B%9F%E4%BA%BA%E6%A8%A1%E5%9D%97%E5%AF%B9%E6%8E%A5hm%E5%9B%A2%E9%98%9Fthevirtualhumanmoduleconnectswiththehmteam/#id-12、虚拟人模块对接HM团队ThevirtualhumanmoduleconnectswiththeHMteam-虚拟人接入万得厨2.0（NVIDIA）集成方案v1.0">5. 虚拟人接入万得厨2.0（NVIDIA）集成方案v1.0</a>
<ul>
<li>5.1<a href="/posts/wiki/12%E8%99%9A%E6%8B%9F%E4%BA%BA%E6%A8%A1%E5%9D%97%E5%AF%B9%E6%8E%A5hm%E5%9B%A2%E9%98%9Fthevirtualhumanmoduleconnectswiththehmteam/#id-12、虚拟人模块对接HM团队ThevirtualhumanmoduleconnectswiththeHMteam-设计原则DesignPrinciples">5.1. 设计原则 Design Principles</a>
<ul>
<li>5.1.1<a href="/posts/wiki/12%E8%99%9A%E6%8B%9F%E4%BA%BA%E6%A8%A1%E5%9D%97%E5%AF%B9%E6%8E%A5hm%E5%9B%A2%E9%98%9Fthevirtualhumanmoduleconnectswiththehmteam/#id-12、虚拟人模块对接HM团队ThevirtualhumanmoduleconnectswiththeHMteam-模块拆分原则Modulesplittingprinciple">5.1.1. 模块拆分原则 Module splitting principle</a></li>
<li>5.1.2<a href="/posts/wiki/12%E8%99%9A%E6%8B%9F%E4%BA%BA%E6%A8%A1%E5%9D%97%E5%AF%B9%E6%8E%A5hm%E5%9B%A2%E9%98%9Fthevirtualhumanmoduleconnectswiththehmteam/#id-12、虚拟人模块对接HM团队ThevirtualhumanmoduleconnectswiththeHMteam-命名规范Namingconvention">5.1.2. 命名规范 Naming convention</a></li>
</ul>
</li>
<li>5.2<a href="/posts/wiki/12%E8%99%9A%E6%8B%9F%E4%BA%BA%E6%A8%A1%E5%9D%97%E5%AF%B9%E6%8E%A5hm%E5%9B%A2%E9%98%9Fthevirtualhumanmoduleconnectswiththehmteam/#id-12、虚拟人模块对接HM团队ThevirtualhumanmoduleconnectswiththeHMteam-优势">5.2. 优势</a></li>
<li>5.3<a href="/posts/wiki/12%E8%99%9A%E6%8B%9F%E4%BA%BA%E6%A8%A1%E5%9D%97%E5%AF%B9%E6%8E%A5hm%E5%9B%A2%E9%98%9Fthevirtualhumanmoduleconnectswiththehmteam/#id-12、虚拟人模块对接HM团队ThevirtualhumanmoduleconnectswiththeHMteam-技术栈technologystack">5.3. 技术栈 technology stack</a></li>
<li>5.4<a href="/posts/wiki/12%E8%99%9A%E6%8B%9F%E4%BA%BA%E6%A8%A1%E5%9D%97%E5%AF%B9%E6%8E%A5hm%E5%9B%A2%E9%98%9Fthevirtualhumanmoduleconnectswiththehmteam/#id-12、虚拟人模块对接HM团队ThevirtualhumanmoduleconnectswiththeHMteam-分层架构layeredarchitecture">5.4. 分层架构 layered architecture</a>
<ul>
<li>5.4.1<a href="/posts/wiki/12%E8%99%9A%E6%8B%9F%E4%BA%BA%E6%A8%A1%E5%9D%97%E5%AF%B9%E6%8E%A5hm%E5%9B%A2%E9%98%9Fthevirtualhumanmoduleconnectswiththehmteam/#id-12、虚拟人模块对接HM团队ThevirtualhumanmoduleconnectswiththeHMteam-架构一Architecture1">5.4.1. 架构一 Architecture 1</a></li>
<li>5.4.2<a href="/posts/wiki/12%E8%99%9A%E6%8B%9F%E4%BA%BA%E6%A8%A1%E5%9D%97%E5%AF%B9%E6%8E%A5hm%E5%9B%A2%E9%98%9Fthevirtualhumanmoduleconnectswiththehmteam/#id-12、虚拟人模块对接HM团队ThevirtualhumanmoduleconnectswiththeHMteam-架构二Architecture2">5.4.2. 架构二 Architecture 2</a> </li>
</ul>
</li>
<li>5.5<a href="/posts/wiki/12%E8%99%9A%E6%8B%9F%E4%BA%BA%E6%A8%A1%E5%9D%97%E5%AF%B9%E6%8E%A5hm%E5%9B%A2%E9%98%9Fthevirtualhumanmoduleconnectswiththehmteam/#id-12、虚拟人模块对接HM团队ThevirtualhumanmoduleconnectswiththeHMteam-通信机制Communicationmechanism">5.5. 通信机制 Communication mechanism</a>
<ul>
<li>5.5.1<a href="/posts/wiki/12%E8%99%9A%E6%8B%9F%E4%BA%BA%E6%A8%A1%E5%9D%97%E5%AF%B9%E6%8E%A5hm%E5%9B%A2%E9%98%9Fthevirtualhumanmoduleconnectswiththehmteam/#id-12、虚拟人模块对接HM团队ThevirtualhumanmoduleconnectswiththeHMteam-语音模块voiceservic通信Voicemodulevoiceserviccommunication">5.5.1. 语音模块voiceservic通信 Voice module voiceservic communication</a></li>
<li>5.5.2<a href="/posts/wiki/12%E8%99%9A%E6%8B%9F%E4%BA%BA%E6%A8%A1%E5%9D%97%E5%AF%B9%E6%8E%A5hm%E5%9B%A2%E9%98%9Fthevirtualhumanmoduleconnectswiththehmteam/#id-12、虚拟人模块对接HM团队ThevirtualhumanmoduleconnectswiththeHMteam-虚拟人APP和外部APP通信方式CommunicationmethodbetweenvirtualpersonAPPandexternalAPP">5.5.2. 虚拟人APP和外部APP通信方式  Communication method between virtual person APP and external APP</a></li>
</ul>
</li>
<li>5.6<a href="/posts/wiki/12%E8%99%9A%E6%8B%9F%E4%BA%BA%E6%A8%A1%E5%9D%97%E5%AF%B9%E6%8E%A5hm%E5%9B%A2%E9%98%9Fthevirtualhumanmoduleconnectswiththehmteam/#id-12、虚拟人模块对接HM团队ThevirtualhumanmoduleconnectswiththeHMteam-时序图Sequencediagram">5.6. 时序图  Sequence diagram</a></li>
</ul>
</li>
</ul>
<h1 id="1-业务流程business-process">1. 业务流程 Business Process<a hidden class="anchor" aria-hidden="true" href="#1-业务流程business-process">#</a></h1>
<p>将虚拟数字人安装在万得厨（之后会有其他设备载体），期望通过语音互动的交互形式，依托背后强大的产业知识数据库及知名第三方厂商的公开知识库，为用户提供设备控制、智能对话等服务</p>
<p>The virtual digital human （VDH）is installed in Wonder Kitchen (there will be other device carriers in the future), and it is expected to provide users with device control and intelligence Conversation and other services through the interactive form of voice interaction, relying on the powerful industrial knowledge database and the public knowledge base of well-known third-party manufacturers</p>
<p>Pool</p>
<p>用户 User</p>
<p>说出语音对话内容<br>
User speaks voice conversation content</p>
<p>设备端 device</p>
<p>执行指令</p>
<p>Execute instructions</p>
<p>mic拾音<br>
mic picking up sound</p>
<p>播放语音</p>
<p>Play voice</p>
<p>VDH Cloud Skills  NLP（natural language processing）Analyze user intent</p>
<p>影子虚拟人 Yingzi VDH</p>
<p>解析意图调用万得厨指令接口<br>
Parsing the intention to call the Wonderchu command interface</p>
<p>播放动作</p>
<p>play action</p>
<p>Acoustic SDK</p>
<p>ASR语音转化为文本<br>
ASR speech to text</p>
<p>VDH SDK</p>
<p>调用接口<br>
calling SDK interface</p>
<p>触发回调接口<br>
Trigger callback interface<br>
(IPlayChat)</p>
<p>Virtual human operation system</p>
<p>配置虚拟人指令、闲聊库、知识库</p>
<p>Configure virtual human instructions, chat library, and knowledge base</p>
<p>VDH: virtual digtal human  虚拟数字人</p>
<p>Acoustic SDK</p>
<p><img loading="lazy" src="data:image/svg&#43;xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0Ij48cGF0aCBkPSJNMjEuOTkgNGMwLTEuMS0uODktMi0xLjk5LTJINGMtMS4xIDAtMiAuOS0yIDJ2MTJjMCAxLjEuOSAyIDIgMmgxNGw0IDQtLjAxLTE4ek0xOCAxNEg2di0yaDEydjJ6bTAtM0g2VjloMTJ2MnptMC0zSDZWNmgxMnYyeiIvPjxwYXRoIGQ9Ik0wIDBoMjR2MjRIMHoiIGZpbGw9Im5vbmUiLz48L3N2Zz4=" alt=""  title="显示评论"  />
</p>
<p>//&lt;![CDATA[ (function() { $ = AJS.$; var graphContainer = document.getElementById(&lsquo;drawio-macro-content-6b6525bc-a85d-4100-b25e-bf121efca794&rsquo;); DrawioProperties = { contextPath : AJS.contextPath(), buildNumber : 8401 }; var readerOpts = {}; readerOpts.loadUrl = &rsquo;&rsquo; + &lsquo;/rest/drawio/1.0/diagram/crud/%E6%9C%AA%E5%91%BD%E5%90%8D%E7%BB%98%E5%9B%BE/123651584?revision=1&rsquo;; readerOpts.imageUrl = &rsquo;&rsquo; + &lsquo;/download/attachments/123651584/未命名绘图.png&rsquo; + &lsquo;?version=1&amp;api=v2&rsquo;; readerOpts.editUrl = &rsquo;&rsquo; + &lsquo;/plugins/drawio/addDiagram.action?ceoId=123651584&amp;owningPageId=123651584&amp;diagramName=%E6%9C%AA%E5%91%BD%E5%90%8D%E7%BB%98%E5%9B%BE&amp;revision=1&rsquo;; readerOpts.editable = true; readerOpts.canComment = true; readerOpts.stylePath = STYLE_PATH; readerOpts.stencilPath = STENCIL_PATH; readerOpts.imagePath = IMAGE_PATH + &lsquo;/reader&rsquo;; readerOpts.border = true; readerOpts.width = &lsquo;1000&rsquo;; readerOpts.simpleViewer = false; readerOpts.tbstyle = &rsquo;top&rsquo;; readerOpts.links = &lsquo;auto&rsquo;; readerOpts.lightbox = true; readerOpts.resourcePath = ATLAS_RESOURCE_BASE + &lsquo;/resources/viewer&rsquo;; readerOpts.disableButtons = false; readerOpts.zoomToFit = true; readerOpts.language = &lsquo;zh&rsquo;; readerOpts.licenseStatus = &lsquo;OK&rsquo;; readerOpts.contextPath = AJS.contextPath(); readerOpts.diagramName = decodeURIComponent(&rsquo;%E6%9C%AA%E5%91%BD%E5%90%8D%E7%BB%98%E5%9B%BE&rsquo;); readerOpts.diagramDisplayName = &lsquo;&rsquo;; readerOpts.aspect = &lsquo;&rsquo;; readerOpts.ceoName = &lsquo;12、虚拟人模块对接HM团队 The virtual human module connects with the HM team&rsquo;; readerOpts.attVer = &lsquo;1&rsquo;; readerOpts.attId = &lsquo;123651603&rsquo;; readerOpts.lastModifierName = &lsquo;王宇&rsquo;; readerOpts.lastModified = &lsquo;2024-05-06 11:33:46.134&rsquo;; readerOpts.creatorName = &lsquo;王宇&rsquo;; //Embed macro specific info readerOpts.extSrvIntegType = &lsquo;$extSrvIntegType&rsquo;; readerOpts.gClientId = &lsquo;$gClientId&rsquo;; readerOpts.oClientId = &lsquo;$oClientId&rsquo;; readerOpts.service = &lsquo;$service&rsquo;; readerOpts.sFileId = &lsquo;$sFileId&rsquo;; readerOpts.odriveId = &lsquo;$odriveId&rsquo;; readerOpts.diagramUrl = &lsquo;$diagramUrl&rsquo;; readerOpts.csvFileUrl = &lsquo;$csvFileUrl&rsquo;; readerOpts.pageId = &lsquo;$pageId&rsquo; || Confluence.getContentId(); readerOpts.aspectHash = &lsquo;$aspectHash&rsquo;; readerOpts.useExternalImageService = &lsquo;$useExternalImageService&rsquo; == &rsquo;true&rsquo;; readerOpts.isTemplate = &lsquo;$isTemplate&rsquo; == &rsquo;true&rsquo;; if (readerOpts.width == &lsquo;&rsquo;) { readerOpts.width = null; } // LATER: Check if delayed loading of resources can be used for image placeholder mode var viewerPromise = createViewer(graphContainer, readerOpts); if(readerOpts.editable) { $(graphContainer).data(&lsquo;viewerConfig&rsquo;, readerOpts); $(graphContainer).on(&lsquo;drawioViewerUpdate&rsquo;, updateDrawioViewer); } viewerPromise.done(function(viewer) { updateCachedDiagram(graphContainer, readerOpts, viewer); }); })(); //]]&gt;</p>
<p><strong>说明 Description：</strong></p>
<p>**运营人员在杭州虚拟人公司的后台运营系统录入指令库和知识库<br>
**</p>
<p><strong>Operators enter the instruction base and knowledge base into the backend operation system of third-party Virtual Human Company</strong></p>
<p><strong>1、用户说出语音对话内容，被麦克风拾音</strong></p>
<p><strong>The user speaks the voice conversation content and the sound is picked up by the microphone.</strong></p>
<p><strong>2、调用科大讯飞sdk asr接口降语音转化为文本</strong></p>
<p><strong>Call the IFLYTEK sdk asr interface to convert speech into text.</strong></p>
<p><strong>3、将文本传给杭州虚拟人接口AvatarPlayCloudBehavior，接口分析语义、情绪、进行行为推理，回调影子虚拟人接口</strong></p>
<p><strong>Pass the text to the third-partyvirtual human interface AvatarPlayCloudBehavior. The interface analyzes semantics, emotions, conducts behavioral inference, and calls back the shadow virtual human interface.</strong></p>
<p><strong>4、影子虚拟人接口收到IPlaychat的接口回调，根据意图，调用万得厨或者其他接口。</strong></p>
<p><strong>The Yingzi VDH interface receives the interface callback from IPlaychat, and calls Wonder Kitchen or other interfaces based on the intention</strong></p>
<h1 id="2-数据流图-data-flow-diagram">2. <strong>数据流图 Data flow diagram</strong><a hidden class="anchor" aria-hidden="true" href="#2-数据流图-data-flow-diagram">#</a></h1>
<p>万得厨 Device</p>
<p>虚拟人应用<br>
VDH application</p>
<p>mic</p>
<p>Acoustic SDK</p>
<p>(Wake ASR)</p>
<p>VDH sdk</p>
<p>VDH cloud service</p>
<p>虚拟人后台运营应用<br>
Virtual human backend operation application</p>
<p>audio</p>
<p>技能 skill</p>
<p><img loading="lazy" src="data:image/svg&#43;xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0Ij48cGF0aCBkPSJNMjEuOTkgNGMwLTEuMS0uODktMi0xLjk5LTJINGMtMS4xIDAtMiAuOS0yIDJ2MTJjMCAxLjEuOSAyIDIgMmgxNGw0IDQtLjAxLTE4ek0xOCAxNEg2di0yaDEydjJ6bTAtM0g2VjloMTJ2MnptMC0zSDZWNmgxMnYyeiIvPjxwYXRoIGQ9Ik0wIDBoMjR2MjRIMHoiIGZpbGw9Im5vbmUiLz48L3N2Zz4=" alt=""  title="显示评论"  />
</p>
<p>//&lt;![CDATA[ (function() { $ = AJS.$; var graphContainer = document.getElementById(&lsquo;drawio-macro-content-ce91b1af-b22c-4950-901e-632e6bc8a16b&rsquo;); DrawioProperties = { contextPath : AJS.contextPath(), buildNumber : 8401 }; var readerOpts = {}; readerOpts.loadUrl = &rsquo;&rsquo; + &lsquo;/rest/drawio/1.0/diagram/crud/%E6%9C%AA%E5%91%BD%E5%90%8D%E7%BB%98%E5%9B%BE%31/123651584?revision=1&rsquo;; readerOpts.imageUrl = &rsquo;&rsquo; + &lsquo;/download/attachments/123651584/未命名绘图1.png&rsquo; + &lsquo;?version=1&amp;api=v2&rsquo;; readerOpts.editUrl = &rsquo;&rsquo; + &lsquo;/plugins/drawio/addDiagram.action?ceoId=123651584&amp;owningPageId=123651584&amp;diagramName=%E6%9C%AA%E5%91%BD%E5%90%8D%E7%BB%98%E5%9B%BE%31&amp;revision=1&rsquo;; readerOpts.editable = true; readerOpts.canComment = true; readerOpts.stylePath = STYLE_PATH; readerOpts.stencilPath = STENCIL_PATH; readerOpts.imagePath = IMAGE_PATH + &lsquo;/reader&rsquo;; readerOpts.border = true; readerOpts.width = &lsquo;600&rsquo;; readerOpts.simpleViewer = false; readerOpts.tbstyle = &rsquo;top&rsquo;; readerOpts.links = &lsquo;auto&rsquo;; readerOpts.lightbox = true; readerOpts.resourcePath = ATLAS_RESOURCE_BASE + &lsquo;/resources/viewer&rsquo;; readerOpts.disableButtons = false; readerOpts.zoomToFit = true; readerOpts.language = &lsquo;zh&rsquo;; readerOpts.licenseStatus = &lsquo;OK&rsquo;; readerOpts.contextPath = AJS.contextPath(); readerOpts.diagramName = decodeURIComponent(&rsquo;%E6%9C%AA%E5%91%BD%E5%90%8D%E7%BB%98%E5%9B%BE%31&rsquo;); readerOpts.diagramDisplayName = &lsquo;&rsquo;; readerOpts.aspect = &lsquo;&rsquo;; readerOpts.ceoName = &lsquo;12、虚拟人模块对接HM团队 The virtual human module connects with the HM team&rsquo;; readerOpts.attVer = &lsquo;1&rsquo;; readerOpts.attId = &lsquo;123651609&rsquo;; readerOpts.lastModifierName = &lsquo;王宇&rsquo;; readerOpts.lastModified = &lsquo;2024-05-06 11:42:02.77&rsquo;; readerOpts.creatorName = &lsquo;王宇&rsquo;; //Embed macro specific info readerOpts.extSrvIntegType = &lsquo;$extSrvIntegType&rsquo;; readerOpts.gClientId = &lsquo;$gClientId&rsquo;; readerOpts.oClientId = &lsquo;$oClientId&rsquo;; readerOpts.service = &lsquo;$service&rsquo;; readerOpts.sFileId = &lsquo;$sFileId&rsquo;; readerOpts.odriveId = &lsquo;$odriveId&rsquo;; readerOpts.diagramUrl = &lsquo;$diagramUrl&rsquo;; readerOpts.csvFileUrl = &lsquo;$csvFileUrl&rsquo;; readerOpts.pageId = &lsquo;$pageId&rsquo; || Confluence.getContentId(); readerOpts.aspectHash = &lsquo;$aspectHash&rsquo;; readerOpts.useExternalImageService = &lsquo;$useExternalImageService&rsquo; == &rsquo;true&rsquo;; readerOpts.isTemplate = &lsquo;$isTemplate&rsquo; == &rsquo;true&rsquo;; if (readerOpts.width == &lsquo;&rsquo;) { readerOpts.width = null; } // LATER: Check if delayed loading of resources can be used for image placeholder mode var viewerPromise = createViewer(graphContainer, readerOpts); if(readerOpts.editable) { $(graphContainer).data(&lsquo;viewerConfig&rsquo;, readerOpts); $(graphContainer).on(&lsquo;drawioViewerUpdate&rsquo;, updateDrawioViewer); } viewerPromise.done(function(viewer) { updateCachedDiagram(graphContainer, readerOpts, viewer); }); })(); //]]&gt;</p>
<h1 id="3-sdk接入指导sdk-access-guidance">3. SDK接入指导 SDK Access Guidance<a hidden class="anchor" aria-hidden="true" href="#3-sdk接入指导sdk-access-guidance">#</a></h1>
<h2 id="31-声学sdkacoustic-sdk-access-guide">3.1. 声学SDK Acoustic SDK access guide<a hidden class="anchor" aria-hidden="true" href="#31-声学sdkacoustic-sdk-access-guide">#</a></h2>
<p><strong>中文版本 Chinese edition :</strong> </p>
<ul>
<li> <a href="https://aiui-doc.xf-yun.com/project-1/doc-12/">https://aiui-doc.xf-yun.com/project-1/doc-12/</a></li>
<li><a href="https://github.com/zrmei/DemoCode/blob/master/docs/src/index.rst">https://github.com/zrmei/DemoCode/blob/master/docs/src/index.rst</a></li>
<li><a href="https://democode.readthedocs.io/zh-cn/latest/src/index.html#sdk">https://democode.readthedocs.io/zh-cn/latest/src/index.html#sdk</a></li>
</ul>
<p><strong>Demo code：</strong></p>
<ul>
<li><a href="/download/attachments/123651584/std_mic2%26aiui.zip?version=1&modificationDate=1714989654129&api=v2">std_mic2&amp;aiui.zip</a></li>
</ul>
<h2 id="32-虚拟人sdk接入指导virtual-human-sdk-access-guide">3.2. 虚拟人SDK接入指导 Virtual Human SDK Access Guide<a hidden class="anchor" aria-hidden="true" href="#32-虚拟人sdk接入指导virtual-human-sdk-access-guide">#</a></h2>
<p><strong>中文文档 Chinese documentation</strong></p>
<p><strong>英文文档  English document</strong></p>
<p><strong>中文文档 Chinese documentation</strong></p>
<p><strong>英文文档  English document</strong></p>
<p><a href="/download/attachments/123651584/HaiSDK_ubuntu%E6%8E%A5%E5%85%A5%E6%8C%87%E5%8D%97.pdf?version=1&modificationDate=1714989721372&api=v2"><img loading="lazy" src="/rest/documentConversion/latest/conversion/thumbnail/123651769/1" alt=""  />
</a> PDF</p>
<p><a href="/download/attachments/123651584/HaiSDK_ubuntu%E6%8E%A5%E5%85%A5%E6%8C%87%E5%8D%97_English.pdf?version=1&modificationDate=1714989936467&api=v2"><img loading="lazy" src="/rest/documentConversion/latest/conversion/thumbnail/123651771/1" alt=""  />
</a> PDF</p>
<p><strong>Demo code：</strong></p>
<ul>
<li><a href="/download/attachments/123651584/nvidia%20jetson%20orin.zip?version=1&modificationDate=1714990789405&api=v2">nvidia jetson orin.zip</a></li>
</ul>
<h1 id="4-创建虚拟人流程create-a-virtual-digital-human-process">4. 创建虚拟人流程 Create a virtual digital human process<a hidden class="anchor" aria-hidden="true" href="#4-创建虚拟人流程create-a-virtual-digital-human-process">#</a></h1>
<p>序号order</p>
<p><strong>中文版本 Chinese edition</strong></p>
<p><strong>英文版本  English edition</strong></p>
<p>序号order</p>
<p><strong>中文版本 Chinese edition</strong></p>
<p><strong>英文版本  English edition</strong></p>
<p>1</p>
<p>【必须】HaiSDK#Init，sdk初始化方法，在回调里面判断是否成功，成功后继续下一步</p>
<p>【Required】 HaiSDK#Init, sdk initialization method, determine whether it is successful in the callback, and continue to the next step if successful.</p>
<p>2</p>
<p>【必须】通过HaiSDK.GetAuthToken()方法获取token，成功后继续下一步</p>
<p>【Required】 Obtain the token through the HaiSDK.GetAuthToken() method and proceed to the next step after success.</p>
<p>3</p>
<p>【必须】获取通过接口虚拟人信息，url=(GPValues.BASE_URL + &ldquo;/getInstListByAppId&rdquo;)，添加token到头部信息，addHeader(&ldquo;Cookie&rdquo;,&ldquo;user_token=$token&rdquo;)</p>
<p>【Required】 Obtain the virtual person information through the interface, url=(GPValues.BASE_URL + &ldquo;/getInstListByAppId&rdquo;), add token to the header information, addHeader(&ldquo;Cookie&rdquo;, &ldquo;user_token=$token&rdquo;)</p>
<p>4</p>
<p>【必须】检查资源包：HaiSDK.CheckServerAsset，如果不需要更新，则可跳过第5步</p>
<p>【Required】 Check the resource package: HaiSDK.CheckServerAsset. If you do not need to update, you can skip step 5.</p>
<p>5</p>
<p>【必须】下载资源包方法：HaiSDK.DownloadCheckedServerAsset</p>
<p>【Required】 How to download resource package: HaiSDK.DownloadCheckedServerAsset</p>
<p>6</p>
<p>【可选】如果是pta虚拟人，需要执行这个，下载PTA实例资源：HaiSDK.DownloadPTA，不是pta虚拟人直接跳过这步，进入创建。</p>
<p>【Optional】 If it is a pta virtual person, you need to perform this and download the PTA instance resource: HaiSDK.DownloadPTA. If it is not a pta virtual person, skip this step and enter creation.</p>
<p>7</p>
<p>【可选】创建pta HaiSDK.CreatePTA 失败原因 //1 创建成功<br>
//-1 未检测到人脸<br>
//-2 不是正脸<br>
//-3 戴了眼镜<br>
//-4 五官被遮挡<br>
//-5 眼睛异常<br>
//-6 嘴部异常<br>
//-7 图片为空</p>
<p>【Optional】 Reason for failure to create pta HaiSDK.CreatePTA //1 Successfully created<br>
//-1 No face detected<br>
//-2 is not a positive face<br>
//-3 Wearing glasses<br>
//-4 facial features are obscured<br>
//-5 Eye abnormalities<br>
//-6 Mouth abnormality<br>
//-7 The picture is empty</p>
<p>8</p>
<p>【必须】创建虚拟人：HaiSDK.CreateInstance</p>
<p>【Required】Create virtual person: HaiSDK.CreateInstance</p>
<p>9</p>
<p>【可选】装扮接口，HaiSDK.InstanceLoadAsset 例如 HaiSDK.InstanceLoadAsset(avatarInstID, qualityType, parts.getMUplimb());穿上衣</p>
<p>【Optional】 Dressing interface, HaiSDK.InstanceLoadAsset For example, HaiSDK.InstanceLoadAsset(avatarInstID, qualityType, parts.getMUplimb()); put on clothes</p>
<h1 id="5-虚拟人接入万得厨20nvidia集成方案v10">5. 虚拟人接入万得厨2.0（NVIDIA）集成方案v1.0<a hidden class="anchor" aria-hidden="true" href="#5-虚拟人接入万得厨20nvidia集成方案v10">#</a></h1>
<h2 id="51-设计原则design-principles">5.1. 设计原则 Design Principles<a hidden class="anchor" aria-hidden="true" href="#51-设计原则design-principles">#</a></h2>
<h3 id="511-模块拆分原则-module-splitting-principle">5.1.1. 模块拆分原则 Module splitting principle<a hidden class="anchor" aria-hidden="true" href="#511-模块拆分原则-module-splitting-principle">#</a></h3>
<p>拆分原则：分层解耦、单一职责、高内聚低耦合、易于维护与扩展</p>
<p>Split principles: layered decoupling, single responsibility, high cohesion and low coupling, easy maintenance and expansion</p>
<ol>
<li>业务模块：承载具体业务需求，业务模块之间尽可能解耦。<br>
Business module: carries specific business needs and is decoupled as much as possible between business modules</li>
<li>通用模块（有的叫功能模块）：包含其他模块经常使用的代码，减少冗余，理论上通用模块不依赖任何业务侧的数据结构。<br>
General modules (some are called functional modules): contain codes frequently used by other modules to reduce redundancy. In theory, general modules do not depend on any business-side data structures.</li>
</ol>
<h3 id="512-命名规范-naming-convention">5.1.2. 命名规范 Naming convention<a hidden class="anchor" aria-hidden="true" href="#512-命名规范-naming-convention">#</a></h3>
<ol>
<li>命名规范（保证语义与表达的同时，尽量做到简洁，可以使用 core、common、business 等文件夹包括各个层级）</li>
</ol>
<p>Naming convention (while ensuring semantics and expression, try to be as concise as possible, you can use core, common, business, etc. folders to include various levels)</p>
<h2 id="52-优势">5.2. 优势<a hidden class="anchor" aria-hidden="true" href="#52-优势">#</a></h2>
<p><strong>中文文档 Chinese documentation</strong></p>
<p><strong>英文文档  English document</strong></p>
<p><strong>中文文档 Chinese documentation</strong></p>
<p><strong>英文文档  English document</strong></p>
<ol>
<li>虚拟人可以快速移植到其他app。</li>
</ol>
<p>Virtual humans can be quickly transplanted to other apps.</p>
<ul>
<li>开发减少构建时间。在开发阶段按需编译组件，一次调试中可能有一两个组件参与集成，这样编译时间就会大大降低，提高开发效率。</li>
</ul>
<p>Develop to reduce build times. Components are compiled on demand during the development phase. One or two components may be integrated during a debugging process, which greatly reduces the compilation time and improves development efficiency.</p>
<ul>
<li>代码解耦，代码责任制，组件之间的交互如果还是直接引用的话，那么组件之间根本没有做到解耦。组件间通信解耦组织直接调用，降低沟通成本。</li>
</ul>
<p>Code decoupling, code accountability, and if the interactions between components are still directly referenced, then there is no decoupling between components at all. Inter-component communication decoupling organizes direct calls, reducing communication costs.</p>
<h2 id="53-技术栈-technology-stack">5.3. 技术栈 technology stack<a hidden class="anchor" aria-hidden="true" href="#53-技术栈-technology-stack">#</a></h2>
<ul>
<li>开发语言programming language：c++</li>
<li>界面Front-end interface framework：QT</li>
</ul>
<h2 id="54-分层架构-layered-architecture">5.4. 分层架构 layered architecture<a hidden class="anchor" aria-hidden="true" href="#54-分层架构-layered-architecture">#</a></h2>
<p>为了加快前端集成进度，建议HM团队去按照生态应用（主应用、子应用）的架构（也就是架构1）去集成，虚拟人团队提供声学SDK、虚拟人SDK的接入技术指导。国内虚拟人团队工作重点放在打造场景化人机交互形态上。</p>
<p>In order to speed up the front-end integration progress, it is recommended that the HM team integrate according to the architecture of the ecological application (main application, sub-application) (that is, architecture 1). The domestic virtual human team provides access technical guidance for the acoustic SDK and virtual human SDK. Domestic virtual human teams focus on creating scenario-based human-computer interaction.</p>
<h3 id="541-架构一-architecture-1">5.4.1. 架构一 Architecture 1<a hidden class="anchor" aria-hidden="true" href="#541-架构一-architecture-1">#</a></h3>
<p>万得厨界面应用、虚拟人应用，两者之间是独立存在的，通过交互协议双向通信。虚拟人应用作为一个生态应用接入。</p>
<p>Wonder Kitchen Interface Application  and Virtual human application ，The two exist independently and communicate in two directions through an interactive protocol.</p>
<p>The virtual human application is accessed as an ecological application</p>
<p>APP</p>
<p>服务</p>
<p>service</p>
<p>加热服务<br>
heating service</p>
<p>外部集成<br>
external integrated</p>
<p>NLP</p>
<p>ASR</p>
<p>其他服务<br>
other service</p>
<p>万得厨</p>
<p>虚拟人<br>
Virtual digtal human</p>
<p><img loading="lazy" src="data:image/svg&#43;xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0Ij48cGF0aCBkPSJNMjEuOTkgNGMwLTEuMS0uODktMi0xLjk5LTJINGMtMS4xIDAtMiAuOS0yIDJ2MTJjMCAxLjEuOSAyIDIgMmgxNGw0IDQtLjAxLTE4ek0xOCAxNEg2di0yaDEydjJ6bTAtM0g2VjloMTJ2MnptMC0zSDZWNmgxMnYyeiIvPjxwYXRoIGQ9Ik0wIDBoMjR2MjRIMHoiIGZpbGw9Im5vbmUiLz48L3N2Zz4=" alt=""  title="显示评论"  />
</p>
<p>//&lt;![CDATA[ (function() { $ = AJS.$; var graphContainer = document.getElementById(&lsquo;drawio-macro-content-c6f8061d-24a8-4aef-ba43-9d5f25fff9fc&rsquo;); DrawioProperties = { contextPath : AJS.contextPath(), buildNumber : 8401 }; var readerOpts = {}; readerOpts.loadUrl = &rsquo;&rsquo; + &lsquo;/rest/drawio/1.0/diagram/crud/%6C%61%79%65%72%65%64%20%61%72%63%68%69%74%65%63%74%75%72%65/123651584?revision=2&rsquo;; readerOpts.imageUrl = &rsquo;&rsquo; + &lsquo;/download/attachments/123651584/layered architecture-b16d28ddda6d9de30bd12cd604bc041fe50121ab.png&rsquo; + &lsquo;?version=2&amp;api=v2&rsquo;; readerOpts.editUrl = &rsquo;&rsquo; + &lsquo;/plugins/drawio/addDiagram.action?ceoId=123651584&amp;owningPageId=123651584&amp;diagramName=%6C%61%79%65%72%65%64%20%61%72%63%68%69%74%65%63%74%75%72%65&amp;revision=2&rsquo;; readerOpts.editable = true; readerOpts.canComment = true; readerOpts.stylePath = STYLE_PATH; readerOpts.stencilPath = STENCIL_PATH; readerOpts.imagePath = IMAGE_PATH + &lsquo;/reader&rsquo;; readerOpts.border = true; readerOpts.width = &lsquo;800&rsquo;; readerOpts.simpleViewer = false; readerOpts.tbstyle = &rsquo;top&rsquo;; readerOpts.links = &lsquo;auto&rsquo;; readerOpts.lightbox = true; readerOpts.resourcePath = ATLAS_RESOURCE_BASE + &lsquo;/resources/viewer&rsquo;; readerOpts.disableButtons = false; readerOpts.zoomToFit = true; readerOpts.language = &lsquo;zh&rsquo;; readerOpts.licenseStatus = &lsquo;OK&rsquo;; readerOpts.contextPath = AJS.contextPath(); readerOpts.diagramName = decodeURIComponent(&rsquo;%6C%61%79%65%72%65%64%20%61%72%63%68%69%74%65%63%74%75%72%65&rsquo;); readerOpts.diagramDisplayName = &lsquo;&rsquo;; readerOpts.aspect = &lsquo;kmN2Z7sw7ftHL1OGfhmL&rsquo;; readerOpts.ceoName = &lsquo;12、虚拟人模块对接HM团队 The virtual human module connects with the HM team&rsquo;; readerOpts.attVer = &lsquo;2&rsquo;; readerOpts.attId = &lsquo;123651788&rsquo;; readerOpts.lastModifierName = &lsquo;王宇&rsquo;; readerOpts.lastModified = &lsquo;2024-05-06 18:55:48.559&rsquo;; readerOpts.creatorName = &lsquo;王宇&rsquo;; //Embed macro specific info readerOpts.extSrvIntegType = &lsquo;$extSrvIntegType&rsquo;; readerOpts.gClientId = &lsquo;$gClientId&rsquo;; readerOpts.oClientId = &lsquo;$oClientId&rsquo;; readerOpts.service = &lsquo;$service&rsquo;; readerOpts.sFileId = &lsquo;$sFileId&rsquo;; readerOpts.odriveId = &lsquo;$odriveId&rsquo;; readerOpts.diagramUrl = &lsquo;$diagramUrl&rsquo;; readerOpts.csvFileUrl = &lsquo;$csvFileUrl&rsquo;; readerOpts.pageId = &lsquo;$pageId&rsquo; || Confluence.getContentId(); readerOpts.aspectHash = &lsquo;$aspectHash&rsquo;; readerOpts.useExternalImageService = &lsquo;$useExternalImageService&rsquo; == &rsquo;true&rsquo;; readerOpts.isTemplate = &lsquo;$isTemplate&rsquo; == &rsquo;true&rsquo;; if (readerOpts.width == &lsquo;&rsquo;) { readerOpts.width = null; } // LATER: Check if delayed loading of resources can be used for image placeholder mode var viewerPromise = createViewer(graphContainer, readerOpts); if(readerOpts.editable) { $(graphContainer).data(&lsquo;viewerConfig&rsquo;, readerOpts); $(graphContainer).on(&lsquo;drawioViewerUpdate&rsquo;, updateDrawioViewer); } viewerPromise.done(function(viewer) { updateCachedDiagram(graphContainer, readerOpts, viewer); }); })(); //]]&gt;</p>
<ol>
<li>绿色代表虚拟人负责的部分。<br>
The green color represents the part that the virtual person is responsible for.</li>
<li>黄色代表万得厨负责的部分<br>
The yellow color represents the part that Wonder Kitchen is responsible for</li>
<li>虚拟人包含语音和形象展示。主要用来和用户交互，和万得厨进行数据传递，完成对万得厨指令的调用。<br>
The virtual person includes voice and image display. It is mainly used to interact with users, transfer data with Wonder Kitchen, and complete the call of Wonder Kitchen instructions.</li>
<li>虚拟人模块主要包含ASR（语音转文字）、TTS（文字转语音）、NLP（自然语言理解处理）和以及动画的封装。<br>
The virtual human module mainly includes ASR (speech to text), TTS (text to speech), NLP (natural language understanding processing) and animation encapsulation.</li>
</ol>
<h3 id="542-架构二-architecture-2">5.4.2. 架构二 Architecture 2 <a hidden class="anchor" aria-hidden="true" href="#542-架构二-architecture-2">#</a></h3>
<p>虚拟人应用，作为万得厨界面应用的一个模块，通过SDK的形式，整体集成进去</p>
<p>Virtual human application, as a module of WINDUK interface application，Integrated as a whole through SDK</p>
<p>APP</p>
<p>服务</p>
<p>service</p>
<p>加热服务<br>
heating service</p>
<p>外部集成<br>
external integrated</p>
<p>NLP</p>
<p>ASR</p>
<p>其他服务<br>
other service</p>
<p>万得厨</p>
<p>虚拟人<br>
Virtual digtal human</p>
<p><img loading="lazy" src="data:image/svg&#43;xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0Ij48cGF0aCBkPSJNMjEuOTkgNGMwLTEuMS0uODktMi0xLjk5LTJINGMtMS4xIDAtMiAuOS0yIDJ2MTJjMCAxLjEuOSAyIDIgMmgxNGw0IDQtLjAxLTE4ek0xOCAxNEg2di0yaDEydjJ6bTAtM0g2VjloMTJ2MnptMC0zSDZWNmgxMnYyeiIvPjxwYXRoIGQ9Ik0wIDBoMjR2MjRIMHoiIGZpbGw9Im5vbmUiLz48L3N2Zz4=" alt=""  title="显示评论"  />
</p>
<p>//&lt;![CDATA[ (function() { $ = AJS.$; var graphContainer = document.getElementById(&lsquo;drawio-macro-content-b2d1d86b-3967-4242-8b6c-a7b029d9a72c&rsquo;); DrawioProperties = { contextPath : AJS.contextPath(), buildNumber : 8401 }; var readerOpts = {}; readerOpts.loadUrl = &rsquo;&rsquo; + &lsquo;/rest/drawio/1.0/diagram/crud/%6C%61%79%65%72%65%64%20%61%72%63%68%69%74%65%63%74%75%72%65/123651584?revision=2&rsquo;; readerOpts.imageUrl = &rsquo;&rsquo; + &lsquo;/download/attachments/123651584/layered architecture-b16d28ddda6d9de30bd12cd604bc041fe50121ab.png&rsquo; + &lsquo;?version=2&amp;api=v2&rsquo;; readerOpts.editUrl = &rsquo;&rsquo; + &lsquo;/plugins/drawio/addDiagram.action?ceoId=123651584&amp;owningPageId=123651584&amp;diagramName=%6C%61%79%65%72%65%64%20%61%72%63%68%69%74%65%63%74%75%72%65&amp;revision=2&rsquo;; readerOpts.editable = true; readerOpts.canComment = true; readerOpts.stylePath = STYLE_PATH; readerOpts.stencilPath = STENCIL_PATH; readerOpts.imagePath = IMAGE_PATH + &lsquo;/reader&rsquo;; readerOpts.border = true; readerOpts.width = &lsquo;800&rsquo;; readerOpts.simpleViewer = false; readerOpts.tbstyle = &rsquo;top&rsquo;; readerOpts.links = &lsquo;auto&rsquo;; readerOpts.lightbox = true; readerOpts.resourcePath = ATLAS_RESOURCE_BASE + &lsquo;/resources/viewer&rsquo;; readerOpts.disableButtons = false; readerOpts.zoomToFit = true; readerOpts.language = &lsquo;zh&rsquo;; readerOpts.licenseStatus = &lsquo;OK&rsquo;; readerOpts.contextPath = AJS.contextPath(); readerOpts.diagramName = decodeURIComponent(&rsquo;%6C%61%79%65%72%65%64%20%61%72%63%68%69%74%65%63%74%75%72%65&rsquo;); readerOpts.diagramDisplayName = &lsquo;&rsquo;; readerOpts.aspect = &lsquo;kmN2Z7sw7ftHL1OGfhmL&rsquo;; readerOpts.ceoName = &lsquo;12、虚拟人模块对接HM团队 The virtual human module connects with the HM team&rsquo;; readerOpts.attVer = &lsquo;2&rsquo;; readerOpts.attId = &lsquo;123651788&rsquo;; readerOpts.lastModifierName = &lsquo;王宇&rsquo;; readerOpts.lastModified = &lsquo;2024-05-06 18:55:48.559&rsquo;; readerOpts.creatorName = &lsquo;王宇&rsquo;; //Embed macro specific info readerOpts.extSrvIntegType = &lsquo;$extSrvIntegType&rsquo;; readerOpts.gClientId = &lsquo;$gClientId&rsquo;; readerOpts.oClientId = &lsquo;$oClientId&rsquo;; readerOpts.service = &lsquo;$service&rsquo;; readerOpts.sFileId = &lsquo;$sFileId&rsquo;; readerOpts.odriveId = &lsquo;$odriveId&rsquo;; readerOpts.diagramUrl = &lsquo;$diagramUrl&rsquo;; readerOpts.csvFileUrl = &lsquo;$csvFileUrl&rsquo;; readerOpts.pageId = &lsquo;$pageId&rsquo; || Confluence.getContentId(); readerOpts.aspectHash = &lsquo;$aspectHash&rsquo;; readerOpts.useExternalImageService = &lsquo;$useExternalImageService&rsquo; == &rsquo;true&rsquo;; readerOpts.isTemplate = &lsquo;$isTemplate&rsquo; == &rsquo;true&rsquo;; if (readerOpts.width == &lsquo;&rsquo;) { readerOpts.width = null; } // LATER: Check if delayed loading of resources can be used for image placeholder mode var viewerPromise = createViewer(graphContainer, readerOpts); if(readerOpts.editable) { $(graphContainer).data(&lsquo;viewerConfig&rsquo;, readerOpts); $(graphContainer).on(&lsquo;drawioViewerUpdate&rsquo;, updateDrawioViewer); } viewerPromise.done(function(viewer) { updateCachedDiagram(graphContainer, readerOpts, viewer); }); })(); //]]&gt;</p>
<h2 id="55-通信机制communication-mechanism">5.5. 通信机制 Communication mechanism<a hidden class="anchor" aria-hidden="true" href="#55-通信机制communication-mechanism">#</a></h2>
<h3 id="551-语音模块voiceservic通信voice-module-voiceservic-communication">5.5.1. 语音模块voiceservic通信 Voice module voiceservic communication<a hidden class="anchor" aria-hidden="true" href="#551-语音模块voiceservic通信voice-module-voiceservic-communication">#</a></h3>
<p> 语音模块voiceservice是一个单独的程序集，嵌入到虚拟人app中。语音模块会初始化讯飞sdk并启动录音，识别用户的声音，当用户唤醒或识别的时候，会把相关结果回调到调用方应用。<br>
The voice module voiceservice is a separate assembly that is embedded into the virtual human app. The voice module will initialize the iFlytek SDK and start recording, and recognize the user&rsquo;s voice. When the user wakes up or recognizes it, the relevant results will be called back to the calling application.</p>
<h3 id="552-虚拟人app和外部app通信方式communication-method-between-virtual-person-app-and-external-app">5.5.2. 虚拟人APP和外部APP通信方式  Communication method between virtual person APP and external APP<a hidden class="anchor" aria-hidden="true" href="#552-虚拟人app和外部app通信方式communication-method-between-virtual-person-app-and-external-app">#</a></h3>
<p>主要业务场景 Main business scenes:：</p>
<p>虚拟人&ndash;&gt;万得厨</p>
<p>主要业务场景 Main business scenes:：</p>
<p>虚拟人&ndash;&gt;万得厨</p>
<p>万得厨→虚拟人</p>
<p>指令instruction：</p>
<ol>
<li>
<p>虚拟人APP通过通信发送给万得厨app，万得厨app接收到指令，执行指令逻辑。<br>
The virtual human app sends it to the Wonder Kitchen app via communication, and the Wonder Kitchen app receives the instructions and executes the instruction logic.</p>
</li>
<li>
<p>显示虚拟人  Display virtual people</p>
</li>
<li>
<p>动画（入场、退场等） Animation (admission, exit, etc.)</p>
</li>
<li>
<p>tts语音播报 TTS voice broadcast</p>
</li>
</ol>
<p>万得厨APP通过通信发送给虚拟人APP具体操作，虚拟人APP接收到操作，执行操作逻辑。</p>
<p>Wonder Kitchen APP sends specific operations to the virtual human APP through communication. The virtual human APP receives the operations and executes the operation logic.</p>
<h2 id="56-时序图sequence-diagram">5.6. 时序图  Sequence diagram<a hidden class="anchor" aria-hidden="true" href="#56-时序图sequence-diagram">#</a></h2>
<p>以开始烹饪为例：<br>
Take for example starting cooking</p>
<p>虚拟人appVirtual human app执行指令例如开始烹饪</p>
<p>显示虚拟人<br>
display virtual<br>
 person</p>
<p>加热服务Heating service</p>
<p>用户 User</p>
<p>asr语音转文字asr speech to text</p>
<p>结果返回<br>
Result returned</p>
<p>万得厨appWonder Kitchen app</p>
<p>跳转页面<br>
Jump page</p>
<p>虚拟人云服务Virtual person cloud servicenlp</p>
<p>显示虚拟人<br>
display virtual<br>
 person</p>
<p>烹饪结束<br>
cooking finished</p>
<p>开始烹饪<br>
Start cooking</p>
<p>通知显示虚拟人<br>
Notifications show virtual person</p>
<p><img loading="lazy" src="data:image/svg&#43;xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0Ij48cGF0aCBkPSJNMjEuOTkgNGMwLTEuMS0uODktMi0xLjk5LTJINGMtMS4xIDAtMiAuOS0yIDJ2MTJjMCAxLjEuOSAyIDIgMmgxNGw0IDQtLjAxLTE4ek0xOCAxNEg2di0yaDEydjJ6bTAtM0g2VjloMTJ2MnptMC0zSDZWNmgxMnYyeiIvPjxwYXRoIGQ9Ik0wIDBoMjR2MjRIMHoiIGZpbGw9Im5vbmUiLz48L3N2Zz4=" alt=""  title="显示评论"  />
</p>
<p>//&lt;![CDATA[ (function() { $ = AJS.$; var graphContainer = document.getElementById(&lsquo;drawio-macro-content-a38223e4-4426-4ba6-99ac-8175f8eab0de&rsquo;); DrawioProperties = { contextPath : AJS.contextPath(), buildNumber : 8401 }; var readerOpts = {}; readerOpts.loadUrl = &rsquo;&rsquo; + &lsquo;/rest/drawio/1.0/diagram/crud/%54%69%6D%69%6E%67%20%64%69%61%67%72%61%6D/123651584?revision=1&rsquo;; readerOpts.imageUrl = &rsquo;&rsquo; + &lsquo;/download/attachments/123651584/Timing diagram.png&rsquo; + &lsquo;?version=1&amp;api=v2&rsquo;; readerOpts.editUrl = &rsquo;&rsquo; + &lsquo;/plugins/drawio/addDiagram.action?ceoId=123651584&amp;owningPageId=123651584&amp;diagramName=%54%69%6D%69%6E%67%20%64%69%61%67%72%61%6D&amp;revision=1&rsquo;; readerOpts.editable = true; readerOpts.canComment = true; readerOpts.stylePath = STYLE_PATH; readerOpts.stencilPath = STENCIL_PATH; readerOpts.imagePath = IMAGE_PATH + &lsquo;/reader&rsquo;; readerOpts.border = true; readerOpts.width = &lsquo;1000&rsquo;; readerOpts.simpleViewer = false; readerOpts.tbstyle = &rsquo;top&rsquo;; readerOpts.links = &lsquo;auto&rsquo;; readerOpts.lightbox = true; readerOpts.resourcePath = ATLAS_RESOURCE_BASE + &lsquo;/resources/viewer&rsquo;; readerOpts.disableButtons = false; readerOpts.zoomToFit = true; readerOpts.language = &lsquo;zh&rsquo;; readerOpts.licenseStatus = &lsquo;OK&rsquo;; readerOpts.contextPath = AJS.contextPath(); readerOpts.diagramName = decodeURIComponent(&rsquo;%54%69%6D%69%6E%67%20%64%69%61%67%72%61%6D&rsquo;); readerOpts.diagramDisplayName = &lsquo;&rsquo;; readerOpts.aspect = &lsquo;&rsquo;; readerOpts.ceoName = &lsquo;12、虚拟人模块对接HM团队 The virtual human module connects with the HM team&rsquo;; readerOpts.attVer = &lsquo;1&rsquo;; readerOpts.attId = &lsquo;123651797&rsquo;; readerOpts.lastModifierName = &lsquo;王宇&rsquo;; readerOpts.lastModified = &lsquo;2024-05-06 19:28:24.107&rsquo;; readerOpts.creatorName = &lsquo;王宇&rsquo;; //Embed macro specific info readerOpts.extSrvIntegType = &lsquo;$extSrvIntegType&rsquo;; readerOpts.gClientId = &lsquo;$gClientId&rsquo;; readerOpts.oClientId = &lsquo;$oClientId&rsquo;; readerOpts.service = &lsquo;$service&rsquo;; readerOpts.sFileId = &lsquo;$sFileId&rsquo;; readerOpts.odriveId = &lsquo;$odriveId&rsquo;; readerOpts.diagramUrl = &lsquo;$diagramUrl&rsquo;; readerOpts.csvFileUrl = &lsquo;$csvFileUrl&rsquo;; readerOpts.pageId = &lsquo;$pageId&rsquo; || Confluence.getContentId(); readerOpts.aspectHash = &lsquo;$aspectHash&rsquo;; readerOpts.useExternalImageService = &lsquo;$useExternalImageService&rsquo; == &rsquo;true&rsquo;; readerOpts.isTemplate = &lsquo;$isTemplate&rsquo; == &rsquo;true&rsquo;; if (readerOpts.width == &lsquo;&rsquo;) { readerOpts.width = null; } // LATER: Check if delayed loading of resources can be used for image placeholder mode var viewerPromise = createViewer(graphContainer, readerOpts); if(readerOpts.editable) { $(graphContainer).data(&lsquo;viewerConfig&rsquo;, readerOpts); $(graphContainer).on(&lsquo;drawioViewerUpdate&rsquo;, updateDrawioViewer); } viewerPromise.done(function(viewer) { updateCachedDiagram(graphContainer, readerOpts, viewer); }); })(); //]]&gt;</p>
<p><a href="/">Filter table data</a><a href="/">Create a pivot table</a><a href="/">Create a chart from data series</a></p>
<p><a href="/users/tfac-settings.action">Configure buttons visibility</a></p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/tags/%E4%BA%94%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1/">五、系统架构设计</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="http://localhost:1313/posts/wiki/1.3%E5%B8%82%E9%9D%A2%E4%B8%8A%E5%B7%B2%E6%9C%89%E7%9A%84%E8%99%9A%E6%8B%9F%E4%BA%BA%E5%88%86%E6%9E%90%E4%B9%8B~roki/">
    <span class="title">« 上一页</span>
    <br>
    <span>1.3、市面上已有的虚拟人分析之~ROKI</span>
  </a>
  <a class="next" href="http://localhost:1313/posts/wiki/2024%E5%B9%B4/">
    <span class="title">下一页 »</span>
    <br>
    <span>2024年</span>
  </a>
</nav>


<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 12、虚拟人模块对接HM团队ThevirtualhumanmoduleconnectswiththeHMteam on x"
            href="https://x.com/intent/tweet/?text=12%e3%80%81%e8%99%9a%e6%8b%9f%e4%ba%ba%e6%a8%a1%e5%9d%97%e5%af%b9%e6%8e%a5HM%e5%9b%a2%e9%98%9fThevirtualhumanmoduleconnectswiththeHMteam&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fwiki%2f12%25E8%2599%259A%25E6%258B%259F%25E4%25BA%25BA%25E6%25A8%25A1%25E5%259D%2597%25E5%25AF%25B9%25E6%258E%25A5hm%25E5%259B%25A2%25E9%2598%259Fthevirtualhumanmoduleconnectswiththehmteam%2f&amp;hashtags=%e4%ba%94%e3%80%81%e7%b3%bb%e7%bb%9f%e6%9e%b6%e6%9e%84%e8%ae%be%e8%ae%a1">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 12、虚拟人模块对接HM团队ThevirtualhumanmoduleconnectswiththeHMteam on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fwiki%2f12%25E8%2599%259A%25E6%258B%259F%25E4%25BA%25BA%25E6%25A8%25A1%25E5%259D%2597%25E5%25AF%25B9%25E6%258E%25A5hm%25E5%259B%25A2%25E9%2598%259Fthevirtualhumanmoduleconnectswiththehmteam%2f&amp;title=12%e3%80%81%e8%99%9a%e6%8b%9f%e4%ba%ba%e6%a8%a1%e5%9d%97%e5%af%b9%e6%8e%a5HM%e5%9b%a2%e9%98%9fThevirtualhumanmoduleconnectswiththeHMteam&amp;summary=12%e3%80%81%e8%99%9a%e6%8b%9f%e4%ba%ba%e6%a8%a1%e5%9d%97%e5%af%b9%e6%8e%a5HM%e5%9b%a2%e9%98%9fThevirtualhumanmoduleconnectswiththeHMteam&amp;source=http%3a%2f%2flocalhost%3a1313%2fposts%2fwiki%2f12%25E8%2599%259A%25E6%258B%259F%25E4%25BA%25BA%25E6%25A8%25A1%25E5%259D%2597%25E5%25AF%25B9%25E6%258E%25A5hm%25E5%259B%25A2%25E9%2598%259Fthevirtualhumanmoduleconnectswiththehmteam%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 12、虚拟人模块对接HM团队ThevirtualhumanmoduleconnectswiththeHMteam on reddit"
            href="https://reddit.com/submit?url=http%3a%2f%2flocalhost%3a1313%2fposts%2fwiki%2f12%25E8%2599%259A%25E6%258B%259F%25E4%25BA%25BA%25E6%25A8%25A1%25E5%259D%2597%25E5%25AF%25B9%25E6%258E%25A5hm%25E5%259B%25A2%25E9%2598%259Fthevirtualhumanmoduleconnectswiththehmteam%2f&title=12%e3%80%81%e8%99%9a%e6%8b%9f%e4%ba%ba%e6%a8%a1%e5%9d%97%e5%af%b9%e6%8e%a5HM%e5%9b%a2%e9%98%9fThevirtualhumanmoduleconnectswiththeHMteam">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 12、虚拟人模块对接HM团队ThevirtualhumanmoduleconnectswiththeHMteam on facebook"
            href="https://facebook.com/sharer/sharer.php?u=http%3a%2f%2flocalhost%3a1313%2fposts%2fwiki%2f12%25E8%2599%259A%25E6%258B%259F%25E4%25BA%25BA%25E6%25A8%25A1%25E5%259D%2597%25E5%25AF%25B9%25E6%258E%25A5hm%25E5%259B%25A2%25E9%2598%259Fthevirtualhumanmoduleconnectswiththehmteam%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 12、虚拟人模块对接HM团队ThevirtualhumanmoduleconnectswiththeHMteam on whatsapp"
            href="https://api.whatsapp.com/send?text=12%e3%80%81%e8%99%9a%e6%8b%9f%e4%ba%ba%e6%a8%a1%e5%9d%97%e5%af%b9%e6%8e%a5HM%e5%9b%a2%e9%98%9fThevirtualhumanmoduleconnectswiththeHMteam%20-%20http%3a%2f%2flocalhost%3a1313%2fposts%2fwiki%2f12%25E8%2599%259A%25E6%258B%259F%25E4%25BA%25BA%25E6%25A8%25A1%25E5%259D%2597%25E5%25AF%25B9%25E6%258E%25A5hm%25E5%259B%25A2%25E9%2598%259Fthevirtualhumanmoduleconnectswiththehmteam%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 12、虚拟人模块对接HM团队ThevirtualhumanmoduleconnectswiththeHMteam on telegram"
            href="https://telegram.me/share/url?text=12%e3%80%81%e8%99%9a%e6%8b%9f%e4%ba%ba%e6%a8%a1%e5%9d%97%e5%af%b9%e6%8e%a5HM%e5%9b%a2%e9%98%9fThevirtualhumanmoduleconnectswiththeHMteam&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fwiki%2f12%25E8%2599%259A%25E6%258B%259F%25E4%25BA%25BA%25E6%25A8%25A1%25E5%259D%2597%25E5%25AF%25B9%25E6%258E%25A5hm%25E5%259B%25A2%25E9%2598%259Fthevirtualhumanmoduleconnectswiththehmteam%2f">
            <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
                <path
                    d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 12、虚拟人模块对接HM团队ThevirtualhumanmoduleconnectswiththeHMteam on ycombinator"
            href="https://news.ycombinator.com/submitlink?t=12%e3%80%81%e8%99%9a%e6%8b%9f%e4%ba%ba%e6%a8%a1%e5%9d%97%e5%af%b9%e6%8e%a5HM%e5%9b%a2%e9%98%9fThevirtualhumanmoduleconnectswiththeHMteam&u=http%3a%2f%2flocalhost%3a1313%2fposts%2fwiki%2f12%25E8%2599%259A%25E6%258B%259F%25E4%25BA%25BA%25E6%25A8%25A1%25E5%259D%2597%25E5%25AF%25B9%25E6%258E%25A5hm%25E5%259B%25A2%25E9%2598%259Fthevirtualhumanmoduleconnectswiththehmteam%2f">
            <svg version="1.1" xml:space="preserve" width="30px" height="30px" viewBox="0 0 512 512" fill="currentColor"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape">
                <path
                    d="M449.446 0C483.971 0 512 28.03 512 62.554L512 449.446C512 483.97 483.97 512 449.446 512L62.554 512C28.03 512 0 483.97 0 449.446L0 62.554C0 28.03 28.029 0 62.554 0L449.446 0ZM183.8767 87.9921H121.8427L230.6673 292.4508V424.0079H281.3328V292.4508L390.1575 87.9921H328.1233L256 238.2489z" />
            </svg>
        </a>
    </li>
</ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span><a href="https://beian.miit.gov.cn/">粤ICP备2023039897号-1</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = '复制';

        function copyingDone() {
            copybutton.innerHTML = '已复制！';
            setTimeout(() => {
                copybutton.innerHTML = '复制';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
