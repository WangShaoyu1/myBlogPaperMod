<!DOCTYPE html>
<html lang="zh" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>ğŸš€ğŸš€ğŸš€NestJSå…¥é—¨ç§˜ç±ğŸ”¥ğŸ”¥ğŸ”¥ | PaperMod</title>
<meta name="keywords" content="å‰ç«¯, JavaScript, NestJS">
<meta name="description" content="Nest(NestJS)æ˜¯ä¸€ä¸ªç”¨äºæ„å»ºé«˜æ•ˆã€å¯æ‰©å±•çš„Node.jsæœåŠ¡å™¨ç«¯åº”ç”¨çš„æ¡†æ¶ã€‚å®ƒä½¿ç”¨æ¸è¿›å¼JavaScriptï¼Œæ„å»ºå¹¶å®Œå…¨æ”¯æŒTypeScriptï¼ˆä½†ä»ç„¶å…è®¸å¼€å‘è€…ä½¿ç”¨çº¯J">
<meta name="author" content="æ©™æŸäºº">
<link rel="canonical" href="http://localhost:1313/posts/juejin/nestjs%E5%85%A5%E9%97%A8%E7%A7%98%E7%B1%8D/">
<meta name="google-site-verification" content="XYZabc">
<link crossorigin="anonymous" href="/assets/css/stylesheet.7b92bf4867c997b58ec50f63451b83777173d5bd5593376852abd85746d09d71.css" integrity="sha256-e5K/SGfJl7WOxQ9jRRuDd3Fz1b1VkzdoUqvYV0bQnXE=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/%3Clink%20/%20abs%20url%3E">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/%3Clink%20/%20abs%20url%3E">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/%3Clink%20/%20abs%20url%3E">
<link rel="apple-touch-icon" href="http://localhost:1313/%3Clink%20/%20abs%20url%3E">
<link rel="mask-icon" href="http://localhost:1313/%3Clink%20/%20abs%20url%3E">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="zh" href="http://localhost:1313/posts/juejin/nestjs%E5%85%A5%E9%97%A8%E7%A7%98%E7%B1%8D/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript><meta property="og:title" content="ğŸš€ğŸš€ğŸš€NestJSå…¥é—¨ç§˜ç±ğŸ”¥ğŸ”¥ğŸ”¥" />
<meta property="og:description" content="Nest(NestJS)æ˜¯ä¸€ä¸ªç”¨äºæ„å»ºé«˜æ•ˆã€å¯æ‰©å±•çš„Node.jsæœåŠ¡å™¨ç«¯åº”ç”¨çš„æ¡†æ¶ã€‚å®ƒä½¿ç”¨æ¸è¿›å¼JavaScriptï¼Œæ„å»ºå¹¶å®Œå…¨æ”¯æŒTypeScriptï¼ˆä½†ä»ç„¶å…è®¸å¼€å‘è€…ä½¿ç”¨çº¯J" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://localhost:1313/posts/juejin/nestjs%E5%85%A5%E9%97%A8%E7%A7%98%E7%B1%8D/" />
<meta property="og:image" content="http://localhost:1313/images/papermod-cover.png" />
<meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-07-16T00:00:00+00:00" />
<meta property="article:modified_time" content="2024-07-16T00:00:00+00:00" />


<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="http://localhost:1313/images/papermod-cover.png" />
<meta name="twitter:title" content="ğŸš€ğŸš€ğŸš€NestJSå…¥é—¨ç§˜ç±ğŸ”¥ğŸ”¥ğŸ”¥"/>
<meta name="twitter:description" content="Nest(NestJS)æ˜¯ä¸€ä¸ªç”¨äºæ„å»ºé«˜æ•ˆã€å¯æ‰©å±•çš„Node.jsæœåŠ¡å™¨ç«¯åº”ç”¨çš„æ¡†æ¶ã€‚å®ƒä½¿ç”¨æ¸è¿›å¼JavaScriptï¼Œæ„å»ºå¹¶å®Œå…¨æ”¯æŒTypeScriptï¼ˆä½†ä»ç„¶å…è®¸å¼€å‘è€…ä½¿ç”¨çº¯J"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "http://localhost:1313/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "ğŸš€ğŸš€ğŸš€NestJSå…¥é—¨ç§˜ç±ğŸ”¥ğŸ”¥ğŸ”¥",
      "item": "http://localhost:1313/posts/juejin/nestjs%E5%85%A5%E9%97%A8%E7%A7%98%E7%B1%8D/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "ğŸš€ğŸš€ğŸš€NestJSå…¥é—¨ç§˜ç±ğŸ”¥ğŸ”¥ğŸ”¥",
  "name": "ğŸš€ğŸš€ğŸš€NestJSå…¥é—¨ç§˜ç±ğŸ”¥ğŸ”¥ğŸ”¥",
  "description": "Nest(NestJS)æ˜¯ä¸€ä¸ªç”¨äºæ„å»ºé«˜æ•ˆã€å¯æ‰©å±•çš„Node.jsæœåŠ¡å™¨ç«¯åº”ç”¨çš„æ¡†æ¶ã€‚å®ƒä½¿ç”¨æ¸è¿›å¼JavaScriptï¼Œæ„å»ºå¹¶å®Œå…¨æ”¯æŒTypeScriptï¼ˆä½†ä»ç„¶å…è®¸å¼€å‘è€…ä½¿ç”¨çº¯J",
  "keywords": [
    "å‰ç«¯", "JavaScript", "NestJS"
  ],
  "articleBody": "å‰ç½®æ¡ä»¶ ä¿è¯ä½ çš„ NodeJS ç‰ˆæœ¬æ˜¯ \u003e= 16 ç‰ˆæœ¬çš„â—\nä¿è¯ä½ çš„ NodeJS ç‰ˆæœ¬æ˜¯ \u003e= 16 ç‰ˆæœ¬çš„â—\nä¿è¯ä½ çš„ NodeJS ç‰ˆæœ¬æ˜¯ \u003e= 16 ç‰ˆæœ¬çš„â—\né‡è¦çš„äº‹æƒ…è¯´ä¸‰éã€‚\nç®¡ç† NodeJS ç‰ˆæœ¬ï¼š\nwindowå»ºè®®ä½¿ç”¨ nvm ç®¡ç†ï¼šä¼ é€é—¨ã€‚\nmacå»ºè®®ä½¿ç”¨ n ç®¡ç†ï¼šnpm install n -gã€‚\nç®€ä»‹ ä¸€ä¸ªç”¨äºæ„å»ºé«˜æ•ˆã€å¯æ‰©å±•çš„Â NodeJsÂ æœåŠ¡å™¨ç«¯åº”ç”¨çš„æ¡†æ¶ã€‚\nå®Œå…¨ä½¿ç”¨ TS è¿›è¡Œå¼€å‘ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨çº¯ JS ç¼–ç ï¼Œä½†æœ€å¥½ä¸è¦å‘—ï¼Œåˆä¸æ˜¯å†™ä¸èµ· TS ï¼Œæ˜¯å§æ˜¯å§ã€‚ğŸ˜\nåœ¨ Node çš„åŸºç¡€ä¸Šï¼Œ Nest åˆä½¿ç”¨äº† Express(é»˜è®¤)/Fastify æ¡†æ¶ï¼Œç­‰äºå®ƒä»¬ä¹‹é—´çš„å…³ç³»ï¼š\nNestJS\nExpress/Fastify\nNodeJS\nExpress æ¡†æ¶ç›¸ä¿¡å‰ç«¯çš„å°ä¼™ä¼´åº”è¯¥æˆ–å¤šæˆ–å°‘æœ‰æ‰€äº†è§£ï¼Œå¦‚æœä½ æƒ³æ„å»ºçš„æœåŠ¡ç«¯å¹¶ä¸æ˜¯å¾ˆå¤æ‚ï¼Œå°å‹çš„ï¼Œå¹¶ä¸”ä½ è¿˜æ˜¯ä¸€åå‰ç«¯äººå‘˜ï¼Œé‚£æˆ‘ç›´æ¥æ¨èä½ å»ä½¿ç”¨ Express æˆ– Koa2 å°±è¡Œå•¦ğŸ˜‚ï¼ŒNestJS è¿™ç©æ„çœŸæœ‰ç‚¹å¤æ‚ã€‚\næœ¬æ¬¡ï¼Œå’±ä»¬çš„ç›®æ ‡å°±æ˜¯ç›´æ¥èƒ½ä½¿ç”¨èµ·æ¥ï¼Œä¸å»ç»†è‡´æ¢ç©¶é‚£äº›æ¦‚å¿µçš„ä¸œä¸œäº†ï¼Œå¤ªéš¾æ‡‚äº†ğŸ˜”ï¼Œåƒä»€ä¹ˆIOC-æ§åˆ¶åè½¬ã€DI-ä¾èµ–æ³¨å…¥ã€DTO-éªŒè¯ã€Pipe-ç®¡é“ç­‰ç­‰ï¼Œè¿˜æ˜¯ç­‰åˆ°ä½¿ç”¨èµ·æ¥äº†ï¼Œé‡åˆ°ä¸æ‡‚çš„å†å»æŸ¥æ–‡æ¡£å§ã€‚\nå®‰è£…ä¸ä½¿ç”¨ å…¨å±€å®‰è£… NestJS è„šæ‰‹æ¶ï¼š\njavascript\nä»£ç è§£è¯»\nå¤åˆ¶ä»£ç \nnpm i -g @nestjs/cli\nï¼ˆæœ€å¥½è¿™ä¸ªå…¨å±€è„šæ‰‹æ¶è¿˜æ˜¯å¾—è£…èµ·æ¥ï¼Œå®ƒå°±åƒ Vue çš„ vue-cli ä¸€æ ·ã€‚ï¼‰\nåˆ›å»ºé¡¹ç›®ï¼š\njavascript\nä»£ç è§£è¯»\nå¤åˆ¶ä»£ç \nnest new ä½ çš„é¡¹ç›®åç§°\nå¯åŠ¨é¡¹ç›®ï¼š\njavascript\nä»£ç è§£è¯»\nå¤åˆ¶ä»£ç \nnpm run start:dev\nä¸€èˆ¬å°ç¼–ä¼šè‡ªå·±å†é…ä¸€ä¸ªç›¸åŒçš„ dev å‘½ä»¤ï¼š\njson\nä»£ç è§£è¯»\nå¤åˆ¶ä»£ç \n{ \"script\": { \"dev\": \"nest start --watch\", } }\nç›´æ¥ä½¿ç”¨ npm run dev å°±å¯ä»¥äº†ã€‚ğŸ˜‹\né»˜è®¤å¯åŠ¨çš„ç«¯å£æ˜¯ 3000 ï¼Œå¦‚æœå·²ç»è¢«å ç”¨ï¼Œå¯ä»¥åœ¨ main.ts æ–‡ä»¶ä¸­æ”¹ä¸€ä¸‹ï¼ˆå°ç¼–æ”¹æˆäº† 3001ï¼‰ï¼Œç„¶åç›´æ¥åœ¨æµè§ˆå™¨ä¸Šè®¿é—® http://localhost:3001/ ç§ç§ã€‚\nç›®å½•ç»“æ„ ç›®å½•ç»“æ„å¾ˆç®€æ´ï¼Œç°åœ¨åªæœ‰ä¸€ä¸ªæ ¹æ¨¡å—ï¼ˆAppï¼‰ï¼Œåç»­ä¼šåˆ›å»ºå‡ºå¾ˆå¤šå„ç§æ¨¡å— User/Order/... ç­‰ç­‰ï¼ŒNestJS å¯ä»¥è¯´æ˜¯é€šè¿‡\"æ¨¡å—\"æ¥ç®¡ç†æ•´ä¸ªåº”ç”¨çš„ã€‚\næ–‡ä»¶å\næè¿°\nmain.ts\nå…¥å£æ–‡ä»¶ï¼Œåç»­å…¨å±€æ€§çš„é…ç½®ä¼šåœ¨è¿™é‡Œé…ç½®ã€‚\napp.controller.ts\nå®šä¹‰æ¥å£çš„åœ°æ–¹ï¼Œå‰ç«¯è¯·æ±‚è¿‡æ¥ï¼Œæœ€å…ˆåˆ°è¾¾è¿™é‡Œã€‚\napp.module.ts\nåº”ç”¨çš„æ ¹æ¨¡å—ï¼Œåç»­ä¼šåˆ›å»ºå¾ˆå¤šæ¨¡å—ï¼Œéƒ½è¦åœ¨æ­¤è¿›è¡Œç®¡ç†\napp.service.ts\nç®¡ç†æ•°æ®åº“çš„ CRUD æ“ä½œ\napp.controller.spec.ts\nå•å…ƒæµ‹è¯•ï¼Œä¸ç”¨ç®¡å®ƒã€‚\nç¬¬ä¸€ä¸ªæ¥å£ å’±ä»¬æ¥åˆ° app.controller.ts æ–‡ä»¶ï¼š\nå¯ä»¥çœ‹åˆ°ï¼ŒNest å·²ç»å¸®æˆ‘ä»¬åˆå§‹äº†ä¸€ä¸ªæ¥å£ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬è®¿é—® http://localhost:3001/ çœ‹åˆ°çš„å†…å®¹ã€‚\nå’±ä»¬ä¹Ÿå¯ä»¥æ‰‹åŠ¨å®šä¹‰è‡ªå·±çš„ç¬¬ä¸€ä¸ªæ¥å£ï¼Œå¦‚ï¼š\njavascript\nä»£ç è§£è¯»\nå¤åˆ¶ä»£ç \n@Get('/test') getTest(): object { return { message: 'è¿™æ˜¯æˆ‘çš„ç¬¬ä¸€ä¸ªæ¥å£' }; }\nç›´æ¥è®¿é—® http://localhost:3001/test ã€‚ğŸš€\ngetTest åç§°å¯ä»¥éšä¾¿å–ï¼Œå¹¶æ²¡æœ‰å®é™…æ„ä¹‰ï¼Œçœ‹ä½ å¿ƒæƒ…ã€‚\næ˜¯ä¸æ˜¯è¿˜æŒºç®€å•ğŸ˜‡ï¼Œå¦‚æœä½ è¦å®šä¹‰Postç±»å‹çš„æ¥å£ï¼Œå¯ä»¥æ”¹æˆè¿™æ ·ï¼š\njavascript\nä»£ç è§£è¯»\nå¤åˆ¶ä»£ç \nimport { Controller, Get, Post } from '@nestjs/common'; @Post('/test') getTest(): object { return { message: 'è¿™æ˜¯æˆ‘çš„ç¬¬ä¸€ä¸ªæ¥å£' }; }\nç®€ç›´so easyï¼\nå…¶ä»–ç±»å‹çš„æ¥å£ï¼Œç…§è‘«èŠ¦ç”»ç“¢ã€‚âœ\nç¬¬ä¸€ä¸ªæ¨¡å— æ¥å£çš„å®šä¹‰å’±ä»¬ä¼šäº†ï¼Œä½†æˆ‘ä»¬æ€»ä¸èƒ½æŠŠæ‰€æœ‰æ¥å£éƒ½å®šä¹‰åœ¨ app.controller.ts æ–‡ä»¶ä¸­å§ï¼Œé‚£æ ·å¤ªå¤æ‚äº†ï¼Œä¸å¥½ç»´æŠ¤ï¼Œè¿™ä¸ªæ—¶å€™å°±è¦\"æ¨¡å—\"ä¸Šåœºäº†ã€‚\nå’±ä»¬ç›´æ¥æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š\njavascript\nä»£ç è§£è¯»\nå¤åˆ¶ä»£ç \nnest g res modules/user\nï¼ˆå°ç¼–ä¼šæŠŠæ‰€æœ‰æ¨¡å—éƒ½æ”¾åˆ° modules æ–‡ä»¶ä¸‹ï¼Œä¸ªäººå–œæ¬¢ï¼‰\nè®©ä½ é€‰æ‹©ï¼Œç›´æ¥ä¸¤ä¸ªå›è½¦ï¼Œå•¥ä¹Ÿä¸è¦ç®¡ã€‚ğŸ‘½\nç„¶åä½ å°±ä¼šæ”¶è·ä¸€ä¸ªå®Œæ•´çš„ User æ¨¡å—ã€‚\nè¿™é‡Œå°±ä¸å»ä¸€ä¸€è§£é‡Šæ¯ä¸ªæ–‡ä»¶çš„ä½œç”¨äº†ï¼Œåæ­£æ¯æ¬¡åˆ›å»ºä¸€ä¸ªæ–°æ¨¡å—ï¼Œä½ å°±ç›´æ¥æ€¼ä¸Šè¿™æ¡å‘½ä»¤å°±è¡Œã€‚\nå‰æœŸå’±ä»¬è¦çš„å°±æ˜¯çœäº‹ã€ç»Ÿä¸€ï¼Œç‰¹æ®Šçš„æƒ…å†µå†ç‰¹æ®Šå¤„ç†ï¼Œæ—¥å¸¸ä¸šåŠ¡æ˜¯è¶³å¤Ÿç”¨äº†ï¼Œåæ­£å‘¢ï¼Œå†™å¤šäº†ã€ç†Ÿäº†ä½ ä¹Ÿå°±èƒ½æ‡‚äº†ã€‚ğŸ‘»\næ¨¡å—çš„å…¶ä»–ç›¸å…³çŸ¥è¯†ï¼šä¼ é€é—¨\nUser æ¨¡å—åˆ›å»ºå®Œåï¼Œå’±ä»¬å¯ä»¥ç›´æ¥å®šä¹‰ä¸ User æ¨¡å—ç›¸å…³çš„æ¥å£äº†ï¼Œä»€ä¹ˆéƒ½ä¸ç”¨ç®¡ï¼Œç›´æ¥æ¥åˆ° user.controller.ts æ–‡ä»¶ï¼š\né»˜è®¤ä¼šå¸®æˆ‘ä»¬åˆå§‹åŒ–ä¸€ç³»åˆ—çš„æ¥å£ï¼Œä½†ä¸€èˆ¬ç”¨ä¸ä¸Šï¼Œå…¨åˆ äº†å¾—äº†ğŸ˜‚ï¼Œå’±ä»¬éœ€è¦å¢åŠ è‡ªå·±æƒ³è¦çš„æ¥å£ï¼Œæ¯”å¦‚ç™»å½•æ¥å£ã€è·å–ç”¨æˆ·ä¿¡æ¯æ¥å£ç­‰ç­‰ã€‚\nå¢åŠ åï¼Œç›´æ¥å°±èƒ½è®¿é—® http://localhost:3001/user/getUserInfo è¿›è¡Œä½¿ç”¨ï¼Œçœå¿ƒçœåŠ›ã€‚ğŸ˜Œ\nå¸¸ç”¨å‘½ä»¤ æ—¢ç„¶ nest g res modules/user å‘½ä»¤èƒ½åˆ›å»ºæ¨¡å—ï¼Œé‚£è‚¯å®šè¿˜æœ‰å…¶ä»–å‘½ä»¤å§ï¼Ÿ\nå½“ç„¶ï¼Œä½ å¯ä»¥é€šè¿‡ nest --help æŸ¥çœ‹ Nest æ‰€æœ‰ç›¸å…³å‘½ä»¤ã€‚\nå¯ä»¥çœ‹åˆ°ä¸Šé¢å‘½ä»¤ä¸­ res æ˜¯ç®€å†™ï¼Œå…¨ç§°æ˜¯ resourceï¼Œè¯¥å‘½ä»¤èƒ½å¸®æˆ‘ä»¬ç”Ÿæˆä¸€ä¸ªå®Œæ•´çš„æ¨¡å—ã€‚\nå¦‚ä¸æƒ³è¦å®Œæ•´çš„æ¨¡å—ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡å‘½ä»¤æ‰‹åŠ¨ä¸€ä¸ªæ–‡ä»¶ä¸€ä¸ªæ–‡ä»¶åˆ›å»ºï¼Œå¦‚åˆ›å»º user.controller.ts æ–‡ä»¶ï¼š\nbash\nä»£ç è§£è¯»\nå¤åˆ¶ä»£ç \nnest g co modules/user\nåˆ›å»º user.module.ts æ–‡ä»¶ï¼š\nbash\nä»£ç è§£è¯»\nå¤åˆ¶ä»£ç \nnest g mo modules/user\nåˆ›å»º user.service.ts æ–‡ä»¶ï¼š\nbash\nä»£ç è§£è¯»\nå¤åˆ¶ä»£ç \nnest g s modules/user\næ›´å¤šçš„å°±è‡ªå·±çœ‹çœ‹å›–ã€‚ğŸ¤ \né…ç½®é¡¹ç›®åˆ«å@ å› ä¸º Nest é¡¹ç›®æ˜¯ä½¿ç”¨ TS æ¥ç¼–å†™ï¼Œæ‰€ä»¥å’±ä»¬ç›´æ¥åœ¨å…¶ tsconfig.json é…ç½®æ–‡ä»¶ä¸€ä¸‹å°±å¯ä»¥äº†ï¼Œå¦‚ä¸‹ï¼š\njson\nä»£ç è§£è¯»\nå¤åˆ¶ä»£ç \n{ \"compilerOptions\": { // ... \"paths\": { \"@/*\": [\"src/*\"] } } }\né…ç½®ç¯å¢ƒå˜é‡ Nest å®˜æ–¹æä¾›çš„é…ç½®ç¯å¢ƒå˜é‡çš„æ–¹å¼ï¼šä¼ é€é—¨ã€‚\nä½†æ˜¯â€¦è¯»èµ·æ¥ç¨å¾®æœ‰ç‚¹å¤æ‚ğŸ˜µã€‚\næ¥ä¸‹æ¥ï¼Œä½ å¯ä»¥ç›´æ¥è·Ÿç€å°ç¼–æ“ä½œå°±å¯ä»¥äº†ï¼Œå¦‚æœè¿˜ä¸èƒ½æ»¡è¶³ä½ çš„éœ€æ±‚ï¼Œä½ å¯ä»¥å†å»ç…ç…å®˜ç½‘çš„å…¶ä»–å½¢å¼ã€‚\nå®‰è£…ä¾èµ–ï¼š\njavascript\nä»£ç è§£è¯»\nå¤åˆ¶ä»£ç \nnpm install @nestjs/config cross-env -D\nåˆ›å»º utils/env.ts æ–‡ä»¶ï¼š\njavascript\nä»£ç è§£è¯»\nå¤åˆ¶ä»£ç \nexport const DEV = process.env.NODE_ENV === 'development'; export const PROD = process.env.NODE_ENV === 'production'; const envFilePath = ['.env']; if (DEV) { envFilePath.unshift('.env.dev'); } else { envFilePath.unshift('.env.prod'); } export default { envFilePath, DEV, PROD };\nåœ¨ app.module.ts æ–‡ä»¶ä¸­é…ç½®ï¼š\njavascript\nä»£ç è§£è¯»\nå¤åˆ¶ä»£ç \n// ... import { ConfigModule } from '@nestjs/config'; import env from '@/utils/env'; @Module({ imports: [ // é…ç½®ç¯å¢ƒå˜é‡ ConfigModule.forRoot({ isGlobal: true, envFilePath: env.envFilePath, }), UserModule, ], controllers: [AppController], providers: [AppService], }) export class AppModule {}\nä¿®æ”¹ package.json æ–‡ä»¶å‘½ä»¤ï¼š\njavascript\nä»£ç è§£è¯»\nå¤åˆ¶ä»£ç \n{ \"scripts\": { \"dev\": \"cross-env NODE_ENV=development nest start --watch\", \"build\": \"cross-env NODE_ENV=production nest build\", ... } }\næœ€åï¼Œå†åˆ›å»ºä¸‰ä¸ªé…ç½®æ–‡ä»¶ã€‚\n.env æ–‡ä»¶ï¼š\njavascript\nä»£ç è§£è¯»\nå¤åˆ¶ä»£ç \n// å¯ä»¥æ”¾ä¸€äº›å…¬å…±çš„é…ç½®ï¼Œå¦‚å¯†é’¥ç­‰\n.env.dev æ–‡ä»¶ï¼š\njavascript\nä»£ç è§£è¯»\nå¤åˆ¶ä»£ç \n// å¯ä»¥æ”¾ç½®å¼€å‘ç¯å¢ƒç‰¹æœ‰çš„é…ç½® NAME=å¼€å‘ç¯å¢ƒ\n.env.prod æ–‡ä»¶ï¼š\njavascript\nä»£ç è§£è¯»\nå¤åˆ¶ä»£ç \n// å¯ä»¥æ”¾ç½®ç”Ÿäº§ç¯å¢ƒç‰¹æœ‰çš„é…ç½® NAME=ç”Ÿäº§ç¯å¢ƒ\nä½¿ç”¨å°±å’Œæˆ‘ä»¬å‰ç«¯é¡¹ç›®ä¸­ä½¿ç”¨ process.env ä¸€è‡´ï¼š\njavascript\nä»£ç è§£è¯»\nå¤åˆ¶ä»£ç \nconsole.log('ç¯å¢ƒå˜é‡', process.env.NODE_ENV); console.log('ç¯å¢ƒå˜é‡', process.env.NAME);\né…ç½®session Nest ä¸­çš„ session æ–¹æ¡ˆå¯ä»¥ä½¿ç”¨ express-session æˆ– @fastify/secure-session ï¼Œçœ‹ä½ è‡ªå·±çš„ Nest é¡¹ç›®ä½¿ç”¨çš„æ˜¯é‚£ä¸ªæ¡†æ¶ã€‚\nä¸‹é¢ä»¥ express-session ä¸ºä¾‹è¯´æ˜ã€‚\nå®‰è£…ä¾èµ–ï¼š\njavascript\nä»£ç è§£è¯»\nå¤åˆ¶ä»£ç \nnpm install express-session -S\nåœ¨ main.ts æ–‡ä»¶ä¸­è¿›è¡Œå…¨å±€é…ç½®ï¼š\njavascript\nä»£ç è§£è¯»\nå¤åˆ¶ä»£ç \n// ... import * as session from 'express-session'; import { PROD } from '@/utils/env'; async function bootstrap() { const app = await NestFactory.create(AppModule); // session app.use( session({ name: 'connect.sid', // è®¾ç½®cookieä¸­å­˜å‚¨sessionIdçš„keyï¼Œé»˜è®¤ä¸ºconnect.sidï¼Œåœ¨æµè§ˆå™¨æ§åˆ¶å°çš„ Application-Cookies-Name èƒ½çœ‹åˆ°è¿™ä¸ªåç§° secret: 'å¯†é’¥', // å¿…å¡«ï¼Œæœ€å¥½å­˜åœ¨æ¯”è¾ƒå®‰å…¨çš„åœ°æ–¹ï¼Œæ¯”å¦‚ç¯å¢ƒå˜é‡ resave: false, // æ˜¯å¦å¼ºåˆ¶ä¿å­˜ä¼šè¯ï¼Œå³ä½¿æœªè¢«ä¿®æ”¹ä¹Ÿè¦ä¿å­˜ã€‚é»˜è®¤ä¸ºtrue cookie: { maxAge: 10000, // Cookieçš„è¿‡æœŸæ—¶é—´(æ¯«ç§’) httpOnly: true, // æ˜¯å¦åªä»¥http(s)çš„å½¢å¼å‘é€cookieï¼Œå¯¹å®¢æˆ·ç«¯jsä¸å¯ç”¨ï¼ˆé»˜è®¤ä¸ºtrueï¼Œä¹Ÿå°±æ˜¯å®¢æˆ·ç«¯ä¸èƒ½ä»¥document.cookieæŸ¥çœ‹cookieï¼‰ secure: PROD, // ä»…åœ¨ç”Ÿäº§ç¯å¢ƒä¸‹å¼€å¯ï¼Œå¢åŠ å®‰å…¨æ€§ } }), ); await app.listen(3001); } bootstrap();\nå…·ä½“ä½¿ç”¨ï¼š\njavascript\nä»£ç è§£è¯»\nå¤åˆ¶ä»£ç \n@Get('/test') getHello(@Req() req): string { if (req.session.count) { req.session.count++; } else { req.session.count = 1; } console.log('req.session.count', req.session.count); return req.session.count; }\nç”±äºå’±ä»¬ç»å¸¸ä¼šæŒä¹…åŒ– session ï¼Œæ‰€ä»¥ä¸€èˆ¬ä¼šå°†å®ƒå­˜åœ¨æ•°æ®åº“æˆ–è€… Redis ä¸Šï¼Œè¿™å…¶å®ä¹Ÿèƒ½å¾ˆç®€å•å°±é…ç½®å®Œæˆã€‚\nä»¥ Redis ä¸ºä¾‹ã€‚\nå®‰è£…ä¾èµ–ï¼š\njavascript\nä»£ç è§£è¯»\nå¤åˆ¶ä»£ç \nnpm install connect-redis redis\nä¿®æ”¹é…ç½®ï¼š\njavascript\nä»£ç è§£è¯»\nå¤åˆ¶ä»£ç \n// ... import * as redis from 'redis'; import * as connectRedis from 'connect-redis'; async function bootstrap() { const app = await NestFactory.create(AppModule); // session const RedisStore = connectRedis(session); const redisClient = redis.createClient(); app.use( session({ store: new RedisStore({ client: redisClient }), // ... }), ); await app.listen(3001); } bootstrap();\nå…¨å±€å“åº”æ ¼å¼æ‹¦æˆªå™¨ é€šå¸¸æƒ…å†µä¸‹ï¼Œåç«¯æ¥å£ä¼šè¿”å›å…·æœ‰ç»Ÿä¸€æ ¼å¼çš„å“åº”æ•°æ®ã€‚è¿™ç§åšæ³•ä¸ä»…ä¾¿äºå‰ç«¯å¼€å‘äººå‘˜è¿›è¡Œæ“ä½œï¼Œè¿˜èƒ½å¤Ÿä¿æŒæ¥å£è¿”å›æ•°æ®çš„è§„èŒƒæ€§å’Œä¸€è‡´æ€§ã€‚\nåœ¨ Nest ä¸­è¦åšåˆ°è¿™ä¸ªäº‹æƒ…ï¼Œå’±ä»¬æœ‰ä¸¤éƒ¨åˆ†å†…å®¹éœ€è¦å¤„ç†ï¼Œåˆ†åˆ«æ˜¯\"æ­£å¸¸\"ä¸\"å¼‚å¸¸\"æƒ…å†µä¸‹çš„å“åº”ã€‚ğŸ‘€\nå…ˆçœ‹ç§ç§æ­£å¸¸å“åº”ä¸‹çš„ï¼Œè¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ Nest çš„æ‹¦æˆªå™¨æ¥å¤„ç†ã€‚\nåˆ›å»º utils/response.ts æ–‡ä»¶ï¼š\njavascript\nä»£ç è§£è¯»\nå¤åˆ¶ä»£ç \nimport { Injectable, NestInterceptor, CallHandler } from '@nestjs/common'; import { Observable, map } from 'rxjs'; import { Reflector } from '@nestjs/core'; interface Data { data: T; } /** @name é€šè¿‡æ‹¦æˆªå™¨ç»Ÿä¸€å“åº”æ ¼å¼ **/ @Injectable() export class ResponseSuccess",
  "wordCount" : "2267",
  "inLanguage": "zh",
  "image": "http://localhost:1313/images/papermod-cover.png","datePublished": "2024-07-16T00:00:00Z",
  "dateModified": "2024-07-16T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "æ©™æŸäºº"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://localhost:1313/posts/juejin/nestjs%E5%85%A5%E9%97%A8%E7%A7%98%E7%B1%8D/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "PaperMod",
    "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:1313/%3Clink%20/%20abs%20url%3E"
    }
  }
}
</script>
</head>

<body class=" dark" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="Home (Alt + H)">
                        
                    <img src="http://localhost:1313/images/msg_hu15231257772499651944.png" alt="" aria-label="logo"
                        height="20">Home</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/archives" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://github.com/adityatelange/hugo-PaperMod/wiki/" title="WiKi">
                    <span>WiKi</span>&nbsp;
                    <svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round"
                        stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12">
                        <path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"></path>
                        <path d="M15 3h6v6"></path>
                        <path d="M10 14L21 3"></path>
                    </svg>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://localhost:1313/">ä¸»é¡µ</a>&nbsp;Â»&nbsp;<a href="http://localhost:1313/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      ğŸš€ğŸš€ğŸš€NestJSå…¥é—¨ç§˜ç±ğŸ”¥ğŸ”¥ğŸ”¥
    </h1>
    <div class="post-description">
      Nest(NestJS)æ˜¯ä¸€ä¸ªç”¨äºæ„å»ºé«˜æ•ˆã€å¯æ‰©å±•çš„Node.jsæœåŠ¡å™¨ç«¯åº”ç”¨çš„æ¡†æ¶ã€‚å®ƒä½¿ç”¨æ¸è¿›å¼JavaScriptï¼Œæ„å»ºå¹¶å®Œå…¨æ”¯æŒTypeScriptï¼ˆä½†ä»ç„¶å…è®¸å¼€å‘è€…ä½¿ç”¨çº¯J
    </div>
    <div class="post-meta"><span title='2024-07-16 00:00:00 +0000 UTC'>ä¸ƒæœˆ 16, 2024</span>&nbsp;Â·&nbsp;11 åˆ†é’Ÿ&nbsp;Â·&nbsp;æ©™æŸäºº&nbsp;|&nbsp;<a href="https://github.com/WangShaoyu1/myBlogPaperMod/tree/master/content/posts/jueJin/%f0%9f%9a%80%f0%9f%9a%80%f0%9f%9a%80NestJS%e5%85%a5%e9%97%a8%e7%a7%98%e7%b1%8d%f0%9f%94%a5%f0%9f%94%a5%f0%9f%94%a5.md" rel="noopener noreferrer" target="_blank">Suggest Changes</a>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">ç›®å½•</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#%e5%89%8d%e7%bd%ae%e6%9d%a1%e4%bb%b6" aria-label="å‰ç½®æ¡ä»¶">å‰ç½®æ¡ä»¶</a></li>
                <li>
                    <a href="#%e7%ae%80%e4%bb%8b" aria-label="ç®€ä»‹">ç®€ä»‹</a></li>
                <li>
                    <a href="#%e5%ae%89%e8%a3%85%e4%b8%8e%e4%bd%bf%e7%94%a8" aria-label="å®‰è£…ä¸ä½¿ç”¨">å®‰è£…ä¸ä½¿ç”¨</a></li>
                <li>
                    <a href="#%e7%9b%ae%e5%bd%95%e7%bb%93%e6%9e%84" aria-label="ç›®å½•ç»“æ„">ç›®å½•ç»“æ„</a></li>
                <li>
                    <a href="#%e7%ac%ac%e4%b8%80%e4%b8%aa%e6%8e%a5%e5%8f%a3" aria-label="ç¬¬ä¸€ä¸ªæ¥å£">ç¬¬ä¸€ä¸ªæ¥å£</a></li>
                <li>
                    <a href="#%e7%ac%ac%e4%b8%80%e4%b8%aa%e6%a8%a1%e5%9d%97" aria-label="ç¬¬ä¸€ä¸ªæ¨¡å—">ç¬¬ä¸€ä¸ªæ¨¡å—</a></li>
                <li>
                    <a href="#%e5%b8%b8%e7%94%a8%e5%91%bd%e4%bb%a4" aria-label="å¸¸ç”¨å‘½ä»¤">å¸¸ç”¨å‘½ä»¤</a></li>
                <li>
                    <a href="#%e9%85%8d%e7%bd%ae%e9%a1%b9%e7%9b%ae%e5%88%ab%e5%90%8d" aria-label="é…ç½®é¡¹ç›®åˆ«å@">é…ç½®é¡¹ç›®åˆ«å@</a></li>
                <li>
                    <a href="#%e9%85%8d%e7%bd%ae%e7%8e%af%e5%a2%83%e5%8f%98%e9%87%8f" aria-label="é…ç½®ç¯å¢ƒå˜é‡">é…ç½®ç¯å¢ƒå˜é‡</a></li>
                <li>
                    <a href="#%e9%85%8d%e7%bd%aesession" aria-label="é…ç½®session">é…ç½®session</a></li>
                <li>
                    <a href="#%e5%85%a8%e5%b1%80%e5%93%8d%e5%ba%94%e6%a0%bc%e5%bc%8f%e6%8b%a6%e6%88%aa%e5%99%a8" aria-label="å…¨å±€å“åº”æ ¼å¼æ‹¦æˆªå™¨">å…¨å±€å“åº”æ ¼å¼æ‹¦æˆªå™¨</a></li>
                <li>
                    <a href="#%e5%85%a8%e5%b1%80%e5%bc%82%e5%b8%b8%e8%bf%87%e6%bb%a4%e5%99%a8" aria-label="å…¨å±€å¼‚å¸¸è¿‡æ»¤å™¨">å…¨å±€å¼‚å¸¸è¿‡æ»¤å™¨</a></li>
                <li>
                    <a href="#%e5%85%83%e6%95%b0%e6%8d%ae" aria-label="å…ƒæ•°æ®">å…ƒæ•°æ®</a></li>
                <li>
                    <a href="#%e9%85%8d%e7%bd%aejwt%e7%ad%96%e7%95%a5" aria-label="é…ç½®JWTç­–ç•¥">é…ç½®JWTç­–ç•¥</a></li>
                <li>
                    <a href="#%e8%bf%9e%e6%8e%a5%e6%95%b0%e6%8d%ae%e5%ba%93" aria-label="è¿æ¥æ•°æ®åº“">è¿æ¥æ•°æ®åº“</a></li>
                <li>
                    <a href="#%e6%8e%a5%e5%8f%a3%e6%96%87%e6%a1%a3" aria-label="æ¥å£æ–‡æ¡£">æ¥å£æ–‡æ¡£</a></li>
                <li>
                    <a href="#%e9%85%8d%e7%bd%ae%e8%b7%a8%e5%9f%9f" aria-label="é…ç½®è·¨åŸŸ">é…ç½®è·¨åŸŸ</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h3 id="å‰ç½®æ¡ä»¶">å‰ç½®æ¡ä»¶<a hidden class="anchor" aria-hidden="true" href="#å‰ç½®æ¡ä»¶">#</a></h3>
<p>ä¿è¯ä½ çš„ <code>NodeJS</code> ç‰ˆæœ¬æ˜¯ &gt;= 16 ç‰ˆæœ¬çš„â—<br>
ä¿è¯ä½ çš„ <code>NodeJS</code> ç‰ˆæœ¬æ˜¯ &gt;= 16 ç‰ˆæœ¬çš„â—<br>
ä¿è¯ä½ çš„ <code>NodeJS</code> ç‰ˆæœ¬æ˜¯ &gt;= 16 ç‰ˆæœ¬çš„â—</p>
<p>é‡è¦çš„äº‹æƒ…è¯´ä¸‰éã€‚</p>
<p><strong>ç®¡ç† <code>NodeJS</code> ç‰ˆæœ¬ï¼š</strong></p>
<p>windowå»ºè®®ä½¿ç”¨ <code>nvm</code> ç®¡ç†ï¼š<a href="https://juejin.cn/post/7079246681639763982" title="https://juejin.cn/post/7079246681639763982">ä¼ é€é—¨</a>ã€‚</p>
<p>macå»ºè®®ä½¿ç”¨ <code>n</code> ç®¡ç†ï¼š<code>npm install n -g</code>ã€‚</p>
<h3 id="ç®€ä»‹">ç®€ä»‹<a hidden class="anchor" aria-hidden="true" href="#ç®€ä»‹">#</a></h3>
<p>ä¸€ä¸ªç”¨äºæ„å»ºé«˜æ•ˆã€å¯æ‰©å±•çš„Â <code>NodeJs</code>Â æœåŠ¡å™¨ç«¯åº”ç”¨çš„æ¡†æ¶ã€‚</p>
<p>å®Œå…¨ä½¿ç”¨ <code>TS</code> è¿›è¡Œå¼€å‘ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨çº¯ <code>JS</code> ç¼–ç ï¼Œä½†æœ€å¥½ä¸è¦å‘—ï¼Œåˆä¸æ˜¯å†™ä¸èµ· <code>TS</code> ï¼Œæ˜¯å§æ˜¯å§ã€‚ğŸ˜</p>
<p>åœ¨ <code>Node</code> çš„åŸºç¡€ä¸Šï¼Œ <code>Nest</code> åˆä½¿ç”¨äº† <code>Express(é»˜è®¤)/Fastify</code> æ¡†æ¶ï¼Œç­‰äºå®ƒä»¬ä¹‹é—´çš„å…³ç³»ï¼š</p>
<p>NestJS</p>
<p>Express/Fastify</p>
<p>NodeJS</p>
<p><code>Express</code> æ¡†æ¶ç›¸ä¿¡å‰ç«¯çš„å°ä¼™ä¼´åº”è¯¥æˆ–å¤šæˆ–å°‘æœ‰æ‰€äº†è§£ï¼Œå¦‚æœä½ æƒ³æ„å»ºçš„æœåŠ¡ç«¯å¹¶ä¸æ˜¯å¾ˆå¤æ‚ï¼Œå°å‹çš„ï¼Œå¹¶ä¸”ä½ è¿˜æ˜¯ä¸€åå‰ç«¯äººå‘˜ï¼Œé‚£æˆ‘ç›´æ¥æ¨èä½ å»ä½¿ç”¨ <code>Express</code> æˆ– <code>Koa2</code> å°±è¡Œå•¦ğŸ˜‚ï¼Œ<code>NestJS</code> è¿™ç©æ„çœŸæœ‰ç‚¹å¤æ‚ã€‚</p>
<blockquote>
<p>æœ¬æ¬¡ï¼Œå’±ä»¬çš„ç›®æ ‡å°±æ˜¯ç›´æ¥èƒ½ä½¿ç”¨èµ·æ¥ï¼Œä¸å»ç»†è‡´æ¢ç©¶é‚£äº›æ¦‚å¿µçš„ä¸œä¸œäº†ï¼Œå¤ªéš¾æ‡‚äº†ğŸ˜”ï¼Œåƒä»€ä¹ˆIOC-æ§åˆ¶åè½¬ã€DI-ä¾èµ–æ³¨å…¥ã€DTO-éªŒè¯ã€Pipe-ç®¡é“ç­‰ç­‰ï¼Œè¿˜æ˜¯ç­‰åˆ°ä½¿ç”¨èµ·æ¥äº†ï¼Œé‡åˆ°ä¸æ‡‚çš„å†å»æŸ¥<a href="https://link.juejin.cn?target=https%3A%2F%2Fnest.nodejs.cn%2F" title="https://nest.nodejs.cn/">æ–‡æ¡£</a>å§ã€‚</p>
</blockquote>
<h3 id="å®‰è£…ä¸ä½¿ç”¨">å®‰è£…ä¸ä½¿ç”¨<a hidden class="anchor" aria-hidden="true" href="#å®‰è£…ä¸ä½¿ç”¨">#</a></h3>
<p>å…¨å±€å®‰è£… <code>NestJS</code> è„šæ‰‹æ¶ï¼š</p>
<p>javascript</p>
<p>ä»£ç è§£è¯»</p>
<p>å¤åˆ¶ä»£ç </p>
<p><code>npm i -g @nestjs/cli</code></p>
<p>ï¼ˆæœ€å¥½è¿™ä¸ªå…¨å±€è„šæ‰‹æ¶è¿˜æ˜¯å¾—è£…èµ·æ¥ï¼Œå®ƒå°±åƒ <code>Vue</code> çš„ <code>vue-cli</code> ä¸€æ ·ã€‚ï¼‰</p>
<p>åˆ›å»ºé¡¹ç›®ï¼š</p>
<p>javascript</p>
<p>ä»£ç è§£è¯»</p>
<p>å¤åˆ¶ä»£ç </p>
<p><code>nest new ä½ çš„é¡¹ç›®åç§°</code></p>
<p>å¯åŠ¨é¡¹ç›®ï¼š</p>
<p>javascript</p>
<p>ä»£ç è§£è¯»</p>
<p>å¤åˆ¶ä»£ç </p>
<p><code>npm run start:dev</code></p>
<p>ä¸€èˆ¬å°ç¼–ä¼šè‡ªå·±å†é…ä¸€ä¸ªç›¸åŒçš„ <code>dev</code> å‘½ä»¤ï¼š</p>
<p>json</p>
<p>ä»£ç è§£è¯»</p>
<p>å¤åˆ¶ä»£ç </p>
<p><code>{   &quot;script&quot;: {     &quot;dev&quot;: &quot;nest start --watch&quot;,   } }</code></p>
<p>ç›´æ¥ä½¿ç”¨ <code>npm run dev</code> å°±å¯ä»¥äº†ã€‚ğŸ˜‹</p>
<p>é»˜è®¤å¯åŠ¨çš„ç«¯å£æ˜¯ <code>3000</code> ï¼Œå¦‚æœå·²ç»è¢«å ç”¨ï¼Œå¯ä»¥åœ¨ <code>main.ts</code> æ–‡ä»¶ä¸­æ”¹ä¸€ä¸‹ï¼ˆå°ç¼–æ”¹æˆäº† <code>3001</code>ï¼‰ï¼Œç„¶åç›´æ¥åœ¨æµè§ˆå™¨ä¸Šè®¿é—® <code>http://localhost:3001/</code> ç§ç§ã€‚</p>
<h3 id="ç›®å½•ç»“æ„">ç›®å½•ç»“æ„<a hidden class="anchor" aria-hidden="true" href="#ç›®å½•ç»“æ„">#</a></h3>
<p><img loading="lazy" src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e2bb3d8b497c4a578e41216a0a34a6b5~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=246&amp;h=525&amp;s=20212&amp;e=png&amp;b=22262c" alt="image.png"  />
</p>
<p>ç›®å½•ç»“æ„å¾ˆç®€æ´ï¼Œç°åœ¨åªæœ‰ä¸€ä¸ªæ ¹æ¨¡å—ï¼ˆ<code>App</code>ï¼‰ï¼Œåç»­ä¼šåˆ›å»ºå‡ºå¾ˆå¤šå„ç§æ¨¡å— <code>User/Order/...</code> ç­‰ç­‰ï¼Œ<code>NestJS</code> å¯ä»¥è¯´æ˜¯é€šè¿‡&quot;æ¨¡å—&quot;æ¥ç®¡ç†æ•´ä¸ªåº”ç”¨çš„ã€‚</p>
<p>æ–‡ä»¶å</p>
<p>æè¿°</p>
<p><code>main.ts</code></p>
<p>å…¥å£æ–‡ä»¶ï¼Œåç»­å…¨å±€æ€§çš„é…ç½®ä¼šåœ¨è¿™é‡Œé…ç½®ã€‚</p>
<p><code>app.controller.ts</code></p>
<p>å®šä¹‰æ¥å£çš„åœ°æ–¹ï¼Œå‰ç«¯è¯·æ±‚è¿‡æ¥ï¼Œæœ€å…ˆåˆ°è¾¾è¿™é‡Œã€‚</p>
<p><code>app.module.ts</code></p>
<p>åº”ç”¨çš„æ ¹æ¨¡å—ï¼Œåç»­ä¼šåˆ›å»ºå¾ˆå¤šæ¨¡å—ï¼Œéƒ½è¦åœ¨æ­¤è¿›è¡Œç®¡ç†</p>
<p><code>app.service.ts</code></p>
<p>ç®¡ç†æ•°æ®åº“çš„ <code>CRUD</code> æ“ä½œ</p>
<p><code>app.controller.spec.ts</code></p>
<p>å•å…ƒæµ‹è¯•ï¼Œä¸ç”¨ç®¡å®ƒã€‚</p>
<h3 id="ç¬¬ä¸€ä¸ªæ¥å£">ç¬¬ä¸€ä¸ªæ¥å£<a hidden class="anchor" aria-hidden="true" href="#ç¬¬ä¸€ä¸ªæ¥å£">#</a></h3>
<p>å’±ä»¬æ¥åˆ° <code>app.controller.ts</code> æ–‡ä»¶ï¼š</p>
<p><img loading="lazy" src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a897356410114b7a8a4888bb6a511358~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=642&amp;h=351&amp;s=26039&amp;e=png&amp;b=272b33" alt="image.png"  />
</p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œ<code>Nest</code> å·²ç»å¸®æˆ‘ä»¬åˆå§‹äº†ä¸€ä¸ªæ¥å£ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬è®¿é—® <code>http://localhost:3001/</code> çœ‹åˆ°çš„å†…å®¹ã€‚</p>
<p>å’±ä»¬ä¹Ÿå¯ä»¥æ‰‹åŠ¨å®šä¹‰è‡ªå·±çš„ç¬¬ä¸€ä¸ªæ¥å£ï¼Œå¦‚ï¼š</p>
<p>javascript</p>
<p>ä»£ç è§£è¯»</p>
<p>å¤åˆ¶ä»£ç </p>
<p><code>@Get('/test') getTest(): object {   return { message: 'è¿™æ˜¯æˆ‘çš„ç¬¬ä¸€ä¸ªæ¥å£' }; }</code></p>
<p>ç›´æ¥è®¿é—® <code>http://localhost:3001/test</code> ã€‚ğŸš€</p>
<p><code>getTest</code> åç§°å¯ä»¥éšä¾¿å–ï¼Œå¹¶æ²¡æœ‰å®é™…æ„ä¹‰ï¼Œçœ‹ä½ å¿ƒæƒ…ã€‚</p>
<p>æ˜¯ä¸æ˜¯è¿˜æŒºç®€å•ğŸ˜‡ï¼Œå¦‚æœä½ è¦å®šä¹‰Postç±»å‹çš„æ¥å£ï¼Œå¯ä»¥æ”¹æˆè¿™æ ·ï¼š</p>
<p>javascript</p>
<p>ä»£ç è§£è¯»</p>
<p>å¤åˆ¶ä»£ç </p>
<p><code>import { Controller, Get, Post } from '@nestjs/common'; @Post('/test') getTest(): object {   return { message: 'è¿™æ˜¯æˆ‘çš„ç¬¬ä¸€ä¸ªæ¥å£' }; }</code></p>
<p>ç®€ç›´so easyï¼</p>
<p>å…¶ä»–ç±»å‹çš„æ¥å£ï¼Œç…§è‘«èŠ¦ç”»ç“¢ã€‚âœ</p>
<h3 id="ç¬¬ä¸€ä¸ªæ¨¡å—">ç¬¬ä¸€ä¸ªæ¨¡å—<a hidden class="anchor" aria-hidden="true" href="#ç¬¬ä¸€ä¸ªæ¨¡å—">#</a></h3>
<p>æ¥å£çš„å®šä¹‰å’±ä»¬ä¼šäº†ï¼Œä½†æˆ‘ä»¬æ€»ä¸èƒ½æŠŠæ‰€æœ‰æ¥å£éƒ½å®šä¹‰åœ¨ <code>app.controller.ts</code> æ–‡ä»¶ä¸­å§ï¼Œé‚£æ ·å¤ªå¤æ‚äº†ï¼Œä¸å¥½ç»´æŠ¤ï¼Œè¿™ä¸ªæ—¶å€™å°±è¦&quot;æ¨¡å—&quot;ä¸Šåœºäº†ã€‚</p>
<p>å’±ä»¬ç›´æ¥æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p>
<p>javascript</p>
<p>ä»£ç è§£è¯»</p>
<p>å¤åˆ¶ä»£ç </p>
<p><code>nest g res modules/user</code></p>
<p>ï¼ˆå°ç¼–ä¼šæŠŠæ‰€æœ‰æ¨¡å—éƒ½æ”¾åˆ° <code>modules</code> æ–‡ä»¶ä¸‹ï¼Œä¸ªäººå–œæ¬¢ï¼‰</p>
<p>è®©ä½ é€‰æ‹©ï¼Œç›´æ¥ä¸¤ä¸ªå›è½¦ï¼Œå•¥ä¹Ÿä¸è¦ç®¡ã€‚ğŸ‘½</p>
<p><img loading="lazy" src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ac6854793be34216844e223bb4843dfd~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=737&amp;h=166&amp;s=16479&amp;e=png&amp;b=0d0d0d" alt="image.png"  />
 <img loading="lazy" src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/860a066faf4449249091d13432ff2d93~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=760&amp;h=75&amp;s=11029&amp;e=png&amp;b=0d0d0d" alt="image.png"  />
</p>
<p>ç„¶åä½ å°±ä¼šæ”¶è·ä¸€ä¸ª<strong>å®Œæ•´</strong>çš„ <code>User</code> æ¨¡å—ã€‚</p>
<p><img loading="lazy" src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2af6c57fb82e44b89351e7cb0e74cf2c~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=272&amp;h=411&amp;s=17770&amp;e=png&amp;b=22262c" alt="image.png"  />
</p>
<p>è¿™é‡Œå°±ä¸å»ä¸€ä¸€è§£é‡Šæ¯ä¸ªæ–‡ä»¶çš„ä½œç”¨äº†ï¼Œåæ­£æ¯æ¬¡åˆ›å»ºä¸€ä¸ªæ–°æ¨¡å—ï¼Œä½ å°±ç›´æ¥æ€¼ä¸Šè¿™æ¡å‘½ä»¤å°±è¡Œã€‚</p>
<blockquote>
<p>å‰æœŸå’±ä»¬è¦çš„å°±æ˜¯çœäº‹ã€ç»Ÿä¸€ï¼Œç‰¹æ®Šçš„æƒ…å†µå†ç‰¹æ®Šå¤„ç†ï¼Œæ—¥å¸¸ä¸šåŠ¡æ˜¯è¶³å¤Ÿç”¨äº†ï¼Œåæ­£å‘¢ï¼Œå†™å¤šäº†ã€ç†Ÿäº†ä½ ä¹Ÿå°±èƒ½æ‡‚äº†ã€‚ğŸ‘»</p>
</blockquote>
<p>æ¨¡å—çš„å…¶ä»–ç›¸å…³çŸ¥è¯†ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fnest.nodejs.cn%2Fmodules" title="https://nest.nodejs.cn/modules">ä¼ é€é—¨</a></p>
<p><code>User</code> æ¨¡å—åˆ›å»ºå®Œåï¼Œå’±ä»¬å¯ä»¥ç›´æ¥å®šä¹‰ä¸ <code>User</code> æ¨¡å—ç›¸å…³çš„æ¥å£äº†ï¼Œä»€ä¹ˆéƒ½ä¸ç”¨ç®¡ï¼Œç›´æ¥æ¥åˆ° <code>user.controller.ts</code> æ–‡ä»¶ï¼š</p>
<p><img loading="lazy" src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f8845be3abda434b850ef7306fbf182d~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=686&amp;h=817&amp;s=61291&amp;e=png&amp;b=282c34" alt="image.png"  />
</p>
<p>é»˜è®¤ä¼šå¸®æˆ‘ä»¬åˆå§‹åŒ–ä¸€ç³»åˆ—çš„æ¥å£ï¼Œä½†ä¸€èˆ¬ç”¨ä¸ä¸Šï¼Œå…¨åˆ äº†å¾—äº†ğŸ˜‚ï¼Œå’±ä»¬éœ€è¦å¢åŠ è‡ªå·±æƒ³è¦çš„æ¥å£ï¼Œæ¯”å¦‚ç™»å½•æ¥å£ã€è·å–ç”¨æˆ·ä¿¡æ¯æ¥å£ç­‰ç­‰ã€‚</p>
<p>å¢åŠ åï¼Œç›´æ¥å°±èƒ½è®¿é—® <code>http://localhost:3001/user/getUserInfo</code> è¿›è¡Œä½¿ç”¨ï¼Œçœå¿ƒçœåŠ›ã€‚ğŸ˜Œ</p>
<h3 id="å¸¸ç”¨å‘½ä»¤">å¸¸ç”¨å‘½ä»¤<a hidden class="anchor" aria-hidden="true" href="#å¸¸ç”¨å‘½ä»¤">#</a></h3>
<p>æ—¢ç„¶ <code>nest g res modules/user</code> å‘½ä»¤èƒ½åˆ›å»ºæ¨¡å—ï¼Œé‚£è‚¯å®šè¿˜æœ‰å…¶ä»–å‘½ä»¤å§ï¼Ÿ</p>
<p>å½“ç„¶ï¼Œä½ å¯ä»¥é€šè¿‡ <code>nest --help</code> æŸ¥çœ‹ <code>Nest</code> æ‰€æœ‰ç›¸å…³å‘½ä»¤ã€‚</p>
<p><img loading="lazy" src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0ffb5085bd54470ebfb32569e9ba2499~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=1247&amp;h=859&amp;s=113516&amp;e=png&amp;b=0d0d0d" alt="image.png"  />
</p>
<p>å¯ä»¥çœ‹åˆ°ä¸Šé¢å‘½ä»¤ä¸­ <code>res</code> æ˜¯ç®€å†™ï¼Œå…¨ç§°æ˜¯ <code>resource</code>ï¼Œè¯¥å‘½ä»¤èƒ½å¸®æˆ‘ä»¬ç”Ÿæˆä¸€ä¸ªå®Œæ•´çš„æ¨¡å—ã€‚</p>
<p>å¦‚ä¸æƒ³è¦å®Œæ•´çš„æ¨¡å—ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡å‘½ä»¤æ‰‹åŠ¨ä¸€ä¸ªæ–‡ä»¶ä¸€ä¸ªæ–‡ä»¶åˆ›å»ºï¼Œå¦‚åˆ›å»º <code>user.controller.ts</code> æ–‡ä»¶ï¼š</p>
<p>bash</p>
<p>ä»£ç è§£è¯»</p>
<p>å¤åˆ¶ä»£ç </p>
<p><code>nest g co modules/user</code></p>
<p>åˆ›å»º <code>user.module.ts</code> æ–‡ä»¶ï¼š</p>
<p>bash</p>
<p>ä»£ç è§£è¯»</p>
<p>å¤åˆ¶ä»£ç </p>
<p><code>nest g mo modules/user</code></p>
<p>åˆ›å»º <code>user.service.ts</code> æ–‡ä»¶ï¼š</p>
<p>bash</p>
<p>ä»£ç è§£è¯»</p>
<p>å¤åˆ¶ä»£ç </p>
<p><code>nest g s modules/user</code></p>
<p>æ›´å¤šçš„å°±è‡ªå·±çœ‹çœ‹å›–ã€‚ğŸ¤ </p>
<h3 id="é…ç½®é¡¹ç›®åˆ«å">é…ç½®é¡¹ç›®åˆ«å@<a hidden class="anchor" aria-hidden="true" href="#é…ç½®é¡¹ç›®åˆ«å">#</a></h3>
<p>å› ä¸º <code>Nest</code> é¡¹ç›®æ˜¯ä½¿ç”¨ <code>TS</code> æ¥ç¼–å†™ï¼Œæ‰€ä»¥å’±ä»¬ç›´æ¥åœ¨å…¶ <code>tsconfig.json</code> é…ç½®æ–‡ä»¶ä¸€ä¸‹å°±å¯ä»¥äº†ï¼Œå¦‚ä¸‹ï¼š</p>
<p>json</p>
<p>ä»£ç è§£è¯»</p>
<p>å¤åˆ¶ä»£ç </p>
<p><code>{    &quot;compilerOptions&quot;: {     // ...     &quot;paths&quot;: { &quot;@/*&quot;: [&quot;src/*&quot;] }   }  }</code></p>
<h3 id="é…ç½®ç¯å¢ƒå˜é‡">é…ç½®ç¯å¢ƒå˜é‡<a hidden class="anchor" aria-hidden="true" href="#é…ç½®ç¯å¢ƒå˜é‡">#</a></h3>
<p><code>Nest</code> å®˜æ–¹æä¾›çš„é…ç½®ç¯å¢ƒå˜é‡çš„æ–¹å¼ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fnest.nodejs.cn%2Ftechniques%2Fconfiguration%23%25E9%2585%258D%25E7%25BD%25AE" title="https://nest.nodejs.cn/techniques/configuration#%E9%85%8D%E7%BD%AE">ä¼ é€é—¨</a>ã€‚</p>
<p>ä½†æ˜¯&hellip;è¯»èµ·æ¥ç¨å¾®æœ‰ç‚¹å¤æ‚ğŸ˜µã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œä½ å¯ä»¥ç›´æ¥è·Ÿç€å°ç¼–æ“ä½œå°±å¯ä»¥äº†ï¼Œå¦‚æœè¿˜ä¸èƒ½æ»¡è¶³ä½ çš„éœ€æ±‚ï¼Œä½ å¯ä»¥å†å»ç…ç…å®˜ç½‘çš„å…¶ä»–å½¢å¼ã€‚</p>
<p>å®‰è£…ä¾èµ–ï¼š</p>
<p>javascript</p>
<p>ä»£ç è§£è¯»</p>
<p>å¤åˆ¶ä»£ç </p>
<p><code>npm install @nestjs/config cross-env -D</code></p>
<p>åˆ›å»º <code>utils/env.ts</code> æ–‡ä»¶ï¼š</p>
<p>javascript</p>
<p>ä»£ç è§£è¯»</p>
<p>å¤åˆ¶ä»£ç </p>
<p><code>export const DEV = process.env.NODE_ENV === 'development'; export const PROD = process.env.NODE_ENV === 'production'; const envFilePath = ['.env']; if (DEV) {   envFilePath.unshift('.env.dev'); } else {   envFilePath.unshift('.env.prod'); } export default { envFilePath, DEV, PROD };</code></p>
<p>åœ¨ <code>app.module.ts</code> æ–‡ä»¶ä¸­é…ç½®ï¼š</p>
<p>javascript</p>
<p>ä»£ç è§£è¯»</p>
<p>å¤åˆ¶ä»£ç </p>
<p><code>// ... import { ConfigModule } from '@nestjs/config'; import env from '@/utils/env'; @Module({   imports: [     // é…ç½®ç¯å¢ƒå˜é‡     ConfigModule.forRoot({       isGlobal: true,       envFilePath: env.envFilePath,     }),     UserModule,   ],   controllers: [AppController],   providers: [AppService], }) export class AppModule {}</code></p>
<p>ä¿®æ”¹ <code>package.json</code> æ–‡ä»¶å‘½ä»¤ï¼š</p>
<p>javascript</p>
<p>ä»£ç è§£è¯»</p>
<p>å¤åˆ¶ä»£ç </p>
<p><code>{   &quot;scripts&quot;: {     &quot;dev&quot;: &quot;cross-env NODE_ENV=development nest start --watch&quot;,     &quot;build&quot;: &quot;cross-env NODE_ENV=production nest build&quot;,     ...   } }</code></p>
<p>æœ€åï¼Œå†åˆ›å»ºä¸‰ä¸ªé…ç½®æ–‡ä»¶ã€‚</p>
<p><code>.env</code> æ–‡ä»¶ï¼š</p>
<p>javascript</p>
<p>ä»£ç è§£è¯»</p>
<p>å¤åˆ¶ä»£ç </p>
<p><code>// å¯ä»¥æ”¾ä¸€äº›å…¬å…±çš„é…ç½®ï¼Œå¦‚å¯†é’¥ç­‰</code></p>
<p><code>.env.dev</code> æ–‡ä»¶ï¼š</p>
<p>javascript</p>
<p>ä»£ç è§£è¯»</p>
<p>å¤åˆ¶ä»£ç </p>
<p><code>// å¯ä»¥æ”¾ç½®å¼€å‘ç¯å¢ƒç‰¹æœ‰çš„é…ç½® NAME=å¼€å‘ç¯å¢ƒ</code></p>
<p><code>.env.prod</code> æ–‡ä»¶ï¼š</p>
<p>javascript</p>
<p>ä»£ç è§£è¯»</p>
<p>å¤åˆ¶ä»£ç </p>
<p><code>// å¯ä»¥æ”¾ç½®ç”Ÿäº§ç¯å¢ƒç‰¹æœ‰çš„é…ç½® NAME=ç”Ÿäº§ç¯å¢ƒ</code></p>
<p>ä½¿ç”¨å°±å’Œæˆ‘ä»¬å‰ç«¯é¡¹ç›®ä¸­ä½¿ç”¨ <code>process.env</code> ä¸€è‡´ï¼š</p>
<p>javascript</p>
<p>ä»£ç è§£è¯»</p>
<p>å¤åˆ¶ä»£ç </p>
<p><code>console.log('ç¯å¢ƒå˜é‡', process.env.NODE_ENV); console.log('ç¯å¢ƒå˜é‡', process.env.NAME);</code></p>
<h3 id="é…ç½®session">é…ç½®session<a hidden class="anchor" aria-hidden="true" href="#é…ç½®session">#</a></h3>
<p><code>Nest</code> ä¸­çš„ <code>session</code> æ–¹æ¡ˆå¯ä»¥ä½¿ç”¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2Fexpress-session" title="https://www.npmjs.com/package/express-session">express-session</a> æˆ– <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2F%40fastify%2Fsecure-session" title="https://www.npmjs.com/package/@fastify/secure-session">@fastify/secure-session</a> ï¼Œçœ‹ä½ è‡ªå·±çš„ <code>Nest</code> é¡¹ç›®ä½¿ç”¨çš„æ˜¯é‚£ä¸ªæ¡†æ¶ã€‚</p>
<p>ä¸‹é¢ä»¥ <code>express-session</code> ä¸ºä¾‹è¯´æ˜ã€‚</p>
<p>å®‰è£…ä¾èµ–ï¼š</p>
<p>javascript</p>
<p>ä»£ç è§£è¯»</p>
<p>å¤åˆ¶ä»£ç </p>
<p><code>npm install express-session -S</code></p>
<p>åœ¨ <code>main.ts</code> æ–‡ä»¶ä¸­è¿›è¡Œå…¨å±€é…ç½®ï¼š</p>
<p>javascript</p>
<p>ä»£ç è§£è¯»</p>
<p>å¤åˆ¶ä»£ç </p>
<p><code>// ... import * as session from 'express-session'; import { PROD } from '@/utils/env'; async function bootstrap() {   const app = await NestFactory.create(AppModule);   // session   app.use(     session({       name: 'connect.sid', // è®¾ç½®cookieä¸­å­˜å‚¨sessionIdçš„keyï¼Œé»˜è®¤ä¸ºconnect.sidï¼Œåœ¨æµè§ˆå™¨æ§åˆ¶å°çš„ Application-Cookies-Name èƒ½çœ‹åˆ°è¿™ä¸ªåç§°       secret: 'å¯†é’¥', // å¿…å¡«ï¼Œæœ€å¥½å­˜åœ¨æ¯”è¾ƒå®‰å…¨çš„åœ°æ–¹ï¼Œæ¯”å¦‚ç¯å¢ƒå˜é‡       resave: false, // æ˜¯å¦å¼ºåˆ¶ä¿å­˜ä¼šè¯ï¼Œå³ä½¿æœªè¢«ä¿®æ”¹ä¹Ÿè¦ä¿å­˜ã€‚é»˜è®¤ä¸ºtrue       cookie: {         maxAge: 10000, // Cookieçš„è¿‡æœŸæ—¶é—´(æ¯«ç§’)          httpOnly: true, // æ˜¯å¦åªä»¥http(s)çš„å½¢å¼å‘é€cookieï¼Œå¯¹å®¢æˆ·ç«¯jsä¸å¯ç”¨ï¼ˆé»˜è®¤ä¸ºtrueï¼Œä¹Ÿå°±æ˜¯å®¢æˆ·ç«¯ä¸èƒ½ä»¥document.cookieæŸ¥çœ‹cookieï¼‰         secure: PROD, // ä»…åœ¨ç”Ÿäº§ç¯å¢ƒä¸‹å¼€å¯ï¼Œå¢åŠ å®‰å…¨æ€§       }     }),   );   await app.listen(3001); } bootstrap();</code></p>
<p>å…·ä½“ä½¿ç”¨ï¼š</p>
<p>javascript</p>
<p>ä»£ç è§£è¯»</p>
<p>å¤åˆ¶ä»£ç </p>
<p><code>@Get('/test') getHello(@Req() req): string {   if (req.session.count) {     req.session.count++;   } else {     req.session.count = 1;   }   console.log('req.session.count', req.session.count);   return req.session.count; }</code></p>
<p>ç”±äºå’±ä»¬ç»å¸¸ä¼šæŒä¹…åŒ– <code>session</code> ï¼Œæ‰€ä»¥ä¸€èˆ¬ä¼šå°†å®ƒå­˜åœ¨æ•°æ®åº“æˆ–è€… <code>Redis</code> ä¸Šï¼Œè¿™å…¶å®ä¹Ÿèƒ½å¾ˆç®€å•å°±é…ç½®å®Œæˆã€‚</p>
<p>ä»¥ <code>Redis</code> ä¸ºä¾‹ã€‚</p>
<p>å®‰è£…ä¾èµ–ï¼š</p>
<p>javascript</p>
<p>ä»£ç è§£è¯»</p>
<p>å¤åˆ¶ä»£ç </p>
<p><code>npm install connect-redis redis</code></p>
<p>ä¿®æ”¹é…ç½®ï¼š</p>
<p>javascript</p>
<p>ä»£ç è§£è¯»</p>
<p>å¤åˆ¶ä»£ç </p>
<p><code>// ... import * as redis from 'redis'; import * as connectRedis from 'connect-redis'; async function bootstrap() {   const app = await NestFactory.create(AppModule);   // session   const RedisStore = connectRedis(session);    const redisClient = redis.createClient();   app.use(     session({       store: new RedisStore({ client: redisClient }),       // ...     }),   );   await app.listen(3001); } bootstrap();</code></p>
<h3 id="å…¨å±€å“åº”æ ¼å¼æ‹¦æˆªå™¨">å…¨å±€å“åº”æ ¼å¼æ‹¦æˆªå™¨<a hidden class="anchor" aria-hidden="true" href="#å…¨å±€å“åº”æ ¼å¼æ‹¦æˆªå™¨">#</a></h3>
<p>é€šå¸¸æƒ…å†µä¸‹ï¼Œåç«¯æ¥å£ä¼šè¿”å›å…·æœ‰ç»Ÿä¸€æ ¼å¼çš„å“åº”æ•°æ®ã€‚è¿™ç§åšæ³•ä¸ä»…ä¾¿äºå‰ç«¯å¼€å‘äººå‘˜è¿›è¡Œæ“ä½œï¼Œè¿˜èƒ½å¤Ÿä¿æŒæ¥å£è¿”å›æ•°æ®çš„è§„èŒƒæ€§å’Œä¸€è‡´æ€§ã€‚</p>
<p>åœ¨ <code>Nest</code> ä¸­è¦åšåˆ°è¿™ä¸ªäº‹æƒ…ï¼Œå’±ä»¬æœ‰ä¸¤éƒ¨åˆ†å†…å®¹éœ€è¦å¤„ç†ï¼Œåˆ†åˆ«æ˜¯&quot;æ­£å¸¸&quot;ä¸&quot;å¼‚å¸¸&quot;æƒ…å†µä¸‹çš„å“åº”ã€‚ğŸ‘€</p>
<p>å…ˆçœ‹ç§ç§æ­£å¸¸å“åº”ä¸‹çš„ï¼Œè¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>Nest</code> çš„<a href="https://link.juejin.cn?target=https%3A%2F%2Fnest.nodejs.cn%2Finterceptors" title="https://nest.nodejs.cn/interceptors">æ‹¦æˆªå™¨</a>æ¥å¤„ç†ã€‚</p>
<p>åˆ›å»º <code>utils/response.ts</code> æ–‡ä»¶ï¼š</p>
<p>javascript</p>
<p>ä»£ç è§£è¯»</p>
<p>å¤åˆ¶ä»£ç </p>
<p><code>import { Injectable, NestInterceptor, CallHandler } from '@nestjs/common'; import { Observable, map } from 'rxjs'; import { Reflector } from '@nestjs/core'; interface Data&lt;T&gt; {   data: T; } /** @name é€šè¿‡æ‹¦æˆªå™¨ç»Ÿä¸€å“åº”æ ¼å¼ **/ @Injectable() export class ResponseSuccess&lt;T = any&gt; implements NestInterceptor {   constructor(private readonly reflector: Reflector) {}   intercept(context, next: CallHandler): Observable&lt;Data&lt;T&gt;&gt; {     return next.handle().pipe(       map((response) =&gt; {         // åœ¨å…·ä½“ä¸šåŠ¡ä¸­ä¹Ÿå¯ä»¥è‡ªè¡Œå®šåˆ¶code         if (response.code) {           const { code, data, message } = response;           return {             data,             code,             message,             success: true,           };         } else {           const { data, message } = response;           return {             data: message ? data : response,             code: 0,             message: message || 'success',             success: true,           };         }       }),     );   } }</code></p>
<p>åœ¨ <code>main.ts</code> æ–‡ä»¶ä¸­é…ç½®ä½¿ç”¨ï¼š</p>
<p>javascript</p>
<p>ä»£ç è§£è¯»</p>
<p>å¤åˆ¶ä»£ç </p>
<p><code>// ... import { ResponseSuccess } from './utils/response'; import { Reflector } from '@nestjs/core'; async function bootstrap() {   // ...   // å“åº”æ ¼å¼æ‹¦æˆªå™¨   app.useGlobalInterceptors(new ResponseSuccess(new Reflector()));   await app.listen(3001); } bootstrap();</code></p>
<p>å…·ä½“çš„ä½¿ç”¨è¿‡ç¨‹ï¼š</p>
<p>javascript</p>
<p>ä»£ç è§£è¯»</p>
<p>å¤åˆ¶ä»£ç </p>
<p><code>// modules/user/user.controller.ts import { Controller, Get, Post } from '@nestjs/common'; import { UserService } from './user.service'; @Controller('user') export class UserController {   constructor(private readonly userService: UserService) {}   @Post('add')   create() {     return 'æ·»åŠ æˆåŠŸ';   }   @Get('list')   findAll() {     return {       total: 0,       record: [],     };   } }</code></p>
<p>å’±ä»¬åœ¨ <code>modules/user/user.controller.ts</code> æ–‡ä»¶ä¸‹æ–°å®šä¹‰äº†ä¸¤ä¸ªæ¥å£ï¼Œåˆ†åˆ«æ˜¯ï¼š</p>
<ul>
<li>Postæ–¹å¼ï¼š<code>http://localhost:3001/user/add</code></li>
<li>Getæ–¹å¼ï¼š<code>http://localhost:3001/user/list</code></li>
</ul>
<p><img loading="lazy" src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a655e1ff5a674355a1e6e6198dba854f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qmZ5p-Q5Lq6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1727751225&amp;x-signature=%2Babbx3X86mCvHX%2F%2BWx5XSn7%2Fctc%3D" alt="image.png"  />
 <img loading="lazy" src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/58590431848e411e867d3e98af74965a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qmZ5p-Q5Lq6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1727751225&amp;x-signature=9FyxMiXawWC6YpGaTNmIFhL8Hfo%3D" alt="image.png"  />
</p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œå°ç¼–å°†æ¥å£çš„å“åº”æ ¼å¼ç»Ÿä¸€æˆè¿™ç§å½¢å¼ï¼š</p>
<p>json</p>
<p>ä»£ç è§£è¯»</p>
<p>å¤åˆ¶ä»£ç </p>
<p><code>{   code: number,   messsage: string,   success: boolean,   data: any, }</code></p>
<p>å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥æ ¹æ®ä½ çš„éœ€æ±‚è‡ªè¡Œè¿›è¡Œè°ƒæ•´ã€‚ğŸ˜‹</p>
<h3 id="å…¨å±€å¼‚å¸¸è¿‡æ»¤å™¨">å…¨å±€å¼‚å¸¸è¿‡æ»¤å™¨<a hidden class="anchor" aria-hidden="true" href="#å…¨å±€å¼‚å¸¸è¿‡æ»¤å™¨">#</a></h3>
<p><strong>å“åº”æ ¼å¼ç»Ÿä¸€</strong>ç°åœ¨è¿˜æ²¡åšå®Œï¼Œä¸Šé¢ä»…æ˜¯åšäº†æ­£å¸¸æƒ…å†µä¸‹çš„å“åº”å¤„ç†è€Œå·²ï¼Œå¯¹äºå¼‚å¸¸æƒ…å†µä¸‹çš„å“åº”ï¼Œæˆ‘ä»¬ä¹Ÿè¦æ¥å¤„ç†ä¸€ä¸‹ã€‚</p>
<p>å’±ä»¬å¯ä»¥å…ˆæ¥çœ‹çœ‹ä¸€äº›å¼‚å¸¸æƒ…å†µçš„å“åº”æ ¼å¼ï¼Œå¦‚ï¼š</p>
<ul>
<li>è®¿é—®çš„æ¥å£ä¸å­˜åœ¨</li>
</ul>
<p><img loading="lazy" src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/acd35695b58d4c20bdd575936d155286~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qmZ5p-Q5Lq6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1727751225&amp;x-signature=k4fkTBhfCbnQ49Qyzoq%2BL5bTYEI%3D" alt="image.png"  />
</p>
<ul>
<li>åœ¨å…·ä½“ä¸šåŠ¡ä¸­æŠ›å‡ºé”™è¯¯</li>
</ul>
<p>javascript</p>
<p>ä»£ç è§£è¯»</p>
<p>å¤åˆ¶ä»£ç </p>
<p><code>@Post('add') create() {   // æŠ›å‡ºé”™è¯¯   throw new Error('æ·»åŠ å¤±è´¥');   return 'æ·»åŠ æˆåŠŸ'; }</code></p>
<p><img loading="lazy" src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/832f2d9d4be9488faa09668d2a3d72c8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qmZ5p-Q5Lq6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1727751225&amp;x-signature=Fuo8WlvYoz3%2FkqNJaUdCz7kKb6s%3D" alt="image.png"  />
</p>
<p>å¯¹äºè¿™äº›å“åº”å½¢å¼ï¼Œå’±ä»¬ä¹Ÿåº”è¯¥å¸Œæœ›å®ƒèƒ½æœ‰ä¸€ä¸ªç»Ÿä¸€çš„å“åº”æ ¼å¼ç»™åˆ°å‰ç«¯ã€‚ğŸ˜®</p>
<p>åœ¨ <code>Nest</code> ä¸­æœ‰ä¸€ä¸ªå†…ç½®çš„å¼‚å¸¸å±‚ï¼Œå®ƒèƒ½å¸®æˆ‘ä»¬æ•è·åˆ°è¿™äº›å¼‚å¸¸ï¼Œæˆ‘ä»¬å¯ä»¥ä»è¿™ä¸ªæ–¹é¢å…¥æ‰‹ï¼Œå¯¹å…¶æ ¼å¼è¿›è¡Œç»Ÿä¸€ã€‚</p>
<p>å…³äºè¿™ä¸ªå¼‚å¸¸å±‚çš„è¯¦æƒ…ï¼Œå¯ä»¥è‡ªè¡Œç…ç…å“ˆï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fnest.nodejs.cn%2Fexception-filters" title="https://nest.nodejs.cn/exception-filters">ä¼ é€é—¨</a>ã€‚ğŸƒ</p>
<p>æ¥ä¸‹æ¥ï¼Œæ¥çœ‹çœ‹å…·ä½“å¦‚ä½•å¤„ç†å¼‚å¸¸æƒ…å†µä¸‹çš„å“åº”æ ¼å¼ï¼Œè¿˜æ˜¯åœ¨ <code>utils/response.ts</code> æ–‡ä»¶ï¼š</p>
<p>javascript</p>
<p>ä»£ç è§£è¯»</p>
<p>å¤åˆ¶ä»£ç </p>
<p><code>import {   Injectable,   NestInterceptor,   CallHandler,   Catch,   ExceptionFilter,   ArgumentsHost,   HttpException,   HttpStatus,   Logger, } from '@nestjs/common'; import { Observable, map } from 'rxjs'; import { Reflector } from '@nestjs/core'; import { Request, Response } from 'express'; /** @name é€šè¿‡å¼‚å¸¸è¿‡æ»¤å™¨ç»Ÿä¸€å¼‚å¸¸æ ¼å¼ **/ @Catch() export class ResponseFail implements ExceptionFilter {   catch(exception: HttpException, host: ArgumentsHost): void {     // åˆ›å»ºä¸€ä¸ªæ—¥å¿—     const logger = new Logger();     // åœ¨åå°è¾“å‡ºæ—¥å¿—     logger.error(exception);     const ctx = host.switchToHttp();     const request = ctx.getRequest&lt;Request&gt;();     const response = ctx.getResponse&lt;Response&gt;();     let status = HttpStatus.INTERNAL_SERVER_ERROR;     let message = 'Internal server error';     if (exception instanceof HttpException) {       // æ­£å¸¸æŠ›å‡ºé”™è¯¯       status = exception.getStatus();       if (exception.message) {         message = exception.message;       }     }     response.status(status).json({       status,       message,       success: false,       path: request.url,       timestamp: new Date().getTime(),     });   } }</code></p>
<p>åœ¨ <code>main.ts</code> æ–‡ä»¶ä¸­é…ç½®ä½¿ç”¨ï¼š</p>
<p>javascript</p>
<p>ä»£ç è§£è¯»</p>
<p>å¤åˆ¶ä»£ç </p>
<p><code>// ... import { ResponseSuccess, ResponseFail } from './utils/response'; import { Reflector } from '@nestjs/core'; async function bootstrap() {   // ...   // å¼‚å¸¸è¿‡æ»¤å™¨   app.useGlobalFilters(new ResponseFail());   await app.listen(3001); } bootstrap();</code></p>
<p>ç»Ÿä¸€å¼‚å¸¸å“åº”æ ¼å¼åçš„æ•ˆæœï¼š</p>
<p><img loading="lazy" src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9e7cabd81a6241ddb4e6d88b1076194b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qmZ5p-Q5Lq6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1727751225&amp;x-signature=7Tk4ZfzQtGYwgdFiIVEACOMaY6U%3D" alt="image.png"  />
<img loading="lazy" src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3d7666d6a70d40cbb95ee3319967eb8e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qmZ5p-Q5Lq6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1727751225&amp;x-signature=6BkDPX6rpnkAAWe81kktHiCwh%2B8%3D" alt="image.png"  />
</p>
<h3 id="å…ƒæ•°æ®">å…ƒæ•°æ®<a hidden class="anchor" aria-hidden="true" href="#å…ƒæ•°æ®">#</a></h3>
<p>åœ¨ <code>Nest</code> ä¸­ï¼Œ<a href="https://link.juejin.cn?target=https%3A%2F%2Fnest.nodejs.cn%2Ffundamentals%2Fexecution-context%23%25E5%258F%258D%25E5%25B0%2584%25E5%2592%258C%25E5%2585%2583%25E6%2595%25B0%25E6%258D%25AE" title="https://nest.nodejs.cn/fundamentals/execution-context#%E5%8F%8D%E5%B0%84%E5%92%8C%E5%85%83%E6%95%B0%E6%8D%AE">å…ƒæ•°æ®</a>ï¼ˆMetadataï¼‰æ˜¯ä¸€ä¸ªéå¸¸é‡è¦å¹¶åŸºç¡€çš„æ¦‚å¿µï¼Œå®ƒç”¨äºå­˜å‚¨å…³äºæ§åˆ¶å™¨ã€æ–¹æ³•ã€å‚æ•°ã€è£…é¥°å™¨ç­‰æ–¹é¢çš„ä¿¡æ¯ã€‚å…ƒæ•°æ®æ˜¯ä¸€ç§åœ¨è¿è¡Œæ—¶ç”¨äºå­˜å‚¨å’Œæ£€ç´¢é¢å¤–ä¿¡æ¯çš„æ•°æ®ç»“æ„ï¼Œå®ƒå¯ä»¥å¸®åŠ© <code>Nest</code> æ¡†æ¶æ‰§è¡Œå„ç§æ“ä½œï¼Œæ¯”å¦‚ä¾èµ–æ³¨å…¥ã€å‚æ•°è§£æã€ä¸­é—´ä»¶æ‰§è¡Œã€è·¯ç”±å¤„ç†ç­‰ã€‚</p>
<p>â“â“â“ ä¸€è„¸æ‡µã€‚ã€‚ã€‚ğŸ˜‡ è¿˜æ˜¯æ¥çœ‹çœ‹å…·ä½“çš„åº”ç”¨è¿‡ç¨‹å§ã€‚</p>
<p>åˆ›å»º <code>utils/metadata.ts</code> æ–‡ä»¶ï¼š</p>
<p>javascript</p>
<p>ä»£ç è§£è¯»</p>
<p>å¤åˆ¶ä»£ç </p>
<p><code>import { SetMetadata } from '@nestjs/common'; export const SKIP_RS_INTERCEPTOR = 'skip_response_success_interceptor'; /**  * @name è·³è¿‡å…¨å±€æˆåŠŸå“åº”æ ¼å¼æ‹¦æˆªå™¨  * @description é€šè¿‡Metadataæ·»åŠ è‡ªå®šä¹‰çš„å…ƒæ•°æ®ã€Reflectoræ£€ç´¢å’Œè§£æå…ƒæ•°æ®  */ export const SkipResponseSuccessInterceptor = () =&gt;   SetMetadata(SKIP_RS_INTERCEPTOR, true);</code></p>
<p>ï¼ˆå°ç¼–ä¸€èˆ¬ä¼šæŠŠæ‰€æœ‰çš„å…ƒæ•°æ®éƒ½æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œæ–¹ä¾¿æŸ¥æ‰¾ğŸ˜‚ï¼‰</p>
<p>åœ¨ <code>modules/user/user.controller.ts</code> æ–‡ä»¶ä¸­ä½¿ç”¨ï¼š</p>
<p>javascript</p>
<p>ä»£ç è§£è¯»</p>
<p>å¤åˆ¶ä»£ç </p>
<p><code>// ... import { SkipResponseSuccessInterceptor } from '@/utils/metadata'; @Controller('user') export class UserController {   constructor(private readonly userService: UserService) {}   /** @name éªŒè¯ç  **/   @Get('captcha')   // è·³è¿‡å“åº”æ ¼å¼åŒ–   @SkipResponseSuccessInterceptor()   captcha() {     return 'abcd';   } }</code></p>
<p>å’±ä»¬å¢åŠ äº†ä¸€ä¸ªGetæ–¹å¼çš„ <code>http://localhost:3001/user/captcha</code> éªŒè¯ç æ¥å£ï¼Œå¹¶ä¸”è¯¥æ¥å£å¤šäº†ä¸€ä¸ª <code>@SkipResponseSuccessInterceptor()</code> çš„<a href="https://link.juejin.cn?target=https%3A%2F%2Fnest.nodejs.cn%2Fcustom-decorators" title="https://nest.nodejs.cn/custom-decorators">è£…é¥°å™¨</a>ã€‚</p>
<p>å†æ¥åˆ° <code>utils/response.ts</code> æ–‡ä»¶ä¸­ï¼š</p>
<p>javascript</p>
<p>ä»£ç è§£è¯»</p>
<p>å¤åˆ¶ä»£ç </p>
<p><code>// ... /** @name é€šè¿‡æ‹¦æˆªå™¨ç»Ÿä¸€å“åº”æ ¼å¼ **/ @Injectable() export class ResponseSuccess&lt;T = any&gt; implements NestInterceptor {   intercept(context, next: CallHandler): Observable&lt;Data&lt;T&gt;&gt; {     // è·å–Metadataè‡ªå®šä¹‰å…ƒæ•°æ®     const skipInterceptor = this.reflector.get&lt;boolean&gt;(       SKIP_RS_INTERCEPTOR,       context.getHandler(),     );     console.log(context.args[0].url, 'skipInterceptorï¼š', skipInterceptor);          // ...   } } // ...</code></p>
<p>åˆ†åˆ«å»è®¿é—® <code>list</code> ä¸ <code>captcha</code> ä¸¤ä¸ªæ¥å£ï¼š</p>
<p><img loading="lazy" src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c965f9808a574eb6b0e1496823f47d79~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qmZ5p-Q5Lq6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1727751225&amp;x-signature=2HXDip5dp4rnVjG8%2BhQWcP6DBN4%3D" alt="image.png"  />
</p>
<p>å‘ƒ&hellip;.èƒ½æ„Ÿå—å‡ºå…ƒæ•°æ®çš„ä½œç”¨äº†å—ï¼ŸğŸ˜‹</p>
<p>æ²¡æœ‰â“</p>
<p>æ¥ï¼Œç»§ç»­æŠŠéªŒè¯ç æ¥å£å®Œå–„å¥½ï¼Œå…ˆè£…ä¸€ä¸‹ä¾èµ–ï¼š</p>
<p>javascript</p>
<p>ä»£ç è§£è¯»</p>
<p>å¤åˆ¶ä»£ç </p>
<p><code>npm install svg-captcha</code></p>
<p>æ¥å£ç”ŸæˆéªŒè¯ç ç»™åˆ°å‰ç«¯ï¼š</p>
<p>javascript</p>
<p>ä»£ç è§£è¯»</p>
<p>å¤åˆ¶ä»£ç </p>
<p><code>// modules/user/user.controller.ts // ... import * as svgCaptcha from 'svg-captcha'; @Controller('user') export class UserController {   constructor(private readonly userService: UserService) {}   /** @name éªŒè¯ç  **/   @Get('captcha')   // è·³è¿‡å“åº”æ ¼å¼åŒ–   @SkipResponseSuccessInterceptor()   captcha() {     const captcha = svgCaptcha.create({       size: 4,       fontSize: 60,       ignoreChars: '0o1i',       color: true,     });     // sessionä¸Šé¢å’±ä»¬å¯è®²è¿‡äº†å“¦ï¼Œåˆ«å¿˜äº†     req.session.captcha = captcha.text;     res.type('image/svg+xml');     res.send(captcha.data);   } }</code></p>
<p>å…ƒæ•°æ®å…·ä½“åº”ç”¨ï¼š</p>
<p>javascript</p>
<p>ä»£ç è§£è¯»</p>
<p>å¤åˆ¶ä»£ç </p>
<p><code>// utils/response.ts // ... /** @name é€šè¿‡æ‹¦æˆªå™¨ç»Ÿä¸€å“åº”æ ¼å¼ **/ @Injectable() export class ResponseSuccess&lt;T = any&gt; implements NestInterceptor {   intercept(context, next: CallHandler): Observable&lt;Data&lt;T&gt;&gt; {     // è·å–Metadataè‡ªå®šä¹‰å…ƒæ•°æ®     const skipInterceptor = this.reflector.get&lt;boolean&gt;(       SKIP_RS_INTERCEPTOR,       context.getHandler(),     );     if (skipInterceptor) {       // ç‰¹æ®Šçš„è¯·æ±‚ç›´æ¥è·³è¿‡æ‹¦æˆªå™¨       return next.handle();     }     // ...   } } // ...</code></p>
<p>è®¿é—® <code>http://localhost:3001/user/captcha</code> éªŒè¯ç æ¥å£ï¼Œä¼šå¾—ä¸€ä¸ªå›¾ç‰‡æ•°æ®ï¼Œå°±ä¸ä¼šæ˜¯æˆ‘ä»¬æ¥å£å“åº”çš„ç»Ÿä¸€æ ¼å¼çš„æ•°æ®äº†ã€‚</p>
<p><img loading="lazy" src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bd216afac4a94945bc53dadbf0436e73~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qmZ5p-Q5Lq6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1727751225&amp;x-signature=hAvO1ld8PMeFZ1pg2AVhBd%2FbdFM%3D" alt="image.png"  />
</p>
<p>å…ƒæ•°æ®åœ¨æ•´ä¸ªè¿‡ç¨‹æ‰®æ¼”äº†æ ‡è®°çš„è§’è‰²ï¼Œç»™ç‰¹æ®Šçš„æ¥å£åšäº†ä¸€äº›ç‰¹æ®Šçš„æ ‡è®°ï¼Œæˆ‘æ˜¯è¿™ä¹ˆè®¤ä¸ºçš„ğŸ¤¡ã€‚å½“ç„¶ï¼Œå®ƒè¿˜æœ‰å¾ˆå¤šçš„åº”ç”¨åœºæ™¯ï¼Œä½ å¯ä»¥å†ä»”ç»†å»äº†è§£ä¸€ä¸‹å“ˆã€‚<a href="https://link.juejin.cn?target=https%3A%2F%2Fnest.nodejs.cn%2Ffundamentals%2Fexecution-context%23%25E5%258F%258D%25E5%25B0%2584%25E5%2592%258C%25E5%2585%2583%25E6%2595%25B0%25E6%258D%25AE" title="https://nest.nodejs.cn/fundamentals/execution-context#%E5%8F%8D%E5%B0%84%E5%92%8C%E5%85%83%E6%95%B0%E6%8D%AE">ä¼ é€é—¨</a></p>
<h3 id="é…ç½®jwtç­–ç•¥">é…ç½®JWTç­–ç•¥<a hidden class="anchor" aria-hidden="true" href="#é…ç½®jwtç­–ç•¥">#</a></h3>
<p>å‘ƒ&hellip;å…³äºä»€ä¹ˆæ˜¯ <code>JWT</code> â“</p>
<p>å°±ä¸åœ¨è¿™é‡Œå¤šè¯´äº†ï¼Œåº”è¯¥éƒ½è€³ç†Ÿèƒ½è¯¦çš„ï¼Œæ‡‚å¾—éƒ½æ‡‚ï¼Œå’±ä»¬ç›´æ¥æ¥çœ‹çœ‹åœ¨ <code>Nest</code> ä¸­å¦‚ä½•åšå‡ºè¿™ä¹ˆä¸€å¥—ç©æ„å§ã€‚ğŸƒ</p>
<blockquote>
<p>å¯¹ï¼Œä»Šå¤©ç½‘ä¸Šå†²æµªç…åˆ°ä¸€å¼ å›¾ï¼Œå†™å¾—æŒº&hellip;ç”»å¾—æŒºå¥½çœ‹ğŸ’¯ï¼Œå¯ä»¥ç§ç§å“ˆã€‚</p>
<p><img loading="lazy" src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4454fb45d9fb4f2fa6f529e9b475f034~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qmZ5p-Q5Lq6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1727751225&amp;x-signature=1QhFbN5k3sVsbSeZMZNhViylZ3o%3D" alt="04200c758937c4e64c05143532ec28e.png"  />
</p>
</blockquote>
<p>å…ˆæ¥å®‰è£…ä¾èµ–ï¼š</p>
<p>javascript</p>
<p>ä»£ç è§£è¯»</p>
<p>å¤åˆ¶ä»£ç </p>
<p><code>npm install @nestjs/jwt passport-jwt @nestjs/passport</code></p>
<p>åˆ›å»º <code>utils/jwt/jwt.strategy.ts</code> æ–‡ä»¶ï¼š</p>
<p>javascript</p>
<p>ä»£ç è§£è¯»</p>
<p>å¤åˆ¶ä»£ç </p>
<p><code>import { Injectable } from '@nestjs/common'; import { ConfigService } from '@nestjs/config'; import { PassportStrategy } from '@nestjs/passport'; import { ExtractJwt, Strategy } from 'passport-jwt'; @Injectable() export class JwtStrategy extends PassportStrategy(Strategy, 'jwt') {   constructor(private configService: ConfigService) {     // æ ¡éªŒå‰ç«¯ä¼ é€’çš„token     super({       jwtFromRequest: ExtractJwt.fromAuthHeaderAsBearerToken(), //æ ¡éªŒé€»è¾‘token å·²å°è£…       ignoreExpiration: false,       secretOrKey: 'å¯†é’¥....',     });   }   async validate(payload: any) {     // tokenéªŒè¯æˆåŠŸå, ä¼šä»tokené‡Œé¢è§£æå‡ºç”¨æˆ·ä¿¡æ¯, returnçš„ä¿¡æ¯ä¼šè¢«èµ‹å€¼åˆ°expressçš„requestå¯¹è±¡ä¸Š, å¹¶ä¸”å±æ€§å›ºå®šä¸ºuser     return { id: payload.id, username: payload.username };   } }</code></p>
<p>ç»§ç»­åˆ›å»º <code>utils/jwt/jwt.guard.ts</code> æ–‡ä»¶ï¼š</p>
<p>javascript</p>
<p>ä»£ç è§£è¯»</p>
<p>å¤åˆ¶ä»£ç </p>
<p><code>import {   ExecutionContext,   Injectable,   UnauthorizedException,   NotFoundException, } from '@nestjs/common'; import { AuthGuard } from '@nestjs/passport'; import { Reflector } from '@nestjs/core'; import { Observable } from 'rxjs'; import { SKIP_PUBLIC_TOKEN_GUARD } from '@/utils/metadata'; @Injectable() export class JwtAuthGuard extends AuthGuard('jwt') {   constructor(private reflector: Reflector) {     super();   }   /**    * @name: è¯¥å®ˆæŠ¤ç”¨äºéªŒè¯token    * @description: æ¯ä¸ªå®ˆæŠ¤å¿…é¡»å®ç°è¯¥æ–¹æ³•ï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œæ˜¯å¦å…è®¸å½“å‰è¯·æ±‚ã€‚https://nest.nodejs.cn/guards    */   canActivate(     context: ExecutionContext,   ): boolean | Promise&lt;boolean&gt; | Observable&lt;boolean&gt; {     // æ ¡éªŒæ˜¯å¦æ˜¯å…¬å…±è·¯ç”±     const isPublic = this.reflector.getAllAndOverride&lt;boolean&gt;(       SKIP_PUBLIC_TOKEN_GUARD,       [context.getHandler(), context.getClass()],     );     // å…¬å…±è·¯ç”±ç›´æ¥è·³è¿‡     if (isPublic) return true;     // æ ¡éªŒtoken     return super.canActivate(context);   }   /**    * @name: super.canActivate(context)éªŒå®Œæˆåè°ƒç”¨    * @description: éªŒå®Œæˆåè°ƒç”¨    * @param {*} error è¿™æ˜¯ Passport ç­–ç•¥æ‰§è¡Œè¿‡ç¨‹ä¸­å‘ç”Ÿçš„ä»»ä½•æ½œåœ¨é”™è¯¯ã€‚å¦‚æœåœ¨éªŒè¯è¿‡ç¨‹ä¸­æ²¡æœ‰é”™è¯¯å‘ç”Ÿï¼Œè¿™ä¸ªå€¼é€šå¸¸æ˜¯ null    * @param {*} user è¿™æ˜¯ Passport ç­–ç•¥éªŒè¯æˆåŠŸåè¿”å›çš„ç”¨æˆ·å¯¹è±¡ã€‚å¦‚æœéªŒè¯å¤±è´¥ï¼Œè¿™ä¸ªå€¼å¯èƒ½æ˜¯ false æˆ– nullï¼Œå…·ä½“å–å†³äºä½ ä½¿ç”¨çš„ Passport ç­–ç•¥    * @param {*} info å¦‚æœéªŒè¯å¤±è´¥ï¼Œinfoé€šå¸¸æ˜¯ä¸€ä¸ªerrorå¯¹è±¡    */   handleRequest(error, user, info) {     if (info || error)       throw new UnauthorizedException('tokenæ ¡éªŒå¤±è´¥ï¼Œtokenå·²ç»è¿‡æœŸ');     if (!user) throw new NotFoundException('ç”¨æˆ·ä¸å­˜åœ¨');     return user;   } }</code></p>
<p>åœ¨ <code>utils/metadata.ts</code> æ–‡ä»¶ä¸­è¿›è¡Œå…ƒæ•°æ®é…ç½®ï¼š</p>
<p>javascript</p>
<p>ä»£ç è§£è¯»</p>
<p>å¤åˆ¶ä»£ç </p>
<p><code>import { SetMetadata } from '@nestjs/common'; export const SKIP_PUBLIC_TOKEN_GUARD = 'skip_public_token_guard'; /**  * @name è·³è¿‡å…¨å±€Jwtå®ˆæŠ¤  */ export const SkipPublicTokenGuard = () =&gt;   SetMetadata(SKIP_PUBLIC_TOKEN_GUARD, true);</code></p>
<p>å…·ä½“ä½¿ç”¨ï¼Œåœ¨ <code>app.module.ts</code> æ–‡ä»¶ï¼š</p>
<p>javascript</p>
<p>ä»£ç è§£è¯»</p>
<p>å¤åˆ¶ä»£ç </p>
<p><code>// ... import { APP_GUARD } from '@nestjs/core'; // JWT import { JwtModule } from '@nestjs/jwt'; import { JwtStrategy } from '@/utils/jwt/jwt.strategy'; import { JwtAuthGuard } from '@/utils/jwt/jwt.guard'; @Module({   imports: [     // ...     // æ³¨å†ŒJwt     JwtModule.register({       global: true,       secret: config.token.secret,       signOptions: { expiresIn: config.token.expiresIn },     }),   ],   controllers: [AppController],   providers: [     AppService,     // å…¨å±€æ³¨å…¥Jwtç­–ç•¥     JwtStrategy,     // å…¨å±€æ³¨å†ŒjwtéªŒè¯å®ˆå«     {       provide: APP_GUARD,       useClass: JwtAuthGuard,     },   ], }) export class AppModule {}</code></p>
<p>é€šè¿‡ä»¥ä¸Šçš„é…ç½®åï¼Œç°åœ¨å°±æ— æ³•ç›´æ¥å»è®¿é—®æ¥å£äº†ï¼Œè®¿é—®ä»»ä½•æ¥å£éƒ½éœ€è¦ <code>Token</code> çš„éªŒè¯ã€‚</p>
<p><img loading="lazy" src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/23dae5d7c9ed42a7bff56f575d829f0e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qmZ5p-Q5Lq6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1727751225&amp;x-signature=qHPE%2BivPNEINLpZ361gPc9R4rE8%3D" alt="image.png"  />
</p>
<p>è€Œè¦æƒ³æ­£å¸¸è®¿é—®æ¥å£ï¼Œåªèƒ½æœ‰ä¸¤ç§å½¢å¼ï¼Œå…¶ä¸€ï¼Œæºå¸¦æ­£ç¡®çš„ <code>Token</code> è¿›è¡Œè®¿é—®ï¼Œå…¶äºŒï¼Œç‰¹æ®Šçš„æ¥å£å¯ä»¥é€šè¿‡ <code>@SkipPublicTokenGuard()</code> è£…é¥°å™¨è·³è¿‡ <code>Token</code> çš„éªŒè¯ã€‚</p>
<blockquote>
<p>ä¸Šé¢ï¼Œæˆ‘ä»¬é€šè¿‡å…ƒæ•°æ®å¢åŠ äº†ä¸€ä¸ª <code>@SkipPublicTokenGuard()</code> è£…é¥°å™¨ï¼Œå®ƒçš„ä½œç”¨æ˜¯ç”¨æ¥è·³è¿‡ <code>Token</code> çš„éªŒè¯ï¼Œå®ƒèƒ½è¢«ä½œç”¨äºä¸€äº›ä¸éœ€è¦ <code>Token</code> éªŒè¯çš„æ¥å£ã€‚</p>
</blockquote>
<p>æ¥çœ‹çœ‹å¦‚ä½•æ‰‹åŠ¨è·³è¿‡ <code>Token</code> çš„éªŒè¯ï¼š</p>
<p>javascript</p>
<p>ä»£ç è§£è¯»</p>
<p>å¤åˆ¶ä»£ç </p>
<p><code>// modules/user/user.controller.ts // ... import {   SkipResponseSuccessInterceptor,   SkipPublicTokenGuard, } from '@/utils/metadata'; @Controller('user') export class UserController {   constructor(private readonly userService: UserService) {}   /** @name éªŒè¯ç  **/   @Get('captcha')   // è·³è¿‡tokenéªŒè¯   @SkipPublicTokenGuard()   // è·³è¿‡å“åº”æ ¼å¼åŒ–   @SkipResponseSuccessInterceptor()   captcha() {     const captcha = svgCaptcha.create({       size: 4,       fontSize: 60,       ignoreChars: '0o1i',       color: true,     });     // sessionä¸Šé¢å’±ä»¬å¯è®²è¿‡äº†å“¦ï¼Œåˆ«å¿˜äº†     req.session.captcha = captcha.text;     res.type('image/svg+xml');     res.send(captcha.data);   } }</code></p>
<p>å¯ä»¥çœ‹åˆ°ï¼ŒéªŒè¯ç æ¥å£å·²ç»æœ‰ä¸¤ä¸ªç‰¹æ®Šçš„è£…é¥°å™¨äº†ï¼Œè¿™ä¹Ÿæ¯”è¾ƒç¬¦åˆéªŒè¯ç æ¥å£çš„å®é™…åº”ç”¨é€»è¾‘ã€‚é…ç½®åï¼Œå†å»è®¿é—®éªŒè¯ç æ¥å£å°±åº”è¯¥æ˜¯èƒ½æ­£ç¡®çœ‹åˆ°éªŒè¯ç å›¾ç‰‡è¿”å›äº†ã€‚</p>
<p>å†æ¥çœ‹çœ‹å¦‚ä½•ç”Ÿæˆ <code>Token</code> å¹¶è¿›è¡Œæ­£ç¡®çš„è®¿é—®éªŒè¯å§ï¼Œå…ˆæ¥å¢åŠ ä¸€ä¸ªPostæ–¹å¼çš„ <code>user/login</code> çš„ç™»å½•æ¥å£ï¼š</p>
<p>javascript</p>
<p>ä»£ç è§£è¯»</p>
<p>å¤åˆ¶ä»£ç </p>
<p><code>// modules/user/user.controller.ts // ... import { JwtService } from '@nestjs/jwt'; @Controller('user') export class UserController {   constructor(     private readonly userService: UserService,     // æ³¨å…¥JWT     private readonly jwtService: JwtService    ) {}   ** @name PCç™»å½• **/   @Post('login')   // è·³è¿‡tokenéªŒè¯   @SkipPublicTokenGuard()   async login(@Req() req) {     // ç”Ÿæˆtoken     const token = this.jwtService.sign({       id: 1,       username: 'æ©™æŸäºº',     });     // å­˜å‚¨session     req.session.token = token;     // è¿”å›tokenç»™å‰ç«¯     return token;   } }</code></p>
<p>æ¯”è¾ƒç®€å•å“ˆï¼Œå’±ä»¬ç›´æ¥æ³¨å…¥ <code>JWT</code> åï¼Œé€šè¿‡ <code>sign()</code> å°±èƒ½ç”Ÿæˆä¸€ä¸ª <code>Token</code> ç»™åˆ°å‰ç«¯äº†ã€‚</p>
<p><img loading="lazy" src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f32e73fbf9ba47e180c6eb4ae1825d9c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qmZ5p-Q5Lq6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1727751225&amp;x-signature=igOdbo1CcRmOrXLtYKTWKLoee9Q%3D" alt="image.png"  />
</p>
<p>å‰ç«¯æ‹¿åˆ° <code>Token</code> åï¼Œå…¶ä»–æ¥å£è¦è®¿é—®åç«¯çš„è¯ï¼Œå°±éœ€è¦åœ¨ <code>headers</code> èº«ä¸Šå¢åŠ ä¸€ä¸ª <code>Authorization</code> å±æ€§ç”¨äºæºå¸¦ <code>Token</code> è¿‡æ¥ç»™åˆ°åç«¯ã€‚</p>
<p>javascript</p>
<p>ä»£ç è§£è¯»</p>
<p>å¤åˆ¶ä»£ç </p>
<p><code>// å‰ç«¯éƒ¨åˆ†ä»£ç  axios.interceptors.request.use(   (config: AxiosRequestConfig) =&gt; {     const token = getToken();     if (token) {       if (!config.headers) {         config.headers = {};       }       config.headers.Authorization = `Bearer ${token}`;     }     return config;   },   (error) =&gt; {     return Promise.reject(error);   } );</code></p>
<p><img loading="lazy" src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/34bbee7d88f74c97b644289ef607f68f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qmZ5p-Q5Lq6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1727751225&amp;x-signature=k9%2B%2FAiYTNGU0eDdLnP65QNNWjNk%3D" alt="image.png"  />
</p>
<blockquote>
<p>ä¸ºä»€ä¹ˆå‰ç«¯éœ€è¦åœ¨ <code>Token</code> å‰é¢å¢åŠ ä¸€ä¸ª <strong>Bearer</strong> å•è¯å‘¢â“ <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.jianshu.com%2Fp%2F61d592ae33ee" title="https://www.jianshu.com/p/61d592ae33ee">ä¼ é€é—¨</a></p>
</blockquote>
<h3 id="è¿æ¥æ•°æ®åº“">è¿æ¥æ•°æ®åº“<a hidden class="anchor" aria-hidden="true" href="#è¿æ¥æ•°æ®åº“">#</a></h3>
<p>ä»¥ <code>Mysql</code> ä¸ºä¾‹ï¼Œéœ€è¦æå‰åœ¨è‡ªå·±ç”µè„‘æœ¬åœ°å®‰è£…å¥½ <code>Mysql</code> å“¦ï¼Œä¸‹è½½åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fdev.mysql.com%2Fdownloads%2Fmysql%2F" title="https://dev.mysql.com/downloads/mysql/">ä¼ é€é—¨</a></p>
<blockquote>
<p>è¯¦æƒ…çš„ <code>Mysql</code> å®‰è£…è¿‡ç¨‹ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fm0_71422677%2Farticle%2Fdetails%2F136007088" title="https://blog.csdn.net/m0_71422677/article/details/136007088">ä¼ é€é—¨</a></p>
</blockquote>
<p>ä¸ºäº†æ›´å¥½çš„æ“ä½œæ•°æ®åº“ï¼Œå’±ä»¬å¯ä»¥ä¸‹è½½ä¸€äº›å¯è§†åŒ–çš„å·¥å…·æ¥æ“ä½œæ•°æ®åº“ï¼Œå¦‚ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fnavicat.com.cn%2F" title="https://navicat.com.cn/">Navicat</a>ã€‚</p>
<p>ä¹Ÿå¯ä»¥ç›´æ¥åœ¨ <code>VSCode</code> ä¸­å®‰è£… <code>Database Client</code> æ’ä»¶ï¼Œå®‰è£…ä¹‹åå¤§æ¦‚æ˜¯é•¿è¿™æ ·å­ï¼š</p>
<p><img loading="lazy" src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a829ccc3172542d2bd3de68a7981f3bf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qmZ5p-Q5Lq6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1727751225&amp;x-signature=sCQJwC6bmZmVckX8juaizvqMSHs%3D" alt="image.png"  />
</p>
<p>å…·ä½“çš„ä¸€äº›æ“ä½œï¼Œå¦‚åˆ›å»ºæ•°æ®åº“ï¼Œåˆ›å»ºè¡¨ï¼Œåˆ›å»ºå­—æ®µå•¥çš„ï¼Œä½ å°±è‡ªå·±è€è€çœ‹å§ï¼ŒæŒºå®¹æ˜“ä½¿ç”¨çš„ã€‚ğŸ‘»</p>
<p>åœ¨ <code>Nest</code> ä¸­è¦è¿æ¥ä¸Šæ•°æ®åº“ï¼Œè¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œå¯ä»¥è·Ÿç€<a href="https://link.juejin.cn?target=https%3A%2F%2Fnest.nodejs.cn%2Ftechniques%2Fdatabase" title="https://nest.nodejs.cn/techniques/database">å®˜ç½‘æ•™ç¨‹</a>ä¸€æ­¥æ­¥åšå°±è¡Œå•¦ï¼Œä¹Ÿå¯ä»¥æ¥çœ‹çœ‹å°ç¼–æ˜¯å¦‚ä½•åšçš„ã€‚</p>
<p>å…ˆæ¥è£…è£…ä¾èµ–ï¼š</p>
<p>javascript</p>
<p>ä»£ç è§£è¯»</p>
<p>å¤åˆ¶ä»£ç </p>
<p><code>npm install @nestjs/typeorm typeorm mysql2 -S</code></p>
<blockquote>
<p>å¦‚ <code>npm install --save @nestjs/typeorm typeorm</code> å®‰è£…ä¸äº†ï¼Œå¯ä»¥åˆ‡æ¢æˆ <code>yarn</code> ä¸‹è½½ã€‚</p>
</blockquote>
<p>åœ¨ <code>app.module.ts</code> æ–‡ä»¶ä¸­é…ç½®è¿æ¥ä¿¡æ¯ï¼š</p>
<p>javascript</p>
<p>ä»£ç è§£è¯»</p>
<p>å¤åˆ¶ä»£ç </p>
<p><code>// ... @Module({   imports: [     // ...     // é…ç½®æ•°æ®åº“è¿æ¥     TypeOrmModule.forRoot({       type: 'mysql',       host: '127.0.0.1',       port: 3306,       username: 'root',       password: '123456',       database: 'test', // æ•°æ®åº“å       // è‡ªåŠ¨åŠ è½½æ‰€æœ‰çš„å®ä½“ç±»       entities: [__dirname + '/**/*.entity{.ts,.js}'],       // åŒæ­¥å®ä½“ç±»ä¸æ•°æ®åº“ä¿¡æ¯, è¿™ä¸ªæ“ä½œå¾ˆå±é™©ï¼Œå¯èƒ½æŠŠæ•°æ®ç»™å¹²æ²¡äº†       synchronize: false,     }),   ],   // ... }) export class AppModule {}</code></p>
<p>ä¸€å®šè¦æ³¨æ„ <a href="https://link.juejin.cn?target=https%3A%2F%2Fnest.nodejs.cn%2Ftechniques%2Fdatabase%23sequelize-%25E9%259B%2586%25E6%2588%2590" title="https://nest.nodejs.cn/techniques/database#sequelize-%E9%9B%86%E6%88%90">synchronize</a> å±æ€§ï¼Œå®ƒç”¨äºåŒæ­¥å®ä½“ç±»ä¸æ•°æ®åº“ä¿¡æ¯ï¼Œå®˜ç½‘ä¸ç½‘ä¸Šå¾ˆå¤šéƒ½ä»‹ç»è¯´å¯ä»¥åœ¨å¼€å‘ç¯å¢ƒå¼€å¯è¿™ä¸ªé€‰é¡¹ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒå†å…³é—­ã€‚ä½ å¯ä»¥å»è¿™ä¹ˆåšï¼Œä½†æ˜¯ï¼Œæœ€å¥½åœ¨ä½ è¶³å¤Ÿäº†è§£å®ä½“ç±»ä¸æ•°æ®åº“å…³ç³»çš„åŸºç¡€ä¸‹å†å»å¼€å¯è¿™ä¸ªé€‰é¡¹ï¼›å¦åˆ™ï¼Œè¿˜æ˜¯å»ºè®®ä½ å…³é—­è¿™ä¸ªé€‰é¡¹ï¼Œè€è€å®å®å†™å®ä½“ç±»ï¼Œé€šè¿‡å¯è§†åŒ–å·¥å…·å»æ“ä½œæ“ä½œæ•°æ®åº“å°±è¡Œã€‚ğŸ¥¶ğŸ¥¶ğŸ¥¶</p>
<p>ç„¶åï¼Œåœ¨ <code>modules/user/user.module.ts</code> æ–‡ä»¶ä¸­å°†å®ä½“ç±»å¯¼å…¥ï¼š</p>
<p>javascript</p>
<p>ä»£ç è§£è¯»</p>
<p>å¤åˆ¶ä»£ç </p>
<p><code>import { Module } from '@nestjs/common'; import { UserService } from './user.service'; import { UserController } from './user.controller'; import { TypeOrmModule } from '@nestjs/typeorm'; // å®ä¾‹ç±» import { User } from './entities/user.entity'; @Module({   // å°†ormä¸è¡¨å…³è”èµ·æ¥   imports: [TypeOrmModule.forFeature([User])],   controllers: [UserController],   providers: [UserService], }) export class UserModule {}</code></p>
<p>å‰é¢ï¼Œå’±ä»¬é€šè¿‡ <code>nest g res modules/user</code> åˆ›å»ºæ¨¡å—ï¼Œé»˜è®¤éƒ½ä¼šç”Ÿæˆä¸€ä¸ª <code>entities</code> çš„æ–‡ä»¶å¤¹ï¼Œè¯¥æ–‡ä»¶å¤¹å°±æ˜¯ç”¨äºå­˜æ”¾è¯¥æ¨¡å—ä¸‹çš„æ‰€æœ‰å®ä½“ç±»çš„ã€‚</p>
<blockquote>
<p>ä¸€ç›´åœ¨è¯´ &ldquo;å®ä½“ç±»&rdquo;ï¼Œé‚£å®ƒæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</p>
<p>å¯ä»¥çœ‹çœ‹å®˜ç½‘çš„è§£é‡Šï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fnest.nodejs.cn%2Ftechniques%2Fdatabase%23%25E5%25AD%2598%25E5%2582%25A8%25E5%25BA%2593%25E6%25A8%25A1%25E5%25BC%258F" title="https://nest.nodejs.cn/techniques/database#%E5%AD%98%E5%82%A8%E5%BA%93%E6%A8%A1%E5%BC%8F">ä¼ é€é—¨</a>ã€‚</p>
<p>ä½ ä¹Ÿå¯ä»¥ç®€å•è®¤ä¸ºå®ƒå°±æ˜¯æ•°æ®åº“çš„è¡¨åœ¨ <code>Nest</code> ä¸­çš„æè¿°ã€‚</p>
</blockquote>
<p>ç¼–å†™å®ä½“ç±»ï¼š</p>
<p>javascript</p>
<p>ä»£ç è§£è¯»</p>
<p>å¤åˆ¶ä»£ç </p>
<p><code>// modules/user/entity/user.entity.ts import { Entity, Column, PrimaryGeneratedColumn, AfterLoad } from 'typeorm'; // å…³è”y_userè¡¨ @Entity({ name: 'y_user' }) export class User {   @PrimaryGeneratedColumn()   id: number;      @Column()   username: string; }</code></p>
<p>å‡è®¾å’±ä»¬ç°åœ¨æ•°æ®åº“æœ‰ä¸€ä¸ª <code>y_user</code> è¡¨ï¼Œè¡¨ä¸­åªæœ‰ <code>id</code> ä¸ <code>username</code> ä¸¤ä¸ªå­—æ®µï¼Œæˆ‘ä»¬æƒ³è¦å°†è¿™ä¸ªè¡¨çš„å­—æ®µå…¨æŸ¥å‡ºæ¥ã€‚</p>
<p>åœ¨ <code>modules/user/user.service.ts</code> æ–‡ä»¶ï¼š</p>
<p>javascript</p>
<p>ä»£ç è§£è¯»</p>
<p>å¤åˆ¶ä»£ç </p>
<p><code>import { Injectable } from '@nestjs/common'; import { InjectRepository } from '@nestjs/typeorm'; import { Repository } from 'typeorm'; import { User } from './entities/user.entity'; @Injectable() export class UserService {   constructor(     // æ’å…¥Userå®ä¾‹ç±»     @InjectRepository(User) private readonly user: Repository&lt;User&gt;,   ) {}   /** @name æŸ¥æ‰¾æ‰€æœ‰çš„ç”¨æˆ· **/   async list() {     // é€šè¿‡this.userçš„å®ä¾‹ç±»ç›´æ¥å»æŸ¥è¯¢æ•°æ®åº“çš„y_userè¡¨     const data = await this.user.find();     return data;   } }</code></p>
<p>é€šè¿‡ <code>user/list</code> æ¥å£æ¥æŸ¥è¯¢ç”¨æˆ·åˆ—è¡¨ï¼š</p>
<p>javascript</p>
<p>ä»£ç è§£è¯»</p>
<p>å¤åˆ¶ä»£ç </p>
<p><code>// ... @Controller('user') export class UserController {   constructor(     // æ³¨å…¥UserService     private readonly userService: UserService,     private readonly jwtService: JwtService,   ) {}   /** @name ç”¨æˆ·åˆ—è¡¨ **/   @Get('list')   async list(@Req() req) {     // æŸ¥è¯¢ç”¨æˆ·åˆ—è¡¨     const result = await this.userService.list();     return result;   } }</code></p>
<p>å¦‚æœèƒ½æ­£ç¡®æŸ¥è¯¢åˆ°æ•°æ®åº“çš„æ•°æ®ï¼Œå°±è¯´æ˜ä½ çš„æ•°æ®åº“å·²ç»è¿æ¥ä¸Šäº†ã€‚</p>
<blockquote>
<p>å¦‚å‡ºç°æ•°æ®åº“è¿ä¸ä¸Šï¼Œå¯ä»¥çœ‹çœ‹è¿æ¥ä¿¡æ¯çš„ <code>host</code> é€‰é¡¹é…ç½®ï¼Œå°† <code>localhost</code> æ”¹æˆ <code>127.0.0.1</code>ã€‚ <a href="https://link.juejin.cn?target=https%3A%2F%2Fstackoverflow.com%2Fquestions%2F74837366%2Ferror-connect-econnrefused-127-0-0-15432-at-tcpconnectwrap-afterconnect-as-on" title="https://stackoverflow.com/questions/74837366/error-connect-econnrefused-127-0-0-15432-at-tcpconnectwrap-afterconnect-as-on">ä¼ é€é—¨</a></p>
</blockquote>
<h3 id="æ¥å£æ–‡æ¡£">æ¥å£æ–‡æ¡£<a hidden class="anchor" aria-hidden="true" href="#æ¥å£æ–‡æ¡£">#</a></h3>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fnest.nodejs.cn%2Fopenapi%2Fintroduction" title="https://nest.nodejs.cn/openapi/introduction">nest.nodejs.cn/openapi/intâ€¦</a></p>
<p>ç”±äºï¼Œåœ¨ <code>Nest</code> ä¸­ç¼–å†™çš„æ¥å£éƒ½æ˜¯ä¸¥æ ¼éµä»å…¶è§„èŒƒçš„ï¼Œæ‰€ä»¥æƒ³è¦ç”Ÿæˆä¸€ä¸ªæ¥å£æ–‡æ¡£ï¼Œæ˜¯ä¸€ä»¶å¾ˆç®€å•çš„äº‹æƒ…ã€‚</p>
<p>å®‰è£…ä¾èµ–ï¼š</p>
<p>javascript</p>
<p>ä»£ç è§£è¯»</p>
<p>å¤åˆ¶ä»£ç </p>
<p><code>npm install @nestjs/swagger -S</code></p>
<p>åœ¨ <code>main.ts</code> æ–‡ä»¶ä¸­é…ç½®ä½¿ç”¨ï¼š</p>
<p>javascript</p>
<p>ä»£ç è§£è¯»</p>
<p>å¤åˆ¶ä»£ç </p>
<p><code>// ... import { SwaggerModule, DocumentBuilder } from '@nestjs/swagger'; async function bootstrap() {   const app = await NestFactory.create(AppModule);     // æ¥å£æ–‡æ¡£   const docConfig = new DocumentBuilder()     .setTitle('æˆ‘çš„æ¥å£æ–‡æ¡£')     .setDescription('å®¾è‡³å¦‚å½’ï¼Œå‹æƒ…é•¿å­˜ã€‚')     .setVersion(config.version)     .addTag('hotel')     .build();   const document = SwaggerModule.createDocument(app, docConfig);   SwaggerModule.setup('doc', app, document);      // ...   await app.listen(config.post); } bootstrap();</code></p>
<p>ç„¶åæˆ‘ä»¬é‡å¯é¡¹ç›®ï¼Œç›´æ¥è®¿é—® <code>http://localhost:3000/doc</code> å°±èƒ½çœ‹åˆ°å’±ä»¬çš„æ–‡æ¡£ï¼š</p>
<p><img loading="lazy" src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8936618104204f24a358873994647d27~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qmZ5p-Q5Lq6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1727751225&amp;x-signature=%2FbaV3sAw8u7LPvbxVrgY7KI7dog%3D" alt="image.png"  />
</p>
<p>æŒºç®€å•ï¼Œæ›´å¤šæ–‡æ¡£ç›¸å…³çš„é…ç½®å¯ä»¥çœ‹å®˜ç½‘ç§ç§çœ‹ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fnest.nodejs.cn%2Fopenapi%2Fintroduction" title="https://nest.nodejs.cn/openapi/introduction">ä¼ é€é—¨</a></p>
<h3 id="é…ç½®è·¨åŸŸ">é…ç½®è·¨åŸŸ<a hidden class="anchor" aria-hidden="true" href="#é…ç½®è·¨åŸŸ">#</a></h3>
<p>è·¨åŸŸï¼Œä¸€ä¸ªè€ç”Ÿå¸¸è°ˆçš„é—®é¢˜ã€‚åœ¨ä¸Šé¢ï¼Œå’±ä»¬è¿˜æ²¡ä¸ºé¡¹ç›®é…ç½®å…è®¸è·¨åŸŸæœºåˆ¶ã€‚</p>
<p>ä»¥æˆ‘ä»¬çš„ <code>http://localhost:3000/user/captcha</code> éªŒè¯ç æ¥å£ä¸ºä¾‹ï¼Œå’±ä»¬åœ¨<a href="https://juejin.cn/" title="https://juejin.cn/">æ˜é‡‘</a>çš„é¡µé¢ä¸­è°ƒå‡ºæ§åˆ¶å°ï¼Œé€šè¿‡ <code>fetch</code> è¯·æ±‚ä¸€ä¸‹éªŒè¯ç æ¥å£ï¼š</p>
<p><img loading="lazy" src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/421ad18d13d94788aeea4f5dff881655~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qmZ5p-Q5Lq6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1727751225&amp;x-signature=eww%2FekDEE0OQ6uxDKhC%2FxdJIguE%3D" alt="image.png"  />
</p>
<p>æœç„¶ï¼Œå¾ˆæ˜æ˜¾çš„è·¨åŸŸå¼‚å¸¸ã€‚</p>
<p>å¦‚ä½•åœ¨ <code>Nest</code> ä¸­è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿä¹ŸæŒºç®€å•ï¼Œåœ¨ <code>main.ts</code> æ–‡ä»¶ä¸­ï¼š</p>
<p>javascript</p>
<p>ä»£ç è§£è¯»</p>
<p>å¤åˆ¶ä»£ç </p>
<p><code>// ... async function bootstrap() {   const app = await NestFactory.create(AppModule);   // ...   // å…è®¸è·¨åŸŸ   app.enableCors();   await app.listen(config.post); } bootstrap();</code></p>
<p>å¢åŠ äº†ä¸€ä¸ªä»£ç ï¼Œé…ç½®åï¼Œå†æ¬¡é‡æ–°è®¿é—®ï¼š</p>
<p><img loading="lazy" src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1c8353e972cb42aaaf5def2d1af03963~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qmZ5p-Q5Lq6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1727751225&amp;x-signature=ct3Rchtc2WNotOs764%2FmXwhll0E%3D" alt="image.png"  />
</p>
<p>æ­£å¸¸äº†ã€‚ğŸ¥³</p>
<p>åœ¨åº•å±‚ï¼ŒNest æ ¹æ®åº•å±‚å¹³å°ä½¿ç”¨ ExpressÂ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fexpressjs%2Fcors" title="https://github.com/expressjs/cors">cors</a>Â æˆ– FastifyÂ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ffastify%2Ffastify-cors" title="https://github.com/fastify/fastify-cors">@fastify/cors</a>Â è½¯ä»¶åŒ…ã€‚è¿™äº›è½¯ä»¶åŒ…æä¾›äº†å„ç§é€‰é¡¹ï¼Œä½ å¯ä»¥æ ¹æ®ä½ çš„è¦æ±‚è¿›è¡Œè‡ªå®šä¹‰ã€‚<a href="https://link.juejin.cn?target=https%3A%2F%2Fnest.nodejs.cn%2Fsecurity%2Fcors" title="https://nest.nodejs.cn/security/cors">ä¼ é€é—¨</a></p>
<hr>
<p>è‡³æ­¤ï¼Œæœ¬ç¯‡æ–‡ç« å°±å†™å®Œå•¦ï¼Œæ’’èŠ±æ’’èŠ±ã€‚</p>
<p><img loading="lazy" src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b2198fba2b674f1b935a63e4abb3cbd7~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=90&amp;h=90&amp;s=8866&amp;e=png&amp;b=fcfcfc" alt="image.png"  />
</p>
<p>å¸Œæœ›æœ¬æ–‡å¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼Œå¦‚æœ‰ä»»ä½•ç–‘é—®ï¼ŒæœŸå¾…ä½ çš„ç•™è¨€å“¦ã€‚<br>
è€æ ·å­ï¼Œç‚¹èµ+è¯„è®º=ä½ ä¼šäº†ï¼Œæ”¶è—=ä½ ç²¾é€šäº†ã€‚</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/tags/%E5%89%8D%E7%AB%AF/">å‰ç«¯</a></li>
      <li><a href="http://localhost:1313/tags/javascript/">JavaScript</a></li>
      <li><a href="http://localhost:1313/tags/nestjs/">NestJS</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="http://localhost:1313/posts/wiki/1%E5%9C%BA%E6%99%AF%E9%9D%A9%E5%91%BD%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/">
    <span class="title">Â« ä¸Šä¸€é¡µ</span>
    <br>
    <span>1ã€åœºæ™¯é©å‘½è¯»ä¹¦ç¬”è®°</span>
  </a>
  <a class="next" href="http://localhost:1313/posts/wiki/51%E5%91%A8%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/">
    <span class="title">ä¸‹ä¸€é¡µ Â»</span>
    <br>
    <span>51å‘¨è¯»ä¹¦ç¬”è®°</span>
  </a>
</nav>


<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share ğŸš€ğŸš€ğŸš€NestJSå…¥é—¨ç§˜ç±ğŸ”¥ğŸ”¥ğŸ”¥ on x"
            href="https://x.com/intent/tweet/?text=%f0%9f%9a%80%f0%9f%9a%80%f0%9f%9a%80NestJS%e5%85%a5%e9%97%a8%e7%a7%98%e7%b1%8d%f0%9f%94%a5%f0%9f%94%a5%f0%9f%94%a5&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fjuejin%2fnestjs%25E5%2585%25A5%25E9%2597%25A8%25E7%25A7%2598%25E7%25B1%258D%2f&amp;hashtags=%e5%89%8d%e7%ab%af%2cJavaScript%2cNestJS">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share ğŸš€ğŸš€ğŸš€NestJSå…¥é—¨ç§˜ç±ğŸ”¥ğŸ”¥ğŸ”¥ on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fjuejin%2fnestjs%25E5%2585%25A5%25E9%2597%25A8%25E7%25A7%2598%25E7%25B1%258D%2f&amp;title=%f0%9f%9a%80%f0%9f%9a%80%f0%9f%9a%80NestJS%e5%85%a5%e9%97%a8%e7%a7%98%e7%b1%8d%f0%9f%94%a5%f0%9f%94%a5%f0%9f%94%a5&amp;summary=%f0%9f%9a%80%f0%9f%9a%80%f0%9f%9a%80NestJS%e5%85%a5%e9%97%a8%e7%a7%98%e7%b1%8d%f0%9f%94%a5%f0%9f%94%a5%f0%9f%94%a5&amp;source=http%3a%2f%2flocalhost%3a1313%2fposts%2fjuejin%2fnestjs%25E5%2585%25A5%25E9%2597%25A8%25E7%25A7%2598%25E7%25B1%258D%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share ğŸš€ğŸš€ğŸš€NestJSå…¥é—¨ç§˜ç±ğŸ”¥ğŸ”¥ğŸ”¥ on reddit"
            href="https://reddit.com/submit?url=http%3a%2f%2flocalhost%3a1313%2fposts%2fjuejin%2fnestjs%25E5%2585%25A5%25E9%2597%25A8%25E7%25A7%2598%25E7%25B1%258D%2f&title=%f0%9f%9a%80%f0%9f%9a%80%f0%9f%9a%80NestJS%e5%85%a5%e9%97%a8%e7%a7%98%e7%b1%8d%f0%9f%94%a5%f0%9f%94%a5%f0%9f%94%a5">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share ğŸš€ğŸš€ğŸš€NestJSå…¥é—¨ç§˜ç±ğŸ”¥ğŸ”¥ğŸ”¥ on facebook"
            href="https://facebook.com/sharer/sharer.php?u=http%3a%2f%2flocalhost%3a1313%2fposts%2fjuejin%2fnestjs%25E5%2585%25A5%25E9%2597%25A8%25E7%25A7%2598%25E7%25B1%258D%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share ğŸš€ğŸš€ğŸš€NestJSå…¥é—¨ç§˜ç±ğŸ”¥ğŸ”¥ğŸ”¥ on whatsapp"
            href="https://api.whatsapp.com/send?text=%f0%9f%9a%80%f0%9f%9a%80%f0%9f%9a%80NestJS%e5%85%a5%e9%97%a8%e7%a7%98%e7%b1%8d%f0%9f%94%a5%f0%9f%94%a5%f0%9f%94%a5%20-%20http%3a%2f%2flocalhost%3a1313%2fposts%2fjuejin%2fnestjs%25E5%2585%25A5%25E9%2597%25A8%25E7%25A7%2598%25E7%25B1%258D%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share ğŸš€ğŸš€ğŸš€NestJSå…¥é—¨ç§˜ç±ğŸ”¥ğŸ”¥ğŸ”¥ on telegram"
            href="https://telegram.me/share/url?text=%f0%9f%9a%80%f0%9f%9a%80%f0%9f%9a%80NestJS%e5%85%a5%e9%97%a8%e7%a7%98%e7%b1%8d%f0%9f%94%a5%f0%9f%94%a5%f0%9f%94%a5&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fjuejin%2fnestjs%25E5%2585%25A5%25E9%2597%25A8%25E7%25A7%2598%25E7%25B1%258D%2f">
            <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
                <path
                    d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share ğŸš€ğŸš€ğŸš€NestJSå…¥é—¨ç§˜ç±ğŸ”¥ğŸ”¥ğŸ”¥ on ycombinator"
            href="https://news.ycombinator.com/submitlink?t=%f0%9f%9a%80%f0%9f%9a%80%f0%9f%9a%80NestJS%e5%85%a5%e9%97%a8%e7%a7%98%e7%b1%8d%f0%9f%94%a5%f0%9f%94%a5%f0%9f%94%a5&u=http%3a%2f%2flocalhost%3a1313%2fposts%2fjuejin%2fnestjs%25E5%2585%25A5%25E9%2597%25A8%25E7%25A7%2598%25E7%25B1%258D%2f">
            <svg version="1.1" xml:space="preserve" width="30px" height="30px" viewBox="0 0 512 512" fill="currentColor"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape">
                <path
                    d="M449.446 0C483.971 0 512 28.03 512 62.554L512 449.446C512 483.97 483.97 512 449.446 512L62.554 512C28.03 512 0 483.97 0 449.446L0 62.554C0 28.03 28.029 0 62.554 0L449.446 0ZM183.8767 87.9921H121.8427L230.6673 292.4508V424.0079H281.3328V292.4508L390.1575 87.9921H328.1233L256 238.2489z" />
            </svg>
        </a>
    </li>
</ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span><a href="https://beian.miit.gov.cn/">ç²¤ICPå¤‡2023039897å·-1</a></span> Â· 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'å¤åˆ¶';

        function copyingDone() {
            copybutton.innerHTML = 'å·²å¤åˆ¶ï¼';
            setTimeout(() => {
                copybutton.innerHTML = 'å¤åˆ¶';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
