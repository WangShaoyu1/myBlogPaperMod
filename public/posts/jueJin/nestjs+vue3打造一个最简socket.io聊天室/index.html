<!DOCTYPE html>
<html lang="zh" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>nestjs&#43;vue3打造一个最简socket.io聊天室 | PaperMod</title>
<meta name="keywords" content="前端, Node.js">
<meta name="description" content="1.介绍1.1.项目概述本项目是一个基于NestJS和Vue3的最简聊天室应用。通过这个项目，你将学习如何将前端和后端结合，构建一个具备实时通信功能的聊天室。该聊天室允许用户发送和接收消">
<meta name="author" content="chen77">
<link rel="canonical" href="http://localhost:1313/posts/juejin/nestjs&#43;vue3%E6%89%93%E9%80%A0%E4%B8%80%E4%B8%AA%E6%9C%80%E7%AE%80socket.io%E8%81%8A%E5%A4%A9%E5%AE%A4/">
<meta name="google-site-verification" content="XYZabc">
<link crossorigin="anonymous" href="/assets/css/stylesheet.7b92bf4867c997b58ec50f63451b83777173d5bd5593376852abd85746d09d71.css" integrity="sha256-e5K/SGfJl7WOxQ9jRRuDd3Fz1b1VkzdoUqvYV0bQnXE=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/%3Clink%20/%20abs%20url%3E">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/%3Clink%20/%20abs%20url%3E">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/%3Clink%20/%20abs%20url%3E">
<link rel="apple-touch-icon" href="http://localhost:1313/%3Clink%20/%20abs%20url%3E">
<link rel="mask-icon" href="http://localhost:1313/%3Clink%20/%20abs%20url%3E">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="zh" href="http://localhost:1313/posts/juejin/nestjs&#43;vue3%E6%89%93%E9%80%A0%E4%B8%80%E4%B8%AA%E6%9C%80%E7%AE%80socket.io%E8%81%8A%E5%A4%A9%E5%AE%A4/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript><meta property="og:title" content="nestjs&#43;vue3打造一个最简socket.io聊天室" />
<meta property="og:description" content="1.介绍1.1.项目概述本项目是一个基于NestJS和Vue3的最简聊天室应用。通过这个项目，你将学习如何将前端和后端结合，构建一个具备实时通信功能的聊天室。该聊天室允许用户发送和接收消" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://localhost:1313/posts/juejin/nestjs&#43;vue3%E6%89%93%E9%80%A0%E4%B8%80%E4%B8%AA%E6%9C%80%E7%AE%80socket.io%E8%81%8A%E5%A4%A9%E5%AE%A4/" />
<meta property="og:image" content="http://localhost:1313/images/papermod-cover.png" />
<meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-09-27T00:00:00+00:00" />
<meta property="article:modified_time" content="2024-09-27T00:00:00+00:00" />


<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="http://localhost:1313/images/papermod-cover.png" />
<meta name="twitter:title" content="nestjs&#43;vue3打造一个最简socket.io聊天室"/>
<meta name="twitter:description" content="1.介绍1.1.项目概述本项目是一个基于NestJS和Vue3的最简聊天室应用。通过这个项目，你将学习如何将前端和后端结合，构建一个具备实时通信功能的聊天室。该聊天室允许用户发送和接收消"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "http://localhost:1313/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "nestjs+vue3打造一个最简socket.io聊天室",
      "item": "http://localhost:1313/posts/juejin/nestjs+vue3%E6%89%93%E9%80%A0%E4%B8%80%E4%B8%AA%E6%9C%80%E7%AE%80socket.io%E8%81%8A%E5%A4%A9%E5%AE%A4/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "nestjs+vue3打造一个最简socket.io聊天室",
  "name": "nestjs\u002bvue3打造一个最简socket.io聊天室",
  "description": "1.介绍1.1.项目概述本项目是一个基于NestJS和Vue3的最简聊天室应用。通过这个项目，你将学习如何将前端和后端结合，构建一个具备实时通信功能的聊天室。该聊天室允许用户发送和接收消",
  "keywords": [
    "前端", "Node.js"
  ],
  "articleBody": "1.介绍 1.1.项目概述 本项目是一个基于 NestJS 和 Vue 3 的最简聊天室应用。通过这个项目，你将学习如何将前端和后端结合，构建一个具备实时通信功能的聊天室。该聊天室允许用户发送和接收消息，并在界面上实时展示消息内容。\n1.2.核心技术栈 NestJS：基于 Node.js 构建的渐进式框架，专注于高效的服务端开发，提供了易于维护和扩展的架构。 WebSocket：实现实时通信的协议，允许客户端与服务端之间进行双向通信，适用于实时应用。 Vue 3：现代化的渐进式前端框架，具有响应式数据绑定、组件化等特性，用于构建灵活且高效的前端应用。 Better Scroll：前端界面用于处理滚动体验，提升消息框在多条消息情况下的滚动性能。 TypeScript：全栈代码都采用 TypeScript，提升开发体验、代码可维护性与类型安全性。 1.3.功能特色 实时消息：通过 WebSocket 实现的实时通信功能，用户可以即时发送和接收消息，体验无延迟的互动。 消息同步：不同客户端之间的消息能够保持一致，无论是加入聊天或发送消息，都能立刻看到最新消息。 个人与其他消息区分：聊天窗口中，用户的消息和他人的消息有明确区分，确保清晰的交互体验。 滚动条优化：使用 Better Scroll 管理聊天窗口的滚动，实现流畅的滚动体验和自动滚动到底部功能。 简单直观的前端界面：基于 Vue 3，前端界面简洁直观，便于用户快速上手。 1.4.项目目标 通过这个最简的聊天室项目，理解前后端分离架构的开发流程。 学习如何在 NestJS 中使用 WebSocket 实现实时消息的推送与接收。 掌握 Vue 3 中响应式数据绑定和组件化开发的核心理念。 探索如何利用 Better Scroll 实现用户友好的滚动体验。 1.5.适合人群 想学习如何使用 NestJS 和 Vue 3 开发实时应用的开发者。 有兴趣了解 WebSocket 的使用场景和技术细节的初学者。 想要构建一个具备前后端实时交互的最简应用并巩固全栈开发能力的工程师。 2.项目结构 在开始构建聊天室之前，我们需要了解项目的基本结构，确保每个部分都清晰明了。整个项目将分为前端 (Vue 3) 和后端 (NestJS)，各自负责不同的功能：\n2.1. 前端 (Vue 3) src/ : 包含 Vue 3 组件和页面的目录。\ncomponents/ : Vue 组件目录，包含聊天界面的核心组件（如消息列表、输入框等）。 views/ : 应用的视图文件，如聊天室页面。 assets/ : 存放项目所需的图片、图标等静态资源。 App.vue: 应用的根组件，包含基础布局和全局状态的处理。 main.ts: 项目的入口文件，初始化 Vue 应用及相关插件。 依赖库\nbetter-scroll: 用于处理聊天窗口的滚动效果。 socket.io-client: 用于与服务器进行实时通信。 2.2. 后端 (NestJS) src/ : NestJS 的核心逻辑所在，包含控制器、服务和模块。\nmessages/ : 聊天功能的核心逻辑，包含 WebSocket 网关、消息处理等。\nmessages.gateway.ts: WebSocket 网关，处理前端发送的消息并广播给所有用户。 messages.service.ts: 聊天服务，负责消息存储及处理。 messages.module.ts: 聊天功能的模块化配置。 app.module.ts: 应用的主模块，集成所有功能模块。\n依赖库\n@nestjs/websockets: 用于后端处理 WebSocket 连接，提供实时的消息推送。 @nestjs/platform-socket.io: 提供实时的消息推送。 3.关键功能实现 3.1. 后端实现 - WebSocket 聊天服务 在 messages.gateway.ts 中创建 WebSocket 网关，监听连接和消息：\ntypescript\n代码解读\n复制代码\nimport { WebSocketGateway, SubscribeMessage, MessageBody, WebSocketServer, ConnectedSocket, } from '@nestjs/websockets'; import { Server, Socket } from 'socket.io'; import { MessagesService } from './messages.service'; import { CreateMessageDto } from './dto/create-message.dto'; @WebSocketGateway({ cors: { origin: '*' }, }) export class MessagesGateway { constructor(private readonly messagesService: MessagesService) {} // 获取socket.io 实例 @WebSocketServer() server: Server; @SubscribeMessage('createMessage') async create( @MessageBody() createMessageDto: CreateMessageDto, @ConnectedSocket() client: Socket, ) { const message = await this.messagesService.create( createMessageDto, client.id, ); // 向所有客户端发送消息 this.server.emit('message', message); return message; } @SubscribeMessage('findAllMessages') findAll() { return this.messagesService.findAll(); } @SubscribeMessage('join') joinRoom( @MessageBody('name') name: string, @ConnectedSocket() client: Socket, ) { return this.messagesService.identify(name, client.id); } @SubscribeMessage('typing') async typing( @MessageBody('isTyping') isTyping: boolean, @ConnectedSocket() client: Socket, ) { return this.messagesService.typing(isTyping, client); } }\n3.2. 前端实现 - WebSocket 连接 在 chat-client 项目的 app.vue 中，初始化 WebSocket 客户端并在 Vue 组件中监听和发送消息：\ntypescript\n代码解读\n复制代码\nimport { io } from 'socket.io-client'; const socket = io('http://localhost:3001'); // 发送消息 function sendMessage(message) { socket.emit('sendMessage', message); } // 接收消息 socket.on('receiveMessage', (message) =\u003e { // 更新消息列表 });\n到此为止，你可以让前后端通过 WebSocket 实现实时通信，接下来你可以继续实现消息的发送、展示和聊天记录等功能。\n3.3. 前端实现 - 消息列表与滚动功能 为确保聊天窗口始终展示最新消息，我们可以使用 Better Scroll 实现自动滚动到底部的效果：\nhtml\n代码解读\n复制代码\n{{ message.text }} {{ message.name }}/ {{ message.timestamp }} typescript\n代码解读\n复制代码\nimport BScroll from '@better-scroll/core'; import MouseWheel from '@better-scroll/mouse-wheel'; import Scrollbar from '@better-scroll/scroll-bar'; const scroll = ref(null); BScroll.use(MouseWheel); BScroll.use(Scrollbar); const bs = ref(null); const messagesContent = ref(null); const initializeScroll = async () =\u003e { nextTick(() =\u003e { if (messagesContent.value) { bs.value = new BScroll(messagesContent.value, { scrollY: true, mouseWheel: { speed: 6, invert: false, easeTime: 800 }, scrollbar: { interactive: true, // 允许交互 fade: true, // 滚动条淡入淡出 }, click: true, bounce: false }); } }) }; const updateScroll = () =\u003e { nextTick(() =\u003e { if (bs.value) { bs.value.refresh(); // 获取最后一个消息元素 const lastMessage = messagesContent.value.querySelector('.message:last-child'); if (lastMessage) { // 使用 scrollToElement 方法滚动到最后一个消息 bs.value.scrollToElement(lastMessage, 100); // 100ms 滚动时间 } } }) }; const initScroll = () =\u003e { nextTick(() =\u003e { if (bs.value) { bs.value.refresh(); bs.value.scrollTo(0, bs.value.minScrollX, 100); // 100ms 滚动时间 } }) };\n3.4. 用户身份管理 区分用户消息 为了区分不同用户的消息，你可以通过设置 message 数据结构中加入 id 字段，结合加入聊天室时的用户userId来区分发送者是否为当前用户，从而在样式上做出不同的展示。\nhtml\n代码解读\n复制代码\n{{ message.text }} {{ message.name }}/ {{ message.timestamp }} 通过当前发消息人的id与当前userId匹配来给出不同样式 message message-personal new或message new来展示当前发送用户消息和其他用户消息展示\ntypescript\n代码解读\n复制代码\nsocket.on('message', (message) =\u003e { if (message.id === userId.value) { message.className = 'message message-personal new' } else { message.className = 'message new' } messagesArray.value.push(message) updateScroll() })\ncss\n代码解读\n复制代码\n`.message { clear: both; float: left; padding: 6px 10px 7px; border-radius: 10px 10px 10px 0; background: rgba(0, 0, 0, 0.3); margin: 8px 0; font-size: 11px; line-height: 1.4; margin-left: 35px; position: relative; text-shadow: 0 1px 1px rgba(0, 0, 0, 0.2); \u0026.message-personal { float: right; color: #fff; text-align: right; background: linear-gradient(120deg, #248a52, #257287); border-radius: 10px 10px 0 10px; \u0026::before { left: auto; right: 0; border-right: none; border-left: 5px solid transparent; border-top: 4px solid #257287; bottom: -4px; } }` 3.5. 发送消息优化 可以进一步优化用户发送消息的体验，例如：\n防止重复发送：用户按下回车键时，如果输入框为空则不发送消息。 输入时显示“正在输入” ：当用户输入消息时，其他用户看到聊天框中的loading效果。 输入检测与提示 html\n代码解读\n复制代码\nSend typescript\n代码解读\n复制代码\nconst emitTyping = () =\u003e { socket.emit('typing', { isTyping: true }) if (newMessage.value.trim() === '') { socket.emit('typing', { isTyping: false }) } } socket.on('typing', ({ name, isTyping, id }) =\u003e { const one = messagesArray.value.find(item =\u003e item.id === id \u0026\u0026 item.text === '') if (id !== userId.value \u0026\u0026 isTyping \u0026\u0026 !one) { messagesArray.value.push({ id, text: '', name, className: 'message loading new', timestamp: getTimestamp() }) } if (id !== userId.value \u0026\u0026 !isTyping) { const index = messagesArray.value.findIndex(item =\u003e item.id === id \u0026\u0026 item.text === ''); if (index !== -1) { messagesArray.value.splice(index, 1); // 删除匹配的元素 } } updateScroll() })\ncss\n代码解读\n复制代码\n\u0026.loading { \u0026::before { @include ball; border: none; animation-delay: 0.15s; } \u0026 span { display: block; font-size: 0; width: 20px; height: 10px; position: relative; \u0026::before { @include ball; margin-left: -7px; } \u0026::after { @include ball; margin-left: 7px; animation-delay: 0.3s; } } }\n项目展示 5.待完善… 消息历史与持久化 当前项目消息只是存在内存数组当中，可以拓展至存数据库中\n用户状态展示 样式交互优化… 项目地址 github\n",
  "wordCount" : "830",
  "inLanguage": "zh",
  "image": "http://localhost:1313/images/papermod-cover.png","datePublished": "2024-09-27T00:00:00Z",
  "dateModified": "2024-09-27T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "chen77"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://localhost:1313/posts/juejin/nestjs+vue3%E6%89%93%E9%80%A0%E4%B8%80%E4%B8%AA%E6%9C%80%E7%AE%80socket.io%E8%81%8A%E5%A4%A9%E5%AE%A4/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "PaperMod",
    "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:1313/%3Clink%20/%20abs%20url%3E"
    }
  }
}
</script>
</head>

<body class=" dark" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="Home (Alt + H)">
                        
                    <img src="http://localhost:1313/images/msg_hu15231257772499651944.png" alt="" aria-label="logo"
                        height="20">Home</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/archives" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://github.com/adityatelange/hugo-PaperMod/wiki/" title="WiKi">
                    <span>WiKi</span>&nbsp;
                    <svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round"
                        stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12">
                        <path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"></path>
                        <path d="M15 3h6v6"></path>
                        <path d="M10 14L21 3"></path>
                    </svg>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://localhost:1313/">主页</a>&nbsp;»&nbsp;<a href="http://localhost:1313/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      nestjs&#43;vue3打造一个最简socket.io聊天室
    </h1>
    <div class="post-description">
      1.介绍1.1.项目概述本项目是一个基于NestJS和Vue3的最简聊天室应用。通过这个项目，你将学习如何将前端和后端结合，构建一个具备实时通信功能的聊天室。该聊天室允许用户发送和接收消
    </div>
    <div class="post-meta"><span title='2024-09-27 00:00:00 +0000 UTC'>九月 27, 2024</span>&nbsp;·&nbsp;4 分钟&nbsp;·&nbsp;chen77&nbsp;|&nbsp;<a href="https://github.com/WangShaoyu1/myBlogPaperMod/tree/master/content/posts/jueJin/nestjs&#43;vue3%e6%89%93%e9%80%a0%e4%b8%80%e4%b8%aa%e6%9c%80%e7%ae%80socket.io%e8%81%8a%e5%a4%a9%e5%ae%a4.md" rel="noopener noreferrer" target="_blank">Suggest Changes</a>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">目录</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#1%e4%bb%8b%e7%bb%8d" aria-label="1.介绍">1.介绍</a><ul>
                        
                <li>
                    <a href="#11%e9%a1%b9%e7%9b%ae%e6%a6%82%e8%bf%b0" aria-label="1.1.项目概述">1.1.项目概述</a></li>
                <li>
                    <a href="#12%e6%a0%b8%e5%bf%83%e6%8a%80%e6%9c%af%e6%a0%88" aria-label="1.2.核心技术栈">1.2.核心技术栈</a></li>
                <li>
                    <a href="#13%e5%8a%9f%e8%83%bd%e7%89%b9%e8%89%b2" aria-label="1.3.功能特色">1.3.功能特色</a></li>
                <li>
                    <a href="#14%e9%a1%b9%e7%9b%ae%e7%9b%ae%e6%a0%87" aria-label="1.4.项目目标">1.4.项目目标</a></li>
                <li>
                    <a href="#15%e9%80%82%e5%90%88%e4%ba%ba%e7%be%a4" aria-label="1.5.适合人群">1.5.适合人群</a></li></ul>
                </li>
                <li>
                    <a href="#2%e9%a1%b9%e7%9b%ae%e7%bb%93%e6%9e%84" aria-label="2.项目结构">2.项目结构</a><ul>
                        <ul>
                        <ul>
                        
                <li>
                    <a href="#21-%e5%89%8d%e7%ab%af-vue-3" aria-label="2.1. 前端 (Vue 3)">2.1. 前端 (Vue 3)</a></li>
                <li>
                    <a href="#22-%e5%90%8e%e7%ab%af-nestjs" aria-label="2.2. 后端 (NestJS)">2.2. 后端 (NestJS)</a></li></ul>
                    </ul>
                    </ul>
                </li>
                <li>
                    <a href="#3%e5%85%b3%e9%94%ae%e5%8a%9f%e8%83%bd%e5%ae%9e%e7%8e%b0" aria-label="3.关键功能实现">3.关键功能实现</a><ul>
                        <ul>
                        <ul>
                        
                <li>
                    <a href="#31-%e5%90%8e%e7%ab%af%e5%ae%9e%e7%8e%b0---websocket-%e8%81%8a%e5%a4%a9%e6%9c%8d%e5%8a%a1" aria-label="3.1. 后端实现 - WebSocket 聊天服务">3.1. 后端实现 - WebSocket 聊天服务</a></li>
                <li>
                    <a href="#32-%e5%89%8d%e7%ab%af%e5%ae%9e%e7%8e%b0---websocket-%e8%bf%9e%e6%8e%a5" aria-label="3.2. 前端实现 - WebSocket 连接">3.2. 前端实现 - WebSocket 连接</a></li>
                <li>
                    <a href="#33-%e5%89%8d%e7%ab%af%e5%ae%9e%e7%8e%b0---%e6%b6%88%e6%81%af%e5%88%97%e8%a1%a8%e4%b8%8e%e6%bb%9a%e5%8a%a8%e5%8a%9f%e8%83%bd" aria-label="3.3. 前端实现 - 消息列表与滚动功能">3.3. 前端实现 - 消息列表与滚动功能</a></li></ul>
                    
                <li>
                    <a href="#34-%e7%94%a8%e6%88%b7%e8%ba%ab%e4%bb%bd%e7%ae%a1%e7%90%86" aria-label="3.4. 用户身份管理">3.4. 用户身份管理</a><ul>
                        
                <li>
                    <a href="#%e5%8c%ba%e5%88%86%e7%94%a8%e6%88%b7%e6%b6%88%e6%81%af" aria-label="区分用户消息">区分用户消息</a></li></ul>
                </li>
                <li>
                    <a href="#35-%e5%8f%91%e9%80%81%e6%b6%88%e6%81%af%e4%bc%98%e5%8c%96" aria-label="3.5. 发送消息优化">3.5. 发送消息优化</a><ul>
                        
                <li>
                    <a href="#%e8%be%93%e5%85%a5%e6%a3%80%e6%b5%8b%e4%b8%8e%e6%8f%90%e7%a4%ba" aria-label="输入检测与提示">输入检测与提示</a></li></ul>
                </li></ul>
                    </ul>
                </li>
                <li>
                    <a href="#%e9%a1%b9%e7%9b%ae%e5%b1%95%e7%a4%ba" aria-label="项目展示">项目展示</a></li>
                <li>
                    <a href="#5%e5%be%85%e5%ae%8c%e5%96%84" aria-label="5.待完善&hellip;">5.待完善&hellip;</a><ul>
                        
                <li>
                    <a href="#%e6%b6%88%e6%81%af%e5%8e%86%e5%8f%b2%e4%b8%8e%e6%8c%81%e4%b9%85%e5%8c%96" aria-label="消息历史与持久化">消息历史与持久化</a></li>
                <li>
                    <a href="#%e7%94%a8%e6%88%b7%e7%8a%b6%e6%80%81%e5%b1%95%e7%a4%ba-%e6%a0%b7%e5%bc%8f%e4%ba%a4%e4%ba%92%e4%bc%98%e5%8c%96" aria-label="用户状态展示 样式交互优化&hellip;">用户状态展示 样式交互优化&hellip;</a></li></ul>
                </li>
                <li>
                    <a href="#%e9%a1%b9%e7%9b%ae%e5%9c%b0%e5%9d%80" aria-label="项目地址">项目地址</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h2 id="1介绍">1.介绍<a hidden class="anchor" aria-hidden="true" href="#1介绍">#</a></h2>
<h3 id="11项目概述">1.1.项目概述<a hidden class="anchor" aria-hidden="true" href="#11项目概述">#</a></h3>
<p>本项目是一个基于 <strong>NestJS</strong> 和 <strong>Vue 3</strong> 的最简聊天室应用。通过这个项目，你将学习如何将前端和后端结合，构建一个具备实时通信功能的聊天室。该聊天室允许用户发送和接收消息，并在界面上实时展示消息内容。</p>
<h3 id="12核心技术栈">1.2.核心技术栈<a hidden class="anchor" aria-hidden="true" href="#12核心技术栈">#</a></h3>
<ol>
<li><strong>NestJS</strong>：基于 Node.js 构建的渐进式框架，专注于高效的服务端开发，提供了易于维护和扩展的架构。</li>
<li><strong>WebSocket</strong>：实现实时通信的协议，允许客户端与服务端之间进行双向通信，适用于实时应用。</li>
<li><strong>Vue 3</strong>：现代化的渐进式前端框架，具有响应式数据绑定、组件化等特性，用于构建灵活且高效的前端应用。</li>
<li><strong>Better Scroll</strong>：前端界面用于处理滚动体验，提升消息框在多条消息情况下的滚动性能。</li>
<li><strong>TypeScript</strong>：全栈代码都采用 TypeScript，提升开发体验、代码可维护性与类型安全性。</li>
</ol>
<h3 id="13功能特色">1.3.功能特色<a hidden class="anchor" aria-hidden="true" href="#13功能特色">#</a></h3>
<ul>
<li><strong>实时消息</strong>：通过 WebSocket 实现的实时通信功能，用户可以即时发送和接收消息，体验无延迟的互动。</li>
<li><strong>消息同步</strong>：不同客户端之间的消息能够保持一致，无论是加入聊天或发送消息，都能立刻看到最新消息。</li>
<li><strong>个人与其他消息区分</strong>：聊天窗口中，用户的消息和他人的消息有明确区分，确保清晰的交互体验。</li>
<li><strong>滚动条优化</strong>：使用 Better Scroll 管理聊天窗口的滚动，实现流畅的滚动体验和自动滚动到底部功能。</li>
<li><strong>简单直观的前端界面</strong>：基于 Vue 3，前端界面简洁直观，便于用户快速上手。</li>
</ul>
<h3 id="14项目目标">1.4.项目目标<a hidden class="anchor" aria-hidden="true" href="#14项目目标">#</a></h3>
<ul>
<li>通过这个最简的聊天室项目，理解前后端分离架构的开发流程。</li>
<li>学习如何在 NestJS 中使用 WebSocket 实现实时消息的推送与接收。</li>
<li>掌握 Vue 3 中响应式数据绑定和组件化开发的核心理念。</li>
<li>探索如何利用 Better Scroll 实现用户友好的滚动体验。</li>
</ul>
<h3 id="15适合人群">1.5.适合人群<a hidden class="anchor" aria-hidden="true" href="#15适合人群">#</a></h3>
<ul>
<li>想学习如何使用 <strong>NestJS</strong> 和 <strong>Vue 3</strong> 开发实时应用的开发者。</li>
<li>有兴趣了解 <strong>WebSocket</strong> 的使用场景和技术细节的初学者。</li>
<li>想要构建一个具备前后端实时交互的最简应用并巩固全栈开发能力的工程师。</li>
</ul>
<h2 id="2项目结构">2.项目结构<a hidden class="anchor" aria-hidden="true" href="#2项目结构">#</a></h2>
<p>在开始构建聊天室之前，我们需要了解项目的基本结构，确保每个部分都清晰明了。整个项目将分为前端 (Vue 3) 和后端 (NestJS)，各自负责不同的功能：</p>
<h5 id="21-前端-vue-3">2.1. <strong>前端 (Vue 3)</strong><a hidden class="anchor" aria-hidden="true" href="#21-前端-vue-3">#</a></h5>
<ul>
<li>
<p><strong><code>src/</code></strong> : 包含 Vue 3 组件和页面的目录。</p>
<ul>
<li><strong><code>components/</code></strong> : Vue 组件目录，包含聊天界面的核心组件（如消息列表、输入框等）。</li>
<li><strong><code>views/</code></strong> : 应用的视图文件，如聊天室页面。</li>
<li><strong><code>assets/</code></strong> : 存放项目所需的图片、图标等静态资源。</li>
<li><strong><code>App.vue</code></strong>: 应用的根组件，包含基础布局和全局状态的处理。</li>
<li><strong><code>main.ts</code></strong>: 项目的入口文件，初始化 Vue 应用及相关插件。</li>
</ul>
</li>
<li>
<p><strong>依赖库</strong></p>
<ul>
<li><strong>better-scroll</strong>: 用于处理聊天窗口的滚动效果。</li>
<li><strong>socket.io-client</strong>: 用于与服务器进行实时通信。</li>
</ul>
</li>
</ul>
<h5 id="22-后端-nestjs">2.2. <strong>后端 (NestJS)</strong><a hidden class="anchor" aria-hidden="true" href="#22-后端-nestjs">#</a></h5>
<ul>
<li>
<p><strong><code>src/</code></strong> : NestJS 的核心逻辑所在，包含控制器、服务和模块。</p>
<ul>
<li>
<p><strong><code>messages/</code></strong> : 聊天功能的核心逻辑，包含 WebSocket 网关、消息处理等。</p>
<ul>
<li><strong><code>messages.gateway.ts</code></strong>: WebSocket 网关，处理前端发送的消息并广播给所有用户。</li>
<li><strong><code>messages.service.ts</code></strong>: 聊天服务，负责消息存储及处理。</li>
<li><strong><code>messages.module.ts</code></strong>: 聊天功能的模块化配置。</li>
</ul>
</li>
<li>
<p><strong><code>app.module.ts</code></strong>: 应用的主模块，集成所有功能模块。</p>
</li>
</ul>
</li>
<li>
<p><strong>依赖库</strong></p>
<ul>
<li><strong>@nestjs/websockets</strong>: 用于后端处理 WebSocket 连接，提供实时的消息推送。</li>
<li><strong>@nestjs/platform-socket.io</strong>: 提供实时的消息推送。</li>
</ul>
</li>
</ul>
<h2 id="3关键功能实现">3.关键功能实现<a hidden class="anchor" aria-hidden="true" href="#3关键功能实现">#</a></h2>
<h5 id="31-后端实现---websocket-聊天服务">3.1. <strong>后端实现 - WebSocket 聊天服务</strong><a hidden class="anchor" aria-hidden="true" href="#31-后端实现---websocket-聊天服务">#</a></h5>
<p>在 <code>messages.gateway.ts</code> 中创建 WebSocket 网关，监听连接和消息：</p>
<p>typescript</p>
<p>代码解读</p>
<p>复制代码</p>
<p><code>import {   WebSocketGateway,   SubscribeMessage,   MessageBody,   WebSocketServer,   ConnectedSocket, } from '@nestjs/websockets'; import { Server, Socket } from 'socket.io'; import { MessagesService } from './messages.service'; import { CreateMessageDto } from './dto/create-message.dto'; @WebSocketGateway({   cors: { origin: '*' }, }) export class MessagesGateway {   constructor(private readonly messagesService: MessagesService) {}   // 获取socket.io 实例   @WebSocketServer()   server: Server;   @SubscribeMessage('createMessage')   async create(     @MessageBody() createMessageDto: CreateMessageDto,     @ConnectedSocket() client: Socket,   ) {     const message = await this.messagesService.create(       createMessageDto,       client.id,     );     // 向所有客户端发送消息     this.server.emit('message', message);     return message;   }   @SubscribeMessage('findAllMessages')   findAll() {     return this.messagesService.findAll();   }   @SubscribeMessage('join')   joinRoom(     @MessageBody('name') name: string,     @ConnectedSocket() client: Socket,   ) {     return this.messagesService.identify(name, client.id);   }   @SubscribeMessage('typing')   async typing(     @MessageBody('isTyping') isTyping: boolean,     @ConnectedSocket() client: Socket,   ) {     return this.messagesService.typing(isTyping, client);   } }</code></p>
<h5 id="32-前端实现---websocket-连接">3.2. <strong>前端实现 - WebSocket 连接</strong><a hidden class="anchor" aria-hidden="true" href="#32-前端实现---websocket-连接">#</a></h5>
<p>在 <code>chat-client</code> 项目的 <code>app.vue</code> 中，初始化 WebSocket 客户端并在 Vue 组件中监听和发送消息：</p>
<p>typescript</p>
<p>代码解读</p>
<p>复制代码</p>
<p><code>import { io } from 'socket.io-client'; const socket = io('http://localhost:3001'); // 发送消息 function sendMessage(message) {   socket.emit('sendMessage', message); } // 接收消息 socket.on('receiveMessage', (message) =&gt; {   // 更新消息列表 });</code></p>
<hr>
<p>到此为止，你可以让前后端通过 WebSocket 实现实时通信，接下来你可以继续实现消息的发送、展示和聊天记录等功能。</p>
<h5 id="33-前端实现---消息列表与滚动功能">3.3. <strong>前端实现 - 消息列表与滚动功能</strong><a hidden class="anchor" aria-hidden="true" href="#33-前端实现---消息列表与滚动功能">#</a></h5>
<p>为确保聊天窗口始终展示最新消息，我们可以使用 <code>Better Scroll</code> 实现自动滚动到底部的效果：</p>
<p>html</p>
<p>代码解读</p>
<p>复制代码</p>
<p><code>&lt;div class=&quot;messages&quot; ref=&quot;messages&quot;&gt;       &lt;div class=&quot;messages-box&quot; ref=&quot;messagesContent&quot;&gt;         &lt;div class=&quot;messages-content&quot;&gt;           &lt;div v-for=&quot;(message, index) in messagesArray&quot; :key=&quot;index&quot; :class=&quot;message.className&quot;&gt;             &lt;figure class=&quot;avatar&quot; v-if=&quot;message.className !== 'message message-personal new'&quot;&gt;               &lt;img src=&quot;./assets/imgs/default-icon2.png&quot; /&gt;             &lt;/figure&gt;             &lt;span&gt;{{ message.text }}&lt;/span&gt;             &lt;div class=&quot;timestamp&quot;&gt;               &lt;i&gt;{{ message.name }}/&lt;/i&gt;               &lt;i&gt; {{ message.timestamp }}&lt;/i&gt;             &lt;/div&gt;           &lt;/div&gt;         &lt;/div&gt;       &lt;/div&gt;     &lt;/div&gt;</code></p>
<p>typescript</p>
<p>代码解读</p>
<p>复制代码</p>
<p><code>import BScroll from '@better-scroll/core'; import MouseWheel from '@better-scroll/mouse-wheel'; import Scrollbar from '@better-scroll/scroll-bar'; const scroll = ref(null); BScroll.use(MouseWheel); BScroll.use(Scrollbar); const bs = ref(null); const messagesContent = ref(null); const initializeScroll = async () =&gt; {   nextTick(() =&gt; {     if (messagesContent.value) {       bs.value = new BScroll(messagesContent.value, {         scrollY: true,         mouseWheel: {           speed: 6,           invert: false,           easeTime: 800         },         scrollbar: {           interactive: true, // 允许交互           fade: true, // 滚动条淡入淡出         },         click: true,         bounce: false       });     }   }) }; const updateScroll = () =&gt; {   nextTick(() =&gt; {     if (bs.value) {       bs.value.refresh();       // 获取最后一个消息元素       const lastMessage = messagesContent.value.querySelector('.message:last-child');       if (lastMessage) {         // 使用 scrollToElement 方法滚动到最后一个消息         bs.value.scrollToElement(lastMessage, 100); // 100ms 滚动时间       }     }   }) }; const initScroll = () =&gt; {   nextTick(() =&gt; {     if (bs.value) {       bs.value.refresh();       bs.value.scrollTo(0, bs.value.minScrollX, 100); // 100ms 滚动时间     }   }) };</code></p>
<h4 id="34-用户身份管理">3.4. <strong>用户身份管理</strong><a hidden class="anchor" aria-hidden="true" href="#34-用户身份管理">#</a></h4>
<h5 id="区分用户消息">区分用户消息<a hidden class="anchor" aria-hidden="true" href="#区分用户消息">#</a></h5>
<p>为了区分不同用户的消息，你可以通过设置 <code>message</code> 数据结构中加入 <code>id</code> 字段，结合加入聊天室时的用户<code>userId</code>来区分发送者是否为当前用户，从而在样式上做出不同的展示。</p>
<p>html</p>
<p>代码解读</p>
<p>复制代码</p>
<p><code>&lt;div class=&quot;messages&quot; ref=&quot;messages&quot;&gt;       &lt;div class=&quot;messages-box&quot; ref=&quot;messagesContent&quot;&gt;         &lt;div class=&quot;messages-content&quot;&gt;           &lt;div v-for=&quot;(message, index) in messagesArray&quot; :key=&quot;index&quot; :class=&quot;message.className&quot;&gt;             &lt;figure class=&quot;avatar&quot; v-if=&quot;message.className !== 'message message-personal new'&quot;&gt;               &lt;img src=&quot;./assets/imgs/default-icon2.png&quot; /&gt;             &lt;/figure&gt;             &lt;span&gt;{{ message.text }}&lt;/span&gt;             &lt;div class=&quot;timestamp&quot;&gt;               &lt;i&gt;{{ message.name }}/&lt;/i&gt;               &lt;i&gt; {{ message.timestamp }}&lt;/i&gt;             &lt;/div&gt;           &lt;/div&gt;         &lt;/div&gt;       &lt;/div&gt;     &lt;/div&gt;</code></p>
<p>通过当前发消息人的<code>id</code>与当前<code>userId</code>匹配来给出不同样式 <code>message message-personal new</code>或<code>message new</code>来展示当前发送用户消息和其他用户消息展示</p>
<p>typescript</p>
<p>代码解读</p>
<p>复制代码</p>
<p><code>socket.on('message', (message) =&gt; {       if (message.id === userId.value) {         message.className = 'message message-personal new'       } else {         message.className = 'message new'       }       messagesArray.value.push(message)       updateScroll()     })</code></p>
<p>css</p>
<p>代码解读</p>
<p>复制代码</p>
<pre><code>`.message {       clear: both;       float: left;       padding: 6px 10px 7px;       border-radius: 10px 10px 10px 0;       background: rgba(0, 0, 0, 0.3);       margin: 8px 0;       font-size: 11px;       line-height: 1.4;       margin-left: 35px;       position: relative;       text-shadow: 0 1px 1px rgba(0, 0, 0, 0.2);     &amp;.message-personal {         float: right;         color: #fff;         text-align: right;         background: linear-gradient(120deg, #248a52, #257287);         border-radius: 10px 10px 0 10px;         &amp;::before {           left: auto;           right: 0;           border-right: none;           border-left: 5px solid transparent;           border-top: 4px solid #257287;           bottom: -4px;         }       }`
</code></pre>
<h4 id="35-发送消息优化">3.5. <strong>发送消息优化</strong><a hidden class="anchor" aria-hidden="true" href="#35-发送消息优化">#</a></h4>
<p>可以进一步优化用户发送消息的体验，例如：</p>
<ul>
<li><strong>防止重复发送</strong>：用户按下回车键时，如果输入框为空则不发送消息。</li>
<li><strong>输入时显示“正在输入”</strong> ：当用户输入消息时，其他用户看到聊天框中的loading效果。</li>
</ul>
<h5 id="输入检测与提示">输入检测与提示<a hidden class="anchor" aria-hidden="true" href="#输入检测与提示">#</a></h5>
<p><img loading="lazy" src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b27cdc40ad5a49ddb2a38dcbb323a462~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY2hlbjc3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1728028846&amp;x-signature=90g6pXyCuIzU40s2tx%2FGJiIlrWc%3D" alt="Capturer_2024-09-27_145007_465.gif"  />
</p>
<p>html</p>
<p>代码解读</p>
<p>复制代码</p>
<p><code>&lt;div class=&quot;message-box&quot;&gt;       &lt;textarea v-model=&quot;newMessage&quot; type=&quot;text&quot; class=&quot;message-input&quot; placeholder=&quot;Type message...&quot;         @input=&quot;emitTyping&quot;&gt;&lt;/textarea&gt;       &lt;button type=&quot;submit&quot; class=&quot;message-submit&quot; @click=&quot;sendMessage&quot;&gt;         Send       &lt;/button&gt;     &lt;/div&gt;</code></p>
<p>typescript</p>
<p>代码解读</p>
<p>复制代码</p>
<p><code>const emitTyping = () =&gt; {   socket.emit('typing', { isTyping: true })   if (newMessage.value.trim() === '') {     socket.emit('typing', { isTyping: false })   } } socket.on('typing', ({ name, isTyping, id }) =&gt; {       const one = messagesArray.value.find(item =&gt; item.id === id &amp;&amp; item.text === '')       if (id !== userId.value &amp;&amp; isTyping &amp;&amp; !one) {         messagesArray.value.push({ id, text: '', name, className: 'message loading new', timestamp: getTimestamp() })       }       if (id !== userId.value &amp;&amp; !isTyping) {         const index = messagesArray.value.findIndex(item =&gt; item.id === id &amp;&amp; item.text === '');         if (index !== -1) {           messagesArray.value.splice(index, 1);  // 删除匹配的元素         }       }       updateScroll()     })</code></p>
<p>css</p>
<p>代码解读</p>
<p>复制代码</p>
<p><code>&amp;.loading {         &amp;::before {           @include ball;           border: none;           animation-delay: 0.15s;         }         &amp; span {           display: block;           font-size: 0;           width: 20px;           height: 10px;           position: relative;           &amp;::before {             @include ball;             margin-left: -7px;           }           &amp;::after {             @include ball;             margin-left: 7px;             animation-delay: 0.3s;           }         }       }</code></p>
<h2 id="项目展示">项目展示<a hidden class="anchor" aria-hidden="true" href="#项目展示">#</a></h2>
<p><img loading="lazy" src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b637ada863314c0699860c41ff668abe~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY2hlbjc3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1728028846&amp;x-signature=mycwupEeq5xZvfwNn1ao%2B3g6xPw%3D" alt="image.png"  />
</p>
<p><img loading="lazy" src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/62e90d6fc56146f2a4110f04e220f012~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY2hlbjc3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1728028846&amp;x-signature=ZcQE6KzJF2sGB8ho%2F3f3JPJ8FZc%3D" alt="image.png"  />
</p>
<p><img loading="lazy" src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f7894dfb39ce40f987991ba102c0e979~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY2hlbjc3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1728028846&amp;x-signature=YuV7mq7DnyCEw1j9gU%2FqF5KfMF4%3D" alt="Capturer_2024-09-27_155534_256.gif"  />
</p>
<h2 id="5待完善">5.待完善&hellip;<a hidden class="anchor" aria-hidden="true" href="#5待完善">#</a></h2>
<h3 id="消息历史与持久化">消息历史与持久化<a hidden class="anchor" aria-hidden="true" href="#消息历史与持久化">#</a></h3>
<p>当前项目消息只是存在内存数组当中，可以拓展至存数据库中</p>
<h3 id="用户状态展示-样式交互优化">用户状态展示 样式交互优化&hellip;<a hidden class="anchor" aria-hidden="true" href="#用户状态展示-样式交互优化">#</a></h3>
<h2 id="项目地址">项目地址<a hidden class="anchor" aria-hidden="true" href="#项目地址">#</a></h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fcheen77%2Fnotes-of-nestjs%2Ftree%2Fmain%2F6-websocket" title="https://github.com/cheen77/notes-of-nestjs/tree/main/6-websocket">github</a></p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/tags/%E5%89%8D%E7%AB%AF/">前端</a></li>
      <li><a href="http://localhost:1313/tags/node.js/">Node.js</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="http://localhost:1313/posts/juejin/%E7%B5%A6%E7%A5%96%E5%9B%BD%E5%A6%88%E5%A6%88%E5%BA%86%E7%94%9F%E7%94%A8unicloud%E4%BA%91%E5%BC%80%E5%8F%91%E5%A4%B4%E5%83%8F%E6%A1%86%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%BB%99%E8%87%AA%E5%B7%B1%E7%9A%84%E5%A4%B4%E5%83%8F%E5%8A%A0%E4%B8%8A%E5%9B%BD%E6%97%97%E5%90%A7/">
    <span class="title">« 上一页</span>
    <br>
    <span>【給祖国妈妈庆生】用uniCloud云开发头像框小程序给自己的头像加上国旗吧</span>
  </a>
  <a class="next" href="http://localhost:1313/posts/juejin/android%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E8%B6%85%E7%BA%A7%E6%A3%92%E7%9A%84%E6%B2%89%E6%B5%B8%E5%BC%8F%E4%BD%93%E9%AA%8C/">
    <span class="title">下一页 »</span>
    <br>
    <span>Android如何实现超级棒的沉浸式体验</span>
  </a>
</nav>


<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share nestjs&#43;vue3打造一个最简socket.io聊天室 on x"
            href="https://x.com/intent/tweet/?text=nestjs%2bvue3%e6%89%93%e9%80%a0%e4%b8%80%e4%b8%aa%e6%9c%80%e7%ae%80socket.io%e8%81%8a%e5%a4%a9%e5%ae%a4&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fjuejin%2fnestjs%2bvue3%25E6%2589%2593%25E9%2580%25A0%25E4%25B8%2580%25E4%25B8%25AA%25E6%259C%2580%25E7%25AE%2580socket.io%25E8%2581%258A%25E5%25A4%25A9%25E5%25AE%25A4%2f&amp;hashtags=%e5%89%8d%e7%ab%af%2cNode.js">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share nestjs&#43;vue3打造一个最简socket.io聊天室 on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fjuejin%2fnestjs%2bvue3%25E6%2589%2593%25E9%2580%25A0%25E4%25B8%2580%25E4%25B8%25AA%25E6%259C%2580%25E7%25AE%2580socket.io%25E8%2581%258A%25E5%25A4%25A9%25E5%25AE%25A4%2f&amp;title=nestjs%2bvue3%e6%89%93%e9%80%a0%e4%b8%80%e4%b8%aa%e6%9c%80%e7%ae%80socket.io%e8%81%8a%e5%a4%a9%e5%ae%a4&amp;summary=nestjs%2bvue3%e6%89%93%e9%80%a0%e4%b8%80%e4%b8%aa%e6%9c%80%e7%ae%80socket.io%e8%81%8a%e5%a4%a9%e5%ae%a4&amp;source=http%3a%2f%2flocalhost%3a1313%2fposts%2fjuejin%2fnestjs%2bvue3%25E6%2589%2593%25E9%2580%25A0%25E4%25B8%2580%25E4%25B8%25AA%25E6%259C%2580%25E7%25AE%2580socket.io%25E8%2581%258A%25E5%25A4%25A9%25E5%25AE%25A4%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share nestjs&#43;vue3打造一个最简socket.io聊天室 on reddit"
            href="https://reddit.com/submit?url=http%3a%2f%2flocalhost%3a1313%2fposts%2fjuejin%2fnestjs%2bvue3%25E6%2589%2593%25E9%2580%25A0%25E4%25B8%2580%25E4%25B8%25AA%25E6%259C%2580%25E7%25AE%2580socket.io%25E8%2581%258A%25E5%25A4%25A9%25E5%25AE%25A4%2f&title=nestjs%2bvue3%e6%89%93%e9%80%a0%e4%b8%80%e4%b8%aa%e6%9c%80%e7%ae%80socket.io%e8%81%8a%e5%a4%a9%e5%ae%a4">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share nestjs&#43;vue3打造一个最简socket.io聊天室 on facebook"
            href="https://facebook.com/sharer/sharer.php?u=http%3a%2f%2flocalhost%3a1313%2fposts%2fjuejin%2fnestjs%2bvue3%25E6%2589%2593%25E9%2580%25A0%25E4%25B8%2580%25E4%25B8%25AA%25E6%259C%2580%25E7%25AE%2580socket.io%25E8%2581%258A%25E5%25A4%25A9%25E5%25AE%25A4%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share nestjs&#43;vue3打造一个最简socket.io聊天室 on whatsapp"
            href="https://api.whatsapp.com/send?text=nestjs%2bvue3%e6%89%93%e9%80%a0%e4%b8%80%e4%b8%aa%e6%9c%80%e7%ae%80socket.io%e8%81%8a%e5%a4%a9%e5%ae%a4%20-%20http%3a%2f%2flocalhost%3a1313%2fposts%2fjuejin%2fnestjs%2bvue3%25E6%2589%2593%25E9%2580%25A0%25E4%25B8%2580%25E4%25B8%25AA%25E6%259C%2580%25E7%25AE%2580socket.io%25E8%2581%258A%25E5%25A4%25A9%25E5%25AE%25A4%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share nestjs&#43;vue3打造一个最简socket.io聊天室 on telegram"
            href="https://telegram.me/share/url?text=nestjs%2bvue3%e6%89%93%e9%80%a0%e4%b8%80%e4%b8%aa%e6%9c%80%e7%ae%80socket.io%e8%81%8a%e5%a4%a9%e5%ae%a4&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fjuejin%2fnestjs%2bvue3%25E6%2589%2593%25E9%2580%25A0%25E4%25B8%2580%25E4%25B8%25AA%25E6%259C%2580%25E7%25AE%2580socket.io%25E8%2581%258A%25E5%25A4%25A9%25E5%25AE%25A4%2f">
            <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
                <path
                    d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share nestjs&#43;vue3打造一个最简socket.io聊天室 on ycombinator"
            href="https://news.ycombinator.com/submitlink?t=nestjs%2bvue3%e6%89%93%e9%80%a0%e4%b8%80%e4%b8%aa%e6%9c%80%e7%ae%80socket.io%e8%81%8a%e5%a4%a9%e5%ae%a4&u=http%3a%2f%2flocalhost%3a1313%2fposts%2fjuejin%2fnestjs%2bvue3%25E6%2589%2593%25E9%2580%25A0%25E4%25B8%2580%25E4%25B8%25AA%25E6%259C%2580%25E7%25AE%2580socket.io%25E8%2581%258A%25E5%25A4%25A9%25E5%25AE%25A4%2f">
            <svg version="1.1" xml:space="preserve" width="30px" height="30px" viewBox="0 0 512 512" fill="currentColor"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape">
                <path
                    d="M449.446 0C483.971 0 512 28.03 512 62.554L512 449.446C512 483.97 483.97 512 449.446 512L62.554 512C28.03 512 0 483.97 0 449.446L0 62.554C0 28.03 28.029 0 62.554 0L449.446 0ZM183.8767 87.9921H121.8427L230.6673 292.4508V424.0079H281.3328V292.4508L390.1575 87.9921H328.1233L256 238.2489z" />
            </svg>
        </a>
    </li>
</ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span><a href="https://beian.miit.gov.cn/">粤ICP备2023039897号-1</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = '复制';

        function copyingDone() {
            copybutton.innerHTML = '已复制！';
            setTimeout(() => {
                copybutton.innerHTML = '复制';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
