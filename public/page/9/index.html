<!DOCTYPE html>
<html lang="zh" dir="auto">

<head>
	<meta name="generator" content="Hugo 0.134.1"><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>PaperMod</title>

<meta name="description" content="Theme PaperMod - https://github.com/adityatelange/hugo-PaperMod">
<meta name="author" content="Theme PaperMod">
<link rel="canonical" href="http://localhost:1313/">
<meta name="google-site-verification" content="XYZabc">
<link crossorigin="anonymous" href="/assets/css/stylesheet.7b92bf4867c997b58ec50f63451b83777173d5bd5593376852abd85746d09d71.css" integrity="sha256-e5K/SGfJl7WOxQ9jRRuDd3Fz1b1VkzdoUqvYV0bQnXE=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/%3Clink%20/%20abs%20url%3E">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/%3Clink%20/%20abs%20url%3E">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/%3Clink%20/%20abs%20url%3E">
<link rel="apple-touch-icon" href="http://localhost:1313/%3Clink%20/%20abs%20url%3E">
<link rel="mask-icon" href="http://localhost:1313/%3Clink%20/%20abs%20url%3E">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" type="application/rss+xml" href="http://localhost:1313/index.xml">
<link rel="alternate" type="application/json" href="http://localhost:1313/index.json">
<link rel="alternate" hreflang="zh" href="http://localhost:1313/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript><meta property="og:title" content="PaperMod" />
<meta property="og:description" content="Theme PaperMod - https://github.com/adityatelange/hugo-PaperMod" />
<meta property="og:type" content="website" />
<meta property="og:url" content="http://localhost:1313/" />
<meta property="og:image" content="http://localhost:1313/images/papermod-cover.png" />



<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="http://localhost:1313/images/papermod-cover.png" />
<meta name="twitter:title" content="PaperMod"/>
<meta name="twitter:description" content="Theme PaperMod - https://github.com/adityatelange/hugo-PaperMod"/>

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Organization",
  "name": "PaperMod",
  "url": "http://localhost:1313/",
  "description": "Theme PaperMod - https://github.com/adityatelange/hugo-PaperMod",
  "thumbnailUrl": "http://localhost:1313/%3Clink%20/%20abs%20url%3E",
  "sameAs": [
      "https://github.com/adityatelange/hugo-PaperMod", "https://discord.gg/ahpmTvhVmp", "https://ko-fi.com/adityatelange"
  ]
}
</script>
</head>

<body class="list dark" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="Home (Alt + H)">
                        
                    <img src="http://localhost:1313/images/msg_hu15231257772499651944.png" alt="" aria-label="logo"
                        height="20">Home</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/archives" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://github.com/adityatelange/hugo-PaperMod/wiki/" title="WiKi">
                    <span>WiKi</span>&nbsp;
                    <svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round"
                        stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12">
                        <path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"></path>
                        <path d="M15 3h6v6"></path>
                        <path d="M10 14L21 3"></path>
                    </svg>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main"> 

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">【算法】爱吃香蕉的珂珂
    </h2>
  </header>
  <div class="entry-content">
    <p>难度：中等；
题目： 珂珂喜欢吃香蕉。这里有 n 堆香蕉，第 i 堆中有 piles[i] 根香蕉。警卫已经离开了，将在 h 小时后回来。
珂珂可以决定她吃香蕉的速度 k （单位：根/小时）。每个小时，她将会选择一堆香蕉，从中吃掉 k 根。如果这堆香蕉少于 k 根，她将吃掉这堆的所有香蕉，然后这一小时内不会再吃更多的香蕉。
珂珂喜欢慢慢吃，但仍然想在警卫回来前吃掉所有的香蕉。
返回她可以在 h 小时内吃掉所有香蕉的最小速度 k（k 为整数）。
示例 1：
ini
代码解读
复制代码
输入：piles = [3,6,7,11], h = 8 输出：4
示例 2：
ini
代码解读
复制代码
输入：piles = [30,11,23,4,20], h = 5 输出：30
示例 3：
ini
代码解读
...</p>
  </div>
  <footer class="entry-footer"><span title='2024-09-28 00:00:00 +0000 UTC'>九月 28, 2024</span>&nbsp;·&nbsp;2 分钟&nbsp;·&nbsp;时清云</footer>
  <a class="entry-link" aria-label="post link to 【算法】爱吃香蕉的珂珂" href="http://localhost:1313/posts/juejin/%E7%AE%97%E6%B3%95%E7%88%B1%E5%90%83%E9%A6%99%E8%95%89%E7%9A%84%E7%8F%82%E7%8F%82/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">线上数据库死锁了！震惊
    </h2>
  </header>
  <div class="entry-content">
    <p> 前段时间接到一个需求，线上有用户说数据入不了正式库，导入失败，让我排查排查；小意思啦
一、定位问题 报错信息： Lock wait timeout exceeded； try restarting transaction
扔给我一段报错信息，我英语很差啊，看不懂，翻译一下咯，我就看到两个字，死锁；还是数据库死锁，纳尼！数据库死锁这玩意对于一个成熟的项目很难碰到吧，千年等一回啊，按着别人说的步骤我操作了一下，没问题啊，我想大概和业务逻辑有关系吧！
1.1 代码流程问题 果然，大哥实现数据的导入方式是先校验，完成后将数据导入临时表，临时表如果存在校验失败信息的数据那么导入失败，界面提示失败的数据，如果没问题那么将数据导入正式库，导入完成删除临时表；
猛一看没啥问题哈，我之前文章说了我们的项目代码管理的一团乱麻，所以当我产生几次错误的数据以后，我去临时表一看，纳尼，为啥错误提示了后不把错误数据删除了呢，留着干撒；此时我就已看到胜利曙光了，接着我想产生几次正常流程的数据，额，不行，总是报错，但是也不报报错信息，what，有没有搞错，我啥也没干啊，硬着头皮debug，很完美，这个项目的模板再次有问题，无奈，我自己手工造了一个，这简直惨绝人寰，头疼；模板造好，试一条数据，没问题；接着我又看到胜利曙光了;
让别人查下生产表的临时数据，小小机器居然放了十万条数据，由于是临时表，也没加任何索引，所以我考虑起了数据多不多的问题；十万数据多吗，十万数据没索引不多吗，的确，十万数据即使没索引也的确算不上多的数据，哈哈哈哈，那它为啥死锁，我迷茫了起来，再跑， 好家伙，我本地上两万条后就开始死锁了；稍等，我要开始装了；
临时表两万条数据，然后我开了六七个窗口导入，每个窗口6000条数据，我们再从头到尾梳理下流程，首先导入的时候会删除这个类型导入的临时表数据，就是说他没有在 导入失败后删除，而是在下一次导入的时候删除，而下一次导入由于种种条件导致会删除不彻底，这样随着次数增加数据就会越来越多，回过头来，由于机器配置分享给 mysql的并不多，而且删除条件也不是索引，导致删除的时候会全表扫起来，数据一多自然就慢，而我们的超时时间默认60S好像，在删除后如果此时我们另一个用户去 继续导入那么此时存在两个操作，一个是当前的删除后的插入操作，一个是删除操作，更刺激的来了，这玩意用jdbc居然拼接来了个一次插入，我是6000数据所以一次插入6000 ，60000那就一次插六万，大胆刁民，瞎胡闹，客户也不惯着，1w的插，使劲，最后搞不过，召唤我啦；
我能怎么办，我也没办法啊，我主打就是不重构，其实不能怪我，首先没人熟悉业务，我不能乱动，其次就那么一两天，还要改这改那时间不够，再然后改好了倒好， 改不好万一一个没考虑到出问题了还得担责，所以缝缝补补啦，用些漂亮布；。
1.2 数据库配置问题 上面的问题我们可以看到数据库配置的超时时间很短，其实对于批量操作，咱们超时时间尽量长点好点，太短了可能真的处理不过来，所以我们得改下超时时间；
二、怎么解决？ 首先要看到两个点，代码有问题，超时时间也的确很短，有人可能会问没索引啊，这不算问题？是的，这不算问题，首先数据量不多， 其次我是真不知道哪些字段当索引能优化，没有有效字段；
针对超时时间短，我们先给他延长，发现延长了，部分场景有效，但测试过程中如果插入的过程中存在删除并且临时表有几万条数据的话那么删除会耗费很长时间导致插入迟迟插不进去
sql
代码解读
复制代码
--查看 SHOW GLOBAL VARIABLES LIKE &#39;innodb_lock_wait_timeout&#39;; --修改 SET GLOBAL innodb_lock_wait_timeout = 90;
...</p>
  </div>
  <footer class="entry-footer"><span title='2024-05-28 00:00:00 +0000 UTC'>五月 28, 2024</span>&nbsp;·&nbsp;1 分钟&nbsp;·&nbsp;小红帽的大灰狼</footer>
  <a class="entry-link" aria-label="post link to 线上数据库死锁了！震惊" href="http://localhost:1313/posts/juejin/%E7%BA%BF%E4%B8%8A%E6%95%B0%E6%8D%AE%E5%BA%93%E6%AD%BB%E9%94%81%E4%BA%86%E9%9C%87%E6%83%8A/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">关于TS的枚举，你都知道吗？
    </h2>
  </header>
  <div class="entry-content">
    <p>在 TypeScript 中，enum 关键字提供了一种定义一组命名常量的方式，这些常量可以作为类型或值使用。枚举最早在 TypeScript 的第一个版本中引入，虽然它们还没有被添加到 JavaScript 中，但它们在 TypeScript 中作为一个独有的运行时特性，展现了强大的功能和一些有趣的行为。
枚举特别适用于定义一组有限的、稳定的常量值，帮助开发者编写更加清晰和易于维护的代码。
数值枚举 数值枚举是一种将相关的成员组合在一起，并为它们自动分配从 0 开始的数值的机制。例如，以下是一个定义了 AlbumStatus 枚举的代码：
typescript
代码解读
复制代码
enum AlbumStatus { NewRelease, OnSale, StaffPick }
在这个例子中，AlbumStatus.NewRelease 的值为 0，AlbumStatus.OnSale 为 1，依此类推。我们可以通过名称来使用这个枚举：
typescript
代码解读
复制代码
function logStatus(status: AlbumStatus) { console.log(status); // 输出 0 } logStatus(AlbumStatus.NewRelease);
...</p>
  </div>
  <footer class="entry-footer"><span title='2024-08-15 00:00:00 +0000 UTC'>八月 15, 2024</span>&nbsp;·&nbsp;3 分钟&nbsp;·&nbsp;叶知秋水</footer>
  <a class="entry-link" aria-label="post link to 关于TS的枚举，你都知道吗？" href="http://localhost:1313/posts/juejin/%E5%85%B3%E4%BA%8Ets%E7%9A%84%E6%9E%9A%E4%B8%BE%E4%BD%A0%E9%83%BD%E7%9F%A5%E9%81%93%E5%90%97/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">剖析JS里的流式请求—ReadableStream
    </h2>
  </header>
  <div class="entry-content">
    <p>对于XMLHttpRequest和Fetch，作为前后端通信的主要协议，相信大家都烂熟于心了，它允许我们发送Http请求，以文本格式跟后端通信。那Web Streams API，你用过么？一种在浏览器操作Streams流的API。今天主要介绍一下ReadableStream。
1、什么是流 在介绍流之前，我们先来了解一下什么是流。如名称所示，流就像水流一样，会持续性地从一段流动到另一端，只有当上游停止输入时，才会断流。而在浏览器中流会将你想要的资源分成一个个小的分块，然后按位处理它。
实际上，流无处不在，例如看视频时不用完整下载完才可以播放，而是可以边缓冲区边播，又或者我们看到的图像逐渐地显示。
但曾经这些对于 JavaScript 是不可用的。以前，如果我们想要处理某种资源（如视频、文本文件等），我们必须下载完整的文件，等待它反序列化成适当的格式，然后在完整地接收到所有的内容后再进行处理。
Web Streams API 最初是在 2017 年左右开始在浏览器中得到支持的。它被设计为一个标准 API，用于处理数据流，类似于 Node.js 中的 Streams API，但更加现代和统一。Web Streams API 包括 ReadableStream、WritableStream 和 TransformStream，它们可以用于实现复杂的数据流处理逻辑。
具体来说，Web Streams API 被引入到 WHATWG（Web Hypertext Application Technology Working Group）的 Streams 规范中，随后逐渐被主流浏览器厂商所采纳。到了 2018 年，大多数现代浏览器已经开始支持或部分支持这个 API1116。
随着时间的推移，Web Streams API 的支持度不断提高，并且被集成到了各种 Web 平台和工具中。例如，Node.js 在其后续版本中也开始支持 Web Streams API，允许开发者使用统一的 Streams API 来处理服务器端和客户端的流数据。
2、API介绍 了解了Streams API之后，我们来介绍一下今天的主角ReadableStream。
...</p>
  </div>
  <footer class="entry-footer"><span title='2024-06-27 00:00:00 +0000 UTC'>六月 27, 2024</span>&nbsp;·&nbsp;4 分钟&nbsp;·&nbsp;叶知秋水</footer>
  <a class="entry-link" aria-label="post link to 剖析JS里的流式请求—ReadableStream" href="http://localhost:1313/posts/juejin/%E5%89%96%E6%9E%90js%E9%87%8C%E7%9A%84%E6%B5%81%E5%BC%8F%E8%AF%B7%E6%B1%82readablestream/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">JavaScript中最快的循环是什么？
    </h2>
  </header>
  <div class="entry-content">
    <p>无论使用哪种编程语言，循环都是一种内置功能。JavaScript 也不例外，它提供了多种实现循环的方法，偶尔会给开发人员带来困惑：哪一种循环才是最快的？
以下是Javascript中可以实现循环的方法：
For Loop While Loop Do-While Loop For-In Loop For-Of Loop ForEach Loop Map Loop Filter Loop Reduce Loop Some Loop Every Loop Find Loop 我们将对这些循环方法进行测试，以确定哪种方法最快。
为了比较每个循环的性能，我们将使用 console.time() 和 console.timeEnd() 方法来测量它们的执行时间。
javascript
代码解读
复制代码
console.time(&#39;My Description&#39;); // Code to measure console.timeEnd(&#39;My Description&#39;);
用于测试的任务是：将 5000 万个项目从一个数组转移到另一个数组。
javascript
代码解读
复制代码
console.time(&#39;Array Creation&#39;); const numbersList = Array.from({ length: 50_000_000 }, () =&gt; Math.floor(Math.random() * 100)); console.timeEnd(&#39;Array Creation&#39;);
...</p>
  </div>
  <footer class="entry-footer"><span title='2024-10-04 00:00:00 +0000 UTC'>十月 4, 2024</span>&nbsp;·&nbsp;2 分钟&nbsp;·&nbsp;叶知秋水</footer>
  <a class="entry-link" aria-label="post link to JavaScript中最快的循环是什么？" href="http://localhost:1313/posts/juejin/javascript%E4%B8%AD%E6%9C%80%E5%BF%AB%E7%9A%84%E5%BE%AA%E7%8E%AF%E6%98%AF%E4%BB%80%E4%B9%88/"></a>
</article>
<footer class="page-footer">
  <nav class="pagination">
    <a class="prev" href="http://localhost:1313/page/8/">
      «&nbsp;上一页&nbsp;8/153
    </a>
    <a class="next" href="http://localhost:1313/page/10/">下一页&nbsp;10/153&nbsp;»
    </a>
  </nav>
</footer>
    </main>
    
<footer class="footer">
        <span><a href="https://beian.miit.gov.cn/">粤ICP备2023039897号-1</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
