<!DOCTYPE html>
<html lang="zh" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>知识插件 | PaperMod</title>
<meta name="keywords" content="">
<meta name="description" content="Theme PaperMod - https://github.com/adityatelange/hugo-PaperMod">
<meta name="author" content="Theme PaperMod">
<link rel="canonical" href="http://localhost:1313/tags/%E7%9F%A5%E8%AF%86%E6%8F%92%E4%BB%B6/">
<meta name="google-site-verification" content="XYZabc">
<link crossorigin="anonymous" href="/assets/css/stylesheet.7b92bf4867c997b58ec50f63451b83777173d5bd5593376852abd85746d09d71.css" integrity="sha256-e5K/SGfJl7WOxQ9jRRuDd3Fz1b1VkzdoUqvYV0bQnXE=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/%3Clink%20/%20abs%20url%3E">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/%3Clink%20/%20abs%20url%3E">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/%3Clink%20/%20abs%20url%3E">
<link rel="apple-touch-icon" href="http://localhost:1313/%3Clink%20/%20abs%20url%3E">
<link rel="mask-icon" href="http://localhost:1313/%3Clink%20/%20abs%20url%3E">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" type="application/rss+xml" href="http://localhost:1313/tags/%E7%9F%A5%E8%AF%86%E6%8F%92%E4%BB%B6/index.xml">
<link rel="alternate" hreflang="zh" href="http://localhost:1313/tags/%E7%9F%A5%E8%AF%86%E6%8F%92%E4%BB%B6/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript><meta property="og:title" content="知识插件" />
<meta property="og:description" content="Theme PaperMod - https://github.com/adityatelange/hugo-PaperMod" />
<meta property="og:type" content="website" />
<meta property="og:url" content="http://localhost:1313/tags/%E7%9F%A5%E8%AF%86%E6%8F%92%E4%BB%B6/" />
<meta property="og:image" content="http://localhost:1313/images/papermod-cover.png" />



<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="http://localhost:1313/images/papermod-cover.png" />
<meta name="twitter:title" content="知识插件"/>
<meta name="twitter:description" content="Theme PaperMod - https://github.com/adityatelange/hugo-PaperMod"/>

</head>

<body class="list dark" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="Home (Alt + H)">
                        
                    <img src="http://localhost:1313/images/msg_hu15231257772499651944.png" alt="" aria-label="logo"
                        height="20">Home</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/archives" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://github.com/adityatelange/hugo-PaperMod/wiki/" title="WiKi">
                    <span>WiKi</span>&nbsp;
                    <svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round"
                        stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12">
                        <path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"></path>
                        <path d="M15 3h6v6"></path>
                        <path d="M10 14L21 3"></path>
                    </svg>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main"> 
<header class="page-header"><div class="breadcrumbs"><a href="http://localhost:1313/">主页</a>&nbsp;»&nbsp;<a href="http://localhost:1313/tags/">Tags</a></div>
  <h1>
    知识插件
    <a href="/tags/%E7%9F%A5%E8%AF%86%E6%8F%92%E4%BB%B6/index.xml" title="RSS" aria-label="RSS">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
        stroke-linecap="round" stroke-linejoin="round" height="23">
        <path d="M4 11a9 9 0 0 1 9 9" />
        <path d="M4 4a16 16 0 0 1 16 16" />
        <circle cx="5" cy="19" r="1" />
      </svg>
    </a>
  </h1>
</header>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">FAQ类短文本实践内容总结
    </h2>
  </header>
  <div class="entry-content">
    <p>前段时间，以“春节活动内容”作为基础文本数据，实现了从文本处理、知识库构建、检索方案确定及大模型知识问答整个 rag 系统全链路的流程。因“春节活动内容”是经过人工处理的答案类短文本（最长723个字），故其处理方式与 FAQ 类短文本的处理方式相差无几，本文对相关实践内容做一个总结。
1. 文本处理 FAQ 类短文本直接按照一问一答的粒度拆分，考虑到向量化模型的长度限制，要求拆分后的文本最长不能超过750个词，最短不能少于1个词（过短的内容去除）。
因提供的文本数据只有答案无对应的问题，故未使用元数据，直接读取txt\docx文档并利用换行符进行切分，得到拆分后的文本列表。
2. 知识库构建 向量化模型采用开源预训练的模型，本地 CPU 部署，未使用任何加速技术。
3. 检索方案确定 测试发现，纯向量检索召回（阈值范围0-2）效果不太好，阈值为1的情况下测试结果如下：
由此可见，当前场景下，bge-base-zh-v1.5 模型表现更好，故选用该模型构建向量库并用于向量检索。
通过引入关键词召回，并调整相关权重和阈值（向量召回权重0.8，阈值1.4；关键词召回权重0.2，阈值6），再次使用春节活动测试用例测试后，模型效果有较大提升：
由此可见，检索方案的确定并非一蹴而就的，需要基于具体的场景数据来测评。首先要初选向量化模型，敲定检索方式后，还需要多次测试来确定具体的权重和阈值。
4. 大模型知识问答 本案例采用的是多次测试调整后的提示词和讯飞星火认知大模型完成知识问答，从测试结果来看，回答错误的用例中，有部分检索到了对应的知识，但大模型回答错误，可能与检索知识的顺序和无关内容的影响有关，由此可见检索效果对结果影响较大，但大模型本身的能力也很重要。所以后续大模型的选择、提示词的确认都需要基于具体的场景数据来测评抉择。
Filter table dataCreate a pivot tableCreate a chart from data series
Configure buttons visibility
...</p>
  </div>
  <footer class="entry-footer">1 分钟&nbsp;·&nbsp;王宇</footer>
  <a class="entry-link" aria-label="post link to FAQ类短文本实践内容总结" href="http://localhost:1313/posts/wiki/faq%E7%B1%BB%E7%9F%AD%E6%96%87%E6%9C%AC%E5%AE%9E%E8%B7%B5%E5%86%85%E5%AE%B9%E6%80%BB%E7%BB%93/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">向量模型微调方案设计与实践总结
    </h2>
  </header>
  <div class="entry-content">
    <p>0、前言
本文主要针对“养猪领域”知识向量化和向量检索所用模型进行微调，并总结8月份微调实践的经验。
1**、模型选择**
这是基于5月份构建的“养猪专家”知识库，选用了100条问题，使用3个开源向量模型统计的检出率情况。根据以上测评结果，对于“养猪领域”向量模型微调优先选择 m3e-base 模型，然后才是 bge-base 模型。
2**、训练策略**
FullParametersTraining：全参数微调，不进行任何修改，所有参数都参与训练。 BitFitTraining：只训练某些关键词参数，其他参数固定。通过 keywords 指定要训练的参数名。 PrefixTraining：只训练前缀 tokens 对应的 embedding 参数。通过 additional_special_tokens 指定前缀 tokens，并只训练这些 tokens 的 embedding。 这些策略可以平衡语料大小与模型大小，降低过拟合风险，帮助模型快速适应下游任务。通常先做全参数训练预热一下，再使用部分固定或前缀训练等策略微调到特定下游任务，具体策略选择应根据实际效果进行调整。训练是基于预训练的 embedding 模型，一般能让它在原来的基础上提升3%-10%的性能。
3**、数据格式**
通常，有以下三种训练样本格式:
**Pair (句子对)：**每个样本包含一个正例句子对。用于学习区分正例和负例句子。 [{
’text’: ‘第1胎次母猪的日粮饲喂量和赖氨酸含量是多少？’,
‘positive_text’: ‘第1胎次母猪的日粮饲喂量为4.0lb(1.8kg)，含赖氨酸0.51%。’
},
{
’text’: ‘对于群养在特定地板类型的母猪，温度可以如何调整？’,
‘positive_text’: ‘群养在水泥地板的母猪，温度可以降低4°F(2.2°C)，而在铺有干草的圈舍中的母猪，温度可以降低8°F(4.4°C)。’
}]
...</p>
  </div>
  <footer class="entry-footer">1 分钟&nbsp;·&nbsp;王宇</footer>
  <a class="entry-link" aria-label="post link to 向量模型微调方案设计与实践总结" href="http://localhost:1313/posts/wiki/%E5%90%91%E9%87%8F%E6%A8%A1%E5%9E%8B%E5%BE%AE%E8%B0%83%E6%96%B9%E6%A1%88%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E8%B7%B5%E6%80%BB%E7%BB%93/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">算法接口设计
    </h2>
  </header>
  <div class="entry-content">
    <p> 11. 领域通用检索服务接口 22. 知识插件检索服务接口 33. 知识库构建文件格式及限制 应用名(nacos注册的应用名)：yingzi-algorithm-rag
开发环境： 172.18.64.37
测试/预生产/生产环境：k8s
算法服务错误码：
错误码
触发条件
错误信息示例
备注
错误码
触发条件
错误信息示例
备注
100000000
成功返回
100100201
数据越界
数据越界：问题长度超出限制：[1, 750]
100100203
输入参数类型/格式错误。
不支持的数据格式：app_type
100100205
输入字段缺失
输入字段缺失：query
100100206
输入数据缺失
输入数据缺失：knowledge_configs
100600900
算法服务未知错误/服务器内部错误
未知错误，请联系算法管理员
...</p>
  </div>
  <footer class="entry-footer">3 分钟&nbsp;·&nbsp;王宇</footer>
  <a class="entry-link" aria-label="post link to 算法接口设计" href="http://localhost:1313/posts/wiki/%E7%AE%97%E6%B3%95%E6%8E%A5%E5%8F%A3%E8%AE%BE%E8%AE%A1/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">向量模型GPU支持镜像制作
    </h2>
  </header>
  <div class="entry-content">
    <p>1、使用基础镜像启动一个容器：nvcr.io/nvidia/cuda:12.2.0-runtime-ubuntu20.04
2、更新、安装依赖、选择时区、安装基础包
apt update
apt -y upgrade
apt install build-essential zlib1g-dev libffi-dev libssl-dev libreoffice -y
apt install ca-certificates apt-transport-https software-properties-common lsb-release -y
apt-get -y install $(grep -vE “^\s*#” /tmp/base_requirements.txt | tr “\r\n” &#34; “)
base_requirements.txt
3、下载 Python 3.11 源代码、配置、编译并安装
离线下载python3.11包：https://www.python.org/ftp/python/3.11.6/Python-3.11.6.tgz
tar -xzvf Python-3.11.6.tgz
cd Python-3.11.6
# 在配置文件时通过–prefix指定安装路径
# mkdir /usr/local/python3.11
# ./configure –prefix=/usr/local/python3.11
./configure
./configure –enable-optimizations # 执行后无序额外配置可直接使用python3调用python编辑器
make &amp;&amp; make install
4、验证安装、修改软链接
python3.11 –version
python3 –version
pip3 –version
which python3
# rm -rf /usr/local/bin/python
ln -s /usr/local/bin/python3.11 /usr/local/bin/python
# 升级pip版本
pip3 install –upgrade pip
5、清除安装包
rm -r Python-3.11.6.tgz
rm -r Python-3.11.6
6、安装指定版本的pytorch（安装太慢可在对应网址下载后离线安装）
# pip install torch==2.1.0 –index-url https://download.pytorch.org/whl/cu121
# pip install torch==2.1.0 -f https://download.pytorch.org/whl/cu121/torch_stable.html
pip install torch-2.1.0&#43;cu121-cp311-cp311-linux_x86_64.whl
pip install numpy==1.24.4 -i https://mirrors.aliyun.com/pypi/simple/ –trusted-host mirrors.aliyun.com/pypi
7、验证是否安装成功
python3
import torch
torch.cuda.is_available() # 成功返回true
...</p>
  </div>
  <footer class="entry-footer">1 分钟&nbsp;·&nbsp;王宇</footer>
  <a class="entry-link" aria-label="post link to 向量模型GPU支持镜像制作" href="http://localhost:1313/posts/wiki/%E5%90%91%E9%87%8F%E6%A8%A1%E5%9E%8Bgpu%E6%94%AF%E6%8C%81%E9%95%9C%E5%83%8F%E5%88%B6%E4%BD%9C/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">RAG技术实践及应用中的探索与思考
    </h2>
  </header>
  <div class="entry-content">
    <p> 1 前言 2一、RAG 技术介绍 2.11. 概述 2.22. 知识库的构建 2.2.12.1 文档拆分与处理 2.2.22.2 知识向量化入库 2.33. 检索召回 2.3.13.1 关键词检索 2.3.23.2 向量检索 2.3.33.3 召回重排序 2.44. 第三方平台能力概要 3二、RAG 技术实践 3.11. 短文本类问答实践 3.1.11.1 知识库的构建 3.1.21.2 检索应用 3.1.31.3 思考总结 3.22. 长文档类问答实践 3.2.12.1 知识库的构建 3.2.22.2 探索总结 3.33. 表格类问答实践 3.3.13.1 知识库的构建 3.3.23.2 探索总结 4三、思考与总结 前言 传统自然语言处理（NLP）算法和大规模语言模型（Large Language Models, LLMs）是自然语言处理领域的两大技术分支，各有其特点和适用场景。下面是两者优缺点的对比：
...</p>
  </div>
  <footer class="entry-footer">2 分钟&nbsp;·&nbsp;王宇</footer>
  <a class="entry-link" aria-label="post link to RAG技术实践及应用中的探索与思考" href="http://localhost:1313/posts/wiki/rag%E6%8A%80%E6%9C%AF%E5%AE%9E%E8%B7%B5%E5%8F%8A%E5%BA%94%E7%94%A8%E4%B8%AD%E7%9A%84%E6%8E%A2%E7%B4%A2%E4%B8%8E%E6%80%9D%E8%80%83/"></a>
</article>
<footer class="page-footer">
  <nav class="pagination">
    <a class="next" href="http://localhost:1313/tags/%E7%9F%A5%E8%AF%86%E6%8F%92%E4%BB%B6/page/2/">下一页&nbsp;2/2&nbsp;»
    </a>
  </nav>
</footer>
    </main>
    
<footer class="footer">
        <span><a href="https://beian.miit.gov.cn/">粤ICP备2023039897号-1</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
